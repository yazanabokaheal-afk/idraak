var eL=Object.defineProperty;var QA=n=>{throw TypeError(n)};var tL=(n,e,t)=>e in n?eL(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var z=(n,e,t)=>tL(n,typeof e!="symbol"?e+"":e,t),t_=(n,e,t)=>e.has(n)||QA("Cannot "+t);var u=(n,e,t)=>(t_(n,e,"read from private field"),t?t.call(n):e.get(n)),A=(n,e,t)=>e.has(n)?QA("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),x=(n,e,t,s)=>(t_(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),C=(n,e,t)=>(t_(n,e,"access private method"),t);var Vt=(n,e,t,s)=>({set _(i){x(n,e,i,t)},get _(){return u(n,e,s)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();var Ai=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function nL(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var i=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:function(){return n[s]}})}),t}var i2={exports:{}},hb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sL=Symbol.for("react.transitional.element"),iL=Symbol.for("react.fragment");function r2(n,e,t){var s=null;if(t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),"key"in e){t={};for(var i in e)i!=="key"&&(t[i]=e[i])}else t=e;return e=t.ref,{$$typeof:sL,type:n,key:s,ref:e!==void 0?e:null,props:t}}hb.Fragment=iL;hb.jsx=r2;hb.jsxs=r2;i2.exports=hb;var g=i2.exports,a2={exports:{}},me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE=Symbol.for("react.transitional.element"),rL=Symbol.for("react.portal"),aL=Symbol.for("react.fragment"),oL=Symbol.for("react.strict_mode"),lL=Symbol.for("react.profiler"),cL=Symbol.for("react.consumer"),uL=Symbol.for("react.context"),dL=Symbol.for("react.forward_ref"),hL=Symbol.for("react.suspense"),fL=Symbol.for("react.memo"),o2=Symbol.for("react.lazy"),pL=Symbol.for("react.activity"),ZA=Symbol.iterator;function mL(n){return n===null||typeof n!="object"?null:(n=ZA&&n[ZA]||n["@@iterator"],typeof n=="function"?n:null)}var l2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c2=Object.assign,u2={};function pf(n,e,t){this.props=n,this.context=e,this.refs=u2,this.updater=t||l2}pf.prototype.isReactComponent={};pf.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};pf.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function d2(){}d2.prototype=pf.prototype;function uE(n,e,t){this.props=n,this.context=e,this.refs=u2,this.updater=t||l2}var dE=uE.prototype=new d2;dE.constructor=uE;c2(dE,pf.prototype);dE.isPureReactComponent=!0;var e1=Array.isArray;function cx(){}var ut={H:null,A:null,T:null,S:null},h2=Object.prototype.hasOwnProperty;function hE(n,e,t){var s=t.ref;return{$$typeof:cE,type:n,key:e,ref:s!==void 0?s:null,props:t}}function gL(n,e){return hE(n.type,e,n.props)}function fE(n){return typeof n=="object"&&n!==null&&n.$$typeof===cE}function yL(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var t1=/\/+/g;function n_(n,e){return typeof n=="object"&&n!==null&&n.key!=null?yL(""+n.key):e.toString(36)}function vL(n){switch(n.status){case"fulfilled":return n.value;case"rejected":throw n.reason;default:switch(typeof n.status=="string"?n.then(cx,cx):(n.status="pending",n.then(function(e){n.status==="pending"&&(n.status="fulfilled",n.value=e)},function(e){n.status==="pending"&&(n.status="rejected",n.reason=e)})),n.status){case"fulfilled":return n.value;case"rejected":throw n.reason}}throw n}function Lu(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"bigint":case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case cE:case rL:a=!0;break;case o2:return a=n._init,Lu(a(n._payload),e,t,s,i)}}if(a)return i=i(n),a=s===""?"."+n_(n,0):s,e1(i)?(t="",a!=null&&(t=a.replace(t1,"$&/")+"/"),Lu(i,e,t,"",function(c){return c})):i!=null&&(fE(i)&&(i=gL(i,t+(i.key==null||n&&n.key===i.key?"":(""+i.key).replace(t1,"$&/")+"/")+a)),e.push(i)),1;a=0;var o=s===""?".":s+":";if(e1(n))for(var l=0;l<n.length;l++)s=n[l],r=o+n_(s,l),a+=Lu(s,e,t,r,i);else if(l=mL(n),typeof l=="function")for(n=l.call(n),l=0;!(s=n.next()).done;)s=s.value,r=o+n_(s,l++),a+=Lu(s,e,t,r,i);else if(r==="object"){if(typeof n.then=="function")return Lu(vL(n),e,t,s,i);throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function m0(n,e,t){if(n==null)return n;var s=[],i=0;return Lu(n,s,"","",function(r){return e.call(t,r,i++)}),s}function bL(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var n1=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},_L={map:m0,forEach:function(n,e,t){m0(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return m0(n,function(){e++}),e},toArray:function(n){return m0(n,function(e){return e})||[]},only:function(n){if(!fE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};me.Activity=pL;me.Children=_L;me.Component=pf;me.Fragment=aL;me.Profiler=lL;me.PureComponent=uE;me.StrictMode=oL;me.Suspense=hL;me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ut;me.__COMPILER_RUNTIME={__proto__:null,c:function(n){return ut.H.useMemoCache(n)}};me.cache=function(n){return function(){return n.apply(null,arguments)}};me.cacheSignal=function(){return null};me.cloneElement=function(n,e,t){if(n==null)throw Error("The argument must be a React element, but you passed "+n+".");var s=c2({},n.props),i=n.key;if(e!=null)for(r in e.key!==void 0&&(i=""+e.key),e)!h2.call(e,r)||r==="key"||r==="__self"||r==="__source"||r==="ref"&&e.ref===void 0||(s[r]=e[r]);var r=arguments.length-2;if(r===1)s.children=t;else if(1<r){for(var a=Array(r),o=0;o<r;o++)a[o]=arguments[o+2];s.children=a}return hE(n.type,i,s)};me.createContext=function(n){return n={$$typeof:uL,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null},n.Provider=n,n.Consumer={$$typeof:cL,_context:n},n};me.createElement=function(n,e,t){var s,i={},r=null;if(e!=null)for(s in e.key!==void 0&&(r=""+e.key),e)h2.call(e,s)&&s!=="key"&&s!=="__self"&&s!=="__source"&&(i[s]=e[s]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var o=Array(a),l=0;l<a;l++)o[l]=arguments[l+2];i.children=o}if(n&&n.defaultProps)for(s in a=n.defaultProps,a)i[s]===void 0&&(i[s]=a[s]);return hE(n,r,i)};me.createRef=function(){return{current:null}};me.forwardRef=function(n){return{$$typeof:dL,render:n}};me.isValidElement=fE;me.lazy=function(n){return{$$typeof:o2,_payload:{_status:-1,_result:n},_init:bL}};me.memo=function(n,e){return{$$typeof:fL,type:n,compare:e===void 0?null:e}};me.startTransition=function(n){var e=ut.T,t={};ut.T=t;try{var s=n(),i=ut.S;i!==null&&i(t,s),typeof s=="object"&&s!==null&&typeof s.then=="function"&&s.then(cx,n1)}catch(r){n1(r)}finally{e!==null&&t.types!==null&&(e.types=t.types),ut.T=e}};me.unstable_useCacheRefresh=function(){return ut.H.useCacheRefresh()};me.use=function(n){return ut.H.use(n)};me.useActionState=function(n,e,t){return ut.H.useActionState(n,e,t)};me.useCallback=function(n,e){return ut.H.useCallback(n,e)};me.useContext=function(n){return ut.H.useContext(n)};me.useDebugValue=function(){};me.useDeferredValue=function(n,e){return ut.H.useDeferredValue(n,e)};me.useEffect=function(n,e){return ut.H.useEffect(n,e)};me.useEffectEvent=function(n){return ut.H.useEffectEvent(n)};me.useId=function(){return ut.H.useId()};me.useImperativeHandle=function(n,e,t){return ut.H.useImperativeHandle(n,e,t)};me.useInsertionEffect=function(n,e){return ut.H.useInsertionEffect(n,e)};me.useLayoutEffect=function(n,e){return ut.H.useLayoutEffect(n,e)};me.useMemo=function(n,e){return ut.H.useMemo(n,e)};me.useOptimistic=function(n,e){return ut.H.useOptimistic(n,e)};me.useReducer=function(n,e,t){return ut.H.useReducer(n,e,t)};me.useRef=function(n){return ut.H.useRef(n)};me.useState=function(n){return ut.H.useState(n)};me.useSyncExternalStore=function(n,e,t){return ut.H.useSyncExternalStore(n,e,t)};me.useTransition=function(){return ut.H.useTransition()};me.version="19.2.3";a2.exports=me;var j=a2.exports;const mf=s2(j);var f2={exports:{}},fb={},p2={exports:{}},m2={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(P,F){var H=P.length;P.push(F);e:for(;0<H;){var U=H-1>>>1,K=P[U];if(0<i(K,F))P[U]=F,P[H]=K,H=U;else break e}}function t(P){return P.length===0?null:P[0]}function s(P){if(P.length===0)return null;var F=P[0],H=P.pop();if(H!==F){P[0]=H;e:for(var U=0,K=P.length,se=K>>>1;U<se;){var le=2*(U+1)-1,he=P[le],Je=le+1,Le=P[Je];if(0>i(he,H))Je<K&&0>i(Le,he)?(P[U]=Le,P[Je]=H,U=Je):(P[U]=he,P[le]=H,U=le);else if(Je<K&&0>i(Le,H))P[U]=Le,P[Je]=H,U=Je;else break e}}return F}function i(P,F){var H=P.sortIndex-F.sortIndex;return H!==0?H:P.id-F.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,h=null,p=3,y=!1,v=!1,_=!1,E=!1,b=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function T(P){for(var F=t(c);F!==null;){if(F.callback===null)s(c);else if(F.startTime<=P)s(c),F.sortIndex=F.expirationTime,e(l,F);else break;F=t(c)}}function N(P){if(_=!1,T(P),!v)if(t(l)!==null)v=!0,R||(R=!0,L());else{var F=t(c);F!==null&&ee(N,F.startTime-P)}}var R=!1,k=-1,I=5,M=-1;function D(){return E?!0:!(n.unstable_now()-M<I)}function O(){if(E=!1,R){var P=n.unstable_now();M=P;var F=!0;try{e:{v=!1,_&&(_=!1,w(k),k=-1),y=!0;var H=p;try{t:{for(T(P),h=t(l);h!==null&&!(h.expirationTime>P&&D());){var U=h.callback;if(typeof U=="function"){h.callback=null,p=h.priorityLevel;var K=U(h.expirationTime<=P);if(P=n.unstable_now(),typeof K=="function"){h.callback=K,T(P),F=!0;break t}h===t(l)&&s(l),T(P)}else s(l);h=t(l)}if(h!==null)F=!0;else{var se=t(c);se!==null&&ee(N,se.startTime-P),F=!1}}break e}finally{h=null,p=H,y=!1}F=void 0}}finally{F?L():R=!1}}}var L;if(typeof S=="function")L=function(){S(O)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,G=$.port2;$.port1.onmessage=O,L=function(){G.postMessage(null)}}else L=function(){b(O,0)};function ee(P,F){k=b(function(){P(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(P){P.callback=null},n.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_next=function(P){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var H=p;p=F;try{return P()}finally{p=H}},n.unstable_requestPaint=function(){E=!0},n.unstable_runWithPriority=function(P,F){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var H=p;p=P;try{return F()}finally{p=H}},n.unstable_scheduleCallback=function(P,F,H){var U=n.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?U+H:U):H=U,P){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=H+K,P={id:d++,callback:F,priorityLevel:P,startTime:H,expirationTime:K,sortIndex:-1},H>U?(P.sortIndex=H,e(c,P),t(l)===null&&P===t(c)&&(_?(w(k),k=-1):_=!0,ee(N,H-U))):(P.sortIndex=K,e(l,P),v||y||(v=!0,R||(R=!0,L()))),P},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(P){var F=p;return function(){var H=p;p=F;try{return P.apply(this,arguments)}finally{p=H}}}})(m2);p2.exports=m2;var xL=p2.exports,g2={exports:{}},Qn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wL=j;function y2(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Wa(){}var Kn={d:{f:Wa,r:function(){throw Error(y2(522))},D:Wa,C:Wa,L:Wa,m:Wa,X:Wa,S:Wa,M:Wa},p:0,findDOMNode:null},SL=Symbol.for("react.portal");function EL(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:SL,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}var vp=wL.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function pb(n,e){if(n==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Kn;Qn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(y2(299));return EL(n,e,null,t)};Qn.flushSync=function(n){var e=vp.T,t=Kn.p;try{if(vp.T=null,Kn.p=2,n)return n()}finally{vp.T=e,Kn.p=t,Kn.d.f()}};Qn.preconnect=function(n,e){typeof n=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Kn.d.C(n,e))};Qn.prefetchDNS=function(n){typeof n=="string"&&Kn.d.D(n)};Qn.preinit=function(n,e){if(typeof n=="string"&&e&&typeof e.as=="string"){var t=e.as,s=pb(t,e.crossOrigin),i=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;t==="style"?Kn.d.S(n,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:s,integrity:i,fetchPriority:r}):t==="script"&&Kn.d.X(n,{crossOrigin:s,integrity:i,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Qn.preinitModule=function(n,e){if(typeof n=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var t=pb(e.as,e.crossOrigin);Kn.d.M(n,{crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Kn.d.M(n)};Qn.preload=function(n,e){if(typeof n=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var t=e.as,s=pb(t,e.crossOrigin);Kn.d.L(n,t,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Qn.preloadModule=function(n,e){if(typeof n=="string")if(e){var t=pb(e.as,e.crossOrigin);Kn.d.m(n,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:t,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Kn.d.m(n)};Qn.requestFormReset=function(n){Kn.d.r(n)};Qn.unstable_batchedUpdates=function(n,e){return n(e)};Qn.useFormState=function(n,e,t){return vp.H.useFormState(n,e,t)};Qn.useFormStatus=function(){return vp.H.useHostTransitionStatus()};Qn.version="19.2.3";function v2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v2)}catch(n){console.error(n)}}v2(),g2.exports=Qn;var b2=g2.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tn=xL,_2=j,AL=b2;function B(n){var e="https://react.dev/errors/"+n;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var t=2;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t])}return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function x2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Kg(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function w2(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function S2(n){if(n.tag===31){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function s1(n){if(Kg(n)!==n)throw Error(B(188))}function TL(n){var e=n.alternate;if(!e){if(e=Kg(n),e===null)throw Error(B(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return s1(i),n;if(r===s)return s1(i),e;r=r.sibling}throw Error(B(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(B(189))}}if(t.alternate!==s)throw Error(B(190))}if(t.tag!==3)throw Error(B(188));return t.stateNode.current===t?n:e}function E2(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n;for(n=n.child;n!==null;){if(e=E2(n),e!==null)return e;n=n.sibling}return null}var dt=Object.assign,CL=Symbol.for("react.element"),g0=Symbol.for("react.transitional.element"),qf=Symbol.for("react.portal"),Ju=Symbol.for("react.fragment"),A2=Symbol.for("react.strict_mode"),ux=Symbol.for("react.profiler"),T2=Symbol.for("react.consumer"),ka=Symbol.for("react.context"),pE=Symbol.for("react.forward_ref"),dx=Symbol.for("react.suspense"),hx=Symbol.for("react.suspense_list"),mE=Symbol.for("react.memo"),Za=Symbol.for("react.lazy"),fx=Symbol.for("react.activity"),NL=Symbol.for("react.memo_cache_sentinel"),i1=Symbol.iterator;function Rf(n){return n===null||typeof n!="object"?null:(n=i1&&n[i1]||n["@@iterator"],typeof n=="function"?n:null)}var RL=Symbol.for("react.client.reference");function px(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===RL?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ju:return"Fragment";case ux:return"Profiler";case A2:return"StrictMode";case dx:return"Suspense";case hx:return"SuspenseList";case fx:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case qf:return"Portal";case ka:return n.displayName||"Context";case T2:return(n._context.displayName||"Context")+".Consumer";case pE:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case mE:return e=n.displayName||null,e!==null?e:px(n.type)||"Memo";case Za:e=n._payload,n=n._init;try{return px(n(e))}catch{}}return null}var Vf=Array.isArray,oe=_2.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe=AL.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,su={pending:!1,data:null,method:null,action:null},mx=[],Xu=-1;function Pr(n){return{current:n}}function hn(n){0>Xu||(n.current=mx[Xu],mx[Xu]=null,Xu--)}function at(n,e){Xu++,mx[Xu]=n.current,n.current=e}var Mr=Pr(null),Pp=Pr(null),il=Pr(null),Yy=Pr(null);function Ky(n,e){switch(at(il,e),at(Pp,n),at(Mr,null),e.nodeType){case 9:case 11:n=(n=e.documentElement)&&(n=n.namespaceURI)?uT(n):0;break;default:if(n=e.tagName,e=e.namespaceURI)e=uT(e),n=$k(e,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}hn(Mr),at(Mr,n)}function Zh(){hn(Mr),hn(Pp),hn(il)}function gx(n){n.memoizedState!==null&&at(Yy,n);var e=Mr.current,t=$k(e,n.type);e!==t&&(at(Pp,n),at(Mr,t))}function Jy(n){Pp.current===n&&(hn(Mr),hn(Pp)),Yy.current===n&&(hn(Yy),Vp._currentValue=su)}var s_,r1;function Cl(n){if(s_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);s_=e&&e[1]||"",r1=-1<t.stack.indexOf(`
    at`)?" (<anonymous>)":-1<t.stack.indexOf("@")?"@unknown:0:0":""}return`
`+s_+n+r1}var i_=!1;function r_(n,e){if(!n||i_)return"";i_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(y){var p=y}Reflect.construct(n,[],h)}else{try{h.call()}catch(y){p=y}n.call(h.prototype)}}else{try{throw Error()}catch(y){p=y}(h=n())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(y){if(y&&p&&typeof y.stack=="string")return[y.stack,p.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=s.DetermineComponentFrameRoot(),a=r[0],o=r[1];if(a&&o){var l=a.split(`
`),c=o.split(`
`);for(i=s=0;s<l.length&&!l[s].includes("DetermineComponentFrameRoot");)s++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(s===l.length||i===c.length)for(s=l.length-1,i=c.length-1;1<=s&&0<=i&&l[s]!==c[i];)i--;for(;1<=s&&0<=i;s--,i--)if(l[s]!==c[i]){if(s!==1||i!==1)do if(s--,i--,0>i||l[s]!==c[i]){var d=`
`+l[s].replace(" at new "," at ");return n.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",n.displayName)),d}while(1<=s&&0<=i);break}}}finally{i_=!1,Error.prepareStackTrace=t}return(t=n?n.displayName||n.name:"")?Cl(t):""}function kL(n,e){switch(n.tag){case 26:case 27:case 5:return Cl(n.type);case 16:return Cl("Lazy");case 13:return n.child!==e&&e!==null?Cl("Suspense Fallback"):Cl("Suspense");case 19:return Cl("SuspenseList");case 0:case 15:return r_(n.type,!1);case 11:return r_(n.type.render,!1);case 1:return r_(n.type,!0);case 31:return Cl("Activity");default:return""}}function a1(n){try{var e="",t=null;do e+=kL(n,t),t=n,n=n.return;while(n);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var yx=Object.prototype.hasOwnProperty,gE=tn.unstable_scheduleCallback,a_=tn.unstable_cancelCallback,ML=tn.unstable_shouldYield,IL=tn.unstable_requestPaint,$s=tn.unstable_now,DL=tn.unstable_getCurrentPriorityLevel,C2=tn.unstable_ImmediatePriority,N2=tn.unstable_UserBlockingPriority,Xy=tn.unstable_NormalPriority,PL=tn.unstable_LowPriority,R2=tn.unstable_IdlePriority,LL=tn.log,OL=tn.unstable_setDisableYieldValue,Jg=null,Ys=null;function Zo(n){if(typeof LL=="function"&&OL(n),Ys&&typeof Ys.setStrictMode=="function")try{Ys.setStrictMode(Jg,n)}catch{}}var Ks=Math.clz32?Math.clz32:FL,UL=Math.log,BL=Math.LN2;function FL(n){return n>>>=0,n===0?32:31-(UL(n)/BL|0)|0}var y0=256,v0=262144,b0=4194304;function Nl(n){var e=n&42;if(e!==0)return e;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function mb(n,e,t){var s=n.pendingLanes;if(s===0)return 0;var i=0,r=n.suspendedLanes,a=n.pingedLanes;n=n.warmLanes;var o=s&134217727;return o!==0?(s=o&~r,s!==0?i=Nl(s):(a&=o,a!==0?i=Nl(a):t||(t=o&~n,t!==0&&(i=Nl(t))))):(o=s&~r,o!==0?i=Nl(o):a!==0?i=Nl(a):t||(t=s&~n,t!==0&&(i=Nl(t)))),i===0?0:e!==0&&e!==i&&!(e&r)&&(r=i&-i,t=e&-e,r>=t||r===32&&(t&4194048)!==0)?e:i}function Xg(n,e){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&e)===0}function zL(n,e){switch(n){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k2(){var n=b0;return b0<<=1,!(b0&62914560)&&(b0=4194304),n}function o_(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Wg(n,e){n.pendingLanes|=e,e!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function HL(n,e,t,s,i,r){var a=n.pendingLanes;n.pendingLanes=t,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=t,n.entangledLanes&=t,n.errorRecoveryDisabledLanes&=t,n.shellSuspendCounter=0;var o=n.entanglements,l=n.expirationTimes,c=n.hiddenUpdates;for(t=a&~t;0<t;){var d=31-Ks(t),h=1<<d;o[d]=0,l[d]=-1;var p=c[d];if(p!==null)for(c[d]=null,d=0;d<p.length;d++){var y=p[d];y!==null&&(y.lane&=-536870913)}t&=~h}s!==0&&M2(n,s,0),r!==0&&i===0&&n.tag!==0&&(n.suspendedLanes|=r&~(a&~e))}function M2(n,e,t){n.pendingLanes|=e,n.suspendedLanes&=~e;var s=31-Ks(e);n.entangledLanes|=e,n.entanglements[s]=n.entanglements[s]|1073741824|t&261930}function I2(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Ks(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}function D2(n,e){var t=e&-e;return t=t&42?1:yE(t),t&(n.suspendedLanes|e)?0:t}function yE(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function vE(n){return n&=-n,2<n?8<n?n&134217727?32:268435456:8:2}function P2(){var n=Pe.p;return n!==0?n:(n=window.event,n===void 0?32:sM(n.type))}function o1(n,e){var t=Pe.p;try{return Pe.p=n,e()}finally{Pe.p=t}}var _l=Math.random().toString(36).slice(2),Tn="__reactFiber$"+_l,ps="__reactProps$"+_l,gf="__reactContainer$"+_l,vx="__reactEvents$"+_l,jL="__reactListeners$"+_l,GL="__reactHandles$"+_l,l1="__reactResources$"+_l,Qg="__reactMarker$"+_l;function bE(n){delete n[Tn],delete n[ps],delete n[vx],delete n[jL],delete n[GL]}function Wu(n){var e=n[Tn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[gf]||t[Tn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=mT(n);n!==null;){if(t=n[Tn])return t;n=mT(n)}return e}n=t,t=n.parentNode}return null}function yf(n){if(n=n[Tn]||n[gf]){var e=n.tag;if(e===5||e===6||e===13||e===31||e===26||e===27||e===3)return n}return null}function $f(n){var e=n.tag;if(e===5||e===26||e===27||e===6)return n.stateNode;throw Error(B(33))}function gd(n){var e=n[l1];return e||(e=n[l1]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function dn(n){n[Qg]=!0}var L2=new Set,O2={};function yu(n,e){ef(n,e),ef(n+"Capture",e)}function ef(n,e){for(O2[n]=e,n=0;n<e.length;n++)L2.add(e[n])}var qL=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),c1={},u1={};function VL(n){return yx.call(u1,n)?!0:yx.call(c1,n)?!1:qL.test(n)?u1[n]=!0:(c1[n]=!0,!1)}function X0(n,e,t){if(VL(e))if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":n.removeAttribute(e);return;case"boolean":var s=e.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){n.removeAttribute(e);return}}n.setAttribute(e,""+t)}}function _0(n,e,t){if(t===null)n.removeAttribute(e);else{switch(typeof t){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(e);return}n.setAttribute(e,""+t)}}function Or(n,e,t,s){if(s===null)n.removeAttribute(t);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(t);return}n.setAttributeNS(e,t,""+s)}}function pi(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function U2(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $L(n,e,t){var s=Object.getOwnPropertyDescriptor(n.constructor.prototype,e);if(!n.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,r=s.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){t=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:s.enumerable}),{getValue:function(){return t},setValue:function(a){t=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function bx(n){if(!n._valueTracker){var e=U2(n)?"checked":"value";n._valueTracker=$L(n,e,""+n[e])}}function B2(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=U2(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Wy(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var YL=/[\n"\\]/g;function yi(n){return n.replace(YL,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function _x(n,e,t,s,i,r,a,o){n.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?n.type=a:n.removeAttribute("type"),e!=null?a==="number"?(e===0&&n.value===""||n.value!=e)&&(n.value=""+pi(e)):n.value!==""+pi(e)&&(n.value=""+pi(e)):a!=="submit"&&a!=="reset"||n.removeAttribute("value"),e!=null?xx(n,a,pi(e)):t!=null?xx(n,a,pi(t)):s!=null&&n.removeAttribute("value"),i==null&&r!=null&&(n.defaultChecked=!!r),i!=null&&(n.checked=i&&typeof i!="function"&&typeof i!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?n.name=""+pi(o):n.removeAttribute("name")}function F2(n,e,t,s,i,r,a,o){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(n.type=r),e!=null||t!=null){if(!(r!=="submit"&&r!=="reset"||e!=null)){bx(n);return}t=t!=null?""+pi(t):"",e=e!=null?""+pi(e):t,o||e===n.value||(n.value=e),n.defaultValue=e}s=s??i,s=typeof s!="function"&&typeof s!="symbol"&&!!s,n.checked=o?n.checked:!!s,n.defaultChecked=!!s,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(n.name=a),bx(n)}function xx(n,e,t){e==="number"&&Wy(n.ownerDocument)===n||n.defaultValue===""+t||(n.defaultValue=""+t)}function yd(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+pi(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function z2(n,e,t){if(e!=null&&(e=""+pi(e),e!==n.value&&(n.value=e),t==null)){n.defaultValue!==e&&(n.defaultValue=e);return}n.defaultValue=t!=null?""+pi(t):""}function H2(n,e,t,s){if(e==null){if(s!=null){if(t!=null)throw Error(B(92));if(Vf(s)){if(1<s.length)throw Error(B(93));s=s[0]}t=s}t==null&&(t=""),e=t}t=pi(e),n.defaultValue=t,s=n.textContent,s===t&&s!==""&&s!==null&&(n.value=s),bx(n)}function tf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var KL=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function d1(n,e,t){var s=e.indexOf("--")===0;t==null||typeof t=="boolean"||t===""?s?n.setProperty(e,""):e==="float"?n.cssFloat="":n[e]="":s?n.setProperty(e,t):typeof t!="number"||t===0||KL.has(e)?e==="float"?n.cssFloat=t:n[e]=(""+t).trim():n[e]=t+"px"}function j2(n,e,t){if(e!=null&&typeof e!="object")throw Error(B(62));if(n=n.style,t!=null){for(var s in t)!t.hasOwnProperty(s)||e!=null&&e.hasOwnProperty(s)||(s.indexOf("--")===0?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="");for(var i in e)s=e[i],e.hasOwnProperty(i)&&t[i]!==s&&d1(n,i,s)}else for(var r in e)e.hasOwnProperty(r)&&d1(n,r,e[r])}function _E(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JL=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),XL=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function W0(n){return XL.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Ma(){}var wx=null;function xE(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Qu=null,vd=null;function h1(n){var e=yf(n);if(e&&(n=e.stateNode)){var t=n[ps]||null;e:switch(n=e.stateNode,e.type){case"input":if(_x(n,t.value,t.defaultValue,t.defaultValue,t.checked,t.defaultChecked,t.type,t.name),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll('input[name="'+yi(""+e)+'"][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=s[ps]||null;if(!i)throw Error(B(90));_x(s,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(e=0;e<t.length;e++)s=t[e],s.form===n.form&&B2(s)}break e;case"textarea":z2(n,t.value,t.defaultValue);break e;case"select":e=t.value,e!=null&&yd(n,!!t.multiple,e,!1)}}}var l_=!1;function G2(n,e,t){if(l_)return n(e,t);l_=!0;try{var s=n(e);return s}finally{if(l_=!1,(Qu!==null||vd!==null)&&(Cb(),Qu&&(e=Qu,n=vd,vd=Qu=null,h1(e),n)))for(e=0;e<n.length;e++)h1(n[e])}}function Lp(n,e){var t=n.stateNode;if(t===null)return null;var s=t[ps]||null;if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(B(231,e,typeof t));return t}var Fa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sx=!1;if(Fa)try{var kf={};Object.defineProperty(kf,"passive",{get:function(){Sx=!0}}),window.addEventListener("test",kf,kf),window.removeEventListener("test",kf,kf)}catch{Sx=!1}var el=null,wE=null,Q0=null;function q2(){if(Q0)return Q0;var n,e=wE,t=e.length,s,i="value"in el?el.value:el.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return Q0=i.slice(n,1<s?1-s:void 0)}function Z0(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function x0(){return!0}function f1(){return!1}function ms(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?x0:f1,this.isPropagationStopped=f1,this}return dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=x0)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=x0)},persist:function(){},isPersistent:x0}),e}var vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gb=ms(vu),Zg=dt({},vu,{view:0,detail:0}),WL=ms(Zg),c_,u_,Mf,yb=dt({},Zg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:SE,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Mf&&(Mf&&n.type==="mousemove"?(c_=n.screenX-Mf.screenX,u_=n.screenY-Mf.screenY):u_=c_=0,Mf=n),c_)},movementY:function(n){return"movementY"in n?n.movementY:u_}}),p1=ms(yb),QL=dt({},yb,{dataTransfer:0}),ZL=ms(QL),eO=dt({},Zg,{relatedTarget:0}),d_=ms(eO),tO=dt({},vu,{animationName:0,elapsedTime:0,pseudoElement:0}),nO=ms(tO),sO=dt({},vu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),iO=ms(sO),rO=dt({},vu,{data:0}),m1=ms(rO),aO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cO(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=lO[n])?!!e[n]:!1}function SE(){return cO}var uO=dt({},Zg,{key:function(n){if(n.key){var e=aO[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Z0(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?oO[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:SE,charCode:function(n){return n.type==="keypress"?Z0(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Z0(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),dO=ms(uO),hO=dt({},yb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g1=ms(hO),fO=dt({},Zg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:SE}),pO=ms(fO),mO=dt({},vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),gO=ms(mO),yO=dt({},yb,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),vO=ms(yO),bO=dt({},vu,{newState:0,oldState:0}),_O=ms(bO),xO=[9,13,27,32],EE=Fa&&"CompositionEvent"in window,bp=null;Fa&&"documentMode"in document&&(bp=document.documentMode);var wO=Fa&&"TextEvent"in window&&!bp,V2=Fa&&(!EE||bp&&8<bp&&11>=bp),y1=" ",v1=!1;function $2(n,e){switch(n){case"keyup":return xO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Y2(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Zu=!1;function SO(n,e){switch(n){case"compositionend":return Y2(e);case"keypress":return e.which!==32?null:(v1=!0,y1);case"textInput":return n=e.data,n===y1&&v1?null:n;default:return null}}function EO(n,e){if(Zu)return n==="compositionend"||!EE&&$2(n,e)?(n=q2(),Q0=wE=el=null,Zu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return V2&&e.locale!=="ko"?null:e.data;default:return null}}var AO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function b1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!AO[n.type]:e==="textarea"}function K2(n,e,t,s){Qu?vd?vd.push(s):vd=[s]:Qu=s,e=mv(e,"onChange"),0<e.length&&(t=new gb("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var _p=null,Op=null;function TO(n){Gk(n,0)}function vb(n){var e=$f(n);if(B2(e))return n}function _1(n,e){if(n==="change")return e}var J2=!1;if(Fa){var h_;if(Fa){var f_="oninput"in document;if(!f_){var x1=document.createElement("div");x1.setAttribute("oninput","return;"),f_=typeof x1.oninput=="function"}h_=f_}else h_=!1;J2=h_&&(!document.documentMode||9<document.documentMode)}function w1(){_p&&(_p.detachEvent("onpropertychange",X2),Op=_p=null)}function X2(n){if(n.propertyName==="value"&&vb(Op)){var e=[];K2(e,Op,n,xE(n)),G2(TO,e)}}function CO(n,e,t){n==="focusin"?(w1(),_p=e,Op=t,_p.attachEvent("onpropertychange",X2)):n==="focusout"&&w1()}function NO(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return vb(Op)}function RO(n,e){if(n==="click")return vb(e)}function kO(n,e){if(n==="input"||n==="change")return vb(e)}function MO(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ws=typeof Object.is=="function"?Object.is:MO;function Up(n,e){if(Ws(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!yx.call(e,i)||!Ws(n[i],e[i]))return!1}return!0}function S1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function E1(n,e){var t=S1(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=S1(t)}}function W2(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?W2(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Q2(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var e=Wy(n.document);e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Wy(n.document)}return e}function AE(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}var IO=Fa&&"documentMode"in document&&11>=document.documentMode,ed=null,Ex=null,xp=null,Ax=!1;function A1(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Ax||ed==null||ed!==Wy(s)||(s=ed,"selectionStart"in s&&AE(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),xp&&Up(xp,s)||(xp=s,s=mv(Ex,"onSelect"),0<s.length&&(e=new gb("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=ed)))}function El(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var td={animationend:El("Animation","AnimationEnd"),animationiteration:El("Animation","AnimationIteration"),animationstart:El("Animation","AnimationStart"),transitionrun:El("Transition","TransitionRun"),transitionstart:El("Transition","TransitionStart"),transitioncancel:El("Transition","TransitionCancel"),transitionend:El("Transition","TransitionEnd")},p_={},Z2={};Fa&&(Z2=document.createElement("div").style,"AnimationEvent"in window||(delete td.animationend.animation,delete td.animationiteration.animation,delete td.animationstart.animation),"TransitionEvent"in window||delete td.transitionend.transition);function bu(n){if(p_[n])return p_[n];if(!td[n])return n;var e=td[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in Z2)return p_[n]=e[t];return n}var eR=bu("animationend"),tR=bu("animationiteration"),nR=bu("animationstart"),DO=bu("transitionrun"),PO=bu("transitionstart"),LO=bu("transitioncancel"),sR=bu("transitionend"),iR=new Map,Tx="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tx.push("scrollEnd");function Qi(n,e){iR.set(n,e),yu(e,[n])}var Qy=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},fi=[],nd=0,TE=0;function bb(){for(var n=nd,e=TE=nd=0;e<n;){var t=fi[e];fi[e++]=null;var s=fi[e];fi[e++]=null;var i=fi[e];fi[e++]=null;var r=fi[e];if(fi[e++]=null,s!==null&&i!==null){var a=s.pending;a===null?i.next=i:(i.next=a.next,a.next=i),s.pending=i}r!==0&&rR(t,i,r)}}function _b(n,e,t,s){fi[nd++]=n,fi[nd++]=e,fi[nd++]=t,fi[nd++]=s,TE|=s,n.lanes|=s,n=n.alternate,n!==null&&(n.lanes|=s)}function CE(n,e,t,s){return _b(n,e,t,s),Zy(n)}function _u(n,e){return _b(n,null,null,e),Zy(n)}function rR(n,e,t){n.lanes|=t;var s=n.alternate;s!==null&&(s.lanes|=t);for(var i=!1,r=n.return;r!==null;)r.childLanes|=t,s=r.alternate,s!==null&&(s.childLanes|=t),r.tag===22&&(n=r.stateNode,n===null||n._visibility&1||(i=!0)),n=r,r=r.return;return n.tag===3?(r=n.stateNode,i&&e!==null&&(i=31-Ks(t),n=r.hiddenUpdates,s=n[i],s===null?n[i]=[e]:s.push(e),e.lane=t|536870912),r):null}function Zy(n){if(50<kp)throw kp=0,Yx=null,Error(B(185));for(var e=n.return;e!==null;)n=e,e=n.return;return n.tag===3?n.stateNode:null}var sd={};function OO(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function js(n,e,t,s){return new OO(n,e,t,s)}function NE(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Da(n,e){var t=n.alternate;return t===null?(t=js(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&65011712,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t.refCleanup=n.refCleanup,t}function aR(n,e){n.flags&=65011714;var t=n.alternate;return t===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,n.type=t.type,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n}function ey(n,e,t,s,i,r){var a=0;if(s=n,typeof n=="function")NE(n)&&(a=1);else if(typeof n=="string")a=H4(n,t,Mr.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case fx:return n=js(31,t,e,i),n.elementType=fx,n.lanes=r,n;case Ju:return iu(t.children,i,r,e);case A2:a=8,i|=24;break;case ux:return n=js(12,t,e,i|2),n.elementType=ux,n.lanes=r,n;case dx:return n=js(13,t,e,i),n.elementType=dx,n.lanes=r,n;case hx:return n=js(19,t,e,i),n.elementType=hx,n.lanes=r,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ka:a=10;break e;case T2:a=9;break e;case pE:a=11;break e;case mE:a=14;break e;case Za:a=16,s=null;break e}a=29,t=Error(B(130,n===null?"null":typeof n,"")),s=null}return e=js(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function iu(n,e,t,s){return n=js(7,n,s,e),n.lanes=t,n}function m_(n,e,t){return n=js(6,n,null,e),n.lanes=t,n}function oR(n){var e=js(18,null,null,0);return e.stateNode=n,e}function g_(n,e,t){return e=js(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}var T1=new WeakMap;function vi(n,e){if(typeof n=="object"&&n!==null){var t=T1.get(n);return t!==void 0?t:(e={value:n,source:e,stack:a1(e)},T1.set(n,e),e)}return{value:n,source:e,stack:a1(e)}}var id=[],rd=0,ev=null,Bp=0,mi=[],gi=0,fl=null,Nr=1,Rr="";function Yr(n,e){id[rd++]=Bp,id[rd++]=ev,ev=n,Bp=e}function lR(n,e,t){mi[gi++]=Nr,mi[gi++]=Rr,mi[gi++]=fl,fl=n;var s=Nr;n=Rr;var i=32-Ks(s)-1;s&=~(1<<i),t+=1;var r=32-Ks(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Nr=1<<32-Ks(e)+i|t<<i|s,Rr=r+n}else Nr=1<<r|t<<i|s,Rr=n}function RE(n){n.return!==null&&(Yr(n,1),lR(n,1,0))}function kE(n){for(;n===ev;)ev=id[--rd],id[rd]=null,Bp=id[--rd],id[rd]=null;for(;n===fl;)fl=mi[--gi],mi[gi]=null,Rr=mi[--gi],mi[gi]=null,Nr=mi[--gi],mi[gi]=null}function cR(n,e){mi[gi++]=Nr,mi[gi++]=Rr,mi[gi++]=fl,Nr=e.id,Rr=e.overflow,fl=n}var Cn=null,ct=null,Ce=!1,rl=null,bi=!1,Cx=Error(B(519));function pl(n){var e=Error(B(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fp(vi(e,n)),Cx}function C1(n){var e=n.stateNode,t=n.type,s=n.memoizedProps;switch(e[Tn]=n,e[ps]=s,t){case"dialog":xe("cancel",e),xe("close",e);break;case"iframe":case"object":case"embed":xe("load",e);break;case"video":case"audio":for(t=0;t<Gp.length;t++)xe(Gp[t],e);break;case"source":xe("error",e);break;case"img":case"image":case"link":xe("error",e),xe("load",e);break;case"details":xe("toggle",e);break;case"input":xe("invalid",e),F2(e,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":xe("invalid",e);break;case"textarea":xe("invalid",e),H2(e,s.value,s.defaultValue,s.children)}t=s.children,typeof t!="string"&&typeof t!="number"&&typeof t!="bigint"||e.textContent===""+t||s.suppressHydrationWarning===!0||Vk(e.textContent,t)?(s.popover!=null&&(xe("beforetoggle",e),xe("toggle",e)),s.onScroll!=null&&xe("scroll",e),s.onScrollEnd!=null&&xe("scrollend",e),s.onClick!=null&&(e.onclick=Ma),e=!0):e=!1,e||pl(n,!0)}function N1(n){for(Cn=n.return;Cn;)switch(Cn.tag){case 5:case 31:case 13:bi=!1;return;case 27:case 3:bi=!0;return;default:Cn=Cn.return}}function Tu(n){if(n!==Cn)return!1;if(!Ce)return N1(n),Ce=!0,!1;var e=n.tag,t;if((t=e!==3&&e!==27)&&((t=e===5)&&(t=n.type,t=!(t!=="form"&&t!=="button")||Qx(n.type,n.memoizedProps)),t=!t),t&&ct&&pl(n),N1(n),e===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(B(317));ct=pT(n)}else if(e===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(B(317));ct=pT(n)}else e===27?(e=ct,xl(n.type)?(n=nw,nw=null,ct=n):ct=e):ct=Cn?wi(n.stateNode.nextSibling):null;return!0}function lu(){ct=Cn=null,Ce=!1}function y_(){var n=rl;return n!==null&&(us===null?us=n:us.push.apply(us,n),rl=null),n}function Fp(n){rl===null?rl=[n]:rl.push(n)}var Nx=Pr(null),xu=null,Ia=null;function no(n,e,t){at(Nx,e._currentValue),e._currentValue=t}function Pa(n){n._currentValue=Nx.current,hn(Nx)}function Rx(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function kx(n,e,t,s){var i=n.child;for(i!==null&&(i.return=n);i!==null;){var r=i.dependencies;if(r!==null){var a=i.child;r=r.firstContext;e:for(;r!==null;){var o=r;r=i;for(var l=0;l<e.length;l++)if(o.context===e[l]){r.lanes|=t,o=r.alternate,o!==null&&(o.lanes|=t),Rx(r.return,t,n),s||(a=null);break e}r=o.next}}else if(i.tag===18){if(a=i.return,a===null)throw Error(B(341));a.lanes|=t,r=a.alternate,r!==null&&(r.lanes|=t),Rx(a,t,n),a=null}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===n){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}}function vf(n,e,t,s){n=null;for(var i=e,r=!1;i!==null;){if(!r){if(i.flags&524288)r=!0;else if(i.flags&262144)break}if(i.tag===10){var a=i.alternate;if(a===null)throw Error(B(387));if(a=a.memoizedProps,a!==null){var o=i.type;Ws(i.pendingProps.value,a.value)||(n!==null?n.push(o):n=[o])}}else if(i===Yy.current){if(a=i.alternate,a===null)throw Error(B(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(n!==null?n.push(Vp):n=[Vp])}i=i.return}n!==null&&kx(e,n,t,s),e.flags|=262144}function tv(n){for(n=n.firstContext;n!==null;){if(!Ws(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function cu(n){xu=n,Ia=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Rn(n){return uR(xu,n)}function w0(n,e){return xu===null&&cu(n),uR(n,e)}function uR(n,e){var t=e._currentValue;if(e={context:e,memoizedValue:t,next:null},Ia===null){if(n===null)throw Error(B(308));Ia=e,n.dependencies={lanes:0,firstContext:e},n.flags|=524288}else Ia=Ia.next=e;return t}var UO=typeof AbortController<"u"?AbortController:function(){var n=[],e=this.signal={aborted:!1,addEventListener:function(t,s){n.push(s)}};this.abort=function(){e.aborted=!0,n.forEach(function(t){return t()})}},BO=tn.unstable_scheduleCallback,FO=tn.unstable_NormalPriority,jt={$$typeof:ka,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ME(){return{controller:new UO,data:new Map,refCount:0}}function e0(n){n.refCount--,n.refCount===0&&BO(FO,function(){n.controller.abort()})}var wp=null,Mx=0,nf=0,bd=null;function zO(n,e){if(wp===null){var t=wp=[];Mx=0,nf=nA(),bd={status:"pending",value:void 0,then:function(s){t.push(s)}}}return Mx++,e.then(R1,R1),e}function R1(){if(--Mx===0&&wp!==null){bd!==null&&(bd.status="fulfilled");var n=wp;wp=null,nf=0,bd=null;for(var e=0;e<n.length;e++)(0,n[e])()}}function HO(n,e){var t=[],s={status:"pending",value:null,reason:null,then:function(i){t.push(i)}};return n.then(function(){s.status="fulfilled",s.value=e;for(var i=0;i<t.length;i++)(0,t[i])(e)},function(i){for(s.status="rejected",s.reason=i,i=0;i<t.length;i++)(0,t[i])(void 0)}),s}var k1=oe.S;oe.S=function(n,e){Ek=$s(),typeof e=="object"&&e!==null&&typeof e.then=="function"&&zO(n,e),k1!==null&&k1(n,e)};var ru=Pr(null);function IE(){var n=ru.current;return n!==null?n:et.pooledCache}function ty(n,e){e===null?at(ru,ru.current):at(ru,e.pool)}function dR(){var n=IE();return n===null?null:{parent:jt._currentValue,pool:n}}var bf=Error(B(460)),DE=Error(B(474)),xb=Error(B(542)),nv={then:function(){}};function M1(n){return n=n.status,n==="fulfilled"||n==="rejected"}function hR(n,e,t){switch(t=n[t],t===void 0?n.push(e):t!==e&&(e.then(Ma,Ma),e=t),e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,D1(n),n;default:if(typeof e.status=="string")e.then(Ma,Ma);else{if(n=et,n!==null&&100<n.shellSuspendCounter)throw Error(B(482));n=e,n.status="pending",n.then(function(s){if(e.status==="pending"){var i=e;i.status="fulfilled",i.value=s}},function(s){if(e.status==="pending"){var i=e;i.status="rejected",i.reason=s}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw n=e.reason,D1(n),n}throw au=e,bf}}function Rl(n){try{var e=n._init;return e(n._payload)}catch(t){throw t!==null&&typeof t=="object"&&typeof t.then=="function"?(au=t,bf):t}}var au=null;function I1(){if(au===null)throw Error(B(459));var n=au;return au=null,n}function D1(n){if(n===bf||n===xb)throw Error(B(483))}var _d=null,zp=0;function S0(n){var e=zp;return zp+=1,_d===null&&(_d=[]),hR(_d,n,e)}function If(n,e){e=e.props.ref,n.ref=e!==void 0?e:null}function E0(n,e){throw e.$$typeof===CL?Error(B(525)):(n=Object.prototype.toString.call(e),Error(B(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)))}function fR(n){function e(b,w){if(n){var S=b.deletions;S===null?(b.deletions=[w],b.flags|=16):S.push(w)}}function t(b,w){if(!n)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function s(b){for(var w=new Map;b!==null;)b.key!==null?w.set(b.key,b):w.set(b.index,b),b=b.sibling;return w}function i(b,w){return b=Da(b,w),b.index=0,b.sibling=null,b}function r(b,w,S){return b.index=S,n?(S=b.alternate,S!==null?(S=S.index,S<w?(b.flags|=67108866,w):S):(b.flags|=67108866,w)):(b.flags|=1048576,w)}function a(b){return n&&b.alternate===null&&(b.flags|=67108866),b}function o(b,w,S,T){return w===null||w.tag!==6?(w=m_(S,b.mode,T),w.return=b,w):(w=i(w,S),w.return=b,w)}function l(b,w,S,T){var N=S.type;return N===Ju?d(b,w,S.props.children,T,S.key):w!==null&&(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Za&&Rl(N)===w.type)?(w=i(w,S.props),If(w,S),w.return=b,w):(w=ey(S.type,S.key,S.props,null,b.mode,T),If(w,S),w.return=b,w)}function c(b,w,S,T){return w===null||w.tag!==4||w.stateNode.containerInfo!==S.containerInfo||w.stateNode.implementation!==S.implementation?(w=g_(S,b.mode,T),w.return=b,w):(w=i(w,S.children||[]),w.return=b,w)}function d(b,w,S,T,N){return w===null||w.tag!==7?(w=iu(S,b.mode,T,N),w.return=b,w):(w=i(w,S),w.return=b,w)}function h(b,w,S){if(typeof w=="string"&&w!==""||typeof w=="number"||typeof w=="bigint")return w=m_(""+w,b.mode,S),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case g0:return S=ey(w.type,w.key,w.props,null,b.mode,S),If(S,w),S.return=b,S;case qf:return w=g_(w,b.mode,S),w.return=b,w;case Za:return w=Rl(w),h(b,w,S)}if(Vf(w)||Rf(w))return w=iu(w,b.mode,S,null),w.return=b,w;if(typeof w.then=="function")return h(b,S0(w),S);if(w.$$typeof===ka)return h(b,w0(b,w),S);E0(b,w)}return null}function p(b,w,S,T){var N=w!==null?w.key:null;if(typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint")return N!==null?null:o(b,w,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case g0:return S.key===N?l(b,w,S,T):null;case qf:return S.key===N?c(b,w,S,T):null;case Za:return S=Rl(S),p(b,w,S,T)}if(Vf(S)||Rf(S))return N!==null?null:d(b,w,S,T,null);if(typeof S.then=="function")return p(b,w,S0(S),T);if(S.$$typeof===ka)return p(b,w,w0(b,S),T);E0(b,S)}return null}function y(b,w,S,T,N){if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return b=b.get(S)||null,o(w,b,""+T,N);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case g0:return b=b.get(T.key===null?S:T.key)||null,l(w,b,T,N);case qf:return b=b.get(T.key===null?S:T.key)||null,c(w,b,T,N);case Za:return T=Rl(T),y(b,w,S,T,N)}if(Vf(T)||Rf(T))return b=b.get(S)||null,d(w,b,T,N,null);if(typeof T.then=="function")return y(b,w,S,S0(T),N);if(T.$$typeof===ka)return y(b,w,S,w0(w,T),N);E0(w,T)}return null}function v(b,w,S,T){for(var N=null,R=null,k=w,I=w=0,M=null;k!==null&&I<S.length;I++){k.index>I?(M=k,k=null):M=k.sibling;var D=p(b,k,S[I],T);if(D===null){k===null&&(k=M);break}n&&k&&D.alternate===null&&e(b,k),w=r(D,w,I),R===null?N=D:R.sibling=D,R=D,k=M}if(I===S.length)return t(b,k),Ce&&Yr(b,I),N;if(k===null){for(;I<S.length;I++)k=h(b,S[I],T),k!==null&&(w=r(k,w,I),R===null?N=k:R.sibling=k,R=k);return Ce&&Yr(b,I),N}for(k=s(k);I<S.length;I++)M=y(k,b,I,S[I],T),M!==null&&(n&&M.alternate!==null&&k.delete(M.key===null?I:M.key),w=r(M,w,I),R===null?N=M:R.sibling=M,R=M);return n&&k.forEach(function(O){return e(b,O)}),Ce&&Yr(b,I),N}function _(b,w,S,T){if(S==null)throw Error(B(151));for(var N=null,R=null,k=w,I=w=0,M=null,D=S.next();k!==null&&!D.done;I++,D=S.next()){k.index>I?(M=k,k=null):M=k.sibling;var O=p(b,k,D.value,T);if(O===null){k===null&&(k=M);break}n&&k&&O.alternate===null&&e(b,k),w=r(O,w,I),R===null?N=O:R.sibling=O,R=O,k=M}if(D.done)return t(b,k),Ce&&Yr(b,I),N;if(k===null){for(;!D.done;I++,D=S.next())D=h(b,D.value,T),D!==null&&(w=r(D,w,I),R===null?N=D:R.sibling=D,R=D);return Ce&&Yr(b,I),N}for(k=s(k);!D.done;I++,D=S.next())D=y(k,b,I,D.value,T),D!==null&&(n&&D.alternate!==null&&k.delete(D.key===null?I:D.key),w=r(D,w,I),R===null?N=D:R.sibling=D,R=D);return n&&k.forEach(function(L){return e(b,L)}),Ce&&Yr(b,I),N}function E(b,w,S,T){if(typeof S=="object"&&S!==null&&S.type===Ju&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case g0:e:{for(var N=S.key;w!==null;){if(w.key===N){if(N=S.type,N===Ju){if(w.tag===7){t(b,w.sibling),T=i(w,S.props.children),T.return=b,b=T;break e}}else if(w.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Za&&Rl(N)===w.type){t(b,w.sibling),T=i(w,S.props),If(T,S),T.return=b,b=T;break e}t(b,w);break}else e(b,w);w=w.sibling}S.type===Ju?(T=iu(S.props.children,b.mode,T,S.key),T.return=b,b=T):(T=ey(S.type,S.key,S.props,null,b.mode,T),If(T,S),T.return=b,b=T)}return a(b);case qf:e:{for(N=S.key;w!==null;){if(w.key===N)if(w.tag===4&&w.stateNode.containerInfo===S.containerInfo&&w.stateNode.implementation===S.implementation){t(b,w.sibling),T=i(w,S.children||[]),T.return=b,b=T;break e}else{t(b,w);break}else e(b,w);w=w.sibling}T=g_(S,b.mode,T),T.return=b,b=T}return a(b);case Za:return S=Rl(S),E(b,w,S,T)}if(Vf(S))return v(b,w,S,T);if(Rf(S)){if(N=Rf(S),typeof N!="function")throw Error(B(150));return S=N.call(S),_(b,w,S,T)}if(typeof S.then=="function")return E(b,w,S0(S),T);if(S.$$typeof===ka)return E(b,w,w0(b,S),T);E0(b,S)}return typeof S=="string"&&S!==""||typeof S=="number"||typeof S=="bigint"?(S=""+S,w!==null&&w.tag===6?(t(b,w.sibling),T=i(w,S),T.return=b,b=T):(t(b,w),T=m_(S,b.mode,T),T.return=b,b=T),a(b)):t(b,w)}return function(b,w,S,T){try{zp=0;var N=E(b,w,S,T);return _d=null,N}catch(k){if(k===bf||k===xb)throw k;var R=js(29,k,null,b.mode);return R.lanes=T,R.return=b,R}finally{}}}var uu=fR(!0),pR=fR(!1),eo=!1;function PE(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ix(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function al(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ol(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,De&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,e=Zy(n),rR(n,null,t),e}return _b(n,s,e,t),Zy(n)}function Sp(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194048)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,I2(n,t)}}function v_(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={lane:t.lane,tag:t.tag,payload:t.payload,callback:null,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,callbacks:s.callbacks},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}var Dx=!1;function Ep(){if(Dx){var n=bd;if(n!==null)throw n}}function Ap(n,e,t,s){Dx=!1;var i=n.updateQueue;eo=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?r=c:a.next=c,a=l;var d=n.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(r!==null){var h=i.baseState;a=0,d=c=l=null,o=r;do{var p=o.lane&-536870913,y=p!==o.lane;if(y?(Ee&p)===p:(s&p)===p){p!==0&&p===nf&&(Dx=!0),d!==null&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var v=n,_=o;p=e;var E=t;switch(_.tag){case 1:if(v=_.payload,typeof v=="function"){h=v.call(E,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,p=typeof v=="function"?v.call(E,h,p):v,p==null)break e;h=dt({},h,p);break e;case 2:eo=!0}}p=o.callback,p!==null&&(n.flags|=64,y&&(n.flags|=8192),y=i.callbacks,y===null?i.callbacks=[p]:y.push(p))}else y={lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=y,l=h):d=d.next=y,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;y=o,o=y.next,y.next=null,i.lastBaseUpdate=y,i.shared.pending=null}}while(!0);d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,r===null&&(i.shared.lanes=0),gl|=a,n.lanes=a,n.memoizedState=h}}function mR(n,e){if(typeof n!="function")throw Error(B(191,n));n.call(e)}function gR(n,e){var t=n.callbacks;if(t!==null)for(n.callbacks=null,n=0;n<t.length;n++)mR(t[n],e)}var sf=Pr(null),sv=Pr(0);function P1(n,e){n=Ga,at(sv,n),at(sf,e),Ga=n|e.baseLanes}function Px(){at(sv,Ga),at(sf,sf.current)}function LE(){Ga=sv.current,hn(sf),hn(sv)}var Qs=Pr(null),xi=null;function so(n){var e=n.alternate;at(Pt,Pt.current&1),at(Qs,n),xi===null&&(e===null||sf.current!==null||e.memoizedState!==null)&&(xi=n)}function Lx(n){at(Pt,Pt.current),at(Qs,n),xi===null&&(xi=n)}function yR(n){n.tag===22?(at(Pt,Pt.current),at(Qs,n),xi===null&&(xi=n)):io()}function io(){at(Pt,Pt.current),at(Qs,Qs.current)}function zs(n){hn(Qs),xi===n&&(xi=null),hn(Pt)}var Pt=Pr(0);function iv(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||ew(t)||tw(t)))return e}else if(e.tag===19&&(e.memoizedProps.revealOrder==="forwards"||e.memoizedProps.revealOrder==="backwards"||e.memoizedProps.revealOrder==="unstable_legacy-backwards"||e.memoizedProps.revealOrder==="together")){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var za=0,ye=null,Ye=null,zt=null,rv=!1,xd=!1,du=!1,av=0,Hp=0,wd=null,jO=0;function Et(){throw Error(B(321))}function OE(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ws(n[t],e[t]))return!1;return!0}function UE(n,e,t,s,i,r){return za=r,ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,oe.H=n===null||n.memoizedState===null?KR:KE,du=!1,r=t(s,i),du=!1,xd&&(r=bR(e,t,s,i)),vR(n),r}function vR(n){oe.H=jp;var e=Ye!==null&&Ye.next!==null;if(za=0,zt=Ye=ye=null,rv=!1,Hp=0,wd=null,e)throw Error(B(300));n===null||Gt||(n=n.dependencies,n!==null&&tv(n)&&(Gt=!0))}function bR(n,e,t,s){ye=n;var i=0;do{if(xd&&(wd=null),Hp=0,xd=!1,25<=i)throw Error(B(301));if(i+=1,zt=Ye=null,n.updateQueue!=null){var r=n.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}oe.H=JR,r=e(t,s)}while(xd);return r}function GO(){var n=oe.H,e=n.useState()[0];return e=typeof e.then=="function"?t0(e):e,n=n.useState()[0],(Ye!==null?Ye.memoizedState:null)!==n&&(ye.flags|=1024),e}function BE(){var n=av!==0;return av=0,n}function FE(n,e,t){e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~t}function zE(n){if(rv){for(n=n.memoizedState;n!==null;){var e=n.queue;e!==null&&(e.pending=null),n=n.next}rv=!1}za=0,zt=Ye=ye=null,xd=!1,Hp=av=0,wd=null}function qn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?ye.memoizedState=zt=n:zt=zt.next=n,zt}function Lt(){if(Ye===null){var n=ye.alternate;n=n!==null?n.memoizedState:null}else n=Ye.next;var e=zt===null?ye.memoizedState:zt.next;if(e!==null)zt=e,Ye=n;else{if(n===null)throw ye.alternate===null?Error(B(467)):Error(B(310));Ye=n,n={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},zt===null?ye.memoizedState=zt=n:zt=zt.next=n}return zt}function wb(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function t0(n){var e=Hp;return Hp+=1,wd===null&&(wd=[]),n=hR(wd,n,e),e=ye,(zt===null?e.memoizedState:zt.next)===null&&(e=e.alternate,oe.H=e===null||e.memoizedState===null?KR:KE),n}function Sb(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return t0(n);if(n.$$typeof===ka)return Rn(n)}throw Error(B(438,String(n)))}function HE(n){var e=null,t=ye.updateQueue;if(t!==null&&(e=t.memoCache),e==null){var s=ye.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(e={data:s.data.map(function(i){return i.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),t===null&&(t=wb(),ye.updateQueue=t),t.memoCache=e,t=e.data[e.index],t===void 0)for(t=e.data[e.index]=Array(n),s=0;s<n;s++)t[s]=NL;return e.index++,t}function Ha(n,e){return typeof e=="function"?e(n):e}function ny(n){var e=Lt();return jE(e,Ye,n)}function jE(n,e,t){var s=n.queue;if(s===null)throw Error(B(311));s.lastRenderedReducer=t;var i=n.baseQueue,r=s.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}e.baseQueue=i=r,s.pending=null}if(r=n.baseState,i===null)n.memoizedState=r;else{e=i.next;var o=a=null,l=null,c=e,d=!1;do{var h=c.lane&-536870913;if(h!==c.lane?(Ee&h)===h:(za&h)===h){var p=c.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),h===nf&&(d=!0);else if((za&p)===p){c=c.next,p===nf&&(d=!0);continue}else h={lane:0,revertLane:c.revertLane,gesture:null,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(o=l=h,a=r):l=l.next=h,ye.lanes|=p,gl|=p;h=c.action,du&&t(r,h),r=c.hasEagerState?c.eagerState:t(r,h)}else p={lane:h,revertLane:c.revertLane,gesture:c.gesture,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},l===null?(o=l=p,a=r):l=l.next=p,ye.lanes|=h,gl|=h;c=c.next}while(c!==null&&c!==e);if(l===null?a=r:l.next=o,!Ws(r,n.memoizedState)&&(Gt=!0,d&&(t=bd,t!==null)))throw t;n.memoizedState=r,n.baseState=a,n.baseQueue=l,s.lastRenderedState=r}return i===null&&(s.lanes=0),[n.memoizedState,s.dispatch]}function b_(n){var e=Lt(),t=e.queue;if(t===null)throw Error(B(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);Ws(r,e.memoizedState)||(Gt=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function _R(n,e,t){var s=ye,i=Lt(),r=Ce;if(r){if(t===void 0)throw Error(B(407));t=t()}else t=e();var a=!Ws((Ye||i).memoizedState,t);if(a&&(i.memoizedState=t,Gt=!0),i=i.queue,GE(SR.bind(null,s,i,n),[n]),i.getSnapshot!==e||a||zt!==null&&zt.memoizedState.tag&1){if(s.flags|=2048,rf(9,{destroy:void 0},wR.bind(null,s,i,t,e),null),et===null)throw Error(B(349));r||za&127||xR(s,e,t)}return t}function xR(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ye.updateQueue,e===null?(e=wb(),ye.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function wR(n,e,t,s){e.value=t,e.getSnapshot=s,ER(e)&&AR(n)}function SR(n,e,t){return t(function(){ER(e)&&AR(n)})}function ER(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ws(n,t)}catch{return!0}}function AR(n){var e=_u(n,2);e!==null&&fs(e,n,2)}function Ox(n){var e=qn();if(typeof n=="function"){var t=n;if(n=t(),du){Zo(!0);try{t()}finally{Zo(!1)}}}return e.memoizedState=e.baseState=n,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:n},e}function TR(n,e,t,s){return n.baseState=t,jE(n,Ye,typeof s=="function"?s:Ha)}function qO(n,e,t,s,i){if(Ab(n))throw Error(B(485));if(n=e.action,n!==null){var r={payload:i,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){r.listeners.push(a)}};oe.T!==null?t(!0):r.isTransition=!1,s(r),t=e.pending,t===null?(r.next=e.pending=r,CR(e,r)):(r.next=t.next,e.pending=t.next=r)}}function CR(n,e){var t=e.action,s=e.payload,i=n.state;if(e.isTransition){var r=oe.T,a={};oe.T=a;try{var o=t(i,s),l=oe.S;l!==null&&l(a,o),L1(n,e,o)}catch(c){Ux(n,e,c)}finally{r!==null&&a.types!==null&&(r.types=a.types),oe.T=r}}else try{r=t(i,s),L1(n,e,r)}catch(c){Ux(n,e,c)}}function L1(n,e,t){t!==null&&typeof t=="object"&&typeof t.then=="function"?t.then(function(s){O1(n,e,s)},function(s){return Ux(n,e,s)}):O1(n,e,t)}function O1(n,e,t){e.status="fulfilled",e.value=t,NR(e),n.state=t,e=n.pending,e!==null&&(t=e.next,t===e?n.pending=null:(t=t.next,e.next=t,CR(n,t)))}function Ux(n,e,t){var s=n.pending;if(n.pending=null,s!==null){s=s.next;do e.status="rejected",e.reason=t,NR(e),e=e.next;while(e!==s)}n.action=null}function NR(n){n=n.listeners;for(var e=0;e<n.length;e++)(0,n[e])()}function RR(n,e){return e}function U1(n,e){if(Ce){var t=et.formState;if(t!==null){e:{var s=ye;if(Ce){if(ct){t:{for(var i=ct,r=bi;i.nodeType!==8;){if(!r){i=null;break t}if(i=wi(i.nextSibling),i===null){i=null;break t}}r=i.data,i=r==="F!"||r==="F"?i:null}if(i){ct=wi(i.nextSibling),s=i.data==="F!";break e}}pl(s)}s=!1}s&&(e=t[0])}}return t=qn(),t.memoizedState=t.baseState=e,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:RR,lastRenderedState:e},t.queue=s,t=VR.bind(null,ye,s),s.dispatch=t,s=Ox(!1),r=YE.bind(null,ye,!1,s.queue),s=qn(),i={state:e,dispatch:null,action:n,pending:null},s.queue=i,t=qO.bind(null,ye,i,r,t),i.dispatch=t,s.memoizedState=n,[e,t,!1]}function B1(n){var e=Lt();return kR(e,Ye,n)}function kR(n,e,t){if(e=jE(n,e,RR)[0],n=ny(Ha)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var s=t0(e)}catch(a){throw a===bf?xb:a}else s=e;e=Lt();var i=e.queue,r=i.dispatch;return t!==e.memoizedState&&(ye.flags|=2048,rf(9,{destroy:void 0},VO.bind(null,i,t),null)),[s,r,n]}function VO(n,e){n.action=e}function F1(n){var e=Lt(),t=Ye;if(t!==null)return kR(e,t,n);Lt(),e=e.memoizedState,t=Lt();var s=t.queue.dispatch;return t.memoizedState=n,[e,s,!1]}function rf(n,e,t,s){return n={tag:n,create:t,deps:s,inst:e,next:null},e=ye.updateQueue,e===null&&(e=wb(),ye.updateQueue=e),t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n),n}function MR(){return Lt().memoizedState}function sy(n,e,t,s){var i=qn();ye.flags|=n,i.memoizedState=rf(1|e,{destroy:void 0},t,s===void 0?null:s)}function Eb(n,e,t,s){var i=Lt();s=s===void 0?null:s;var r=i.memoizedState.inst;Ye!==null&&s!==null&&OE(s,Ye.memoizedState.deps)?i.memoizedState=rf(e,r,t,s):(ye.flags|=n,i.memoizedState=rf(1|e,r,t,s))}function z1(n,e){sy(8390656,8,n,e)}function GE(n,e){Eb(2048,8,n,e)}function $O(n){ye.flags|=4;var e=ye.updateQueue;if(e===null)e=wb(),ye.updateQueue=e,e.events=[n];else{var t=e.events;t===null?e.events=[n]:t.push(n)}}function IR(n){var e=Lt().memoizedState;return $O({ref:e,nextImpl:n}),function(){if(De&2)throw Error(B(440));return e.impl.apply(void 0,arguments)}}function DR(n,e){return Eb(4,2,n,e)}function PR(n,e){return Eb(4,4,n,e)}function LR(n,e){if(typeof e=="function"){n=n();var t=e(n);return function(){typeof t=="function"?t():e(null)}}if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function OR(n,e,t){t=t!=null?t.concat([n]):null,Eb(4,4,LR.bind(null,e,n),t)}function qE(){}function UR(n,e){var t=Lt();e=e===void 0?null:e;var s=t.memoizedState;return e!==null&&OE(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function BR(n,e){var t=Lt();e=e===void 0?null:e;var s=t.memoizedState;if(e!==null&&OE(e,s[1]))return s[0];if(s=n(),du){Zo(!0);try{n()}finally{Zo(!1)}}return t.memoizedState=[s,e],s}function VE(n,e,t){return t===void 0||za&1073741824&&!(Ee&261930)?n.memoizedState=e:(n.memoizedState=t,n=Tk(),ye.lanes|=n,gl|=n,t)}function FR(n,e,t,s){return Ws(t,e)?t:sf.current!==null?(n=VE(n,t,s),Ws(n,e)||(Gt=!0),n):!(za&42)||za&1073741824&&!(Ee&261930)?(Gt=!0,n.memoizedState=t):(n=Tk(),ye.lanes|=n,gl|=n,e)}function zR(n,e,t,s,i){var r=Pe.p;Pe.p=r!==0&&8>r?r:8;var a=oe.T,o={};oe.T=o,YE(n,!1,e,t);try{var l=i(),c=oe.S;if(c!==null&&c(o,l),l!==null&&typeof l=="object"&&typeof l.then=="function"){var d=HO(l,s);Tp(n,e,d,Js(n))}else Tp(n,e,s,Js(n))}catch(h){Tp(n,e,{then:function(){},status:"rejected",reason:h},Js())}finally{Pe.p=r,a!==null&&o.types!==null&&(a.types=o.types),oe.T=a}}function YO(){}function Bx(n,e,t,s){if(n.tag!==5)throw Error(B(476));var i=HR(n).queue;zR(n,i,e,su,t===null?YO:function(){return jR(n),t(s)})}function HR(n){var e=n.memoizedState;if(e!==null)return e;e={memoizedState:su,baseState:su,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:su},next:null};var t={};return e.next={memoizedState:t,baseState:t,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ha,lastRenderedState:t},next:null},n.memoizedState=e,n=n.alternate,n!==null&&(n.memoizedState=e),e}function jR(n){var e=HR(n);e.next===null&&(e=n.alternate.memoizedState),Tp(n,e.next.queue,{},Js())}function $E(){return Rn(Vp)}function GR(){return Lt().memoizedState}function qR(){return Lt().memoizedState}function KO(n){for(var e=n.return;e!==null;){switch(e.tag){case 24:case 3:var t=Js();n=al(t);var s=ol(e,n,t);s!==null&&(fs(s,e,t),Sp(s,e,t)),e={cache:ME()},n.payload=e;return}e=e.return}}function JO(n,e,t){var s=Js();t={lane:s,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null},Ab(n)?$R(e,t):(t=CE(n,e,t,s),t!==null&&(fs(t,n,s),YR(t,e,s)))}function VR(n,e,t){var s=Js();Tp(n,e,t,s)}function Tp(n,e,t,s){var i={lane:s,revertLane:0,gesture:null,action:t,hasEagerState:!1,eagerState:null,next:null};if(Ab(n))$R(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,Ws(o,a))return _b(n,e,i,0),et===null&&bb(),!1}catch{}finally{}if(t=CE(n,e,i,s),t!==null)return fs(t,n,s),YR(t,e,s),!0}return!1}function YE(n,e,t,s){if(s={lane:2,revertLane:nA(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Ab(n)){if(e)throw Error(B(479))}else e=CE(n,t,s,2),e!==null&&fs(e,n,2)}function Ab(n){var e=n.alternate;return n===ye||e!==null&&e===ye}function $R(n,e){xd=rv=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function YR(n,e,t){if(t&4194048){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,I2(n,t)}}var jp={readContext:Rn,use:Sb,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et,useHostTransitionStatus:Et,useFormState:Et,useActionState:Et,useOptimistic:Et,useMemoCache:Et,useCacheRefresh:Et};jp.useEffectEvent=Et;var KR={readContext:Rn,use:Sb,useCallback:function(n,e){return qn().memoizedState=[n,e===void 0?null:e],n},useContext:Rn,useEffect:z1,useImperativeHandle:function(n,e,t){t=t!=null?t.concat([n]):null,sy(4194308,4,LR.bind(null,e,n),t)},useLayoutEffect:function(n,e){return sy(4194308,4,n,e)},useInsertionEffect:function(n,e){sy(4,2,n,e)},useMemo:function(n,e){var t=qn();e=e===void 0?null:e;var s=n();if(du){Zo(!0);try{n()}finally{Zo(!1)}}return t.memoizedState=[s,e],s},useReducer:function(n,e,t){var s=qn();if(t!==void 0){var i=t(e);if(du){Zo(!0);try{t(e)}finally{Zo(!1)}}}else i=e;return s.memoizedState=s.baseState=i,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},s.queue=n,n=n.dispatch=JO.bind(null,ye,n),[s.memoizedState,n]},useRef:function(n){var e=qn();return n={current:n},e.memoizedState=n},useState:function(n){n=Ox(n);var e=n.queue,t=VR.bind(null,ye,e);return e.dispatch=t,[n.memoizedState,t]},useDebugValue:qE,useDeferredValue:function(n,e){var t=qn();return VE(t,n,e)},useTransition:function(){var n=Ox(!1);return n=zR.bind(null,ye,n.queue,!0,!1),qn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,e,t){var s=ye,i=qn();if(Ce){if(t===void 0)throw Error(B(407));t=t()}else{if(t=e(),et===null)throw Error(B(349));Ee&127||xR(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,z1(SR.bind(null,s,r,n),[n]),s.flags|=2048,rf(9,{destroy:void 0},wR.bind(null,s,r,t,e),null),t},useId:function(){var n=qn(),e=et.identifierPrefix;if(Ce){var t=Rr,s=Nr;t=(s&~(1<<32-Ks(s)-1)).toString(32)+t,e="_"+e+"R_"+t,t=av++,0<t&&(e+="H"+t.toString(32)),e+="_"}else t=jO++,e="_"+e+"r_"+t.toString(32)+"_";return n.memoizedState=e},useHostTransitionStatus:$E,useFormState:U1,useActionState:U1,useOptimistic:function(n){var e=qn();e.memoizedState=e.baseState=n;var t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=t,e=YE.bind(null,ye,!0,t),t.dispatch=e,[n,e]},useMemoCache:HE,useCacheRefresh:function(){return qn().memoizedState=KO.bind(null,ye)},useEffectEvent:function(n){var e=qn(),t={impl:n};return e.memoizedState=t,function(){if(De&2)throw Error(B(440));return t.impl.apply(void 0,arguments)}}},KE={readContext:Rn,use:Sb,useCallback:UR,useContext:Rn,useEffect:GE,useImperativeHandle:OR,useInsertionEffect:DR,useLayoutEffect:PR,useMemo:BR,useReducer:ny,useRef:MR,useState:function(){return ny(Ha)},useDebugValue:qE,useDeferredValue:function(n,e){var t=Lt();return FR(t,Ye.memoizedState,n,e)},useTransition:function(){var n=ny(Ha)[0],e=Lt().memoizedState;return[typeof n=="boolean"?n:t0(n),e]},useSyncExternalStore:_R,useId:GR,useHostTransitionStatus:$E,useFormState:B1,useActionState:B1,useOptimistic:function(n,e){var t=Lt();return TR(t,Ye,n,e)},useMemoCache:HE,useCacheRefresh:qR};KE.useEffectEvent=IR;var JR={readContext:Rn,use:Sb,useCallback:UR,useContext:Rn,useEffect:GE,useImperativeHandle:OR,useInsertionEffect:DR,useLayoutEffect:PR,useMemo:BR,useReducer:b_,useRef:MR,useState:function(){return b_(Ha)},useDebugValue:qE,useDeferredValue:function(n,e){var t=Lt();return Ye===null?VE(t,n,e):FR(t,Ye.memoizedState,n,e)},useTransition:function(){var n=b_(Ha)[0],e=Lt().memoizedState;return[typeof n=="boolean"?n:t0(n),e]},useSyncExternalStore:_R,useId:GR,useHostTransitionStatus:$E,useFormState:F1,useActionState:F1,useOptimistic:function(n,e){var t=Lt();return Ye!==null?TR(t,Ye,n,e):(t.baseState=n,[n,t.queue.dispatch])},useMemoCache:HE,useCacheRefresh:qR};JR.useEffectEvent=IR;function __(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:dt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Fx={enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Js(),i=al(s);i.payload=e,t!=null&&(i.callback=t),e=ol(n,i,s),e!==null&&(fs(e,n,s),Sp(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Js(),i=al(s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=ol(n,i,s),e!==null&&(fs(e,n,s),Sp(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Js(),s=al(t);s.tag=2,e!=null&&(s.callback=e),e=ol(n,s,t),e!==null&&(fs(e,n,t),Sp(e,n,t))}};function H1(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Up(t,s)||!Up(i,r):!0}function j1(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&Fx.enqueueReplaceState(e,e.state,null)}function hu(n,e){var t=e;if("ref"in e){t={};for(var s in e)s!=="ref"&&(t[s]=e[s])}if(n=n.defaultProps){t===e&&(t=dt({},t));for(var i in n)t[i]===void 0&&(t[i]=n[i])}return t}function XR(n){Qy(n)}function WR(n){console.error(n)}function QR(n){Qy(n)}function ov(n,e){try{var t=n.onUncaughtError;t(e.value,{componentStack:e.stack})}catch(s){setTimeout(function(){throw s})}}function G1(n,e,t){try{var s=n.onCaughtError;s(t.value,{componentStack:t.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function zx(n,e,t){return t=al(t),t.tag=3,t.payload={element:null},t.callback=function(){ov(n,e)},t}function ZR(n){return n=al(n),n.tag=3,n}function ek(n,e,t,s){var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=s.value;n.payload=function(){return i(r)},n.callback=function(){G1(e,t,s)}}var a=t.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){G1(e,t,s),typeof i!="function"&&(ll===null?ll=new Set([this]):ll.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})})}function XO(n,e,t,s,i){if(t.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(e=t.alternate,e!==null&&vf(e,t,i,!0),t=Qs.current,t!==null){switch(t.tag){case 31:case 13:return xi===null?hv():t.alternate===null&&Mt===0&&(Mt=3),t.flags&=-257,t.flags|=65536,t.lanes=i,s===nv?t.flags|=16384:(e=t.updateQueue,e===null?t.updateQueue=new Set([s]):e.add(s),M_(n,s,i)),!1;case 22:return t.flags|=65536,s===nv?t.flags|=16384:(e=t.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([s])},t.updateQueue=e):(t=e.retryQueue,t===null?e.retryQueue=new Set([s]):t.add(s)),M_(n,s,i)),!1}throw Error(B(435,t.tag))}return M_(n,s,i),hv(),!1}if(Ce)return e=Qs.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=i,s!==Cx&&(n=Error(B(422),{cause:s}),Fp(vi(n,t)))):(s!==Cx&&(e=Error(B(423),{cause:s}),Fp(vi(e,t))),n=n.current.alternate,n.flags|=65536,i&=-i,n.lanes|=i,s=vi(s,t),i=zx(n.stateNode,s,i),v_(n,i),Mt!==4&&(Mt=2)),!1;var r=Error(B(520),{cause:s});if(r=vi(r,t),Rp===null?Rp=[r]:Rp.push(r),Mt!==4&&(Mt=2),e===null)return!0;s=vi(s,t),t=e;do{switch(t.tag){case 3:return t.flags|=65536,n=i&-i,t.lanes|=n,n=zx(t.stateNode,s,n),v_(t,n),!1;case 1:if(e=t.type,r=t.stateNode,(t.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(ll===null||!ll.has(r))))return t.flags|=65536,i&=-i,t.lanes|=i,i=ZR(i),ek(i,n,t,s),v_(t,i),!1}t=t.return}while(t!==null);return!1}var JE=Error(B(461)),Gt=!1;function wn(n,e,t,s){e.child=n===null?pR(e,null,t,s):uu(e,n.child,t,s)}function q1(n,e,t,s,i){t=t.render;var r=e.ref;if("ref"in s){var a={};for(var o in s)o!=="ref"&&(a[o]=s[o])}else a=s;return cu(e),s=UE(n,e,t,a,r,i),o=BE(),n!==null&&!Gt?(FE(n,e,i),ja(n,e,i)):(Ce&&o&&RE(e),e.flags|=1,wn(n,e,s,i),e.child)}function V1(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!NE(r)&&r.defaultProps===void 0&&t.compare===null?(e.tag=15,e.type=r,tk(n,e,r,s,i)):(n=ey(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!XE(n,i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Up,t(a,s)&&n.ref===e.ref)return ja(n,e,i)}return e.flags|=1,n=Da(r,s),n.ref=e.ref,n.return=e,e.child=n}function tk(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Up(r,s)&&n.ref===e.ref)if(Gt=!1,e.pendingProps=s=r,XE(n,i))n.flags&131072&&(Gt=!0);else return e.lanes=n.lanes,ja(n,e,i)}return Hx(n,e,t,s,i)}function nk(n,e,t,s){var i=s.children,r=n!==null?n.memoizedState:null;if(n===null&&e.stateNode===null&&(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if(e.flags&128){if(r=r!==null?r.baseLanes|t:t,n!==null){for(s=e.child=n.child,i=0;s!==null;)i=i|s.lanes|s.childLanes,s=s.sibling;s=i&~r}else s=0,e.child=null;return $1(n,e,r,t,s)}if(t&536870912)e.memoizedState={baseLanes:0,cachePool:null},n!==null&&ty(e,r!==null?r.cachePool:null),r!==null?P1(e,r):Px(),yR(e);else return s=e.lanes=536870912,$1(n,e,r!==null?r.baseLanes|t:t,t,s)}else r!==null?(ty(e,r.cachePool),P1(e,r),io(),e.memoizedState=null):(n!==null&&ty(e,null),Px(),io());return wn(n,e,i,t),e.child}function Yf(n,e){return n!==null&&n.tag===22||e.stateNode!==null||(e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),e.sibling}function $1(n,e,t,s,i){var r=IE();return r=r===null?null:{parent:jt._currentValue,pool:r},e.memoizedState={baseLanes:t,cachePool:r},n!==null&&ty(e,null),Px(),yR(e),n!==null&&vf(n,e,s,!0),e.childLanes=i,null}function iy(n,e){return e=lv({mode:e.mode,children:e.children},n.mode),e.ref=n.ref,n.child=e,e.return=n,e}function Y1(n,e,t){return uu(e,n.child,null,t),n=iy(e,e.pendingProps),n.flags|=2,zs(e),e.memoizedState=null,n}function WO(n,e,t){var s=e.pendingProps,i=(e.flags&128)!==0;if(e.flags&=-129,n===null){if(Ce){if(s.mode==="hidden")return n=iy(e,s),e.lanes=536870912,Yf(null,n);if(Lx(e),(n=ct)?(n=Kk(n,bi),n=n!==null&&n.data==="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:fl!==null?{id:Nr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},t=oR(n),t.return=e,e.child=t,Cn=e,ct=null)):n=null,n===null)throw pl(e);return e.lanes=536870912,null}return iy(e,s)}var r=n.memoizedState;if(r!==null){var a=r.dehydrated;if(Lx(e),i)if(e.flags&256)e.flags&=-257,e=Y1(n,e,t);else if(e.memoizedState!==null)e.child=n.child,e.flags|=128,e=null;else throw Error(B(558));else if(Gt||vf(n,e,t,!1),i=(t&n.childLanes)!==0,Gt||i){if(s=et,s!==null&&(a=D2(s,t),a!==0&&a!==r.retryLane))throw r.retryLane=a,_u(n,a),fs(s,n,a),JE;hv(),e=Y1(n,e,t)}else n=r.treeContext,ct=wi(a.nextSibling),Cn=e,Ce=!0,rl=null,bi=!1,n!==null&&cR(e,n),e=iy(e,s),e.flags|=4096;return e}return n=Da(n.child,{mode:s.mode,children:s.children}),n.ref=e.ref,e.child=n,n.return=e,n}function ry(n,e){var t=e.ref;if(t===null)n!==null&&n.ref!==null&&(e.flags|=4194816);else{if(typeof t!="function"&&typeof t!="object")throw Error(B(284));(n===null||n.ref!==t)&&(e.flags|=4194816)}}function Hx(n,e,t,s,i){return cu(e),t=UE(n,e,t,s,void 0,i),s=BE(),n!==null&&!Gt?(FE(n,e,i),ja(n,e,i)):(Ce&&s&&RE(e),e.flags|=1,wn(n,e,t,i),e.child)}function K1(n,e,t,s,i,r){return cu(e),e.updateQueue=null,t=bR(e,s,t,i),vR(n),s=BE(),n!==null&&!Gt?(FE(n,e,r),ja(n,e,r)):(Ce&&s&&RE(e),e.flags|=1,wn(n,e,t,r),e.child)}function J1(n,e,t,s,i){if(cu(e),e.stateNode===null){var r=sd,a=t.contextType;typeof a=="object"&&a!==null&&(r=Rn(a)),r=new t(s,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Fx,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=s,r.state=e.memoizedState,r.refs={},PE(e),a=t.contextType,r.context=typeof a=="object"&&a!==null?Rn(a):sd,r.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(__(e,t,a,s),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(a=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),a!==r.state&&Fx.enqueueReplaceState(r,r.state,null),Ap(e,s,r,i),Ep(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!0}else if(n===null){r=e.stateNode;var o=e.memoizedProps,l=hu(t,o);r.props=l;var c=r.context,d=t.contextType;a=sd,typeof d=="object"&&d!==null&&(a=Rn(d));var h=t.getDerivedStateFromProps;d=typeof h=="function"||typeof r.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(o||c!==a)&&j1(e,r,s,a),eo=!1;var p=e.memoizedState;r.state=p,Ap(e,s,r,i),Ep(),c=e.memoizedState,o||p!==c||eo?(typeof h=="function"&&(__(e,t,h,s),c=e.memoizedState),(l=eo||H1(e,t,l,s,p,c,a))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),r.props=s,r.state=c,r.context=a,s=l):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,Ix(n,e),a=e.memoizedProps,d=hu(t,a),r.props=d,h=e.pendingProps,p=r.context,c=t.contextType,l=sd,typeof c=="object"&&c!==null&&(l=Rn(c)),o=t.getDerivedStateFromProps,(c=typeof o=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(a!==h||p!==l)&&j1(e,r,s,l),eo=!1,p=e.memoizedState,r.state=p,Ap(e,s,r,i),Ep();var y=e.memoizedState;a!==h||p!==y||eo||n!==null&&n.dependencies!==null&&tv(n.dependencies)?(typeof o=="function"&&(__(e,t,o,s),y=e.memoizedState),(d=eo||H1(e,t,d,s,p,y,l)||n!==null&&n.dependencies!==null&&tv(n.dependencies))?(c||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,y,l),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,y,l)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=y),r.props=s,r.state=y,r.context=l,s=d):(typeof r.componentDidUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return r=s,ry(n,e),s=(e.flags&128)!==0,r||s?(r=e.stateNode,t=s&&typeof t.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,n!==null&&s?(e.child=uu(e,n.child,null,i),e.child=uu(e,null,t,i)):wn(n,e,t,i),e.memoizedState=r.state,n=e.child):n=ja(n,e,i),n}function X1(n,e,t,s){return lu(),e.flags|=256,wn(n,e,t,s),e.child}var x_={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function w_(n){return{baseLanes:n,cachePool:dR()}}function S_(n,e,t){return n=n!==null?n.childLanes&~t:0,e&&(n|=Vs),n}function sk(n,e,t){var s=e.pendingProps,i=!1,r=(e.flags&128)!==0,a;if((a=r)||(a=n!==null&&n.memoizedState===null?!1:(Pt.current&2)!==0),a&&(i=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,n===null){if(Ce){if(i?so(e):io(),(n=ct)?(n=Kk(n,bi),n=n!==null&&n.data!=="&"?n:null,n!==null&&(e.memoizedState={dehydrated:n,treeContext:fl!==null?{id:Nr,overflow:Rr}:null,retryLane:536870912,hydrationErrors:null},t=oR(n),t.return=e,e.child=t,Cn=e,ct=null)):n=null,n===null)throw pl(e);return tw(n)?e.lanes=32:e.lanes=536870912,null}var o=s.children;return s=s.fallback,i?(io(),i=e.mode,o=lv({mode:"hidden",children:o},i),s=iu(s,i,t,null),o.return=e,s.return=e,o.sibling=s,e.child=o,s=e.child,s.memoizedState=w_(t),s.childLanes=S_(n,a,t),e.memoizedState=x_,Yf(null,s)):(so(e),jx(e,o))}var l=n.memoizedState;if(l!==null&&(o=l.dehydrated,o!==null)){if(r)e.flags&256?(so(e),e.flags&=-257,e=E_(n,e,t)):e.memoizedState!==null?(io(),e.child=n.child,e.flags|=128,e=null):(io(),o=s.fallback,i=e.mode,s=lv({mode:"visible",children:s.children},i),o=iu(o,i,t,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,uu(e,n.child,null,t),s=e.child,s.memoizedState=w_(t),s.childLanes=S_(n,a,t),e.memoizedState=x_,e=Yf(null,s));else if(so(e),tw(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var c=a.dgst;a=c,s=Error(B(419)),s.stack="",s.digest=a,Fp({value:s,source:null,stack:null}),e=E_(n,e,t)}else if(Gt||vf(n,e,t,!1),a=(t&n.childLanes)!==0,Gt||a){if(a=et,a!==null&&(s=D2(a,t),s!==0&&s!==l.retryLane))throw l.retryLane=s,_u(n,s),fs(a,n,s),JE;ew(o)||hv(),e=E_(n,e,t)}else ew(o)?(e.flags|=192,e.child=n.child,e=null):(n=l.treeContext,ct=wi(o.nextSibling),Cn=e,Ce=!0,rl=null,bi=!1,n!==null&&cR(e,n),e=jx(e,s.children),e.flags|=4096);return e}return i?(io(),o=s.fallback,i=e.mode,l=n.child,c=l.sibling,s=Da(l,{mode:"hidden",children:s.children}),s.subtreeFlags=l.subtreeFlags&65011712,c!==null?o=Da(c,o):(o=iu(o,i,t,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,Yf(null,s),s=e.child,o=n.child.memoizedState,o===null?o=w_(t):(i=o.cachePool,i!==null?(l=jt._currentValue,i=i.parent!==l?{parent:l,pool:l}:i):i=dR(),o={baseLanes:o.baseLanes|t,cachePool:i}),s.memoizedState=o,s.childLanes=S_(n,a,t),e.memoizedState=x_,Yf(n.child,s)):(so(e),t=n.child,n=t.sibling,t=Da(t,{mode:"visible",children:s.children}),t.return=e,t.sibling=null,n!==null&&(a=e.deletions,a===null?(e.deletions=[n],e.flags|=16):a.push(n)),e.child=t,e.memoizedState=null,t)}function jx(n,e){return e=lv({mode:"visible",children:e},n.mode),e.return=n,n.child=e}function lv(n,e){return n=js(22,n,null,e),n.lanes=0,n}function E_(n,e,t){return uu(e,n.child,null,t),n=jx(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function W1(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),Rx(n.return,e,t)}function A_(n,e,t,s,i,r){var a=n.memoizedState;a===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i,treeForkCount:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=t,a.tailMode=i,a.treeForkCount=r)}function ik(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;s=s.children;var a=Pt.current,o=(a&2)!==0;if(o?(a=a&1|2,e.flags|=128):a&=1,at(Pt,a),wn(n,e,s,t),s=Ce?Bp:0,!o&&n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&W1(n,t,e);else if(n.tag===19)W1(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&iv(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),A_(e,!1,i,t,r,s);break;case"backwards":case"unstable_legacy-backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&iv(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}A_(e,!0,t,null,r,s);break;case"together":A_(e,!1,null,null,void 0,s);break;default:e.memoizedState=null}return e.child}function ja(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),gl|=e.lanes,!(t&e.childLanes))if(n!==null){if(vf(n,e,t,!1),(t&e.childLanes)===0)return null}else return null;if(n!==null&&e.child!==n.child)throw Error(B(153));if(e.child!==null){for(n=e.child,t=Da(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Da(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function XE(n,e){return n.lanes&e?!0:(n=n.dependencies,!!(n!==null&&tv(n)))}function QO(n,e,t){switch(e.tag){case 3:Ky(e,e.stateNode.containerInfo),no(e,jt,n.memoizedState.cache),lu();break;case 27:case 5:gx(e);break;case 4:Ky(e,e.stateNode.containerInfo);break;case 10:no(e,e.type,e.memoizedProps.value);break;case 31:if(e.memoizedState!==null)return e.flags|=128,Lx(e),null;break;case 13:var s=e.memoizedState;if(s!==null)return s.dehydrated!==null?(so(e),e.flags|=128,null):t&e.child.childLanes?sk(n,e,t):(so(e),n=ja(n,e,t),n!==null?n.sibling:null);so(e);break;case 19:var i=(n.flags&128)!==0;if(s=(t&e.childLanes)!==0,s||(vf(n,e,t,!1),s=(t&e.childLanes)!==0),i){if(s)return ik(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),at(Pt,Pt.current),s)break;return null;case 22:return e.lanes=0,nk(n,e,t,e.pendingProps);case 24:no(e,jt,n.memoizedState.cache)}return ja(n,e,t)}function rk(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps)Gt=!0;else{if(!XE(n,t)&&!(e.flags&128))return Gt=!1,QO(n,e,t);Gt=!!(n.flags&131072)}else Gt=!1,Ce&&e.flags&1048576&&lR(e,Bp,e.index);switch(e.lanes=0,e.tag){case 16:e:{var s=e.pendingProps;if(n=Rl(e.elementType),e.type=n,typeof n=="function")NE(n)?(s=hu(n,s),e.tag=1,e=J1(null,e,n,s,t)):(e.tag=0,e=Hx(null,e,n,s,t));else{if(n!=null){var i=n.$$typeof;if(i===pE){e.tag=11,e=q1(null,e,n,s,t);break e}else if(i===mE){e.tag=14,e=V1(null,e,n,s,t);break e}}throw e=px(n)||n,Error(B(306,e,""))}}return e;case 0:return Hx(n,e,e.type,e.pendingProps,t);case 1:return s=e.type,i=hu(s,e.pendingProps),J1(n,e,s,i,t);case 3:e:{if(Ky(e,e.stateNode.containerInfo),n===null)throw Error(B(387));s=e.pendingProps;var r=e.memoizedState;i=r.element,Ix(n,e),Ap(e,s,null,t);var a=e.memoizedState;if(s=a.cache,no(e,jt,s),s!==r.cache&&kx(e,[jt],t,!0),Ep(),s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=X1(n,e,s,t);break e}else if(s!==i){i=vi(Error(B(424)),e),Fp(i),e=X1(n,e,s,t);break e}else{switch(n=e.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(ct=wi(n.firstChild),Cn=e,Ce=!0,rl=null,bi=!0,t=pR(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling}else{if(lu(),s===i){e=ja(n,e,t);break e}wn(n,e,s,t)}e=e.child}return e;case 26:return ry(n,e),n===null?(t=yT(e.type,null,e.pendingProps,null))?e.memoizedState=t:Ce||(t=e.type,n=e.pendingProps,s=gv(il.current).createElement(t),s[Tn]=e,s[ps]=n,kn(s,t,n),dn(s),e.stateNode=s):e.memoizedState=yT(e.type,n.memoizedProps,e.pendingProps,n.memoizedState),null;case 27:return gx(e),n===null&&Ce&&(s=e.stateNode=Jk(e.type,e.pendingProps,il.current),Cn=e,bi=!0,i=ct,xl(e.type)?(nw=i,ct=wi(s.firstChild)):ct=i),wn(n,e,e.pendingProps.children,t),ry(n,e),n===null&&(e.flags|=4194304),e.child;case 5:return n===null&&Ce&&((i=s=ct)&&(s=N4(s,e.type,e.pendingProps,bi),s!==null?(e.stateNode=s,Cn=e,ct=wi(s.firstChild),bi=!1,i=!0):i=!1),i||pl(e)),gx(e),i=e.type,r=e.pendingProps,a=n!==null?n.memoizedProps:null,s=r.children,Qx(i,r)?s=null:a!==null&&Qx(i,a)&&(e.flags|=32),e.memoizedState!==null&&(i=UE(n,e,GO,null,null,t),Vp._currentValue=i),ry(n,e),wn(n,e,s,t),e.child;case 6:return n===null&&Ce&&((n=t=ct)&&(t=R4(t,e.pendingProps,bi),t!==null?(e.stateNode=t,Cn=e,ct=null,n=!0):n=!1),n||pl(e)),null;case 13:return sk(n,e,t);case 4:return Ky(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=uu(e,null,s,t):wn(n,e,s,t),e.child;case 11:return q1(n,e,e.type,e.pendingProps,t);case 7:return wn(n,e,e.pendingProps,t),e.child;case 8:return wn(n,e,e.pendingProps.children,t),e.child;case 12:return wn(n,e,e.pendingProps.children,t),e.child;case 10:return s=e.pendingProps,no(e,e.type,s.value),wn(n,e,s.children,t),e.child;case 9:return i=e.type._context,s=e.pendingProps.children,cu(e),i=Rn(i),s=s(i),e.flags|=1,wn(n,e,s,t),e.child;case 14:return V1(n,e,e.type,e.pendingProps,t);case 15:return tk(n,e,e.type,e.pendingProps,t);case 19:return ik(n,e,t);case 31:return WO(n,e,t);case 22:return nk(n,e,t,e.pendingProps);case 24:return cu(e),s=Rn(jt),n===null?(i=IE(),i===null&&(i=et,r=ME(),i.pooledCache=r,r.refCount++,r!==null&&(i.pooledCacheLanes|=t),i=r),e.memoizedState={parent:s,cache:i},PE(e),no(e,jt,i)):(n.lanes&t&&(Ix(n,e),Ap(e,null,null,t),Ep()),i=n.memoizedState,r=e.memoizedState,i.parent!==s?(i={parent:s,cache:s},e.memoizedState=i,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=i),no(e,jt,s)):(s=r.cache,no(e,jt,s),s!==i.cache&&kx(e,[jt],t,!0))),wn(n,e,e.pendingProps.children,t),e.child;case 29:throw e.pendingProps}throw Error(B(156,e.tag))}function Ur(n){n.flags|=4}function T_(n,e,t,s,i){if((e=(n.mode&32)!==0)&&(e=!1),e){if(n.flags|=16777216,(i&335544128)===i)if(n.stateNode.complete)n.flags|=8192;else if(Rk())n.flags|=8192;else throw au=nv,DE}else n.flags&=-16777217}function Q1(n,e){if(e.type!=="stylesheet"||e.state.loading&4)n.flags&=-16777217;else if(n.flags|=16777216,!Qk(e))if(Rk())n.flags|=8192;else throw au=nv,DE}function A0(n,e){e!==null&&(n.flags|=4),n.flags&16384&&(e=n.tag!==22?k2():536870912,n.lanes|=e,af|=e)}function Df(n,e){if(!Ce)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function ot(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&65011712,s|=i.flags&65011712,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function ZO(n,e,t){var s=e.pendingProps;switch(kE(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(e),null;case 1:return ot(e),null;case 3:return t=e.stateNode,s=null,n!==null&&(s=n.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),Pa(jt),Zh(),t.pendingContext&&(t.context=t.pendingContext,t.pendingContext=null),(n===null||n.child===null)&&(Tu(e)?Ur(e):n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,y_())),ot(e),null;case 26:var i=e.type,r=e.memoizedState;return n===null?(Ur(e),r!==null?(ot(e),Q1(e,r)):(ot(e),T_(e,i,null,s,t))):r?r!==n.memoizedState?(Ur(e),ot(e),Q1(e,r)):(ot(e),e.flags&=-16777217):(n=n.memoizedProps,n!==s&&Ur(e),ot(e),T_(e,i,n,s,t)),null;case 27:if(Jy(e),t=il.current,i=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==s&&Ur(e);else{if(!s){if(e.stateNode===null)throw Error(B(166));return ot(e),null}n=Mr.current,Tu(e)?C1(e):(n=Jk(i,s,t),e.stateNode=n,Ur(e))}return ot(e),null;case 5:if(Jy(e),i=e.type,n!==null&&e.stateNode!=null)n.memoizedProps!==s&&Ur(e);else{if(!s){if(e.stateNode===null)throw Error(B(166));return ot(e),null}if(r=Mr.current,Tu(e))C1(e);else{var a=gv(il.current);switch(r){case 1:r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":r=a.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":r=a.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":r=a.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof s.is=="string"?a.createElement("select",{is:s.is}):a.createElement("select"),s.multiple?r.multiple=!0:s.size&&(r.size=s.size);break;default:r=typeof s.is=="string"?a.createElement(i,{is:s.is}):a.createElement(i)}}r[Tn]=e,r[ps]=s;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)r.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=r;e:switch(kn(r,i,s),i){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Ur(e)}}return ot(e),T_(e,e.type,n===null?null:n.memoizedProps,e.pendingProps,t),null;case 6:if(n&&e.stateNode!=null)n.memoizedProps!==s&&Ur(e);else{if(typeof s!="string"&&e.stateNode===null)throw Error(B(166));if(n=il.current,Tu(e)){if(n=e.stateNode,t=e.memoizedProps,s=null,i=Cn,i!==null)switch(i.tag){case 27:case 5:s=i.memoizedProps}n[Tn]=e,n=!!(n.nodeValue===t||s!==null&&s.suppressHydrationWarning===!0||Vk(n.nodeValue,t)),n||pl(e,!0)}else n=gv(n).createTextNode(s),n[Tn]=e,e.stateNode=n}return ot(e),null;case 31:if(t=e.memoizedState,n===null||n.memoizedState!==null){if(s=Tu(e),t!==null){if(n===null){if(!s)throw Error(B(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(B(557));n[Tn]=e}else lu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ot(e),n=!1}else t=y_(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=t),n=!0;if(!n)return e.flags&256?(zs(e),e):(zs(e),null);if(e.flags&128)throw Error(B(558))}return ot(e),null;case 13:if(s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(i=Tu(e),s!==null&&s.dehydrated!==null){if(n===null){if(!i)throw Error(B(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[Tn]=e}else lu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ot(e),i=!1}else i=y_(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=i),i=!0;if(!i)return e.flags&256?(zs(e),e):(zs(e),null)}return zs(e),e.flags&128?(e.lanes=t,e):(t=s!==null,n=n!==null&&n.memoizedState!==null,t&&(s=e.child,i=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(i=s.alternate.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==i&&(s.flags|=2048)),t!==n&&t&&(e.child.flags|=8192),A0(e,e.updateQueue),ot(e),null);case 4:return Zh(),n===null&&sA(e.stateNode.containerInfo),ot(e),null;case 10:return Pa(e.type),ot(e),null;case 19:if(hn(Pt),s=e.memoizedState,s===null)return ot(e),null;if(i=(e.flags&128)!==0,r=s.rendering,r===null)if(i)Df(s,!1);else{if(Mt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(r=iv(n),r!==null){for(e.flags|=128,Df(s,!1),n=r.updateQueue,e.updateQueue=n,A0(e,n),e.subtreeFlags=0,n=t,t=e.child;t!==null;)aR(t,n),t=t.sibling;return at(Pt,Pt.current&1|2),Ce&&Yr(e,s.treeForkCount),e.child}n=n.sibling}s.tail!==null&&$s()>uv&&(e.flags|=128,i=!0,Df(s,!1),e.lanes=4194304)}else{if(!i)if(n=iv(r),n!==null){if(e.flags|=128,i=!0,n=n.updateQueue,e.updateQueue=n,A0(e,n),Df(s,!0),s.tail===null&&s.tailMode==="hidden"&&!r.alternate&&!Ce)return ot(e),null}else 2*$s()-s.renderingStartTime>uv&&t!==536870912&&(e.flags|=128,i=!0,Df(s,!1),e.lanes=4194304);s.isBackwards?(r.sibling=e.child,e.child=r):(n=s.last,n!==null?n.sibling=r:e.child=r,s.last=r)}return s.tail!==null?(n=s.tail,s.rendering=n,s.tail=n.sibling,s.renderingStartTime=$s(),n.sibling=null,t=Pt.current,at(Pt,i?t&1|2:t&1),Ce&&Yr(e,s.treeForkCount),n):(ot(e),null);case 22:case 23:return zs(e),LE(),s=e.memoizedState!==null,n!==null?n.memoizedState!==null!==s&&(e.flags|=8192):s&&(e.flags|=8192),s?t&536870912&&!(e.flags&128)&&(ot(e),e.subtreeFlags&6&&(e.flags|=8192)):ot(e),t=e.updateQueue,t!==null&&A0(e,t.retryQueue),t=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),s=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),s!==t&&(e.flags|=2048),n!==null&&hn(ru),null;case 24:return t=null,n!==null&&(t=n.memoizedState.cache),e.memoizedState.cache!==t&&(e.flags|=2048),Pa(jt),ot(e),null;case 25:return null;case 30:return null}throw Error(B(156,e.tag))}function e4(n,e){switch(kE(e),e.tag){case 1:return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Pa(jt),Zh(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 26:case 27:case 5:return Jy(e),null;case 31:if(e.memoizedState!==null){if(zs(e),e.alternate===null)throw Error(B(340));lu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 13:if(zs(e),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(B(340));lu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return hn(Pt),null;case 4:return Zh(),null;case 10:return Pa(e.type),null;case 22:case 23:return zs(e),LE(),n!==null&&hn(ru),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 24:return Pa(jt),null;case 25:return null;default:return null}}function ak(n,e){switch(kE(e),e.tag){case 3:Pa(jt),Zh();break;case 26:case 27:case 5:Jy(e);break;case 4:Zh();break;case 31:e.memoizedState!==null&&zs(e);break;case 13:zs(e);break;case 19:hn(Pt);break;case 10:Pa(e.type);break;case 22:case 23:zs(e),LE(),n!==null&&hn(ru);break;case 24:Pa(jt)}}function n0(n,e){try{var t=e.updateQueue,s=t!==null?t.lastEffect:null;if(s!==null){var i=s.next;t=i;do{if((t.tag&n)===n){s=void 0;var r=t.create,a=t.inst;s=r(),a.destroy=s}t=t.next}while(t!==i)}}catch(o){ze(e,e.return,o)}}function ml(n,e,t){try{var s=e.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var r=i.next;s=r;do{if((s.tag&n)===n){var a=s.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,i=e;var l=t,c=o;try{c()}catch(d){ze(i,l,d)}}}s=s.next}while(s!==r)}}catch(d){ze(e,e.return,d)}}function ok(n){var e=n.updateQueue;if(e!==null){var t=n.stateNode;try{gR(e,t)}catch(s){ze(n,n.return,s)}}}function lk(n,e,t){t.props=hu(n.type,n.memoizedProps),t.state=n.memoizedState;try{t.componentWillUnmount()}catch(s){ze(n,e,s)}}function Cp(n,e){try{var t=n.ref;if(t!==null){switch(n.tag){case 26:case 27:case 5:var s=n.stateNode;break;case 30:s=n.stateNode;break;default:s=n.stateNode}typeof t=="function"?n.refCleanup=t(s):t.current=s}}catch(i){ze(n,e,i)}}function kr(n,e){var t=n.ref,s=n.refCleanup;if(t!==null)if(typeof s=="function")try{s()}catch(i){ze(n,e,i)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof t=="function")try{t(null)}catch(i){ze(n,e,i)}else t.current=null}function ck(n){var e=n.type,t=n.memoizedProps,s=n.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":t.autoFocus&&s.focus();break e;case"img":t.src?s.src=t.src:t.srcSet&&(s.srcset=t.srcSet)}}catch(i){ze(n,n.return,i)}}function C_(n,e,t){try{var s=n.stateNode;w4(s,n.type,t,e),s[ps]=e}catch(i){ze(n,n.return,i)}}function uk(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&xl(n.type)||n.tag===4}function N_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||uk(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&xl(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Gx(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t).insertBefore(n,e):(e=t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,e.appendChild(n),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Ma));else if(s!==4&&(s===27&&xl(n.type)&&(t=n.stateNode,e=null),n=n.child,n!==null))for(Gx(n,e,t),n=n.sibling;n!==null;)Gx(n,e,t),n=n.sibling}function cv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(s===27&&xl(n.type)&&(t=n.stateNode),n=n.child,n!==null))for(cv(n,e,t),n=n.sibling;n!==null;)cv(n,e,t),n=n.sibling}function dk(n){var e=n.stateNode,t=n.memoizedProps;try{for(var s=n.type,i=e.attributes;i.length;)e.removeAttributeNode(i[0]);kn(e,s,t),e[Tn]=n,e[ps]=t}catch(r){ze(n,n.return,r)}}var Na=!1,Ht=!1,R_=!1,Z1=typeof WeakSet=="function"?WeakSet:Set,un=null;function t4(n,e){if(n=n.containerInfo,Xx=_v,n=Q2(n),AE(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,d=0,h=n,p=null;t:for(;;){for(var y;h!==t||i!==0&&h.nodeType!==3||(o=a+i),h!==r||s!==0&&h.nodeType!==3||(l=a+s),h.nodeType===3&&(a+=h.nodeValue.length),(y=h.firstChild)!==null;)p=h,h=y;for(;;){if(h===n)break t;if(p===t&&++c===i&&(o=a),p===r&&++d===s&&(l=a),(y=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=y}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Wx={focusedElem:n,selectionRange:t},_v=!1,un=e;un!==null;)if(e=un,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,un=n;else for(;un!==null;){switch(e=un,r=e.alternate,n=e.flags,e.tag){case 0:if(n&4&&(n=e.updateQueue,n=n!==null?n.events:null,n!==null))for(t=0;t<n.length;t++)i=n[t],i.ref.impl=i.nextImpl;break;case 11:case 15:break;case 1:if(n&1024&&r!==null){n=void 0,t=e,i=r.memoizedProps,r=r.memoizedState,s=t.stateNode;try{var v=hu(t.type,i);n=s.getSnapshotBeforeUpdate(v,r),s.__reactInternalSnapshotBeforeUpdate=n}catch(_){ze(t,t.return,_)}}break;case 3:if(n&1024){if(n=e.stateNode.containerInfo,t=n.nodeType,t===9)Zx(n);else if(t===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Zx(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(n&1024)throw Error(B(163))}if(n=e.sibling,n!==null){n.return=e.return,un=n;break}un=e.return}}function hk(n,e,t){var s=t.flags;switch(t.tag){case 0:case 11:case 15:Fr(n,t),s&4&&n0(5,t);break;case 1:if(Fr(n,t),s&4)if(n=t.stateNode,e===null)try{n.componentDidMount()}catch(a){ze(t,t.return,a)}else{var i=hu(t.type,e.memoizedProps);e=e.memoizedState;try{n.componentDidUpdate(i,e,n.__reactInternalSnapshotBeforeUpdate)}catch(a){ze(t,t.return,a)}}s&64&&ok(t),s&512&&Cp(t,t.return);break;case 3:if(Fr(n,t),s&64&&(n=t.updateQueue,n!==null)){if(e=null,t.child!==null)switch(t.child.tag){case 27:case 5:e=t.child.stateNode;break;case 1:e=t.child.stateNode}try{gR(n,e)}catch(a){ze(t,t.return,a)}}break;case 27:e===null&&s&4&&dk(t);case 26:case 5:Fr(n,t),e===null&&s&4&&ck(t),s&512&&Cp(t,t.return);break;case 12:Fr(n,t);break;case 31:Fr(n,t),s&4&&mk(n,t);break;case 13:Fr(n,t),s&4&&gk(n,t),s&64&&(n=t.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(t=u4.bind(null,t),k4(n,t))));break;case 22:if(s=t.memoizedState!==null||Na,!s){e=e!==null&&e.memoizedState!==null||Ht,i=Na;var r=Ht;Na=s,(Ht=e)&&!r?zr(n,t,(t.subtreeFlags&8772)!==0):Fr(n,t),Na=i,Ht=r}break;case 30:break;default:Fr(n,t)}}function fk(n){var e=n.alternate;e!==null&&(n.alternate=null,fk(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&bE(e)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var gt=null,cs=!1;function Br(n,e,t){for(t=t.child;t!==null;)pk(n,e,t),t=t.sibling}function pk(n,e,t){if(Ys&&typeof Ys.onCommitFiberUnmount=="function")try{Ys.onCommitFiberUnmount(Jg,t)}catch{}switch(t.tag){case 26:Ht||kr(t,e),Br(n,e,t),t.memoizedState?t.memoizedState.count--:t.stateNode&&(t=t.stateNode,t.parentNode.removeChild(t));break;case 27:Ht||kr(t,e);var s=gt,i=cs;xl(t.type)&&(gt=t.stateNode,cs=!1),Br(n,e,t),Mp(t.stateNode),gt=s,cs=i;break;case 5:Ht||kr(t,e);case 6:if(s=gt,i=cs,gt=null,Br(n,e,t),gt=s,cs=i,gt!==null)if(cs)try{(gt.nodeType===9?gt.body:gt.nodeName==="HTML"?gt.ownerDocument.body:gt).removeChild(t.stateNode)}catch(r){ze(t,e,r)}else try{gt.removeChild(t.stateNode)}catch(r){ze(t,e,r)}break;case 18:gt!==null&&(cs?(n=gt,hT(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.stateNode),uf(n)):hT(gt,t.stateNode));break;case 4:s=gt,i=cs,gt=t.stateNode.containerInfo,cs=!0,Br(n,e,t),gt=s,cs=i;break;case 0:case 11:case 14:case 15:ml(2,t,e),Ht||ml(4,t,e),Br(n,e,t);break;case 1:Ht||(kr(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"&&lk(t,e,s)),Br(n,e,t);break;case 21:Br(n,e,t);break;case 22:Ht=(s=Ht)||t.memoizedState!==null,Br(n,e,t),Ht=s;break;default:Br(n,e,t)}}function mk(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{uf(n)}catch(t){ze(e,e.return,t)}}}function gk(n,e){if(e.memoizedState===null&&(n=e.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{uf(n)}catch(t){ze(e,e.return,t)}}function n4(n){switch(n.tag){case 31:case 13:case 19:var e=n.stateNode;return e===null&&(e=n.stateNode=new Z1),e;case 22:return n=n.stateNode,e=n._retryCache,e===null&&(e=n._retryCache=new Z1),e;default:throw Error(B(435,n.tag))}}function T0(n,e){var t=n4(n);e.forEach(function(s){if(!t.has(s)){t.add(s);var i=d4.bind(null,n,s);s.then(i,i)}})}function Zn(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s],r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(xl(o.type)){gt=o.stateNode,cs=!1;break e}break;case 5:gt=o.stateNode,cs=!1;break e;case 3:case 4:gt=o.stateNode.containerInfo,cs=!0;break e}o=o.return}if(gt===null)throw Error(B(160));pk(r,a,i),gt=null,cs=!1,r=i.alternate,r!==null&&(r.return=null),i.return=null}if(e.subtreeFlags&13886)for(e=e.child;e!==null;)yk(e,n),e=e.sibling}var $i=null;function yk(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Zn(e,n),es(n),s&4&&(ml(3,n,n.return),n0(3,n),ml(5,n,n.return));break;case 1:Zn(e,n),es(n),s&512&&(Ht||t===null||kr(t,t.return)),s&64&&Na&&(n=n.updateQueue,n!==null&&(s=n.callbacks,s!==null&&(t=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=t===null?s:t.concat(s))));break;case 26:var i=$i;if(Zn(e,n),es(n),s&512&&(Ht||t===null||kr(t,t.return)),s&4){var r=t!==null?t.memoizedState:null;if(s=n.memoizedState,t===null)if(s===null)if(n.stateNode===null){e:{s=n.type,t=n.memoizedProps,i=i.ownerDocument||i;t:switch(s){case"title":r=i.getElementsByTagName("title")[0],(!r||r[Qg]||r[Tn]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=i.createElement(s),i.head.insertBefore(r,i.querySelector("head > title"))),kn(r,s,t),r[Tn]=n,dn(r),s=r;break e;case"link":var a=bT("link","href",i).get(s+(t.href||""));if(a){for(var o=0;o<a.length;o++)if(r=a[o],r.getAttribute("href")===(t.href==null||t.href===""?null:t.href)&&r.getAttribute("rel")===(t.rel==null?null:t.rel)&&r.getAttribute("title")===(t.title==null?null:t.title)&&r.getAttribute("crossorigin")===(t.crossOrigin==null?null:t.crossOrigin)){a.splice(o,1);break t}}r=i.createElement(s),kn(r,s,t),i.head.appendChild(r);break;case"meta":if(a=bT("meta","content",i).get(s+(t.content||""))){for(o=0;o<a.length;o++)if(r=a[o],r.getAttribute("content")===(t.content==null?null:""+t.content)&&r.getAttribute("name")===(t.name==null?null:t.name)&&r.getAttribute("property")===(t.property==null?null:t.property)&&r.getAttribute("http-equiv")===(t.httpEquiv==null?null:t.httpEquiv)&&r.getAttribute("charset")===(t.charSet==null?null:t.charSet)){a.splice(o,1);break t}}r=i.createElement(s),kn(r,s,t),i.head.appendChild(r);break;default:throw Error(B(468,s))}r[Tn]=n,dn(r),s=r}n.stateNode=s}else _T(i,n.type,n.stateNode);else n.stateNode=vT(i,s,n.memoizedProps);else r!==s?(r===null?t.stateNode!==null&&(t=t.stateNode,t.parentNode.removeChild(t)):r.count--,s===null?_T(i,n.type,n.stateNode):vT(i,s,n.memoizedProps)):s===null&&n.stateNode!==null&&C_(n,n.memoizedProps,t.memoizedProps)}break;case 27:Zn(e,n),es(n),s&512&&(Ht||t===null||kr(t,t.return)),t!==null&&s&4&&C_(n,n.memoizedProps,t.memoizedProps);break;case 5:if(Zn(e,n),es(n),s&512&&(Ht||t===null||kr(t,t.return)),n.flags&32){i=n.stateNode;try{tf(i,"")}catch(v){ze(n,n.return,v)}}s&4&&n.stateNode!=null&&(i=n.memoizedProps,C_(n,i,t!==null?t.memoizedProps:i)),s&1024&&(R_=!0);break;case 6:if(Zn(e,n),es(n),s&4){if(n.stateNode===null)throw Error(B(162));s=n.memoizedProps,t=n.stateNode;try{t.nodeValue=s}catch(v){ze(n,n.return,v)}}break;case 3:if(ly=null,i=$i,$i=yv(e.containerInfo),Zn(e,n),$i=i,es(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{uf(e.containerInfo)}catch(v){ze(n,n.return,v)}R_&&(R_=!1,vk(n));break;case 4:s=$i,$i=yv(n.stateNode.containerInfo),Zn(e,n),es(n),$i=s;break;case 12:Zn(e,n),es(n);break;case 31:Zn(e,n),es(n),s&4&&(s=n.updateQueue,s!==null&&(n.updateQueue=null,T0(n,s)));break;case 13:Zn(e,n),es(n),n.child.flags&8192&&n.memoizedState!==null!=(t!==null&&t.memoizedState!==null)&&(Tb=$s()),s&4&&(s=n.updateQueue,s!==null&&(n.updateQueue=null,T0(n,s)));break;case 22:i=n.memoizedState!==null;var l=t!==null&&t.memoizedState!==null,c=Na,d=Ht;if(Na=c||i,Ht=d||l,Zn(e,n),Ht=d,Na=c,es(n),s&8192)e:for(e=n.stateNode,e._visibility=i?e._visibility&-2:e._visibility|1,i&&(t===null||l||Na||Ht||kl(n)),t=null,e=n;;){if(e.tag===5||e.tag===26){if(t===null){l=t=e;try{if(r=l.stateNode,i)a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=l.stateNode;var h=l.memoizedProps.style,p=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=p==null||typeof p=="boolean"?"":(""+p).trim()}}catch(v){ze(l,l.return,v)}}}else if(e.tag===6){if(t===null){l=e;try{l.stateNode.nodeValue=i?"":l.memoizedProps}catch(v){ze(l,l.return,v)}}}else if(e.tag===18){if(t===null){l=e;try{var y=l.stateNode;i?fT(y,!0):fT(l.stateNode,!1)}catch(v){ze(l,l.return,v)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===n)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;t===e&&(t=null),e=e.return}t===e&&(t=null),e.sibling.return=e.return,e=e.sibling}s&4&&(s=n.updateQueue,s!==null&&(t=s.retryQueue,t!==null&&(s.retryQueue=null,T0(n,t))));break;case 19:Zn(e,n),es(n),s&4&&(s=n.updateQueue,s!==null&&(n.updateQueue=null,T0(n,s)));break;case 30:break;case 21:break;default:Zn(e,n),es(n)}}function es(n){var e=n.flags;if(e&2){try{for(var t,s=n.return;s!==null;){if(uk(s)){t=s;break}s=s.return}if(t==null)throw Error(B(160));switch(t.tag){case 27:var i=t.stateNode,r=N_(n);cv(n,r,i);break;case 5:var a=t.stateNode;t.flags&32&&(tf(a,""),t.flags&=-33);var o=N_(n);cv(n,o,a);break;case 3:case 4:var l=t.stateNode.containerInfo,c=N_(n);Gx(n,c,l);break;default:throw Error(B(161))}}catch(d){ze(n,n.return,d)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function vk(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var e=n;vk(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),n=n.sibling}}function Fr(n,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)hk(n,e.alternate,e),e=e.sibling}function kl(n){for(n=n.child;n!==null;){var e=n;switch(e.tag){case 0:case 11:case 14:case 15:ml(4,e,e.return),kl(e);break;case 1:kr(e,e.return);var t=e.stateNode;typeof t.componentWillUnmount=="function"&&lk(e,e.return,t),kl(e);break;case 27:Mp(e.stateNode);case 26:case 5:kr(e,e.return),kl(e);break;case 22:e.memoizedState===null&&kl(e);break;case 30:kl(e);break;default:kl(e)}n=n.sibling}}function zr(n,e,t){for(t=t&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var s=e.alternate,i=n,r=e,a=r.flags;switch(r.tag){case 0:case 11:case 15:zr(i,r,t),n0(4,r);break;case 1:if(zr(i,r,t),s=r,i=s.stateNode,typeof i.componentDidMount=="function")try{i.componentDidMount()}catch(c){ze(s,s.return,c)}if(s=r,i=s.updateQueue,i!==null){var o=s.stateNode;try{var l=i.shared.hiddenCallbacks;if(l!==null)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)mR(l[i],o)}catch(c){ze(s,s.return,c)}}t&&a&64&&ok(r),Cp(r,r.return);break;case 27:dk(r);case 26:case 5:zr(i,r,t),t&&s===null&&a&4&&ck(r),Cp(r,r.return);break;case 12:zr(i,r,t);break;case 31:zr(i,r,t),t&&a&4&&mk(i,r);break;case 13:zr(i,r,t),t&&a&4&&gk(i,r);break;case 22:r.memoizedState===null&&zr(i,r,t),Cp(r,r.return);break;case 30:break;default:zr(i,r,t)}e=e.sibling}}function WE(n,e){var t=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==t&&(n!=null&&n.refCount++,t!=null&&e0(t))}function QE(n,e){n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&e0(n))}function Ri(n,e,t,s){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)bk(n,e,t,s),e=e.sibling}function bk(n,e,t,s){var i=e.flags;switch(e.tag){case 0:case 11:case 15:Ri(n,e,t,s),i&2048&&n0(9,e);break;case 1:Ri(n,e,t,s);break;case 3:Ri(n,e,t,s),i&2048&&(n=null,e.alternate!==null&&(n=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==n&&(e.refCount++,n!=null&&e0(n)));break;case 12:if(i&2048){Ri(n,e,t,s),n=e.stateNode;try{var r=e.memoizedProps,a=r.id,o=r.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(l){ze(e,e.return,l)}}else Ri(n,e,t,s);break;case 31:Ri(n,e,t,s);break;case 13:Ri(n,e,t,s);break;case 23:break;case 22:r=e.stateNode,a=e.alternate,e.memoizedState!==null?r._visibility&2?Ri(n,e,t,s):Np(n,e):r._visibility&2?Ri(n,e,t,s):(r._visibility|=2,Ou(n,e,t,s,(e.subtreeFlags&10256)!==0||!1)),i&2048&&WE(a,e);break;case 24:Ri(n,e,t,s),i&2048&&QE(e.alternate,e);break;default:Ri(n,e,t,s)}}function Ou(n,e,t,s,i){for(i=i&&((e.subtreeFlags&10256)!==0||!1),e=e.child;e!==null;){var r=n,a=e,o=t,l=s,c=a.flags;switch(a.tag){case 0:case 11:case 15:Ou(r,a,o,l,i),n0(8,a);break;case 23:break;case 22:var d=a.stateNode;a.memoizedState!==null?d._visibility&2?Ou(r,a,o,l,i):Np(r,a):(d._visibility|=2,Ou(r,a,o,l,i)),i&&c&2048&&WE(a.alternate,a);break;case 24:Ou(r,a,o,l,i),i&&c&2048&&QE(a.alternate,a);break;default:Ou(r,a,o,l,i)}e=e.sibling}}function Np(n,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var t=n,s=e,i=s.flags;switch(s.tag){case 22:Np(t,s),i&2048&&WE(s.alternate,s);break;case 24:Np(t,s),i&2048&&QE(s.alternate,s);break;default:Np(t,s)}e=e.sibling}}var Kf=8192;function Cu(n,e,t){if(n.subtreeFlags&Kf)for(n=n.child;n!==null;)_k(n,e,t),n=n.sibling}function _k(n,e,t){switch(n.tag){case 26:Cu(n,e,t),n.flags&Kf&&n.memoizedState!==null&&j4(t,$i,n.memoizedState,n.memoizedProps);break;case 5:Cu(n,e,t);break;case 3:case 4:var s=$i;$i=yv(n.stateNode.containerInfo),Cu(n,e,t),$i=s;break;case 22:n.memoizedState===null&&(s=n.alternate,s!==null&&s.memoizedState!==null?(s=Kf,Kf=16777216,Cu(n,e,t),Kf=s):Cu(n,e,t));break;default:Cu(n,e,t)}}function xk(n){var e=n.alternate;if(e!==null&&(n=e.child,n!==null)){e.child=null;do e=n.sibling,n.sibling=null,n=e;while(n!==null)}}function Pf(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var s=e[t];un=s,Sk(s,n)}xk(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)wk(n),n=n.sibling}function wk(n){switch(n.tag){case 0:case 11:case 15:Pf(n),n.flags&2048&&ml(9,n,n.return);break;case 3:Pf(n);break;case 12:Pf(n);break;case 22:var e=n.stateNode;n.memoizedState!==null&&e._visibility&2&&(n.return===null||n.return.tag!==13)?(e._visibility&=-3,ay(n)):Pf(n);break;default:Pf(n)}}function ay(n){var e=n.deletions;if(n.flags&16){if(e!==null)for(var t=0;t<e.length;t++){var s=e[t];un=s,Sk(s,n)}xk(n)}for(n=n.child;n!==null;){switch(e=n,e.tag){case 0:case 11:case 15:ml(8,e,e.return),ay(e);break;case 22:t=e.stateNode,t._visibility&2&&(t._visibility&=-3,ay(e));break;default:ay(e)}n=n.sibling}}function Sk(n,e){for(;un!==null;){var t=un;switch(t.tag){case 0:case 11:case 15:ml(8,t,e);break;case 23:case 22:if(t.memoizedState!==null&&t.memoizedState.cachePool!==null){var s=t.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:e0(t.memoizedState.cache)}if(s=t.child,s!==null)s.return=t,un=s;else e:for(t=n;un!==null;){s=un;var i=s.sibling,r=s.return;if(fk(s),s===t){un=null;break e}if(i!==null){i.return=r,un=i;break e}un=r}}}var s4={getCacheForType:function(n){var e=Rn(jt),t=e.data.get(n);return t===void 0&&(t=n(),e.data.set(n,t)),t},cacheSignal:function(){return Rn(jt).controller.signal}},i4=typeof WeakMap=="function"?WeakMap:Map,De=0,et=null,we=null,Ee=0,Fe=0,Bs=null,tl=!1,_f=!1,ZE=!1,Ga=0,Mt=0,gl=0,ou=0,eA=0,Vs=0,af=0,Rp=null,us=null,qx=!1,Tb=0,Ek=0,uv=1/0,dv=null,ll=null,Qt=0,cl=null,of=null,La=0,Vx=0,$x=null,Ak=null,kp=0,Yx=null;function Js(){return De&2&&Ee!==0?Ee&-Ee:oe.T!==null?nA():P2()}function Tk(){if(Vs===0)if(!(Ee&536870912)||Ce){var n=v0;v0<<=1,!(v0&3932160)&&(v0=262144),Vs=n}else Vs=536870912;return n=Qs.current,n!==null&&(n.flags|=32),Vs}function fs(n,e,t){(n===et&&(Fe===2||Fe===9)||n.cancelPendingCommit!==null)&&(lf(n,0),nl(n,Ee,Vs,!1)),Wg(n,t),(!(De&2)||n!==et)&&(n===et&&(!(De&2)&&(ou|=t),Mt===4&&nl(n,Ee,Vs,!1)),Lr(n))}function Ck(n,e,t){if(De&6)throw Error(B(327));var s=!t&&(e&127)===0&&(e&n.expiredLanes)===0||Xg(n,e),i=s?o4(n,e):k_(n,e,!0),r=s;do{if(i===0){_f&&!s&&nl(n,e,0,!1);break}else{if(t=n.current.alternate,r&&!r4(t)){i=k_(n,e,!1),r=!1;continue}if(i===2){if(r=e,n.errorRecoveryDisabledLanes&r)var a=0;else a=n.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=n;i=Rp;var l=o.current.memoizedState.isDehydrated;if(l&&(lf(o,a).flags|=256),a=k_(o,a,!1),a!==2){if(ZE&&!l){o.errorRecoveryDisabledLanes|=r,ou|=r,i=4;break e}r=us,us=i,r!==null&&(us===null?us=r:us.push.apply(us,r))}i=a}if(r=!1,i!==2)continue}}if(i===1){lf(n,0),nl(n,e,0,!0);break}e:{switch(s=n,r=i,r){case 0:case 1:throw Error(B(345));case 4:if((e&4194048)!==e)break;case 6:nl(s,e,Vs,!tl);break e;case 2:us=null;break;case 3:case 5:break;default:throw Error(B(329))}if((e&62914560)===e&&(i=Tb+300-$s(),10<i)){if(nl(s,e,Vs,!tl),mb(s,0,!0)!==0)break e;La=e,s.timeoutHandle=Yk(eT.bind(null,s,t,us,dv,qx,e,Vs,ou,af,tl,r,"Throttled",-0,0),i);break e}eT(s,t,us,dv,qx,e,Vs,ou,af,tl,r,null,-0,0)}}break}while(!0);Lr(n)}function eT(n,e,t,s,i,r,a,o,l,c,d,h,p,y){if(n.timeoutHandle=-1,h=e.subtreeFlags,h&8192||(h&16785408)===16785408){h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ma},_k(e,r,h);var v=(r&62914560)===r?Tb-$s():(r&4194048)===r?Ek-$s():0;if(v=G4(h,v),v!==null){La=r,n.cancelPendingCommit=v(nT.bind(null,n,e,r,t,s,i,a,o,l,d,h,null,p,y)),nl(n,r,a,!c);return}}nT(n,e,r,t,s,i,a,o,l)}function r4(n){for(var e=n;;){var t=e.tag;if((t===0||t===11||t===15)&&e.flags&16384&&(t=e.updateQueue,t!==null&&(t=t.stores,t!==null)))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Ws(r(),i))return!1}catch{return!1}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function nl(n,e,t,s){e&=~eA,e&=~ou,n.suspendedLanes|=e,n.pingedLanes&=~e,s&&(n.warmLanes|=e),s=n.expirationTimes;for(var i=e;0<i;){var r=31-Ks(i),a=1<<r;s[r]=-1,i&=~a}t!==0&&M2(n,t,e)}function Cb(){return De&6?!0:(s0(0),!1)}function tA(){if(we!==null){if(Fe===0)var n=we.return;else n=we,Ia=xu=null,zE(n),_d=null,zp=0,n=we;for(;n!==null;)ak(n.alternate,n),n=n.return;we=null}}function lf(n,e){var t=n.timeoutHandle;t!==-1&&(n.timeoutHandle=-1,A4(t)),t=n.cancelPendingCommit,t!==null&&(n.cancelPendingCommit=null,t()),La=0,tA(),et=n,we=t=Da(n.current,null),Ee=e,Fe=0,Bs=null,tl=!1,_f=Xg(n,e),ZE=!1,af=Vs=eA=ou=gl=Mt=0,us=Rp=null,qx=!1,e&8&&(e|=e&32);var s=n.entangledLanes;if(s!==0)for(n=n.entanglements,s&=e;0<s;){var i=31-Ks(s),r=1<<i;e|=n[i],s&=~r}return Ga=e,bb(),t}function Nk(n,e){ye=null,oe.H=jp,e===bf||e===xb?(e=I1(),Fe=3):e===DE?(e=I1(),Fe=4):Fe=e===JE?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Bs=e,we===null&&(Mt=1,ov(n,vi(e,n.current)))}function Rk(){var n=Qs.current;return n===null?!0:(Ee&4194048)===Ee?xi===null:(Ee&62914560)===Ee||Ee&536870912?n===xi:!1}function kk(){var n=oe.H;return oe.H=jp,n===null?jp:n}function Mk(){var n=oe.A;return oe.A=s4,n}function hv(){Mt=4,tl||(Ee&4194048)!==Ee&&Qs.current!==null||(_f=!0),!(gl&134217727)&&!(ou&134217727)||et===null||nl(et,Ee,Vs,!1)}function k_(n,e,t){var s=De;De|=2;var i=kk(),r=Mk();(et!==n||Ee!==e)&&(dv=null,lf(n,e)),e=!1;var a=Mt;e:do try{if(Fe!==0&&we!==null){var o=we,l=Bs;switch(Fe){case 8:tA(),a=6;break e;case 3:case 2:case 9:case 6:Qs.current===null&&(e=!0);var c=Fe;if(Fe=0,Bs=null,ad(n,o,l,c),t&&_f){a=0;break e}break;default:c=Fe,Fe=0,Bs=null,ad(n,o,l,c)}}a4(),a=Mt;break}catch(d){Nk(n,d)}while(!0);return e&&n.shellSuspendCounter++,Ia=xu=null,De=s,oe.H=i,oe.A=r,we===null&&(et=null,Ee=0,bb()),a}function a4(){for(;we!==null;)Ik(we)}function o4(n,e){var t=De;De|=2;var s=kk(),i=Mk();et!==n||Ee!==e?(dv=null,uv=$s()+500,lf(n,e)):_f=Xg(n,e);e:do try{if(Fe!==0&&we!==null){e=we;var r=Bs;t:switch(Fe){case 1:Fe=0,Bs=null,ad(n,e,r,1);break;case 2:case 9:if(M1(r)){Fe=0,Bs=null,tT(e);break}e=function(){Fe!==2&&Fe!==9||et!==n||(Fe=7),Lr(n)},r.then(e,e);break e;case 3:Fe=7;break e;case 4:Fe=5;break e;case 7:M1(r)?(Fe=0,Bs=null,tT(e)):(Fe=0,Bs=null,ad(n,e,r,7));break;case 5:var a=null;switch(we.tag){case 26:a=we.memoizedState;case 5:case 27:var o=we;if(a?Qk(a):o.stateNode.complete){Fe=0,Bs=null;var l=o.sibling;if(l!==null)we=l;else{var c=o.return;c!==null?(we=c,Nb(c)):we=null}break t}}Fe=0,Bs=null,ad(n,e,r,5);break;case 6:Fe=0,Bs=null,ad(n,e,r,6);break;case 8:tA(),Mt=6;break e;default:throw Error(B(462))}}l4();break}catch(d){Nk(n,d)}while(!0);return Ia=xu=null,oe.H=s,oe.A=i,De=t,we!==null?0:(et=null,Ee=0,bb(),Mt)}function l4(){for(;we!==null&&!ML();)Ik(we)}function Ik(n){var e=rk(n.alternate,n,Ga);n.memoizedProps=n.pendingProps,e===null?Nb(n):we=e}function tT(n){var e=n,t=e.alternate;switch(e.tag){case 15:case 0:e=K1(t,e,e.pendingProps,e.type,void 0,Ee);break;case 11:e=K1(t,e,e.pendingProps,e.type.render,e.ref,Ee);break;case 5:zE(e);default:ak(t,e),e=we=aR(e,Ga),e=rk(t,e,Ga)}n.memoizedProps=n.pendingProps,e===null?Nb(n):we=e}function ad(n,e,t,s){Ia=xu=null,zE(e),_d=null,zp=0;var i=e.return;try{if(XO(n,i,e,t,Ee)){Mt=1,ov(n,vi(t,n.current)),we=null;return}}catch(r){if(i!==null)throw we=i,r;Mt=1,ov(n,vi(t,n.current)),we=null;return}e.flags&32768?(Ce||s===1?n=!0:_f||Ee&536870912?n=!1:(tl=n=!0,(s===2||s===9||s===3||s===6)&&(s=Qs.current,s!==null&&s.tag===13&&(s.flags|=16384))),Dk(e,n)):Nb(e)}function Nb(n){var e=n;do{if(e.flags&32768){Dk(e,tl);return}n=e.return;var t=ZO(e.alternate,e,Ga);if(t!==null){we=t;return}if(e=e.sibling,e!==null){we=e;return}we=e=n}while(e!==null);Mt===0&&(Mt=5)}function Dk(n,e){do{var t=e4(n.alternate,n);if(t!==null){t.flags&=32767,we=t;return}if(t=n.return,t!==null&&(t.flags|=32768,t.subtreeFlags=0,t.deletions=null),!e&&(n=n.sibling,n!==null)){we=n;return}we=n=t}while(n!==null);Mt=6,we=null}function nT(n,e,t,s,i,r,a,o,l){n.cancelPendingCommit=null;do Rb();while(Qt!==0);if(De&6)throw Error(B(327));if(e!==null){if(e===n.current)throw Error(B(177));if(r=e.lanes|e.childLanes,r|=TE,HL(n,t,r,a,o,l),n===et&&(we=et=null,Ee=0),of=e,cl=n,La=t,Vx=r,$x=i,Ak=s,e.subtreeFlags&10256||e.flags&10256?(n.callbackNode=null,n.callbackPriority=0,h4(Xy,function(){return Bk(),null})):(n.callbackNode=null,n.callbackPriority=0),s=(e.flags&13878)!==0,e.subtreeFlags&13878||s){s=oe.T,oe.T=null,i=Pe.p,Pe.p=2,a=De,De|=4;try{t4(n,e,t)}finally{De=a,Pe.p=i,oe.T=s}}Qt=1,Pk(),Lk(),Ok()}}function Pk(){if(Qt===1){Qt=0;var n=cl,e=of,t=(e.flags&13878)!==0;if(e.subtreeFlags&13878||t){t=oe.T,oe.T=null;var s=Pe.p;Pe.p=2;var i=De;De|=4;try{yk(e,n);var r=Wx,a=Q2(n.containerInfo),o=r.focusedElem,l=r.selectionRange;if(a!==o&&o&&o.ownerDocument&&W2(o.ownerDocument.documentElement,o)){if(l!==null&&AE(o)){var c=l.start,d=l.end;if(d===void 0&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var h=o.ownerDocument||document,p=h&&h.defaultView||window;if(p.getSelection){var y=p.getSelection(),v=o.textContent.length,_=Math.min(l.start,v),E=l.end===void 0?_:Math.min(l.end,v);!y.extend&&_>E&&(a=E,E=_,_=a);var b=E1(o,_),w=E1(o,E);if(b&&w&&(y.rangeCount!==1||y.anchorNode!==b.node||y.anchorOffset!==b.offset||y.focusNode!==w.node||y.focusOffset!==w.offset)){var S=h.createRange();S.setStart(b.node,b.offset),y.removeAllRanges(),_>E?(y.addRange(S),y.extend(w.node,w.offset)):(S.setEnd(w.node,w.offset),y.addRange(S))}}}}for(h=[],y=o;y=y.parentNode;)y.nodeType===1&&h.push({element:y,left:y.scrollLeft,top:y.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var T=h[o];T.element.scrollLeft=T.left,T.element.scrollTop=T.top}}_v=!!Xx,Wx=Xx=null}finally{De=i,Pe.p=s,oe.T=t}}n.current=e,Qt=2}}function Lk(){if(Qt===2){Qt=0;var n=cl,e=of,t=(e.flags&8772)!==0;if(e.subtreeFlags&8772||t){t=oe.T,oe.T=null;var s=Pe.p;Pe.p=2;var i=De;De|=4;try{hk(n,e.alternate,e)}finally{De=i,Pe.p=s,oe.T=t}}Qt=3}}function Ok(){if(Qt===4||Qt===3){Qt=0,IL();var n=cl,e=of,t=La,s=Ak;e.subtreeFlags&10256||e.flags&10256?Qt=5:(Qt=0,of=cl=null,Uk(n,n.pendingLanes));var i=n.pendingLanes;if(i===0&&(ll=null),vE(t),e=e.stateNode,Ys&&typeof Ys.onCommitFiberRoot=="function")try{Ys.onCommitFiberRoot(Jg,e,void 0,(e.current.flags&128)===128)}catch{}if(s!==null){e=oe.T,i=Pe.p,Pe.p=2,oe.T=null;try{for(var r=n.onRecoverableError,a=0;a<s.length;a++){var o=s[a];r(o.value,{componentStack:o.stack})}}finally{oe.T=e,Pe.p=i}}La&3&&Rb(),Lr(n),i=n.pendingLanes,t&261930&&i&42?n===Yx?kp++:(kp=0,Yx=n):kp=0,s0(0)}}function Uk(n,e){(n.pooledCacheLanes&=e)===0&&(e=n.pooledCache,e!=null&&(n.pooledCache=null,e0(e)))}function Rb(){return Pk(),Lk(),Ok(),Bk()}function Bk(){if(Qt!==5)return!1;var n=cl,e=Vx;Vx=0;var t=vE(La),s=oe.T,i=Pe.p;try{Pe.p=32>t?32:t,oe.T=null,t=$x,$x=null;var r=cl,a=La;if(Qt=0,of=cl=null,La=0,De&6)throw Error(B(331));var o=De;if(De|=4,wk(r.current),bk(r,r.current,a,t),De=o,s0(0,!1),Ys&&typeof Ys.onPostCommitFiberRoot=="function")try{Ys.onPostCommitFiberRoot(Jg,r)}catch{}return!0}finally{Pe.p=i,oe.T=s,Uk(n,e)}}function sT(n,e,t){e=vi(t,e),e=zx(n.stateNode,e,2),n=ol(n,e,2),n!==null&&(Wg(n,2),Lr(n))}function ze(n,e,t){if(n.tag===3)sT(n,n,t);else for(;e!==null;){if(e.tag===3){sT(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ll===null||!ll.has(s))){n=vi(t,n),t=ZR(2),s=ol(e,t,2),s!==null&&(ek(t,s,e,n),Wg(s,2),Lr(s));break}}e=e.return}}function M_(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new i4;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(ZE=!0,i.add(t),n=c4.bind(null,n,e,t),e.then(n,n))}function c4(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),n.pingedLanes|=n.suspendedLanes&t,n.warmLanes&=~t,et===n&&(Ee&t)===t&&(Mt===4||Mt===3&&(Ee&62914560)===Ee&&300>$s()-Tb?!(De&2)&&lf(n,0):eA|=t,af===Ee&&(af=0)),Lr(n)}function Fk(n,e){e===0&&(e=k2()),n=_u(n,e),n!==null&&(Wg(n,e),Lr(n))}function u4(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Fk(n,t)}function d4(n,e){var t=0;switch(n.tag){case 31:case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;case 22:s=n.stateNode._retryCache;break;default:throw Error(B(314))}s!==null&&s.delete(e),Fk(n,t)}function h4(n,e){return gE(n,e)}var fv=null,Uu=null,Kx=!1,pv=!1,I_=!1,sl=0;function Lr(n){n!==Uu&&n.next===null&&(Uu===null?fv=Uu=n:Uu=Uu.next=n),pv=!0,Kx||(Kx=!0,p4())}function s0(n,e){if(!I_&&pv){I_=!0;do for(var t=!1,s=fv;s!==null;){if(n!==0){var i=s.pendingLanes;if(i===0)var r=0;else{var a=s.suspendedLanes,o=s.pingedLanes;r=(1<<31-Ks(42|n)+1)-1,r&=i&~(a&~o),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(t=!0,iT(s,r))}else r=Ee,r=mb(s,s===et?r:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),!(r&3)||Xg(s,r)||(t=!0,iT(s,r));s=s.next}while(t);I_=!1}}function f4(){zk()}function zk(){pv=Kx=!1;var n=0;sl!==0&&E4()&&(n=sl);for(var e=$s(),t=null,s=fv;s!==null;){var i=s.next,r=Hk(s,e);r===0?(s.next=null,t===null?fv=i:t.next=i,i===null&&(Uu=t)):(t=s,(n!==0||r&3)&&(pv=!0)),s=i}Qt!==0&&Qt!==5||s0(n),sl!==0&&(sl=0)}function Hk(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes&-62914561;0<r;){var a=31-Ks(r),o=1<<a,l=i[a];l===-1?(!(o&t)||o&s)&&(i[a]=zL(o,e)):l<=e&&(n.expiredLanes|=o),r&=~o}if(e=et,t=Ee,t=mb(n,n===e?t:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),s=n.callbackNode,t===0||n===e&&(Fe===2||Fe===9)||n.cancelPendingCommit!==null)return s!==null&&s!==null&&a_(s),n.callbackNode=null,n.callbackPriority=0;if(!(t&3)||Xg(n,t)){if(e=t&-t,e===n.callbackPriority)return e;switch(s!==null&&a_(s),vE(t)){case 2:case 8:t=N2;break;case 32:t=Xy;break;case 268435456:t=R2;break;default:t=Xy}return s=jk.bind(null,n),t=gE(t,s),n.callbackPriority=e,n.callbackNode=t,e}return s!==null&&s!==null&&a_(s),n.callbackPriority=2,n.callbackNode=null,2}function jk(n,e){if(Qt!==0&&Qt!==5)return n.callbackNode=null,n.callbackPriority=0,null;var t=n.callbackNode;if(Rb()&&n.callbackNode!==t)return null;var s=Ee;return s=mb(n,n===et?s:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),s===0?null:(Ck(n,s,e),Hk(n,$s()),n.callbackNode!=null&&n.callbackNode===t?jk.bind(null,n):null)}function iT(n,e){if(Rb())return null;Ck(n,e,!0)}function p4(){T4(function(){De&6?gE(C2,f4):zk()})}function nA(){if(sl===0){var n=nf;n===0&&(n=y0,y0<<=1,!(y0&261888)&&(y0=256)),sl=n}return sl}function rT(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:W0(""+n)}function aT(n,e){var t=e.ownerDocument.createElement("input");return t.name=e.name,t.value=e.value,n.id&&t.setAttribute("form",n.id),e.parentNode.insertBefore(t,e),n=new FormData(n),t.parentNode.removeChild(t),n}function m4(n,e,t,s,i){if(e==="submit"&&t&&t.stateNode===i){var r=rT((i[ps]||null).action),a=s.submitter;a&&(e=(e=a[ps]||null)?rT(e.formAction):a.getAttribute("formAction"),e!==null&&(r=e,a=null));var o=new gb("action","action",null,s,i);n.push({event:o,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(sl!==0){var l=a?aT(i,a):new FormData(i);Bx(t,{pending:!0,data:l,method:i.method,action:r},null,l)}}else typeof r=="function"&&(o.preventDefault(),l=a?aT(i,a):new FormData(i),Bx(t,{pending:!0,data:l,method:i.method,action:r},r,l))},currentTarget:i}]})}}for(var D_=0;D_<Tx.length;D_++){var P_=Tx[D_],g4=P_.toLowerCase(),y4=P_[0].toUpperCase()+P_.slice(1);Qi(g4,"on"+y4)}Qi(eR,"onAnimationEnd");Qi(tR,"onAnimationIteration");Qi(nR,"onAnimationStart");Qi("dblclick","onDoubleClick");Qi("focusin","onFocus");Qi("focusout","onBlur");Qi(DO,"onTransitionRun");Qi(PO,"onTransitionStart");Qi(LO,"onTransitionCancel");Qi(sR,"onTransitionEnd");ef("onMouseEnter",["mouseout","mouseover"]);ef("onMouseLeave",["mouseout","mouseover"]);ef("onPointerEnter",["pointerout","pointerover"]);ef("onPointerLeave",["pointerout","pointerover"]);yu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yu("onBeforeInput",["compositionend","keypress","textInput","paste"]);yu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gp));function Gk(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=c;try{r(i)}catch(d){Qy(d)}i.currentTarget=null,r=l}else for(a=0;a<s.length;a++){if(o=s[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==r&&i.isPropagationStopped())break e;r=o,i.currentTarget=c;try{r(i)}catch(d){Qy(d)}i.currentTarget=null,r=l}}}}function xe(n,e){var t=e[vx];t===void 0&&(t=e[vx]=new Set);var s=n+"__bubble";t.has(s)||(qk(e,n,2,!1),t.add(s))}function L_(n,e,t){var s=0;e&&(s|=4),qk(t,n,s,e)}var C0="_reactListening"+Math.random().toString(36).slice(2);function sA(n){if(!n[C0]){n[C0]=!0,L2.forEach(function(t){t!=="selectionchange"&&(v4.has(t)||L_(t,!1,n),L_(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[C0]||(e[C0]=!0,L_("selectionchange",!1,e))}}function qk(n,e,t,s){switch(sM(e)){case 2:var i=$4;break;case 8:i=Y4;break;default:i=oA}t=i.bind(null,e,t,n),i=void 0,!Sx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function O_(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i)break;if(a===4)for(a=s.return;a!==null;){var l=a.tag;if((l===3||l===4)&&a.stateNode.containerInfo===i)return;a=a.return}for(;o!==null;){if(a=Wu(o),a===null)return;if(l=a.tag,l===5||l===6||l===26||l===27){s=r=a;continue e}o=o.parentNode}}s=s.return}G2(function(){var c=r,d=xE(t),h=[];e:{var p=iR.get(n);if(p!==void 0){var y=gb,v=n;switch(n){case"keypress":if(Z0(t)===0)break e;case"keydown":case"keyup":y=dO;break;case"focusin":v="focus",y=d_;break;case"focusout":v="blur",y=d_;break;case"beforeblur":case"afterblur":y=d_;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=p1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=ZL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=pO;break;case eR:case tR:case nR:y=nO;break;case sR:y=gO;break;case"scroll":case"scrollend":y=WL;break;case"wheel":y=vO;break;case"copy":case"cut":case"paste":y=iO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=g1;break;case"toggle":case"beforetoggle":y=_O}var _=(e&4)!==0,E=!_&&(n==="scroll"||n==="scrollend"),b=_?p!==null?p+"Capture":null:p;_=[];for(var w=c,S;w!==null;){var T=w;if(S=T.stateNode,T=T.tag,T!==5&&T!==26&&T!==27||S===null||b===null||(T=Lp(w,b),T!=null&&_.push(qp(w,T,S))),E)break;w=w.return}0<_.length&&(p=new y(p,v,null,t,d),h.push({event:p,listeners:_}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",y=n==="mouseout"||n==="pointerout",p&&t!==wx&&(v=t.relatedTarget||t.fromElement)&&(Wu(v)||v[gf]))break e;if((y||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,y?(v=t.relatedTarget||t.toElement,y=c,v=v?Wu(v):null,v!==null&&(E=Kg(v),_=v.tag,v!==E||_!==5&&_!==27&&_!==6)&&(v=null)):(y=null,v=c),y!==v)){if(_=p1,T="onMouseLeave",b="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(_=g1,T="onPointerLeave",b="onPointerEnter",w="pointer"),E=y==null?p:$f(y),S=v==null?p:$f(v),p=new _(T,w+"leave",y,t,d),p.target=E,p.relatedTarget=S,T=null,Wu(d)===c&&(_=new _(b,w+"enter",v,t,d),_.target=S,_.relatedTarget=E,T=_),E=T,y&&v)t:{for(_=b4,b=y,w=v,S=0,T=b;T;T=_(T))S++;T=0;for(var N=w;N;N=_(N))T++;for(;0<S-T;)b=_(b),S--;for(;0<T-S;)w=_(w),T--;for(;S--;){if(b===w||w!==null&&b===w.alternate){_=b;break t}b=_(b),w=_(w)}_=null}else _=null;y!==null&&oT(h,p,y,_,!1),v!==null&&E!==null&&oT(h,E,v,_,!0)}}e:{if(p=c?$f(c):window,y=p.nodeName&&p.nodeName.toLowerCase(),y==="select"||y==="input"&&p.type==="file")var R=_1;else if(b1(p))if(J2)R=kO;else{R=NO;var k=CO}else y=p.nodeName,!y||y.toLowerCase()!=="input"||p.type!=="checkbox"&&p.type!=="radio"?c&&_E(c.elementType)&&(R=_1):R=RO;if(R&&(R=R(n,c))){K2(h,R,t,d);break e}k&&k(n,p,c),n==="focusout"&&c&&p.type==="number"&&c.memoizedProps.value!=null&&xx(p,"number",p.value)}switch(k=c?$f(c):window,n){case"focusin":(b1(k)||k.contentEditable==="true")&&(ed=k,Ex=c,xp=null);break;case"focusout":xp=Ex=ed=null;break;case"mousedown":Ax=!0;break;case"contextmenu":case"mouseup":case"dragend":Ax=!1,A1(h,t,d);break;case"selectionchange":if(IO)break;case"keydown":case"keyup":A1(h,t,d)}var I;if(EE)e:{switch(n){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Zu?$2(n,t)&&(M="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(M="onCompositionStart");M&&(V2&&t.locale!=="ko"&&(Zu||M!=="onCompositionStart"?M==="onCompositionEnd"&&Zu&&(I=q2()):(el=d,wE="value"in el?el.value:el.textContent,Zu=!0)),k=mv(c,M),0<k.length&&(M=new m1(M,n,null,t,d),h.push({event:M,listeners:k}),I?M.data=I:(I=Y2(t),I!==null&&(M.data=I)))),(I=wO?SO(n,t):EO(n,t))&&(M=mv(c,"onBeforeInput"),0<M.length&&(k=new m1("onBeforeInput","beforeinput",null,t,d),h.push({event:k,listeners:M}),k.data=I)),m4(h,n,c,t,d)}Gk(h,e)})}function qp(n,e,t){return{instance:n,listener:e,currentTarget:t}}function mv(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||r===null||(i=Lp(n,t),i!=null&&s.unshift(qp(n,i,r)),i=Lp(n,e),i!=null&&s.push(qp(n,i,r))),n.tag===3)return s;n=n.return}return[]}function b4(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function oT(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,l=o.alternate,c=o.stateNode;if(o=o.tag,l!==null&&l===s)break;o!==5&&o!==26&&o!==27||c===null||(l=c,i?(c=Lp(t,r),c!=null&&a.unshift(qp(t,c,l))):i||(c=Lp(t,r),c!=null&&a.push(qp(t,c,l)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var _4=/\r\n?/g,x4=/\u0000|\uFFFD/g;function lT(n){return(typeof n=="string"?n:""+n).replace(_4,`
`).replace(x4,"")}function Vk(n,e){return e=lT(e),lT(n)===e}function $e(n,e,t,s,i,r){switch(t){case"children":typeof s=="string"?e==="body"||e==="textarea"&&s===""||tf(n,s):(typeof s=="number"||typeof s=="bigint")&&e!=="body"&&tf(n,""+s);break;case"className":_0(n,"class",s);break;case"tabIndex":_0(n,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":_0(n,t,s);break;case"style":j2(n,s,r);break;case"data":if(e!=="object"){_0(n,"data",s);break}case"src":case"href":if(s===""&&(e!=="a"||t!=="href")){n.removeAttribute(t);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){n.removeAttribute(t);break}s=W0(""+s),n.setAttribute(t,s);break;case"action":case"formAction":if(typeof s=="function"){n.setAttribute(t,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(t==="formAction"?(e!=="input"&&$e(n,e,"name",i.name,i,null),$e(n,e,"formEncType",i.formEncType,i,null),$e(n,e,"formMethod",i.formMethod,i,null),$e(n,e,"formTarget",i.formTarget,i,null)):($e(n,e,"encType",i.encType,i,null),$e(n,e,"method",i.method,i,null),$e(n,e,"target",i.target,i,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){n.removeAttribute(t);break}s=W0(""+s),n.setAttribute(t,s);break;case"onClick":s!=null&&(n.onclick=Ma);break;case"onScroll":s!=null&&xe("scroll",n);break;case"onScrollEnd":s!=null&&xe("scrollend",n);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(B(61));if(t=s.__html,t!=null){if(i.children!=null)throw Error(B(60));n.innerHTML=t}}break;case"multiple":n.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":n.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){n.removeAttribute("xlink:href");break}t=W0(""+s),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?n.setAttribute(t,""+s):n.removeAttribute(t);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?n.setAttribute(t,""):n.removeAttribute(t);break;case"capture":case"download":s===!0?n.setAttribute(t,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?n.setAttribute(t,s):n.removeAttribute(t);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?n.setAttribute(t,s):n.removeAttribute(t);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?n.removeAttribute(t):n.setAttribute(t,s);break;case"popover":xe("beforetoggle",n),xe("toggle",n),X0(n,"popover",s);break;case"xlinkActuate":Or(n,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Or(n,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Or(n,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Or(n,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Or(n,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Or(n,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Or(n,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Or(n,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Or(n,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":X0(n,"is",s);break;case"innerText":case"textContent":break;default:(!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(t=JL.get(t)||t,X0(n,t,s))}}function Jx(n,e,t,s,i,r){switch(t){case"style":j2(n,s,r);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(B(61));if(t=s.__html,t!=null){if(i.children!=null)throw Error(B(60));n.innerHTML=t}}break;case"children":typeof s=="string"?tf(n,s):(typeof s=="number"||typeof s=="bigint")&&tf(n,""+s);break;case"onScroll":s!=null&&xe("scroll",n);break;case"onScrollEnd":s!=null&&xe("scrollend",n);break;case"onClick":s!=null&&(n.onclick=Ma);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!O2.hasOwnProperty(t))e:{if(t[0]==="o"&&t[1]==="n"&&(i=t.endsWith("Capture"),e=t.slice(2,i?t.length-7:void 0),r=n[ps]||null,r=r!=null?r[t]:null,typeof r=="function"&&n.removeEventListener(e,r,i),typeof s=="function")){typeof r!="function"&&r!==null&&(t in n?n[t]=null:n.hasAttribute(t)&&n.removeAttribute(t)),n.addEventListener(e,s,i);break e}t in n?n[t]=s:s===!0?n.setAttribute(t,""):X0(n,t,s)}}}function kn(n,e,t){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xe("error",n),xe("load",n);var s=!1,i=!1,r;for(r in t)if(t.hasOwnProperty(r)){var a=t[r];if(a!=null)switch(r){case"src":s=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(B(137,e));default:$e(n,e,r,a,t,null)}}i&&$e(n,e,"srcSet",t.srcSet,t,null),s&&$e(n,e,"src",t.src,t,null);return;case"input":xe("invalid",n);var o=r=a=i=null,l=null,c=null;for(s in t)if(t.hasOwnProperty(s)){var d=t[s];if(d!=null)switch(s){case"name":i=d;break;case"type":a=d;break;case"checked":l=d;break;case"defaultChecked":c=d;break;case"value":r=d;break;case"defaultValue":o=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(B(137,e));break;default:$e(n,e,s,d,t,null)}}F2(n,r,o,l,c,a,i,!1);return;case"select":xe("invalid",n),s=a=r=null;for(i in t)if(t.hasOwnProperty(i)&&(o=t[i],o!=null))switch(i){case"value":r=o;break;case"defaultValue":a=o;break;case"multiple":s=o;default:$e(n,e,i,o,t,null)}e=r,t=a,n.multiple=!!s,e!=null?yd(n,!!s,e,!1):t!=null&&yd(n,!!s,t,!0);return;case"textarea":xe("invalid",n),r=i=s=null;for(a in t)if(t.hasOwnProperty(a)&&(o=t[a],o!=null))switch(a){case"value":s=o;break;case"defaultValue":i=o;break;case"children":r=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(B(91));break;default:$e(n,e,a,o,t,null)}H2(n,s,i,r);return;case"option":for(l in t)if(t.hasOwnProperty(l)&&(s=t[l],s!=null))switch(l){case"selected":n.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:$e(n,e,l,s,t,null)}return;case"dialog":xe("beforetoggle",n),xe("toggle",n),xe("cancel",n),xe("close",n);break;case"iframe":case"object":xe("load",n);break;case"video":case"audio":for(s=0;s<Gp.length;s++)xe(Gp[s],n);break;case"image":xe("error",n),xe("load",n);break;case"details":xe("toggle",n);break;case"embed":case"source":case"link":xe("error",n),xe("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in t)if(t.hasOwnProperty(c)&&(s=t[c],s!=null))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(B(137,e));default:$e(n,e,c,s,t,null)}return;default:if(_E(e)){for(d in t)t.hasOwnProperty(d)&&(s=t[d],s!==void 0&&Jx(n,e,d,s,t,void 0));return}}for(o in t)t.hasOwnProperty(o)&&(s=t[o],s!=null&&$e(n,e,o,s,t,null))}function w4(n,e,t,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,a=null,o=null,l=null,c=null,d=null;for(y in t){var h=t[y];if(t.hasOwnProperty(y)&&h!=null)switch(y){case"checked":break;case"value":break;case"defaultValue":l=h;default:s.hasOwnProperty(y)||$e(n,e,y,null,s,h)}}for(var p in s){var y=s[p];if(h=t[p],s.hasOwnProperty(p)&&(y!=null||h!=null))switch(p){case"type":r=y;break;case"name":i=y;break;case"checked":c=y;break;case"defaultChecked":d=y;break;case"value":a=y;break;case"defaultValue":o=y;break;case"children":case"dangerouslySetInnerHTML":if(y!=null)throw Error(B(137,e));break;default:y!==h&&$e(n,e,p,y,s,h)}}_x(n,a,o,l,c,d,r,i);return;case"select":y=a=o=p=null;for(r in t)if(l=t[r],t.hasOwnProperty(r)&&l!=null)switch(r){case"value":break;case"multiple":y=l;default:s.hasOwnProperty(r)||$e(n,e,r,null,s,l)}for(i in s)if(r=s[i],l=t[i],s.hasOwnProperty(i)&&(r!=null||l!=null))switch(i){case"value":p=r;break;case"defaultValue":o=r;break;case"multiple":a=r;default:r!==l&&$e(n,e,i,r,s,l)}e=o,t=a,s=y,p!=null?yd(n,!!t,p,!1):!!s!=!!t&&(e!=null?yd(n,!!t,e,!0):yd(n,!!t,t?[]:"",!1));return;case"textarea":y=p=null;for(o in t)if(i=t[o],t.hasOwnProperty(o)&&i!=null&&!s.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:$e(n,e,o,null,s,i)}for(a in s)if(i=s[a],r=t[a],s.hasOwnProperty(a)&&(i!=null||r!=null))switch(a){case"value":p=i;break;case"defaultValue":y=i;break;case"children":break;case"dangerouslySetInnerHTML":if(i!=null)throw Error(B(91));break;default:i!==r&&$e(n,e,a,i,s,r)}z2(n,p,y);return;case"option":for(var v in t)if(p=t[v],t.hasOwnProperty(v)&&p!=null&&!s.hasOwnProperty(v))switch(v){case"selected":n.selected=!1;break;default:$e(n,e,v,null,s,p)}for(l in s)if(p=s[l],y=t[l],s.hasOwnProperty(l)&&p!==y&&(p!=null||y!=null))switch(l){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:$e(n,e,l,p,s,y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _ in t)p=t[_],t.hasOwnProperty(_)&&p!=null&&!s.hasOwnProperty(_)&&$e(n,e,_,null,s,p);for(c in s)if(p=s[c],y=t[c],s.hasOwnProperty(c)&&p!==y&&(p!=null||y!=null))switch(c){case"children":case"dangerouslySetInnerHTML":if(p!=null)throw Error(B(137,e));break;default:$e(n,e,c,p,s,y)}return;default:if(_E(e)){for(var E in t)p=t[E],t.hasOwnProperty(E)&&p!==void 0&&!s.hasOwnProperty(E)&&Jx(n,e,E,void 0,s,p);for(d in s)p=s[d],y=t[d],!s.hasOwnProperty(d)||p===y||p===void 0&&y===void 0||Jx(n,e,d,p,s,y);return}}for(var b in t)p=t[b],t.hasOwnProperty(b)&&p!=null&&!s.hasOwnProperty(b)&&$e(n,e,b,null,s,p);for(h in s)p=s[h],y=t[h],!s.hasOwnProperty(h)||p===y||p==null&&y==null||$e(n,e,h,p,s,y)}function cT(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function S4(){if(typeof performance.getEntriesByType=="function"){for(var n=0,e=0,t=performance.getEntriesByType("resource"),s=0;s<t.length;s++){var i=t[s],r=i.transferSize,a=i.initiatorType,o=i.duration;if(r&&o&&cT(a)){for(a=0,o=i.responseEnd,s+=1;s<t.length;s++){var l=t[s],c=l.startTime;if(c>o)break;var d=l.transferSize,h=l.initiatorType;d&&cT(h)&&(l=l.responseEnd,a+=d*(l<o?1:(o-c)/(l-c)))}if(--s,e+=8*(r+a)/(i.duration/1e3),n++,10<n)break}}if(0<n)return e/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Xx=null,Wx=null;function gv(n){return n.nodeType===9?n:n.ownerDocument}function uT(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $k(n,e){if(n===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&e==="foreignObject"?0:n}function Qx(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var U_=null;function E4(){var n=window.event;return n&&n.type==="popstate"?n===U_?!1:(U_=n,!0):(U_=null,!1)}var Yk=typeof setTimeout=="function"?setTimeout:void 0,A4=typeof clearTimeout=="function"?clearTimeout:void 0,dT=typeof Promise=="function"?Promise:void 0,T4=typeof queueMicrotask=="function"?queueMicrotask:typeof dT<"u"?function(n){return dT.resolve(null).then(n).catch(C4)}:Yk;function C4(n){setTimeout(function(){throw n})}function xl(n){return n==="head"}function hT(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"||t==="/&"){if(s===0){n.removeChild(i),uf(e);return}s--}else if(t==="$"||t==="$?"||t==="$~"||t==="$!"||t==="&")s++;else if(t==="html")Mp(n.ownerDocument.documentElement);else if(t==="head"){t=n.ownerDocument.head,Mp(t);for(var r=t.firstChild;r;){var a=r.nextSibling,o=r.nodeName;r[Qg]||o==="SCRIPT"||o==="STYLE"||o==="LINK"&&r.rel.toLowerCase()==="stylesheet"||t.removeChild(r),r=a}}else t==="body"&&Mp(n.ownerDocument.body);t=i}while(t);uf(e)}function fT(n,e){var t=n;n=0;do{var s=t.nextSibling;if(t.nodeType===1?e?(t._stashedDisplay=t.style.display,t.style.display="none"):(t.style.display=t._stashedDisplay||"",t.getAttribute("style")===""&&t.removeAttribute("style")):t.nodeType===3&&(e?(t._stashedText=t.nodeValue,t.nodeValue=""):t.nodeValue=t._stashedText||""),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(n===0)break;n--}else t!=="$"&&t!=="$?"&&t!=="$~"&&t!=="$!"||n++;t=s}while(t)}function Zx(n){var e=n.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var t=e;switch(e=e.nextSibling,t.nodeName){case"HTML":case"HEAD":case"BODY":Zx(t),bE(t);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(t.rel.toLowerCase()==="stylesheet")continue}n.removeChild(t)}}function N4(n,e,t,s){for(;n.nodeType===1;){var i=t;if(n.nodeName.toLowerCase()!==e.toLowerCase()){if(!s&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(s){if(!n[Qg])switch(e){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(r=n.getAttribute("rel"),r==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(r!==i.rel||n.getAttribute("href")!==(i.href==null||i.href===""?null:i.href)||n.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin)||n.getAttribute("title")!==(i.title==null?null:i.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(r=n.getAttribute("src"),(r!==(i.src==null?null:i.src)||n.getAttribute("type")!==(i.type==null?null:i.type)||n.getAttribute("crossorigin")!==(i.crossOrigin==null?null:i.crossOrigin))&&r&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(e==="input"&&n.type==="hidden"){var r=i.name==null?null:""+i.name;if(i.type==="hidden"&&n.getAttribute("name")===r)return n}else return n;if(n=wi(n.nextSibling),n===null)break}return null}function R4(n,e,t){if(e==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!t||(n=wi(n.nextSibling),n===null))return null;return n}function Kk(n,e){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!e||(n=wi(n.nextSibling),n===null))return null;return n}function ew(n){return n.data==="$?"||n.data==="$~"}function tw(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function k4(n,e){var t=n.ownerDocument;if(n.data==="$~")n._reactRetry=e;else if(n.data!=="$?"||t.readyState!=="loading")e();else{var s=function(){e(),t.removeEventListener("DOMContentLoaded",s)};t.addEventListener("DOMContentLoaded",s),n._reactRetry=s}}function wi(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?"||e==="$~"||e==="&"||e==="F!"||e==="F")break;if(e==="/$"||e==="/&")return null}}return n}var nw=null;function pT(n){n=n.nextSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"||t==="/&"){if(e===0)return wi(n.nextSibling);e--}else t!=="$"&&t!=="$!"&&t!=="$?"&&t!=="$~"&&t!=="&"||e++}n=n.nextSibling}return null}function mT(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"){if(e===0)return n;e--}else t!=="/$"&&t!=="/&"||e++}n=n.previousSibling}return null}function Jk(n,e,t){switch(e=gv(t),n){case"html":if(n=e.documentElement,!n)throw Error(B(452));return n;case"head":if(n=e.head,!n)throw Error(B(453));return n;case"body":if(n=e.body,!n)throw Error(B(454));return n;default:throw Error(B(451))}}function Mp(n){for(var e=n.attributes;e.length;)n.removeAttributeNode(e[0]);bE(n)}var Ti=new Map,gT=new Set;function yv(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ya=Pe.d;Pe.d={f:M4,r:I4,D:D4,C:P4,L:L4,m:O4,X:B4,S:U4,M:F4};function M4(){var n=Ya.f(),e=Cb();return n||e}function I4(n){var e=yf(n);e!==null&&e.tag===5&&e.type==="form"?jR(e):Ya.r(n)}var xf=typeof document>"u"?null:document;function Xk(n,e,t){var s=xf;if(s&&typeof e=="string"&&e){var i=yi(e);i='link[rel="'+n+'"][href="'+i+'"]',typeof t=="string"&&(i+='[crossorigin="'+t+'"]'),gT.has(i)||(gT.add(i),n={rel:n,crossOrigin:t,href:e},s.querySelector(i)===null&&(e=s.createElement("link"),kn(e,"link",n),dn(e),s.head.appendChild(e)))}}function D4(n){Ya.D(n),Xk("dns-prefetch",n,null)}function P4(n,e){Ya.C(n,e),Xk("preconnect",n,e)}function L4(n,e,t){Ya.L(n,e,t);var s=xf;if(s&&n&&e){var i='link[rel="preload"][as="'+yi(e)+'"]';e==="image"&&t&&t.imageSrcSet?(i+='[imagesrcset="'+yi(t.imageSrcSet)+'"]',typeof t.imageSizes=="string"&&(i+='[imagesizes="'+yi(t.imageSizes)+'"]')):i+='[href="'+yi(n)+'"]';var r=i;switch(e){case"style":r=cf(n);break;case"script":r=wf(n)}Ti.has(r)||(n=dt({rel:"preload",href:e==="image"&&t&&t.imageSrcSet?void 0:n,as:e},t),Ti.set(r,n),s.querySelector(i)!==null||e==="style"&&s.querySelector(i0(r))||e==="script"&&s.querySelector(r0(r))||(e=s.createElement("link"),kn(e,"link",n),dn(e),s.head.appendChild(e)))}}function O4(n,e){Ya.m(n,e);var t=xf;if(t&&n){var s=e&&typeof e.as=="string"?e.as:"script",i='link[rel="modulepreload"][as="'+yi(s)+'"][href="'+yi(n)+'"]',r=i;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=wf(n)}if(!Ti.has(r)&&(n=dt({rel:"modulepreload",href:n},e),Ti.set(r,n),t.querySelector(i)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(t.querySelector(r0(r)))return}s=t.createElement("link"),kn(s,"link",n),dn(s),t.head.appendChild(s)}}}function U4(n,e,t){Ya.S(n,e,t);var s=xf;if(s&&n){var i=gd(s).hoistableStyles,r=cf(n);e=e||"default";var a=i.get(r);if(!a){var o={loading:0,preload:null};if(a=s.querySelector(i0(r)))o.loading=5;else{n=dt({rel:"stylesheet",href:n,"data-precedence":e},t),(t=Ti.get(r))&&iA(n,t);var l=a=s.createElement("link");dn(l),kn(l,"link",n),l._p=new Promise(function(c,d){l.onload=c,l.onerror=d}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,oy(a,e,s)}a={type:"stylesheet",instance:a,count:1,state:o},i.set(r,a)}}}function B4(n,e){Ya.X(n,e);var t=xf;if(t&&n){var s=gd(t).hoistableScripts,i=wf(n),r=s.get(i);r||(r=t.querySelector(r0(i)),r||(n=dt({src:n,async:!0},e),(e=Ti.get(i))&&rA(n,e),r=t.createElement("script"),dn(r),kn(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function F4(n,e){Ya.M(n,e);var t=xf;if(t&&n){var s=gd(t).hoistableScripts,i=wf(n),r=s.get(i);r||(r=t.querySelector(r0(i)),r||(n=dt({src:n,async:!0,type:"module"},e),(e=Ti.get(i))&&rA(n,e),r=t.createElement("script"),dn(r),kn(r,"link",n),t.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},s.set(i,r))}}function yT(n,e,t,s){var i=(i=il.current)?yv(i):null;if(!i)throw Error(B(446));switch(n){case"meta":case"title":return null;case"style":return typeof t.precedence=="string"&&typeof t.href=="string"?(e=cf(t.href),t=gd(i).hoistableStyles,s=t.get(e),s||(s={type:"style",instance:null,count:0,state:null},t.set(e,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(t.rel==="stylesheet"&&typeof t.href=="string"&&typeof t.precedence=="string"){n=cf(t.href);var r=gd(i).hoistableStyles,a=r.get(n);if(a||(i=i.ownerDocument||i,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(n,a),(r=i.querySelector(i0(n)))&&!r._p&&(a.instance=r,a.state.loading=5),Ti.has(n)||(t={rel:"preload",as:"style",href:t.href,crossOrigin:t.crossOrigin,integrity:t.integrity,media:t.media,hrefLang:t.hrefLang,referrerPolicy:t.referrerPolicy},Ti.set(n,t),r||z4(i,n,t,a.state))),e&&s===null)throw Error(B(528,""));return a}if(e&&s!==null)throw Error(B(529,""));return null;case"script":return e=t.async,t=t.src,typeof t=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=wf(t),t=gd(i).hoistableScripts,s=t.get(e),s||(s={type:"script",instance:null,count:0,state:null},t.set(e,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(B(444,n))}}function cf(n){return'href="'+yi(n)+'"'}function i0(n){return'link[rel="stylesheet"]['+n+"]"}function Wk(n){return dt({},n,{"data-precedence":n.precedence,precedence:null})}function z4(n,e,t,s){n.querySelector('link[rel="preload"][as="style"]['+e+"]")?s.loading=1:(e=n.createElement("link"),s.preload=e,e.addEventListener("load",function(){return s.loading|=1}),e.addEventListener("error",function(){return s.loading|=2}),kn(e,"link",t),dn(e),n.head.appendChild(e))}function wf(n){return'[src="'+yi(n)+'"]'}function r0(n){return"script[async]"+n}function vT(n,e,t){if(e.count++,e.instance===null)switch(e.type){case"style":var s=n.querySelector('style[data-href~="'+yi(t.href)+'"]');if(s)return e.instance=s,dn(s),s;var i=dt({},t,{"data-href":t.href,"data-precedence":t.precedence,href:null,precedence:null});return s=(n.ownerDocument||n).createElement("style"),dn(s),kn(s,"style",i),oy(s,t.precedence,n),e.instance=s;case"stylesheet":i=cf(t.href);var r=n.querySelector(i0(i));if(r)return e.state.loading|=4,e.instance=r,dn(r),r;s=Wk(t),(i=Ti.get(i))&&iA(s,i),r=(n.ownerDocument||n).createElement("link"),dn(r);var a=r;return a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),kn(r,"link",s),e.state.loading|=4,oy(r,t.precedence,n),e.instance=r;case"script":return r=wf(t.src),(i=n.querySelector(r0(r)))?(e.instance=i,dn(i),i):(s=t,(i=Ti.get(r))&&(s=dt({},t),rA(s,i)),n=n.ownerDocument||n,i=n.createElement("script"),dn(i),kn(i,"link",s),n.head.appendChild(i),e.instance=i);case"void":return null;default:throw Error(B(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(s=e.instance,e.state.loading|=4,oy(s,t.precedence,n));return e.instance}function oy(n,e,t){for(var s=t.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=s.length?s[s.length-1]:null,r=i,a=0;a<s.length;a++){var o=s[a];if(o.dataset.precedence===e)r=o;else if(r!==i)break}r?r.parentNode.insertBefore(n,r.nextSibling):(e=t.nodeType===9?t.head:t,e.insertBefore(n,e.firstChild))}function iA(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.title==null&&(n.title=e.title)}function rA(n,e){n.crossOrigin==null&&(n.crossOrigin=e.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=e.referrerPolicy),n.integrity==null&&(n.integrity=e.integrity)}var ly=null;function bT(n,e,t){if(ly===null){var s=new Map,i=ly=new Map;i.set(t,s)}else i=ly,s=i.get(t),s||(s=new Map,i.set(t,s));if(s.has(n))return s;for(s.set(n,null),t=t.getElementsByTagName(n),i=0;i<t.length;i++){var r=t[i];if(!(r[Qg]||r[Tn]||n==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var a=r.getAttribute(e)||"";a=n+a;var o=s.get(a);o?o.push(r):s.set(a,[r])}}return s}function _T(n,e,t){n=n.ownerDocument||n,n.head.insertBefore(t,e==="title"?n.querySelector("head > title"):null)}function H4(n,e,t){if(t===1||e.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return n=e.disabled,typeof e.precedence=="string"&&n==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function Qk(n){return!(n.type==="stylesheet"&&!(n.state.loading&3))}function j4(n,e,t,s){if(t.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(t.state.loading&4)){if(t.instance===null){var i=cf(s.href),r=e.querySelector(i0(i));if(r){e=r._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(n.count++,n=vv.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=r,dn(r);return}r=e.ownerDocument||e,s=Wk(s),(i=Ti.get(i))&&iA(s,i),r=r.createElement("link"),dn(r);var a=r;a._p=new Promise(function(o,l){a.onload=o,a.onerror=l}),kn(r,"link",s),t.instance=r}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&!(t.state.loading&3)&&(n.count++,t=vv.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}var B_=0;function G4(n,e){return n.stylesheets&&n.count===0&&cy(n,n.stylesheets),0<n.count||0<n.imgCount?function(t){var s=setTimeout(function(){if(n.stylesheets&&cy(n,n.stylesheets),n.unsuspend){var r=n.unsuspend;n.unsuspend=null,r()}},6e4+e);0<n.imgBytes&&B_===0&&(B_=62500*S4());var i=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&cy(n,n.stylesheets),n.unsuspend)){var r=n.unsuspend;n.unsuspend=null,r()}},(n.imgBytes>B_?50:800)+e);return n.unsuspend=t,function(){n.unsuspend=null,clearTimeout(s),clearTimeout(i)}}:null}function vv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)cy(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var bv=null;function cy(n,e){n.stylesheets=null,n.unsuspend!==null&&(n.count++,bv=new Map,e.forEach(q4,n),bv=null,vv.call(n))}function q4(n,e){if(!(e.state.loading&4)){var t=bv.get(n);if(t)var s=t.get(null);else{t=new Map,bv.set(n,t);for(var i=n.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var a=i[r];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(t.set(a.dataset.precedence,a),s=a)}s&&t.set(null,s)}i=e.instance,a=i.getAttribute("data-precedence"),r=t.get(a)||s,r===s&&t.set(null,i),t.set(a,i),this.count++,s=vv.bind(this),i.addEventListener("load",s),i.addEventListener("error",s),r?r.parentNode.insertBefore(i,r.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(i,n.firstChild)),e.state.loading|=4}}var Vp={$$typeof:ka,Provider:null,Consumer:null,_currentValue:su,_currentValue2:su,_threadCount:0};function V4(n,e,t,s,i,r,a,o,l){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=o_(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=o_(0),this.hiddenUpdates=o_(null),this.identifierPrefix=s,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function Zk(n,e,t,s,i,r,a,o,l,c,d,h){return n=new V4(n,e,t,a,l,c,d,h,o),e=1,r===!0&&(e|=24),r=js(3,null,null,e),n.current=r,r.stateNode=n,e=ME(),e.refCount++,n.pooledCache=e,e.refCount++,r.memoizedState={element:s,isDehydrated:t,cache:e},PE(r),n}function eM(n){return n?(n=sd,n):sd}function tM(n,e,t,s,i,r){i=eM(i),s.context===null?s.context=i:s.pendingContext=i,s=al(e),s.payload={element:t},r=r===void 0?null:r,r!==null&&(s.callback=r),t=ol(n,s,e),t!==null&&(fs(t,n,e),Sp(t,n,e))}function xT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function aA(n,e){xT(n,e),(n=n.alternate)&&xT(n,e)}function nM(n){if(n.tag===13||n.tag===31){var e=_u(n,67108864);e!==null&&fs(e,n,67108864),aA(n,67108864)}}function wT(n){if(n.tag===13||n.tag===31){var e=Js();e=yE(e);var t=_u(n,e);t!==null&&fs(t,n,e),aA(n,e)}}var _v=!0;function $4(n,e,t,s){var i=oe.T;oe.T=null;var r=Pe.p;try{Pe.p=2,oA(n,e,t,s)}finally{Pe.p=r,oe.T=i}}function Y4(n,e,t,s){var i=oe.T;oe.T=null;var r=Pe.p;try{Pe.p=8,oA(n,e,t,s)}finally{Pe.p=r,oe.T=i}}function oA(n,e,t,s){if(_v){var i=sw(s);if(i===null)O_(n,e,s,xv,t),ST(n,s);else if(J4(i,n,e,t,s))s.stopPropagation();else if(ST(n,s),e&4&&-1<K4.indexOf(n)){for(;i!==null;){var r=yf(i);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var a=Nl(r.pendingLanes);if(a!==0){var o=r;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var l=1<<31-Ks(a);o.entanglements[1]|=l,a&=~l}Lr(r),!(De&6)&&(uv=$s()+500,s0(0))}}break;case 31:case 13:o=_u(r,2),o!==null&&fs(o,r,2),Cb(),aA(r,2)}if(r=sw(s),r===null&&O_(n,e,s,xv,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else O_(n,e,s,null,t)}}function sw(n){return n=xE(n),lA(n)}var xv=null;function lA(n){if(xv=null,n=Wu(n),n!==null){var e=Kg(n);if(e===null)n=null;else{var t=e.tag;if(t===13){if(n=w2(e),n!==null)return n;n=null}else if(t===31){if(n=S2(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null)}}return xv=n,null}function sM(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(DL()){case C2:return 2;case N2:return 8;case Xy:case PL:return 32;case R2:return 268435456;default:return 32}default:return 32}}var iw=!1,ul=null,dl=null,hl=null,$p=new Map,Yp=new Map,ro=[],K4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ST(n,e){switch(n){case"focusin":case"focusout":ul=null;break;case"dragenter":case"dragleave":dl=null;break;case"mouseover":case"mouseout":hl=null;break;case"pointerover":case"pointerout":$p.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yp.delete(e.pointerId)}}function Lf(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=yf(e),e!==null&&nM(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function J4(n,e,t,s,i){switch(e){case"focusin":return ul=Lf(ul,n,e,t,s,i),!0;case"dragenter":return dl=Lf(dl,n,e,t,s,i),!0;case"mouseover":return hl=Lf(hl,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return $p.set(r,Lf($p.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Yp.set(r,Lf(Yp.get(r)||null,n,e,t,s,i)),!0}return!1}function iM(n){var e=Wu(n.target);if(e!==null){var t=Kg(e);if(t!==null){if(e=t.tag,e===13){if(e=w2(t),e!==null){n.blockedOn=e,o1(n.priority,function(){wT(t)});return}}else if(e===31){if(e=S2(t),e!==null){n.blockedOn=e,o1(n.priority,function(){wT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function uy(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=sw(n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);wx=s,t.target.dispatchEvent(s),wx=null}else return e=yf(t),e!==null&&nM(e),n.blockedOn=t,!1;e.shift()}return!0}function ET(n,e,t){uy(n)&&t.delete(e)}function X4(){iw=!1,ul!==null&&uy(ul)&&(ul=null),dl!==null&&uy(dl)&&(dl=null),hl!==null&&uy(hl)&&(hl=null),$p.forEach(ET),Yp.forEach(ET)}function N0(n,e){n.blockedOn===e&&(n.blockedOn=null,iw||(iw=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,X4)))}var R0=null;function AT(n){R0!==n&&(R0=n,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,function(){R0===n&&(R0=null);for(var e=0;e<n.length;e+=3){var t=n[e],s=n[e+1],i=n[e+2];if(typeof s!="function"){if(lA(s||t)===null)continue;break}var r=yf(t);r!==null&&(n.splice(e,3),e-=3,Bx(r,{pending:!0,data:i,method:t.method,action:s},s,i))}}))}function uf(n){function e(l){return N0(l,n)}ul!==null&&N0(ul,n),dl!==null&&N0(dl,n),hl!==null&&N0(hl,n),$p.forEach(e),Yp.forEach(e);for(var t=0;t<ro.length;t++){var s=ro[t];s.blockedOn===n&&(s.blockedOn=null)}for(;0<ro.length&&(t=ro[0],t.blockedOn===null);)iM(t),t.blockedOn===null&&ro.shift();if(t=(n.ownerDocument||n).$$reactFormReplay,t!=null)for(s=0;s<t.length;s+=3){var i=t[s],r=t[s+1],a=i[ps]||null;if(typeof r=="function")a||AT(t);else if(a){var o=null;if(r&&r.hasAttribute("formAction")){if(i=r,a=r[ps]||null)o=a.formAction;else if(lA(i)!==null)continue}else o=a.action;typeof o=="function"?t[s+1]=o:(t.splice(s,3),s-=3),AT(t)}}}function rM(){function n(r){r.canIntercept&&r.info==="react-transition"&&r.intercept({handler:function(){return new Promise(function(a){return i=a})},focusReset:"manual",scroll:"manual"})}function e(){i!==null&&(i(),i=null),s||setTimeout(t,20)}function t(){if(!s&&!navigation.transition){var r=navigation.currentEntry;r&&r.url!=null&&navigation.navigate(r.url,{state:r.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,i=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",e),navigation.addEventListener("navigateerror",e),setTimeout(t,100),function(){s=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",e),navigation.removeEventListener("navigateerror",e),i!==null&&(i(),i=null)}}}function cA(n){this._internalRoot=n}kb.prototype.render=cA.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(B(409));var t=e.current,s=Js();tM(t,s,n,e,null,null)};kb.prototype.unmount=cA.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;tM(n.current,2,null,n,null,null),Cb(),e[gf]=null}};function kb(n){this._internalRoot=n}kb.prototype.unstable_scheduleHydration=function(n){if(n){var e=P2();n={blockedOn:null,target:n,priority:e};for(var t=0;t<ro.length&&e!==0&&e<ro[t].priority;t++);ro.splice(t,0,n),t===0&&iM(n)}};var TT=_2.version;if(TT!=="19.2.3")throw Error(B(527,TT,"19.2.3"));Pe.findDOMNode=function(n){var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(B(188)):(n=Object.keys(n).join(","),Error(B(268,n)));return n=TL(e),n=n!==null?E2(n):null,n=n===null?null:n.stateNode,n};var W4={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:oe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var k0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!k0.isDisabled&&k0.supportsFiber)try{Jg=k0.inject(W4),Ys=k0}catch{}}fb.createRoot=function(n,e){if(!x2(n))throw Error(B(299));var t=!1,s="",i=XR,r=WR,a=QR;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onUncaughtError!==void 0&&(i=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Zk(n,1,!1,null,null,t,s,null,i,r,a,rM),n[gf]=e.current,sA(n),new cA(e)};fb.hydrateRoot=function(n,e,t){if(!x2(n))throw Error(B(299));var s=!1,i="",r=XR,a=WR,o=QR,l=null;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(a=t.onCaughtError),t.onRecoverableError!==void 0&&(o=t.onRecoverableError),t.formState!==void 0&&(l=t.formState)),e=Zk(n,1,!0,e,t??null,s,i,l,r,a,o,rM),e.context=eM(null),t=e.current,s=Js(),s=yE(s),i=al(s),i.callback=null,ol(t,i,s),t=s,e.current.lanes=t,Wg(e,t),Lr(e),n[gf]=e.current,sA(n),new kb(e)};fb.version="19.2.3";function aM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aM)}catch(n){console.error(n)}}aM(),f2.exports=fb;var Q4=f2.exports;const Z4=s2(Q4),$n=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),rw=[.001,0,0,.001,0,0],F_=1.35,Us={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ao={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Kp="pdfjs_internal_editor_",pe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Ae={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},eU={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},aw={TRIANGLES:1,LATTICE:2},$t={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},dy={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ut={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Bu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Mb={ERRORS:0,WARNINGS:1,INFOS:5},Jp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Of={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},tU={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ib=Mb.WARNINGS;function nU(n){Number.isInteger(n)&&(Ib=n)}function sU(){return Ib}function Db(n){Ib>=Mb.INFOS&&console.info(`Info: ${n}`)}function ue(n){Ib>=Mb.WARNINGS&&console.warn(`Warning: ${n}`)}function Ze(n){throw new Error(n)}function Te(n,e){n||Ze(e)}function iU(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function oM(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=cU(n)}catch{}}const s=e?URL.parse(n,e):URL.parse(n);return iU(s)?s:null}function lM(n,e,t=!1){const s=URL.parse(n);return s?(s.hash=e,s.href):t&&oM(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function de(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const wu=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class CT extends wu{constructor(e,t){super(e,"PasswordException"),this.code=t}}class z_ extends wu{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class ow extends wu{constructor(e){super(e,"InvalidPDFException")}}class wv extends wu{constructor(e,t,s){super(e,"ResponseException"),this.status=t,this.missing=s}}class rU extends wu{constructor(e){super(e,"FormatError")}}class yl extends wu{constructor(e){super(e,"AbortException")}}function cM(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ze("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function a0(n){typeof n!="string"&&Ze("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function aU(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function oU(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function lU(){try{return new Function(""),!0}catch{return!1}}class en{static get isLittleEndian(){return de(this,"isLittleEndian",oU())}static get isEvalSupported(){return de(this,"isEvalSupported",lU())}static get isOffscreenCanvasSupported(){return de(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return de(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return de(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return de(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return de(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return de(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const H_=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Oa,hy,lw;class X{static makeHexColor(e,t,s){return`#${H_[e]}${H_[t]}${H_[s]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,s=0){const i=e[s],r=e[s+1];e[s]=i*t[0]+r*t[2]+t[4],e[s+1]=i*t[1]+r*t[3]+t[5]}static applyTransformToBezier(e,t,s=0){const i=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5];for(let d=0;d<6;d+=2){const h=e[s+d],p=e[s+d+1];e[s+d]=h*i+p*a+l,e[s+d+1]=h*r+p*o+c}}static applyInverseTransform(e,t){const s=e[0],i=e[1],r=t[0]*t[3]-t[1]*t[2];e[0]=(s*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/r,e[1]=(-s*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/r}static axialAlignedBoundingBox(e,t,s){const i=t[0],r=t[1],a=t[2],o=t[3],l=t[4],c=t[5],d=e[0],h=e[1],p=e[2],y=e[3];let v=i*d+l,_=v,E=i*p+l,b=E,w=o*h+c,S=w,T=o*y+c,N=T;if(r!==0||a!==0){const R=r*d,k=r*p,I=a*h,M=a*y;v+=I,b+=I,E+=M,_+=M,w+=R,N+=R,T+=k,S+=k}s[0]=Math.min(s[0],v,E,_,b),s[1]=Math.min(s[1],w,T,S,N),s[2]=Math.max(s[2],v,E,_,b),s[3]=Math.max(s[3],w,T,S,N)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const s=e[0],i=e[1],r=e[2],a=e[3],o=s**2+i**2,l=s*r+i*a,c=r**2+a**2,d=(o+c)/2,h=Math.sqrt(d**2-(o*c-l**2));t[0]=Math.sqrt(d+h||1),t[1]=Math.sqrt(d-h||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static pointBoundingBox(e,t,s){s[0]=Math.min(s[0],e),s[1]=Math.min(s[1],t),s[2]=Math.max(s[2],e),s[3]=Math.max(s[3],t)}static rectBoundingBox(e,t,s,i,r){r[0]=Math.min(r[0],e,s),r[1]=Math.min(r[1],t,i),r[2]=Math.max(r[2],e,s),r[3]=Math.max(r[3],t,i)}static bezierBoundingBox(e,t,s,i,r,a,o,l,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l),C(this,Oa,lw).call(this,e,s,r,o,t,i,a,l,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),c),C(this,Oa,lw).call(this,e,s,r,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),c)}}Oa=new WeakSet,hy=function(e,t,s,i,r,a,o,l,c,d){if(c<=0||c>=1)return;const h=1-c,p=c*c,y=p*c,v=h*(h*(h*e+3*c*t)+3*p*s)+y*i,_=h*(h*(h*r+3*c*a)+3*p*o)+y*l;d[0]=Math.min(d[0],v),d[1]=Math.min(d[1],_),d[2]=Math.max(d[2],v),d[3]=Math.max(d[3],_)},lw=function(e,t,s,i,r,a,o,l,c,d,h,p){if(Math.abs(c)<1e-12){Math.abs(d)>=1e-12&&C(this,Oa,hy).call(this,e,t,s,i,r,a,o,l,-h/d,p);return}const y=d**2-4*h*c;if(y<0)return;const v=Math.sqrt(y),_=2*c;C(this,Oa,hy).call(this,e,t,s,i,r,a,o,l,(-d+v)/_,p),C(this,Oa,hy).call(this,e,t,s,i,r,a,o,l,(-d-v)/_,p)},A(X,Oa);function cU(n){return decodeURIComponent(escape(n))}let j_=null,NT=null;function uU(n){return j_||(j_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,NT=new Map([["","t"]])),n.replaceAll(j_,(e,t,s)=>t?t.normalize("NFKC"):NT.get(s))}function uM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),cM(n)}const od="pdfjs_internal_id_";function dU(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[s,i,...r]=t;if(!n(s)&&!Number.isInteger(s)||!e(i))return!1;const a=r.length;let o=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of r)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Yn(n,e,t){return Math.min(Math.max(n,e),t)}function dM(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(cM(n))}function hU(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):a0(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class Xp{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(Xp.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const c of r.children)i(c)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class hM{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var h,p;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const y=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=y}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(i.children.length===0){if(i.value){const y=document.createTextNode(i.value);a.append(y),o&&Xp.shouldBuildText(i.name)&&c.push(y)}return{textDivs:c}}const d=[[i,-1,a]];for(;d.length>0;){const[y,v,_]=d.at(-1);if(v+1===y.children.length){d.pop();continue}const E=y.children[++d.at(-1)[1]];if(E===null)continue;const{name:b}=E;if(b==="#text"){const S=document.createTextNode(E.value);c.push(S),_.append(S);continue}const w=(h=E==null?void 0:E.attributes)!=null&&h.xmlns?document.createElementNS(E.attributes.xmlns,b):document.createElement(b);if(_.append(w),E.attributes&&this.setAttributes({html:w,element:E,storage:t,intent:r,linkService:s}),((p=E.children)==null?void 0:p.length)>0)d.push([E,-1,w]);else if(E.value){const S=document.createTextNode(E.value);o&&Xp.shouldBuildText(b)&&c.push(S),w.append(S)}}for(const y of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Hr="http://www.w3.org/2000/svg",Bl=class Bl{};z(Bl,"CSS",96),z(Bl,"PDF",72),z(Bl,"PDF_TO_CSS_UNITS",Bl.CSS/Bl.PDF);let vl=Bl;async function o0(n,e="text"){if(Jf(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class l0{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let d,h,p,y;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,p=0,y=1;break;case 90:d=0,h=1,p=1,y=0;break;case 270:d=0,h=-1,p=-1,y=0;break;case 0:d=1,h=0,p=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,y=-y);let v,_,E,b;d===0?(v=Math.abs(c-e[1])*s+r,_=Math.abs(l-e[0])*s+a,E=(e[3]-e[1])*s,b=(e[2]-e[0])*s):(v=Math.abs(l-e[0])*s+r,_=Math.abs(c-e[1])*s+a,E=(e[2]-e[0])*s,b=(e[3]-e[1])*s),this.transform=[d*s,h*s,p*s,y*s,v-d*s*l-p*s*c,_-h*s*l-y*s*c],this.width=E,this.height=b}get rawDims(){const e=this.viewBox;return de(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new l0({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){const s=[e,t];return X.applyTransform(s,this.transform),s}convertToViewportRectangle(e){const t=[e[0],e[1]];X.applyTransform(t,this.transform);const s=[e[2],e[3]];return X.applyTransform(s,this.transform),[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){const s=[e,t];return X.applyInverseTransform(s,this.transform),s}}class uA extends wu{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Pb(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function dA(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function fU(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function pU(n,e="document.pdf"){if(typeof n!="string")return e;if(Pb(n))return ue('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const s=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!s)return e;const i=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},r=/\.pdf$/i,a=s.pathname.split("/").at(-1);if(r.test(a))return i(a);if(s.searchParams.size>0){const o=Array.from(s.searchParams.values()).reverse();for(const c of o)if(r.test(c))return i(c);const l=Array.from(s.searchParams.keys()).reverse();for(const c of l)if(r.test(c))return i(c)}if(s.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(s.hash);if(l)return i(l[0])}return e}class RT{constructor(){z(this,"started",Object.create(null));z(this,"times",[])}time(e){e in this.started&&ue(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ue(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Jf(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Ci(n){n.preventDefault()}function kt(n){n.preventDefault(),n.stopPropagation()}function mU(n){console.log("Deprecated API usage: "+n)}var im;class Sv{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;u(this,im)||x(this,im,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=u(this,im).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,c==="-"?(a+=d,o+=h):c==="+"&&(a-=d,o-=h),new Date(Date.UTC(s,i,r,a,o,l))}}im=new WeakMap,A(Sv,im);function gU(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new l0({viewBox:r,userUnit:1,scale:e,rotation:t})}function c0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ue(`Not a valid color format: "${n}"`),[0,0,0])}function yU(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,c0(s))}e.remove()}function vt(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function nr(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function fu(n,e,t=!1,s=!0){if(e instanceof l0){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=en.isCSSRoundSupported,l=`var(--total-scale-factor) * ${i}px`,c=`var(--total-scale-factor) * ${r}px`,d=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,h=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=d,a.height=h):(a.width=h,a.height=d)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Ir{constructor(){const{pixelRatio:e}=Ir;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,s,i,r=-1){let a=1/0,o=1/0,l=1/0;s=Ir.capPixels(s,r),s>0&&(a=Math.sqrt(s/(e*t))),i!==-1&&(o=i/e,l=i/t);const c=Math.min(a,o,l);return this.sx>c||this.sy>c?(this.sx=c,this.sy=c,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const s=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,s):s}return e}}const cw=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class vU{static get isDarkMode(){var e;return de(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class bU{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:s}=window.getComputedStyle(e);return e.remove(),de(this,"commentForegroundColor",c0(s))}}function _U(n,e,t,s){s=Math.min(Math.max(s??1,0),1);const i=255*(1-s);return n=Math.round(n*s+i),e=Math.round(e*s+i),t=Math.round(t*s+i),[n,e,t]}function kT(n,e){const t=n[0]/255,s=n[1]/255,i=n[2]/255,r=Math.max(t,s,i),a=Math.min(t,s,i),o=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const l=r-a;switch(e[1]=o<.5?l/(r+a):l/(2-r-a),r){case t:e[0]=((s-i)/l+(s<i?6:0))*60;break;case s:e[0]=((i-t)/l+2)*60;break;case i:e[0]=((t-s)/l+4)*60;break}}e[2]=o}function uw(n,e){const t=n[0],s=n[1],i=n[2],r=(1-Math.abs(2*i-1))*s,a=r*(1-Math.abs(t/60%2-1)),o=i-r/2;switch(Math.floor(t/60)){case 0:e[0]=r+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=r+o,e[2]=o;break;case 2:e[0]=o,e[1]=r+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=r+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=r+o;break;case 5:case 6:e[0]=r+o,e[1]=o,e[2]=a+o;break}}function MT(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function IT(n,e,t){uw(n,t),t.map(MT);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];uw(e,t),t.map(MT);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return s>i?(s+.05)/(i+.05):(i+.05)/(s+.05)}const DT=new Map;function xU(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let s=DT.get(t);if(s)return s;const i=new Float32Array(9),r=i.subarray(0,3),a=i.subarray(3,6);kT(n,a);const o=i.subarray(6,9);kT(e,o);const l=o[2]<.5,c=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),IT(a,o,r)<c){let d,h;l?(d=a[2],h=1):(d=0,h=a[2]);const p=.005;for(;h-d>p;){const y=a[2]=(d+h)/2;l===IT(a,o,r)<c?d=y:h=y}a[2]=l?h:d}return uw(a,r),s=X.makeHexColor(Math.round(r[0]*255),Math.round(r[1]*255),Math.round(r[2]*255)),DT.set(t,s),s}function fM({html:n,dir:e,className:t},s){const i=document.createDocumentFragment();if(typeof n=="string"){const r=document.createElement("p");r.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const c=a[o];r.append(document.createTextNode(c)),o<l-1&&r.append(document.createElement("br"))}i.append(r)}else hM.render({xfaHtml:n,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),s.append(i)}function pM(n){const e=new Path2D;if(!n)return e;for(let t=0,s=n.length;t<s;)switch(n[t++]){case Of.moveTo:e.moveTo(n[t++],n[t++]);break;case Of.lineTo:e.lineTo(n[t++],n[t++]);break;case Of.curveTo:e.bezierCurveTo(n[t++],n[t++],n[t++],n[t++],n[t++],n[t++]);break;case Of.quadraticCurveTo:e.quadraticCurveTo(n[t++],n[t++],n[t++],n[t++]);break;case Of.closePath:e.closePath();break;default:ue(`Unrecognized drawing path operator: ${n[t-1]}`);break}return e}var lo,co,ti,ni,rm,uo,Cd,Nd,am,Yv,mM,Nn,gM,yM,Fu,Xf;const Vr=class Vr{constructor(e){A(this,Nn);A(this,lo,null);A(this,co,null);A(this,ti);A(this,ni,null);A(this,rm,null);A(this,uo,null);A(this,Cd,null);A(this,Nd,null);x(this,ti,e),u(Vr,am)||x(Vr,am,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=x(this,lo,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=u(this,ti)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Ci,{signal:t}),e.addEventListener("pointerdown",C(Vr,Yv,mM),{signal:t}));const s=x(this,ni,document.createElement("div"));s.className="buttons",e.append(s);const i=u(this,ti).toolbarPosition;if(i){const{style:r}=e,a=u(this,ti)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return u(this,lo)}hide(){var e;u(this,lo).classList.add("hidden"),(e=u(this,co))==null||e.hideDropdown()}show(){var e,t;u(this,lo).classList.remove("hidden"),(e=u(this,rm))==null||e.shown(),(t=u(this,uo))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=u(this,ti),s=document.createElement("button");s.classList.add("basic","deleteButton"),s.tabIndex=0,s.setAttribute("data-l10n-id",u(Vr,am)[e]),C(this,Nn,Fu).call(this,s)&&s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),u(this,ni).append(s)}async addAltText(e){const t=await e.render();C(this,Nn,Fu).call(this,t),u(this,ni).append(t,u(this,Nn,Xf)),x(this,rm,e)}addComment(e,t=null){if(u(this,uo))return;const s=e.renderForToolbar();if(!s)return;C(this,Nn,Fu).call(this,s);const i=x(this,Cd,u(this,Nn,Xf));t?(u(this,ni).insertBefore(s,t),u(this,ni).insertBefore(i,t)):u(this,ni).append(s,i),x(this,uo,e),e.toolbar=this}addColorPicker(e){if(u(this,co))return;x(this,co,e);const t=e.renderButton();C(this,Nn,Fu).call(this,t),u(this,ni).append(t,u(this,Nn,Xf))}async addEditSignatureButton(e){const t=x(this,Nd,await e.renderEditButton(u(this,ti)));C(this,Nn,Fu).call(this,t),u(this,ni).append(t,u(this,Nn,Xf))}removeButton(e){var t,s;switch(e){case"comment":(t=u(this,uo))==null||t.removeToolbarCommentButton(),x(this,uo,null),(s=u(this,Cd))==null||s.remove(),x(this,Cd,null);break}}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,s){if(!t&&e==="comment")return;const i=u(this,ni).querySelector(s);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){u(this,Nd)&&(u(this,Nd).title=e)}remove(){var e;u(this,lo).remove(),(e=u(this,co))==null||e.destroy(),x(this,co,null)}};lo=new WeakMap,co=new WeakMap,ti=new WeakMap,ni=new WeakMap,rm=new WeakMap,uo=new WeakMap,Cd=new WeakMap,Nd=new WeakMap,am=new WeakMap,Yv=new WeakSet,mM=function(e){e.stopPropagation()},Nn=new WeakSet,gM=function(e){u(this,ti)._focusEventsAllowed=!1,kt(e)},yM=function(e){u(this,ti)._focusEventsAllowed=!0,kt(e)},Fu=function(e){const t=u(this,ti)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",C(this,Nn,gM).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",C(this,Nn,yM).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ci,{signal:t}),!0)},Xf=function(){const e=document.createElement("div");return e.className="divider",e},A(Vr,Yv),A(Vr,am,null);let dw=Vr;var om,jl,Kr,Va,vM,bM,hw;class wU{constructor(e){A(this,Va);A(this,om,null);A(this,jl,null);A(this,Kr);x(this,Kr,e)}show(e,t,s){const[i,r]=C(this,Va,bM).call(this,t,s),{style:a}=u(this,jl)||x(this,jl,C(this,Va,vM).call(this));e.append(u(this,jl)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){u(this,jl).remove()}}om=new WeakMap,jl=new WeakMap,Kr=new WeakMap,Va=new WeakSet,vM=function(){const e=x(this,jl,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=u(this,Kr)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Ci,{signal:t});const s=x(this,om,document.createElement("div"));return s.className="buttons",e.append(s),u(this,Kr).hasCommentManager()&&C(this,Va,hw).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{u(this,Kr).commentSelection("floating_button")}),C(this,Va,hw).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{u(this,Kr).highlightSelection("floating_button")}),e},bM=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},hw=function(e,t,s,i){const r=document.createElement("button");r.classList.add("basic",e),r.tabIndex=0,r.setAttribute("data-l10n-id",t);const a=document.createElement("span");r.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",s);const o=u(this,Kr)._signal;o instanceof AbortSignal&&!o.aborted&&(r.addEventListener("contextmenu",Ci,{signal:o}),r.addEventListener("click",i,{signal:o})),u(this,om).append(r)};function _M(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Gl,ql,Rd,Vl;const He=class He{static initializeAndAddPointerId(e){(u(He,ql)||x(He,ql,new Set)).add(e)}static setPointer(e,t){u(He,Gl)||x(He,Gl,t),u(He,Vl)??x(He,Vl,e)}static setTimeStamp(e){x(He,Rd,e)}static isSamePointerId(e){return u(He,Gl)===e}static isSamePointerIdOrRemove(e){var t;return u(He,Gl)===e?!0:((t=u(He,ql))==null||t.delete(e),!1)}static isSamePointerType(e){return u(He,Vl)===e}static isInitializedAndDifferentPointerType(e){return u(He,Vl)!==null&&!He.isSamePointerType(e)}static isSameTimeStamp(e){return u(He,Rd)===e}static isUsingMultiplePointers(){var e;return((e=u(He,ql))==null?void 0:e.size)>=1}static clearPointerType(){x(He,Vl,null)}static clearPointerIds(){x(He,Gl,NaN),x(He,ql,null)}static clearTimeStamp(){x(He,Rd,NaN)}};Gl=new WeakMap,ql=new WeakMap,Rd=new WeakMap,Vl=new WeakMap,A(He,Gl,NaN),A(He,ql,null),A(He,Rd,NaN),A(He,Vl,null);let In=He;var Kv;class SU{constructor(){A(this,Kv,0)}get id(){return`${Kp}${Vt(this,Kv)._++}`}}Kv=new WeakMap;var kd,lm,Dn,Md,fy;const GA=class GA{constructor(){A(this,Md);A(this,kd,uM());A(this,lm,0);A(this,Dn,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return de(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return C(this,Md,fy).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return C(this,Md,fy).call(this,e,e)}async getFromBlob(e,t){const s=await t;return C(this,Md,fy).call(this,e,s)}async getFromId(e){u(this,Dn)||x(this,Dn,new Map);const t=u(this,Dn).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){u(this,Dn)||x(this,Dn,new Map);let s=u(this,Dn).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${u(this,kd)}_${Vt(this,lm)._++}`,refCounter:1,isSvg:!1},u(this,Dn).set(e,s),u(this,Dn).set(s.id,s),s}getSvgUrl(e){const t=u(this,Dn).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;u(this,Dn)||x(this,Dn,new Map);const t=u(this,Dn).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${u(this,kd)}_`)}};kd=new WeakMap,lm=new WeakMap,Dn=new WeakMap,Md=new WeakSet,fy=async function(e,t){u(this,Dn)||x(this,Dn,new Map);let s=u(this,Dn).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${u(this,kd)}_${Vt(this,lm)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await o0(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=GA._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,d)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,c()},a.onload=async()=>{const h=s.svgUrl=a.result;o.src=await r?`${h}#svgView(preserveAspectRatio(none))`:h},o.onerror=a.onerror=d});a.readAsDataURL(i),await l}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ue(i),s=null}return u(this,Dn).set(e,s),s&&u(this,Dn).set(s.id,s),s};let fw=GA;var It,ho,cm,yt;class EU{constructor(e=128){A(this,It,[]);A(this,ho,!1);A(this,cm);A(this,yt,-1);x(this,cm,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),u(this,ho))return;const l={cmd:e,undo:t,post:s,type:r};if(u(this,yt)===-1){u(this,It).length>0&&(u(this,It).length=0),x(this,yt,0),u(this,It).push(l);return}if(a&&u(this,It)[u(this,yt)].type===r){o&&(l.undo=u(this,It)[u(this,yt)].undo),u(this,It)[u(this,yt)]=l;return}const c=u(this,yt)+1;c===u(this,cm)?u(this,It).splice(0,1):(x(this,yt,c),c<u(this,It).length&&u(this,It).splice(c)),u(this,It).push(l)}undo(){if(u(this,yt)===-1)return;x(this,ho,!0);const{undo:e,post:t}=u(this,It)[u(this,yt)];e(),t==null||t(),x(this,ho,!1),x(this,yt,u(this,yt)-1)}redo(){if(u(this,yt)<u(this,It).length-1){x(this,yt,u(this,yt)+1),x(this,ho,!0);const{cmd:e,post:t}=u(this,It)[u(this,yt)];e(),t==null||t(),x(this,ho,!1)}}hasSomethingToUndo(){return u(this,yt)!==-1}hasSomethingToRedo(){return u(this,yt)<u(this,It).length-1}cleanType(e){if(u(this,yt)!==-1){for(let t=u(this,yt);t>=0;t--)if(u(this,It)[t].type!==e){u(this,It).splice(t+1,u(this,yt)-t),x(this,yt,t);return}u(this,It).length=0,x(this,yt,-1)}}destroy(){x(this,It,null)}}It=new WeakMap,ho=new WeakMap,cm=new WeakMap,yt=new WeakMap;var Jv,xM;class u0{constructor(e){A(this,Jv);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=en.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(C(this,Jv,xM).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||kt(t))}}Jv=new WeakSet,xM=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Xv=class Xv{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return yU(e),de(this,"_colors",e)}convert(e){const t=c0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Xv._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?X.makeHexColor(...t):e}};z(Xv,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let pw=Xv;var Id,vs,Dd,At,Jt,Pd,si,Ld,ii,Pn,fo,po,Od,mo,rr,ri,$l,um,dm,Ud,hm,ar,go,Bd,yo,or,Wv,vo,Fd,fm,bo,Yl,zd,_o,pm,Bt,Ue,Jr,xo,wo,mm,Hd,gm,So,lr,Xr,ym,vm,ai,V,py,mw,wM,SM,Wf,EM,AM,TM,gw,CM,NM,RM,kM,Fn,jr,MM,IM,yw,DM,Qf,vw;const hd=class hd{constructor(e,t,s,i,r,a,o,l,c,d,h,p,y,v,_,E){A(this,V);A(this,Id,new AbortController);A(this,vs,null);A(this,Dd,null);A(this,At,new Map);A(this,Jt,new Map);A(this,Pd,null);A(this,si,null);A(this,Ld,null);A(this,ii,new EU);A(this,Pn,null);A(this,fo,null);A(this,po,null);A(this,Od,0);A(this,mo,new Set);A(this,rr,null);A(this,ri,null);A(this,$l,new Set);z(this,"_editorUndoBar",null);A(this,um,!1);A(this,dm,!1);A(this,Ud,!1);A(this,hm,null);A(this,ar,null);A(this,go,null);A(this,Bd,null);A(this,yo,!1);A(this,or,null);A(this,Wv,new SU);A(this,vo,!1);A(this,Fd,!1);A(this,fm,!1);A(this,bo,null);A(this,Yl,null);A(this,zd,null);A(this,_o,null);A(this,pm,null);A(this,Bt,pe.NONE);A(this,Ue,new Set);A(this,Jr,null);A(this,xo,null);A(this,wo,null);A(this,mm,null);A(this,Hd,null);A(this,gm,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,So,[0,0]);A(this,lr,null);A(this,Xr,null);A(this,ym,null);A(this,vm,null);A(this,ai,null);const b=this._signal=u(this,Id).signal;x(this,Xr,e),x(this,ym,t),x(this,vm,s),x(this,Pd,i),x(this,Pn,r),x(this,xo,a),x(this,Hd,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:b}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),o._on("setpreference",this.onSetPreference.bind(this),{signal:b}),o._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:b}),window.addEventListener("pointerdown",()=>{x(this,Fd,!0)},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{x(this,Fd,!1)},{capture:!0,signal:b}),C(this,V,EM).call(this),C(this,V,kM).call(this),C(this,V,gw).call(this),x(this,si,l.annotationStorage),x(this,hm,l.filterFactory),x(this,wo,c),x(this,Bd,d||null),x(this,um,h),x(this,dm,p),x(this,Ud,y),x(this,pm,v||null),this.viewParameters={realScale:vl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=E!==!1,r==null||r.setSidebarUiManager(this)}static get _keyboardManager(){const e=hd.prototype,t=a=>u(a,Xr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return de(this,"_keyboardManager",new u0([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Xr).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&u(a,Xr).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r,a,o,l,c;(e=u(this,ai))==null||e.resolve(),x(this,ai,null),(t=u(this,Id))==null||t.abort(),x(this,Id,null),this._signal=null;for(const d of u(this,Jt).values())d.destroy();u(this,Jt).clear(),u(this,At).clear(),u(this,$l).clear(),(s=u(this,_o))==null||s.clear(),x(this,vs,null),u(this,Ue).clear(),u(this,ii).destroy(),(i=u(this,Pd))==null||i.destroy(),(r=u(this,Pn))==null||r.destroy(),(a=u(this,xo))==null||a.destroy(),(o=u(this,or))==null||o.hide(),x(this,or,null),(l=u(this,zd))==null||l.destroy(),x(this,zd,null),x(this,Dd,null),u(this,ar)&&(clearTimeout(u(this,ar)),x(this,ar,null)),u(this,lr)&&(clearTimeout(u(this,lr)),x(this,lr,null)),(c=this._editorUndoBar)==null||c.destroy(),x(this,Hd,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return u(this,pm)}get useNewAltTextFlow(){return u(this,dm)}get useNewAltTextWhenAddingImage(){return u(this,Ud)}get hcmFilter(){return de(this,"hcmFilter",u(this,wo)?u(this,hm).addHCMFilter(u(this,wo).foreground,u(this,wo).background):"none")}get direction(){return de(this,"direction",getComputedStyle(u(this,Xr)).direction)}get _highlightColors(){return de(this,"_highlightColors",u(this,Bd)?new Map(u(this,Bd).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return de(this,"highlightColors",null);const t=new Map,s=!!u(this,wo);for(const[i,r]of e){const a=i.endsWith("_HCM");if(s&&a){t.set(i.replace("_HCM",""),r);continue}!s&&!a&&t.set(i,r)}return de(this,"highlightColors",t)}get highlightColorNames(){return de(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),x(this,po,e)}setMainHighlightColorPicker(e){x(this,zd,e)}editAltText(e,t=!1){var s;(s=u(this,Pd))==null||s.editAltText(this,e,t)}hasCommentManager(){return!!u(this,Pn)}editComment(e,t,s,i){var r;(r=u(this,Pn))==null||r.showDialog(this,e,t,s,i)}selectComment(e,t){const s=u(this,Jt).get(e),i=s==null?void 0:s.getEditorByUID(t);i==null||i.toggleComment(!0,!0)}updateComment(e){var t;(t=u(this,Pn))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=u(this,Pn))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=u(this,Pn))==null||t.removeComments([e.uid])}toggleComment(e,t,s=void 0){var i;(i=u(this,Pn))==null||i.toggleCommentPopup(e,t,s)}makeCommentColor(e,t){var s;return e&&((s=u(this,Pn))==null?void 0:s.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=u(this,Pn))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(u(this,Jt).has(e-1))return;const{resolve:t,promise:s}=Promise.withResolvers(),i=r=>{r.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await s}getSignature(e){var t;(t=u(this,xo))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return u(this,xo)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":x(this,Ud,t);break}}onPageChanging({pageNumber:e}){x(this,Od,e-1)}focusMainContainer(){u(this,Xr).focus()}findParent(e,t){for(const s of u(this,Jt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){u(this,ym).classList.toggle("noUserSelect",e)}addShouldRescale(e){u(this,$l).add(e)}removeShouldRescale(e){u(this,$l).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*vl.PDF_TO_CSS_UNITS;for(const s of u(this,$l))s.onScaleChanging();(t=u(this,po))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:o}=s,l=s.toString(),d=C(this,V,py).call(this,s).closest(".textLayer"),h=this.getSelectionBoxes(d);if(!h)return;s.empty();const p=C(this,V,mw).call(this,d),y=u(this,Bt)===pe.NONE,v=()=>{const _=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:o,text:l});y&&this.showAllEditors("highlight",!0,!0),t&&(_==null||_.editComment())};if(y){this.switchToMode(pe.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!u(this,si))return null;const t=`${Kp}${e}`,s=u(this,si).getRawValue(t);return s&&u(this,si).remove(t),s}addToAnnotationStorage(e){!e.isEmpty()&&u(this,si)&&!u(this,si).has(e.id)&&u(this,si).setValue(e.id,e)}a11yAlert(e,t=null){const s=u(this,vm);s&&(s.setAttribute("data-l10n-id",e),t?s.setAttribute("data-l10n-args",JSON.stringify(t)):s.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,u(this,yo)&&(x(this,yo,!1),C(this,V,Wf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of u(this,Ue))if(t.div.contains(e)){x(this,Yl,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!u(this,Yl))return;const[e,t]=u(this,Yl);x(this,Yl,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){C(this,V,gw).call(this),this.setEditingState(!0)}removeEditListeners(){C(this,V,CM).call(this),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of u(this,ri))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of u(this,ri))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=u(this,vs))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of u(this,Ue)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of u(this,ri))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ue(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const l of s){const c=await i.deserialize(l);if(!c)return;r.push(c)}const a=()=>{for(const l of r)C(this,V,yw).call(this,l);C(this,V,vw).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ue(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),u(this,Bt)!==pe.NONE&&!this.isEditorHandlingKeyboard&&hd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,u(this,yo)&&(x(this,yo,!1),C(this,V,Wf).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(C(this,V,AM).call(this),C(this,V,NM).call(this),C(this,V,Fn).call(this,{isEditing:u(this,Bt)!==pe.NONE,isEmpty:C(this,V,Qf).call(this),hasSomethingToUndo:u(this,ii).hasSomethingToUndo(),hasSomethingToRedo:u(this,ii).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,V,TM).call(this),C(this,V,RM).call(this),C(this,V,Fn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!u(this,ri)){x(this,ri,e);for(const t of u(this,ri))C(this,V,jr).call(this,t.defaultPropertiesToUpdate)}}getId(){return u(this,Wv).id}get currentLayer(){return u(this,Jt).get(u(this,Od))}getLayer(e){return u(this,Jt).get(e)}get currentPageIndex(){return u(this,Od)}addLayer(e){u(this,Jt).set(e.pageIndex,e),u(this,vo)?e.enable():e.disable()}removeLayer(e){u(this,Jt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1,i=!1,r=!1,a=!1){var o,l,c,d,h,p;if(u(this,Bt)!==e&&!(u(this,ai)&&(await u(this,ai).promise,!u(this,ai)))){if(x(this,ai,Promise.withResolvers()),(o=u(this,po))==null||o.commitOrRemove(),u(this,Bt)===pe.POPUP&&((l=u(this,Pn))==null||l.hideSidebar()),(c=u(this,Pn))==null||c.destroyPopup(),x(this,Bt,e),e===pe.NONE){this.setEditingState(!1),C(this,V,IM).call(this);for(const y of u(this,At).values())y.hideStandaloneCommentButton();(d=this._editorUndoBar)==null||d.hide(),this.toggleComment(null),u(this,ai).resolve();return}for(const y of u(this,At).values())y.addStandaloneCommentButton();e===pe.SIGNATURE&&await((h=u(this,xo))==null?void 0:h.loadSignatures()),s&&In.clearPointerType(),this.setEditingState(!0),await C(this,V,MM).call(this),this.unselectAll();for(const y of u(this,Jt).values())y.updateMode(e);if(e===pe.POPUP){u(this,Dd)||x(this,Dd,await u(this,Hd).getAnnotationsByType(new Set(u(this,ri).map(_=>_._editorType))));const y=new Set,v=[];for(const _ of u(this,At).values()){const{annotationElementId:E,hasComment:b,deleted:w}=_;E&&y.add(E),b&&!w&&v.push(_.getData())}for(const _ of u(this,Dd)){const{id:E,popupRef:b,contentsObj:w}=_;b&&(w!=null&&w.str)&&!y.has(E)&&!u(this,mo).has(E)&&v.push(_)}(p=u(this,Pn))==null||p.showSidebar(v)}if(!t){i&&this.addNewEditorFromKeyboard(),u(this,ai).resolve();return}for(const y of u(this,At).values())y.uid===t?(this.setSelected(y),a?y.editComment():r?y.enterInEditMode():y.focus()):y.unselect();u(this,ai).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==u(this,Bt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(u(this,ri)){switch(e){case Ae.CREATE:this.currentLayer.addNewEditor(t);return;case Ae.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(u(this,mm)||x(this,mm,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const s of u(this,Ue))s.updateParams(e,t);else for(const s of u(this,ri))s.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of u(this,At).values())a.editorType===e&&a.show(t);(((r=u(this,mm))==null?void 0:r.get(Ae.HIGHLIGHT_SHOW_ALL))??!0)!==t&&C(this,V,jr).call(this,[[Ae.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(u(this,fm)!==e){x(this,fm,e);for(const t of u(this,Jt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of u(this,At).values())t.pageIndex===e&&(yield t)}getEditor(e){return u(this,At).get(e)}addEditor(e){u(this,At).set(e.id,e)}removeEditor(e){var t,s;e.div.contains(document.activeElement)&&(u(this,ar)&&clearTimeout(u(this,ar)),x(this,ar,setTimeout(()=>{this.focusMainContainer(),x(this,ar,null)},0))),u(this,At).delete(e.id),e.annotationElementId&&((t=u(this,_o))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!u(this,mo).has(e.annotationElementId))&&((s=u(this,si))==null||s.remove(e.id))}addDeletedAnnotationElement(e){u(this,mo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return u(this,mo).has(e)}removeDeletedAnnotationElement(e){u(this,mo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){u(this,vs)!==e&&(x(this,vs,e),e&&C(this,V,jr).call(this,e.propertiesToUpdate))}updateUI(e){u(this,V,DM)===e&&C(this,V,jr).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){C(this,V,jr).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(u(this,Ue).has(e)){u(this,Ue).delete(e),e.unselect(),C(this,V,Fn).call(this,{hasSelectedEditor:this.hasSelection});return}u(this,Ue).add(e),e.select(),C(this,V,jr).call(this,e.propertiesToUpdate),C(this,V,Fn).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.uid}),(t=u(this,po))==null||t.commitOrRemove();for(const s of u(this,Ue))s!==e&&s.unselect();u(this,Ue).clear(),u(this,Ue).add(e),e.select(),C(this,V,jr).call(this,e.propertiesToUpdate),C(this,V,Fn).call(this,{hasSelectedEditor:!0})}isSelected(e){return u(this,Ue).has(e)}get firstSelectedEditor(){return u(this,Ue).values().next().value}unselect(e){e.unselect(),u(this,Ue).delete(e),C(this,V,Fn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return u(this,Ue).size!==0}get isEnterHandled(){return u(this,Ue).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;u(this,ii).undo(),C(this,V,Fn).call(this,{hasSomethingToUndo:u(this,ii).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,V,Qf).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){u(this,ii).redo(),C(this,V,Fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:u(this,ii).hasSomethingToRedo(),isEmpty:C(this,V,Qf).call(this)})}addCommands(e){u(this,ii).add(e),C(this,V,Fn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,V,Qf).call(this)})}cleanUndoStack(e){u(this,ii).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...u(this,Ue)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)C(this,V,yw).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=u(this,vs))==null||e.commitOrRemove()}hasSomethingToControl(){return u(this,vs)||this.hasSelection}selectAll(){for(const e of u(this,Ue))e.commit();C(this,V,vw).call(this,u(this,At).values())}unselectAll(){var e;if(!(u(this,vs)&&(u(this,vs).commitOrRemove(),u(this,Bt)!==pe.NONE))&&!((e=u(this,po))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear(),C(this,V,Fn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;u(this,So)[0]+=e,u(this,So)[1]+=t;const[i,r]=u(this,So),a=[...u(this,Ue)],o=1e3;u(this,lr)&&clearTimeout(u(this,lr)),x(this,lr,setTimeout(()=>{x(this,lr,null),u(this,So)[0]=u(this,So)[1]=0,this.addCommands({cmd:()=>{for(const l of a)u(this,At).has(l.id)&&(l.translateInPage(i,r),l.translationDone())},undo:()=>{for(const l of a)u(this,At).has(l.id)&&(l.translateInPage(-i,-r),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),x(this,rr,new Map);for(const e of u(this,Ue))u(this,rr).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!u(this,rr))return!1;this.disableUserSelect(!1);const e=u(this,rr);x(this,rr,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(u(this,At).has(i.id)){const l=u(this,Jt).get(o);l?i._setParentAndPosition(l,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(u(this,rr))for(const s of u(this,rr).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||u(this,Ue).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return u(this,vs)===e}getActive(){return u(this,vs)}getMode(){return u(this,Bt)}isEditingMode(){return u(this,Bt)!==pe.NONE}get imageManager(){return de(this,"imageManager",new fw)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,d=t.rangeCount;c<d;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,d,h,p)=>({x:(d-i)/a,y:1-(c+h-s)/r,width:p/a,height:h/r});break;case"180":o=(c,d,h,p)=>({x:1-(c+h-s)/r,y:1-(d+p-i)/a,width:h/r,height:p/a});break;case"270":o=(c,d,h,p)=>({x:1-(d+p-i)/a,y:(c-s)/r,width:p/a,height:h/r});break;default:o=(c,d,h,p)=>({x:(c-s)/r,y:(d-i)/a,width:h/r,height:p/a});break}const l=[];for(let c=0,d=t.rangeCount;c<d;c++){const h=t.getRangeAt(c);if(!h.collapsed)for(const{x:p,y,width:v,height:_}of h.getClientRects())v===0||_===0||l.push(o(p,y,v,_))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(u(this,Ld)||x(this,Ld,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=u(this,Ld))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=u(this,Ld))==null?void 0:i.get(e.data.id);if(!t)return;const s=u(this,si).getRawValue(t);s&&(u(this,Bt)===pe.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}setMissingCanvas(e,t,s){var r;const i=(r=u(this,_o))==null?void 0:r.get(e);i&&(i.setCanvas(t,s),u(this,_o).delete(e))}addMissingCanvas(e,t){(u(this,_o)||x(this,_o,new Map)).set(e,t)}};Id=new WeakMap,vs=new WeakMap,Dd=new WeakMap,At=new WeakMap,Jt=new WeakMap,Pd=new WeakMap,si=new WeakMap,Ld=new WeakMap,ii=new WeakMap,Pn=new WeakMap,fo=new WeakMap,po=new WeakMap,Od=new WeakMap,mo=new WeakMap,rr=new WeakMap,ri=new WeakMap,$l=new WeakMap,um=new WeakMap,dm=new WeakMap,Ud=new WeakMap,hm=new WeakMap,ar=new WeakMap,go=new WeakMap,Bd=new WeakMap,yo=new WeakMap,or=new WeakMap,Wv=new WeakMap,vo=new WeakMap,Fd=new WeakMap,fm=new WeakMap,bo=new WeakMap,Yl=new WeakMap,zd=new WeakMap,_o=new WeakMap,pm=new WeakMap,Bt=new WeakMap,Ue=new WeakMap,Jr=new WeakMap,xo=new WeakMap,wo=new WeakMap,mm=new WeakMap,Hd=new WeakMap,gm=new WeakMap,So=new WeakMap,lr=new WeakMap,Xr=new WeakMap,ym=new WeakMap,vm=new WeakMap,ai=new WeakMap,V=new WeakSet,py=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},mw=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of u(this,Jt).values())if(s.hasTextLayer(e))return s;return null},wM=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=C(this,V,py).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(u(this,or)||x(this,or,new wU(this)),u(this,or).show(s,i,this.direction==="ltr"))},SM=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){u(this,Jr)&&((r=u(this,or))==null||r.hide(),x(this,Jr,null),C(this,V,Fn).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===u(this,Jr))return;const i=C(this,V,py).call(this,e).closest(".textLayer");if(!i){u(this,Jr)&&((a=u(this,or))==null||a.hide(),x(this,Jr,null),C(this,V,Fn).call(this,{hasSelectedText:!1}));return}if((o=u(this,or))==null||o.hide(),x(this,Jr,t),C(this,V,Fn).call(this,{hasSelectedText:!0}),!(u(this,Bt)!==pe.HIGHLIGHT&&u(this,Bt)!==pe.NONE)&&(u(this,Bt)===pe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),x(this,yo,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=u(this,Bt)===pe.HIGHLIGHT?C(this,V,mw).call(this,i):null;if(l==null||l.toggleDrawing(),u(this,Fd)){const c=new AbortController,d=this.combinedSignal(c),h=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&C(this,V,Wf).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:d}),window.addEventListener("blur",h,{signal:d})}else l==null||l.toggleDrawing(!0),C(this,V,Wf).call(this,"main_toolbar")}},Wf=function(e=""){u(this,Bt)===pe.HIGHLIGHT?this.highlightSelection(e):u(this,um)&&C(this,V,wM).call(this)},EM=function(){document.addEventListener("selectionchange",C(this,V,SM).bind(this),{signal:this._signal})},AM=function(){if(u(this,go))return;x(this,go,new AbortController);const e=this.combinedSignal(u(this,go));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},TM=function(){var e;(e=u(this,go))==null||e.abort(),x(this,go,null)},gw=function(){if(u(this,bo))return;x(this,bo,new AbortController);const e=this.combinedSignal(u(this,bo));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},CM=function(){var e;(e=u(this,bo))==null||e.abort(),x(this,bo,null)},NM=function(){if(u(this,fo))return;x(this,fo,new AbortController);const e=this.combinedSignal(u(this,fo));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},RM=function(){var e;(e=u(this,fo))==null||e.abort(),x(this,fo,null)},kM=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Fn=function(e){Object.entries(e).some(([s,i])=>u(this,gm)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(u(this,gm),e)}),u(this,Bt)===pe.HIGHLIGHT&&e.hasSelectedEditor===!1&&C(this,V,jr).call(this,[[Ae.HIGHLIGHT_FREE,!0]]))},jr=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},MM=async function(){if(!u(this,vo)){x(this,vo,!0);const e=[];for(const t of u(this,Jt).values())e.push(t.enable());await Promise.all(e);for(const t of u(this,At).values())t.enable()}},IM=function(){if(this.unselectAll(),u(this,vo)){x(this,vo,!1);for(const e of u(this,Jt).values())e.disable();for(const e of u(this,At).values())e.disable()}},yw=function(e){const t=u(this,Jt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},DM=function(){let e=null;for(e of u(this,Ue));return e},Qf=function(){if(u(this,At).size===0)return!0;if(u(this,At).size===1)for(const e of u(this,At).values())return e.isEmpty();return!1},vw=function(e){for(const t of u(this,Ue))t.unselect();u(this,Ue).clear();for(const t of e)t.isEmpty()||(u(this,Ue).add(t),t.select());C(this,V,Fn).call(this,{hasSelectedEditor:this.hasSelection})},z(hd,"TRANSLATE_SMALL",1),z(hd,"TRANSLATE_BIG",10);let pu=hd;var nn,cr,Pi,jd,ur,bs,Gd,dr,ss,Wr,Kl,hr,Eo,Ki,Zf,my;const zn=class zn{constructor(e){A(this,Ki);A(this,nn,null);A(this,cr,!1);A(this,Pi,null);A(this,jd,null);A(this,ur,null);A(this,bs,null);A(this,Gd,!1);A(this,dr,null);A(this,ss,null);A(this,Wr,null);A(this,Kl,null);A(this,hr,!1);x(this,ss,e),x(this,hr,e._uiManager.useNewAltTextFlow),u(zn,Eo)||x(zn,Eo,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){zn._l10n??(zn._l10n=e)}async render(){const e=x(this,Pi,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=x(this,jd,document.createElement("span"));e.append(t),u(this,hr)?(e.classList.add("new"),e.setAttribute("data-l10n-id",u(zn,Eo).missing),t.setAttribute("data-l10n-id",u(zn,Eo)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=u(this,ss)._uiManager._signal;e.addEventListener("contextmenu",Ci,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),u(this,ss)._uiManager.editAltText(u(this,ss)),u(this,hr)&&u(this,ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:u(this,Ki,Zf)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(x(this,Gd,!0),i(r))},{signal:s}),await C(this,Ki,my).call(this),e}finish(){u(this,Pi)&&(u(this,Pi).focus({focusVisible:u(this,Gd)}),x(this,Gd,!1))}isEmpty(){return u(this,hr)?u(this,nn)===null:!u(this,nn)&&!u(this,cr)}hasData(){return u(this,hr)?u(this,nn)!==null||!!u(this,Wr):this.isEmpty()}get guessedText(){return u(this,Wr)}async setGuessedText(e){u(this,nn)===null&&(x(this,Wr,e),x(this,Kl,await zn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),C(this,Ki,my).call(this))}toggleAltTextBadge(e=!1){var t;if(!u(this,hr)||u(this,nn)){(t=u(this,dr))==null||t.remove(),x(this,dr,null);return}if(!u(this,dr)){const s=x(this,dr,document.createElement("div"));s.className="noAltTextBadge",u(this,ss).div.append(s)}u(this,dr).classList.toggle("hidden",!e)}serialize(e){let t=u(this,nn);return!e&&u(this,Wr)===t&&(t=u(this,Kl)),{altText:t,decorative:u(this,cr),guessedText:u(this,Wr),textWithDisclaimer:u(this,Kl)}}get data(){return{altText:u(this,nn),decorative:u(this,cr)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(x(this,Wr,s),x(this,Kl,i)),!(u(this,nn)===e&&u(this,cr)===t)&&(r||(x(this,nn,e),x(this,cr,t)),C(this,Ki,my).call(this))}toggle(e=!1){u(this,Pi)&&(!e&&u(this,bs)&&(clearTimeout(u(this,bs)),x(this,bs,null)),u(this,Pi).disabled=!e)}shown(){u(this,ss)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:u(this,Ki,Zf)}})}destroy(){var e,t;(e=u(this,Pi))==null||e.remove(),x(this,Pi,null),x(this,jd,null),x(this,ur,null),(t=u(this,dr))==null||t.remove(),x(this,dr,null)}};nn=new WeakMap,cr=new WeakMap,Pi=new WeakMap,jd=new WeakMap,ur=new WeakMap,bs=new WeakMap,Gd=new WeakMap,dr=new WeakMap,ss=new WeakMap,Wr=new WeakMap,Kl=new WeakMap,hr=new WeakMap,Eo=new WeakMap,Ki=new WeakSet,Zf=function(){return u(this,nn)&&"added"||u(this,nn)===null&&this.guessedText&&"review"||"missing"},my=async function(){var i,r,a;const e=u(this,Pi);if(!e)return;if(u(this,hr)){if(e.classList.toggle("done",!!u(this,nn)),e.setAttribute("data-l10n-id",u(zn,Eo)[u(this,Ki,Zf)]),(i=u(this,jd))==null||i.setAttribute("data-l10n-id",u(zn,Eo)[`${u(this,Ki,Zf)}-label`]),!u(this,nn)){(r=u(this,ur))==null||r.remove();return}}else{if(!u(this,nn)&&!u(this,cr)){e.classList.remove("done"),(a=u(this,ur))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=u(this,ur);if(!t){x(this,ur,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${u(this,ss).id}`;const o=100,l=u(this,ss)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(u(this,bs)),x(this,bs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{x(this,bs,setTimeout(()=>{x(this,bs,null),u(this,ur).classList.add("show"),u(this,ss)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;u(this,bs)&&(clearTimeout(u(this,bs)),x(this,bs,null)),(c=u(this,ur))==null||c.classList.remove("show")},{signal:l})}u(this,cr)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=u(this,nn)),t.parentNode||e.append(t);const s=u(this,ss).getElementForAltText();s==null||s.setAttribute("aria-describedby",t.id)},A(zn,Eo,null),z(zn,"_l10n",null);let Ev=zn;var yn,oi,Jl,it,bm,Xl,Li,Wl,Ql,Zl,_m,bw;class M0{constructor(e){A(this,_m);A(this,yn,null);A(this,oi,null);A(this,Jl,!1);A(this,it,null);A(this,bm,null);A(this,Xl,null);A(this,Li,null);A(this,Wl,null);A(this,Ql,!1);A(this,Zl,null);x(this,it,e)}renderForToolbar(){const e=x(this,oi,document.createElement("button"));return e.className="comment",C(this,_m,bw).call(this,e,!1)}renderForStandalone(){const e=x(this,yn,document.createElement("button"));e.className="annotationCommentButton";const t=u(this,it).commentButtonPosition;if(t){const{style:s}=e;s.insetInlineEnd=`calc(${100*(u(this,it)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,s.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=u(this,it).commentButtonColor;i&&(s.backgroundColor=i)}return C(this,_m,bw).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=u(this,yn)??u(this,oi))==null||e.focus()},0)}onUpdatedColor(){if(!u(this,yn))return;const e=u(this,it).commentButtonColor;e&&(u(this,yn).style.backgroundColor=e),u(this,it)._uiManager.updatePopupColor(u(this,it))}get commentButtonWidth(){var e;return(((e=u(this,yn))==null?void 0:e.getBoundingClientRect().width)??0)/u(this,it).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(u(this,Zl))return u(this,Zl);if(!u(this,yn))return null;const{x:e,y:t,height:s}=u(this,yn).getBoundingClientRect(),{x:i,y:r,width:a,height:o}=u(this,it).parent.boundingClientRect;return[(e-i)/a,(t+s-r)/o]}set commentPopupPositionInLayer(e){x(this,Zl,e)}hasDefaultPopupPosition(){return u(this,Zl)===null}removeStandaloneCommentButton(){var e;(e=u(this,yn))==null||e.remove(),x(this,yn,null)}removeToolbarCommentButton(){var e;(e=u(this,oi))==null||e.remove(),x(this,oi,null)}setCommentButtonStates({selected:e,hasPopup:t}){u(this,yn)&&(u(this,yn).classList.toggle("selected",e),u(this,yn).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let s,i;if(t)[s,i]=t;else{[s,i]=u(this,it).commentButtonPosition;const{width:d,height:h,x:p,y}=u(this,it);s=p+s*d,i=y+i*h}const r=u(this,it).parent.boundingClientRect,{x:a,y:o,width:l,height:c}=r;u(this,it)._uiManager.editComment(u(this,it),a+s*l,o+i*c,{...e,parentDimensions:r})}finish(){u(this,oi)&&(u(this,oi).focus({focusVisible:u(this,Jl)}),x(this,Jl,!1))}isDeleted(){return u(this,Ql)||u(this,Li)===""}isEmpty(){return u(this,Li)===null}hasBeenEdited(){return this.isDeleted()||u(this,Li)!==u(this,bm)}serialize(){return this.data}get data(){return{text:u(this,Li),richText:u(this,Xl),date:u(this,Wl),deleted:this.isDeleted()}}set data(e){if(e!==u(this,Li)&&x(this,Xl,null),e===null){x(this,Li,""),x(this,Ql,!0);return}x(this,Li,e),x(this,Wl,new Date),x(this,Ql,!1)}setInitialText(e,t=null){x(this,bm,e),this.data=e,x(this,Wl,null),x(this,Xl,t)}shown(){}destroy(){var e,t;(e=u(this,oi))==null||e.remove(),x(this,oi,null),(t=u(this,yn))==null||t.remove(),x(this,yn,null),x(this,Li,""),x(this,Xl,null),x(this,Wl,null),x(this,it,null),x(this,Jl,!1),x(this,Ql,!1)}}yn=new WeakMap,oi=new WeakMap,Jl=new WeakMap,it=new WeakMap,bm=new WeakMap,Xl=new WeakMap,Li=new WeakMap,Wl=new WeakMap,Ql=new WeakMap,Zl=new WeakMap,_m=new WeakSet,bw=function(e,t){if(!u(this,it)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[u(this,it)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const s=u(this,it)._uiManager._signal;if(!(s instanceof AbortSignal)||s.aborted)return e;e.addEventListener("contextmenu",Ci,{signal:s}),t&&(e.addEventListener("focusin",r=>{u(this,it)._focusEventsAllowed=!1,kt(r)},{capture:!0,signal:s}),e.addEventListener("focusout",r=>{u(this,it)._focusEventsAllowed=!0,kt(r)},{capture:!0,signal:s})),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),e===u(this,oi)?this.edit():u(this,it).toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(x(this,Jl,!0),i(r))},{signal:s}),e.addEventListener("pointerenter",()=>{u(this,it).toggleComment(!1,!0)},{signal:s}),e.addEventListener("pointerleave",()=>{u(this,it).toggleComment(!1,!1)},{signal:s}),e};var qd,ec,xm,wm,Sm,Em,Am,Qr,tc,Zr,nc,ea,bl,PM,LM,OM;const qA=class qA{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){A(this,bl);A(this,qd);A(this,ec,!1);A(this,xm,null);A(this,wm);A(this,Sm);A(this,Em);A(this,Am);A(this,Qr,null);A(this,tc);A(this,Zr,null);A(this,nc);A(this,ea,null);x(this,qd,e),x(this,xm,s),x(this,wm,t),x(this,Sm,i),x(this,Em,r),x(this,Am,a),x(this,nc,new AbortController),x(this,tc,AbortSignal.any([o,u(this,nc).signal])),e.addEventListener("touchstart",C(this,bl,PM).bind(this),{passive:!1,signal:u(this,tc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ir.pixelRatio}destroy(){var e,t;(e=u(this,nc))==null||e.abort(),x(this,nc,null),(t=u(this,Qr))==null||t.abort(),x(this,Qr,null)}};qd=new WeakMap,ec=new WeakMap,xm=new WeakMap,wm=new WeakMap,Sm=new WeakMap,Em=new WeakMap,Am=new WeakMap,Qr=new WeakMap,tc=new WeakMap,Zr=new WeakMap,nc=new WeakMap,ea=new WeakMap,bl=new WeakSet,PM=function(e){var i,r,a;if((i=u(this,wm))!=null&&i.call(this))return;if(e.touches.length===1){if(u(this,Qr))return;const o=x(this,Qr,new AbortController),l=AbortSignal.any([u(this,tc),o.signal]),c=u(this,qd),d={capture:!0,signal:l,passive:!1},h=p=>{var y;p.pointerType==="touch"&&((y=u(this,Qr))==null||y.abort(),x(this,Qr,null))};c.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(kt(p),h(p))},d),c.addEventListener("pointerup",h,d),c.addEventListener("pointercancel",h,d);return}if(!u(this,ea)){x(this,ea,new AbortController);const o=AbortSignal.any([u(this,tc),u(this,ea).signal]),l=u(this,qd),c={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",C(this,bl,LM).bind(this),c);const d=C(this,bl,OM).bind(this);l.addEventListener("touchend",d,c),l.addEventListener("touchcancel",d,c),c.capture=!0,l.addEventListener("pointerdown",kt,c),l.addEventListener("pointermove",kt,c),l.addEventListener("pointercancel",kt,c),l.addEventListener("pointerup",kt,c),(r=u(this,Sm))==null||r.call(this)}if(kt(e),e.touches.length!==2||(a=u(this,xm))!=null&&a.call(this)){x(this,Zr,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),x(this,Zr,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},LM=function(e){var T;if(!u(this,Zr)||e.touches.length!==2)return;kt(e);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,l=u(this,Zr),{touch0X:c,touch0Y:d,touch1X:h,touch1Y:p}=l,y=h-c,v=p-d,_=a-i,E=o-r,b=Math.hypot(_,E)||1,w=Math.hypot(y,v)||1;if(!u(this,ec)&&Math.abs(w-b)<=qA.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!u(this,ec)){x(this,ec,!0);return}const S=[(i+a)/2,(r+o)/2];(T=u(this,Em))==null||T.call(this,S,w,b)},OM=function(e){var t;e.touches.length>=2||(u(this,ea)&&(u(this,ea).abort(),x(this,ea,null),(t=u(this,Am))==null||t.call(this)),u(this,Zr)&&(kt(e),x(this,Zr,null),x(this,ec,!1)))};let Av=qA;var sc,Oi,pt,Xe,ta,Vd,Ao,Tm,vn,ic,na,li,To,Cm,rc,_s,Nm,ac,sa,fr,$d,Yd,ci,oc,Rm,Qv,ie,_w,km,xw,gy,UM,BM,ww,yy,Sw,FM,zM,HM,Ew,jM,Aw,GM,qM,VM,Tw,ep;const fe=class fe{constructor(e){A(this,ie);A(this,sc,null);A(this,Oi,null);A(this,pt,null);A(this,Xe,null);A(this,ta,null);A(this,Vd,!1);A(this,Ao,null);A(this,Tm,"");A(this,vn,null);A(this,ic,null);A(this,na,null);A(this,li,null);A(this,To,null);A(this,Cm,"");A(this,rc,!1);A(this,_s,null);A(this,Nm,!1);A(this,ac,!1);A(this,sa,!1);A(this,fr,null);A(this,$d,0);A(this,Yd,0);A(this,ci,null);A(this,oc,null);z(this,"isSelected",!1);z(this,"_isCopy",!1);z(this,"_editToolbar",null);z(this,"_initialOptions",Object.create(null));z(this,"_initialData",null);z(this,"_isVisible",!0);z(this,"_uiManager",null);z(this,"_focusEventsAllowed",!0);A(this,Rm,!1);A(this,Qv,fe._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=fe.prototype._resizeWithKeyboard,t=pu.TRANSLATE_SMALL,s=pu.TRANSLATE_BIG;return de(this,"_resizerKeyboardManager",new u0([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],fe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return de(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new AU({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(fe._l10n??(fe._l10n=e),fe._l10nResizer||(fe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),fe._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);fe._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ze("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return u(this,Rm)}set _isDraggable(e){var t;x(this,Rm,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=u(this,Qv)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(C(this,ie,ep).call(this),(t=u(this,li))==null||t.remove(),x(this,li,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(u(this,rc)?x(this,rc,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),this._onTranslated()}translate(e,t){C(this,ie,_w).call(this,this.parentDimensions,e,t)}translateInPage(e,t){u(this,_s)||x(this,_s,[this.x,this.y,this.width,this.height]),C(this,ie,_w).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){u(this,_s)||x(this,_s,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:d}=s;d.left=`${(100*a).toFixed(2)}%`,d.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!u(this,_s)&&(u(this,_s)[0]!==this.x||u(this,_s)[1]!==this.y)}get _hasBeenResized(){return!!u(this,_s)&&(u(this,_s)[2]!==this.width||u(this,_s)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=fe,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=s,l*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Yn(r,0,s-o),a=Yn(a,0,i-l);break;case 90:r=Yn(r,0,s-l),a=Yn(a,o,i);break;case 180:r=Yn(r,o,s),a=Yn(a,l,i);break;case 270:r=Yn(r,l,s),a=Yn(a,0,i-o);break}this.x=r/=s,this.y=a/=i;const[c,d]=this.getBaseTranslation();r+=c,a+=d,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return C(s=fe,km,xw).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return C(s=fe,km,xw).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(){const{div:{style:e},width:t,height:s}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*s).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=u(this,pt))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||u(this,ac))return this._editToolbar;this._editToolbar=new dw(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,s]of e)await this._editToolbar.addButton(t,s);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=u(this,pt))==null||t.destroy()}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return u(this,pt)||(Ev.initialize(fe._l10n),x(this,pt,new Ev(this)),u(this,sc)&&(u(this,pt).data=u(this,sc),x(this,sc,null))),u(this,pt)}get altTextData(){var e;return(e=u(this,pt))==null?void 0:e.data}set altTextData(e){u(this,pt)&&(u(this,pt).data=e)}get guessedAltText(){var e;return(e=u(this,pt))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=u(this,pt))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=u(this,pt))==null?void 0:t.serialize(e)}hasAltText(){return!!u(this,pt)&&!u(this,pt).isEmpty()}hasAltTextData(){var e;return((e=u(this,pt))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=u(this,Xe))==null||e.focusButton()}addCommentButton(){return this.canAddComment?u(this,Xe)||x(this,Xe,new M0(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(u(this,ta)){this._uiManager.isEditingMode()&&u(this,ta).classList.remove("hidden");return}this.hasComment&&(x(this,ta,u(this,Xe).renderForStandalone()),this.div.append(u(this,ta)))}}removeStandaloneCommentButton(){u(this,Xe).removeStandaloneCommentButton(),x(this,ta,null)}hideStandaloneCommentButton(){var e;(e=u(this,ta))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:s,deleted:i}}=u(this,Xe);return{text:t,richText:e,date:s,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){u(this,Xe)||x(this,Xe,new M0(this)),u(this,Xe).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:s}){if(!t||(u(this,Xe)||x(this,Xe,new M0(this)),u(this,Xe).setInitialText(e,s),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){var e;return(e=u(this,Xe))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=u(this,Xe))==null?void 0:e.isDeleted()}get hasComment(){return!!u(this,Xe)&&!u(this,Xe).isEmpty()&&!u(this,Xe).isDeleted()}async editComment(e){u(this,Xe)||x(this,Xe,new M0(this)),u(this,Xe).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){u(this,Xe).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[r]=this.pageDimensions,[a]=this.pageTranslation,o=a+r+1,l=i-100,c=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,c,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){u(this,Xe).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=u(this,Vd)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),C(this,ie,Aw).call(this);const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*s/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),_M(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(u(this,oc)||x(this,oc,new Av({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:C(this,ie,FM).bind(this),onPinching:C(this,ie,zM).bind(this),onPinchEnd:C(this,ie,HM).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=en.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(x(this,rc,!0),this._isDraggable){C(this,ie,jM).call(this,e);return}C(this,ie,Ew).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){u(this,fr)&&clearTimeout(u(this,fr)),x(this,fr,setTimeout(()=>{var e;x(this,fr,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/i,d=t/i,h=this.x*r,p=this.y*a,y=this.width*r,v=this.height*a;switch(s){case 0:return[h+c+o,a-p-d-v+l,h+c+y+o,a-p-d+l];case 90:return[h+d+o,a-p+c+l,h+d+v+o,a-p+c+y+l];case 180:return[h-c-y+o,a-p+d+l,h-c+o,a-p+d+v+l];case 270:return[h-d-v+o,a-p-c-y+l,h-d+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,l=a-i;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-i,l,o];case 180:return[r,t-i,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&fe._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=u(this,Xe))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:s,opacity:i,deleted:r,richText:a},uid:o,pageIndex:l,creationDate:c,modificationDate:d}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:c,modificationDate:s||d,popupRef:!r,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),x(this,ac,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),x(this,ac,!1),!0):!1}isInEditMode(){return u(this,ac)}shouldGetKeyboardEvents(){return u(this,sa)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){C(this,ie,Aw).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var s;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((s=this._initialData)==null?void 0:s.popupRef)||""}}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,x(i,sc,e.accessibilityData),i._isCopy=e.isCopy||!1;const[r,a]=i.pageDimensions,[o,l,c,d]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=l/a,i.width=c/r,i.height=d/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t,s;if((e=u(this,To))==null||e.abort(),x(this,To,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),u(this,fr)&&(clearTimeout(u(this,fr)),x(this,fr,null)),C(this,ie,ep).call(this),this.removeEditToolbar(),u(this,ci)){for(const i of u(this,ci).values())clearTimeout(i);x(this,ci,null)}this.parent=null,(t=u(this,oc))==null||t.destroy(),x(this,oc,null),(s=u(this,li))==null||s.remove(),x(this,li,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,ie,UM).call(this),u(this,vn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[s,i,r,a]=this.getPDFRect();return[fe._round(s+(r-s)*e),fe._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return u(this,Xe).commentPopupPositionInLayer}set commentPopupPosition(e){u(this,Xe).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return u(this,Xe).hasDefaultPopupPosition()}get commentButtonWidth(){return u(this,Xe).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){var t;(t=u(this,Xe))==null||t.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),x(this,na,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=u(this,vn).children;if(!u(this,Oi)){x(this,Oi,Array.from(t));const a=C(this,ie,GM).bind(this),o=C(this,ie,qM).bind(this),l=this._uiManager._signal;for(const c of u(this,Oi)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",C(this,ie,VM).bind(this,d),{signal:l}),c.setAttribute("data-l10n-id",fe._l10nResizer[d])}}const s=u(this,Oi)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(u(this,Oi).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)u(this,vn).append(u(this,vn).firstElementChild);else if(r>i)for(let o=0;o<r-i;o++)u(this,vn).firstElementChild.before(u(this,vn).lastElementChild);let a=0;for(const o of t){const c=u(this,Oi)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",fe._l10nResizer[c])}}C(this,ie,Tw).call(this,0),x(this,sa,!0),u(this,vn).firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){u(this,sa)&&C(this,ie,Sw).call(this,u(this,Cm),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){C(this,ie,ep).call(this),this.div.focus()}select(){var e,t,s;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=u(this,pt))==null||s.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,s,i,r;this.isSelected&&(this.isSelected=!1,(e=u(this,vn))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=u(this,pt))==null||r.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return u(this,Nm)}set isEditing(e){x(this,Nm,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){u(this,ci)||x(this,ci,new Map);const{action:s}=e;let i=u(this,ci).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),u(this,ci).delete(s),u(this,ci).size===0&&x(this,ci,null)},fe._telemetryTimeout),u(this,ci).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),x(this,Vd,!1)}disable(){this.div&&(this.div.tabIndex=-1),x(this,Vd,!0)}updateFakeAnnotationElement(e){if(!u(this,li)&&!this.deleted){x(this,li,e.addFakeAnnotation(this));return}if(this.deleted){u(this,li).remove(),x(this,li,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&u(this,li).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};sc=new WeakMap,Oi=new WeakMap,pt=new WeakMap,Xe=new WeakMap,ta=new WeakMap,Vd=new WeakMap,Ao=new WeakMap,Tm=new WeakMap,vn=new WeakMap,ic=new WeakMap,na=new WeakMap,li=new WeakMap,To=new WeakMap,Cm=new WeakMap,rc=new WeakMap,_s=new WeakMap,Nm=new WeakMap,ac=new WeakMap,sa=new WeakMap,fr=new WeakMap,$d=new WeakMap,Yd=new WeakMap,ci=new WeakMap,oc=new WeakMap,Rm=new WeakMap,Qv=new WeakMap,ie=new WeakSet,_w=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},km=new WeakSet,xw=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},gy=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},UM=function(){if(u(this,vn))return;x(this,vn,document.createElement("div")),u(this,vn).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");u(this,vn).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",C(this,ie,BM).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Ci,{signal:t}),i.tabIndex=-1}this.div.prepend(u(this,vn))},BM=function(e,t){var d;t.preventDefault();const{isMac:s}=en.platform;if(t.button!==0||t.ctrlKey&&s)return;(d=u(this,pt))==null||d.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,x(this,ic,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C(this,ie,Sw).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",kt,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ci,{signal:a}),x(this,na,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var h;r.abort(),this.parent.togglePointerEvents(!0),(h=u(this,pt))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,C(this,ie,yy).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},ww=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},yy=function(){if(!u(this,na))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=u(this,na);x(this,na,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===s&&l===i||this.addCommands({cmd:C(this,ie,ww).bind(this,r,a,o,l),undo:C(this,ie,ww).bind(this,e,t,s,i),mustExec:!0})},Sw=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,c=fe.MIN_SIZE/s,d=fe.MIN_SIZE/i,h=C(this,ie,gy).call(this,this.rotation),p=(P,F)=>[h[0]*P+h[2]*F,h[1]*P+h[3]*F],y=C(this,ie,gy).call(this,360-this.rotation),v=(P,F)=>[y[0]*P+y[2]*F,y[1]*P+y[3]*F];let _,E,b=!1,w=!1;switch(e){case"topLeft":b=!0,_=(P,F)=>[0,0],E=(P,F)=>[P,F];break;case"topMiddle":_=(P,F)=>[P/2,0],E=(P,F)=>[P/2,F];break;case"topRight":b=!0,_=(P,F)=>[P,0],E=(P,F)=>[0,F];break;case"middleRight":w=!0,_=(P,F)=>[P,F/2],E=(P,F)=>[0,F/2];break;case"bottomRight":b=!0,_=(P,F)=>[P,F],E=(P,F)=>[0,0];break;case"bottomMiddle":_=(P,F)=>[P/2,F],E=(P,F)=>[P/2,0];break;case"bottomLeft":b=!0,_=(P,F)=>[0,F],E=(P,F)=>[P,0];break;case"middleLeft":w=!0,_=(P,F)=>[0,F/2],E=(P,F)=>[P,F/2];break}const S=_(o,l),T=E(o,l);let N=p(...T);const R=fe._round(r+N[0]),k=fe._round(a+N[1]);let I=1,M=1,D,O;if(t.fromKeyboard)({deltaX:D,deltaY:O}=t);else{const{screenX:P,screenY:F}=t,[H,U]=u(this,ic);[D,O]=this.screenToPageTranslation(P-H,F-U),u(this,ic)[0]=P,u(this,ic)[1]=F}if([D,O]=v(D/s,O/i),b){const P=Math.hypot(o,l);I=M=Math.max(Math.min(Math.hypot(T[0]-S[0]-D,T[1]-S[1]-O)/P,1/o,1/l),c/o,d/l)}else w?I=Yn(Math.abs(T[0]-S[0]-D),c,1)/o:M=Yn(Math.abs(T[1]-S[1]-O),d,1)/l;const L=fe._round(o*I),$=fe._round(l*M);N=p(...E(L,$));const G=R-N[0],ee=k-N[1];u(this,_s)||x(this,_s,[this.x,this.y,this.width,this.height]),this.width=L,this.height=$,this.x=G,this.y=ee,this.setDims(),this.fixAndSetPosition(),this._onResizing()},FM=function(){var e;x(this,na,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=u(this,pt))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},zM=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=C(this,ie,gy).call(this,this.rotation),o=(R,k)=>[a[0]*R+a[2]*k,a[1]*R+a[3]*k],[l,c]=this.parentDimensions,d=this.x,h=this.y,p=this.width,y=this.height,v=fe.MIN_SIZE/l,_=fe.MIN_SIZE/c;r=Math.max(Math.min(r,1/p,1/y),v/p,_/y);const E=fe._round(p*r),b=fe._round(y*r);if(E===p&&b===y)return;u(this,_s)||x(this,_s,[d,h,p,y]);const w=o(p/2,y/2),S=fe._round(d+w[0]),T=fe._round(h+w[1]),N=o(E/2,b/2);this.x=S-N[0],this.y=T-N[1],this.width=E,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()},HM=function(){var e;(e=u(this,pt))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),C(this,ie,yy).call(this)},Ew=function(e){const{isMac:t}=en.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},jM=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=c=>{i.abort(),x(this,Ao,null),x(this,rc,!1),this._uiManager.endDragSession()||C(this,ie,Ew).call(this,c),s&&this._onStopDragging()};t&&(x(this,$d,e.clientX),x(this,Yd,e.clientY),x(this,Ao,e.pointerId),x(this,Tm,e.pointerType),window.addEventListener("pointermove",c=>{s||(s=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:d,clientY:h,pointerId:p}=c;if(p!==u(this,Ao)){kt(c);return}const[y,v]=this.screenToPageTranslation(d-u(this,$d),h-u(this,Yd));x(this,$d,d),x(this,Yd,h),this._uiManager.dragSelectedEditors(y,v)},a),window.addEventListener("touchmove",kt,a),window.addEventListener("pointerdown",c=>{c.pointerType===u(this,Tm)&&(u(this,oc)||c.isPrimary)&&o(c),kt(c)},a));const l=c=>{if(!u(this,Ao)||u(this,Ao)===c.pointerId){o(c);return}kt(c)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},Aw=function(){if(u(this,To)||!this.div)return;x(this,To,new AbortController);const e=this._uiManager.combinedSignal(u(this,To));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},GM=function(e){fe._resizerKeyboardManager.exec(this,e)},qM=function(e){var t;u(this,sa)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==u(this,vn)&&C(this,ie,ep).call(this)},VM=function(e){x(this,Cm,u(this,sa)?e:"")},Tw=function(e){if(u(this,Oi))for(const t of u(this,Oi))t.tabIndex=e},ep=function(){x(this,sa,!1),C(this,ie,Tw).call(this,-1),C(this,ie,yy).call(this)},A(fe,km),z(fe,"_l10n",null),z(fe,"_l10nResizer",null),z(fe,"_borderLineWidth",-1),z(fe,"_colorManager",new pw),z(fe,"_zIndex",1),z(fe,"_telemetryTimeout",1e3);let rt=fe;class AU extends rt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const PT=3285377520,Zs=4294901760,sr=65535;class $M{constructor(e){this.h1=e?e&4294967295:PT,this.h2=e?e&4294967295:PT}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let _=0,E=e.length;_<E;_++){const b=e.charCodeAt(_);b<=255?t[s++]=b:(t[s++]=b>>>8,t[s++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,c=this.h1,d=this.h2;const h=3432918353,p=461845907,y=h&sr,v=p&sr;for(let _=0;_<i;_++)_&1?(o=a[_],o=o*h&Zs|o*y&sr,o=o<<15|o>>>17,o=o*p&Zs|o*v&sr,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[_],l=l*h&Zs|l*y&sr,l=l<<15|l>>>17,l=l*p&Zs|l*v&sr,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*h&Zs|o*y&sr,o=o<<15|o>>>17,o=o*p&Zs|o*v&sr,i&1?c^=o:d^=o}this.h1=c,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Zs|e*36045&sr,t=t*4283543511&Zs|((t<<16|e>>>16)*2950163797&Zs)>>>16,e^=t>>>1,e=e*444984403&Zs|e*60499&sr,t=t*3301882366&Zs|((t<<16|e>>>16)*3120437893&Zs)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Cw=Object.freeze({map:null,hash:"",transfer:void 0});var lc,cc,ia,bn,Zv,YM;class hA{constructor(){A(this,Zv);A(this,lc,!1);A(this,cc,null);A(this,ia,null);A(this,bn,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=u(this,bn).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return u(this,bn).get(e)}remove(e){const t=u(this,bn).get(e);if(t!==void 0&&(t instanceof rt&&u(this,ia).delete(t.annotationElementId),u(this,bn).delete(e),u(this,bn).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const s of u(this,bn).values())if(s instanceof rt)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=u(this,bn).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,u(this,bn).set(e,t);i&&C(this,Zv,YM).call(this),t instanceof rt&&((u(this,ia)||x(this,ia,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return u(this,bn).has(e)}get size(){return u(this,bn).size}resetModified(){u(this,lc)&&(x(this,lc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new KM(this)}get serializable(){if(u(this,bn).size===0)return Cw;const e=new Map,t=new $M,s=[],i=Object.create(null);let r=!1;for(const[a,o]of u(this,bn)){const l=o instanceof rt?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Cw}get editorStats(){let e=null;const t=new Map;let s=0,i=0;for(const r of u(this,bn).values()){if(!(r instanceof rt)){r.popup&&(r.popup.deleted?i+=1:s+=1);continue}r.isCommentDeleted?i+=1:r.hasEditedComment&&(s+=1);const a=r.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(r).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[c,d]of Object.entries(a)){if(c==="type")continue;let h=l.get(c);h||(h=new Map,l.set(c,h));const p=h.get(d)??0;h.set(d,p+1)}}if((i>0||s>0)&&(e||(e=Object.create(null)),e.comments={deleted:i,edited:s}),!e)return null;for(const[r,a]of t)e[r]=a.computeTelemetryFinalData(e[r]);return e}resetModifiedIds(){x(this,cc,null)}updateEditor(e,t){var i;const s=(i=u(this,ia))==null?void 0:i.get(e);return s?(s.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=u(this,ia))==null?void 0:t.get(e))||null}get modifiedIds(){if(u(this,cc))return u(this,cc);const e=[];if(u(this,ia))for(const t of u(this,ia).values())t.serialize()&&e.push(t.annotationElementId);return x(this,cc,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return u(this,bn).entries()}}lc=new WeakMap,cc=new WeakMap,ia=new WeakMap,bn=new WeakMap,Zv=new WeakSet,YM=function(){u(this,lc)||(x(this,lc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Mm;class KM extends hA{constructor(t){super();A(this,Mm);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);x(this,Mm,{map:a,hash:i,transfer:r})}get print(){Ze("Should not call PrintAnnotationStorage.print")}get serializable(){return u(this,Mm)}get modifiedIds(){return de(this,"modifiedIds",{ids:new Set,hash:""})}}Mm=new WeakMap;var Kd;class TU{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){A(this,Kd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),u(this,Kd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:s}){if(!(!e||u(this,Kd).has(e.loadedName))){if(Te(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:a}=e,o=new FontFace(i,r,a);this.addNativeFontFace(o);try{await o.load(),u(this,Kd).add(i),s==null||s(e)}catch{ue(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Ze("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ue(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return de(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return de(this,"isSyncFontLoadingSupported",$n||en.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Te(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return de(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(T,N){return T.charCodeAt(N)<<24|T.charCodeAt(N+1)<<16|T.charCodeAt(N+2)<<8|T.charCodeAt(N+3)&255}function i(T,N,R,k){const I=T.substring(0,N),M=T.substring(N+R);return I+k+M}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function d(T,N){if(++c>30){ue("Load test font never loaded."),N();return}if(l.font="30px "+T,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(d.bind(null,T,N))}const h=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,h.length,h);const v=16,_=1482184792;let E=s(p,v);for(r=0,a=h.length-3;r<a;r+=4)E=E-_+s(h,r)|0;r<h.length&&(E=E-_+s(h+"XXX",r)|0),p=i(p,v,4,aU(E));const b=`url(data:font/opentype;base64,${btoa(p)});`,w=`@font-face {font-family:"${h}";src:${b}}`;this.insertRule(w);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const T of[e.loadedName,h]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=T,S.append(N)}this._document.body.append(S),d(h,()=>{S.remove(),t.complete()})}}Kd=new WeakMap;var je;class CU{constructor(e,t=null,s,i){A(this,je);this.compiledGlyphs=Object.create(null),x(this,je,e),this._inspectFont=t,s&&Object.assign(this,s),i&&(this.charProcOperatorList=i)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${dM(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){ue(`getPathGenerator - ignoring character: "${a}".`)}const r=pM(i==null?void 0:i.path);return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}get black(){return u(this,je).black}get bold(){return u(this,je).bold}get disableFontFace(){return u(this,je).disableFontFace??!1}set disableFontFace(e){de(this,"disableFontFace",!!e)}get fontExtraProperties(){return u(this,je).fontExtraProperties??!1}get isInvalidPDFjsFont(){return u(this,je).isInvalidPDFjsFont}get isType3Font(){return u(this,je).isType3Font}get italic(){return u(this,je).italic}get missingFile(){return u(this,je).missingFile}get remeasure(){return u(this,je).remeasure}get vertical(){return u(this,je).vertical}get ascent(){return u(this,je).ascent}get defaultWidth(){return u(this,je).defaultWidth}get descent(){return u(this,je).descent}get bbox(){return u(this,je).bbox}set bbox(e){de(this,"bbox",e)}get fontMatrix(){return u(this,je).fontMatrix}get fallbackName(){return u(this,je).fallbackName}get loadedName(){return u(this,je).loadedName}get mimetype(){return u(this,je).mimetype}get name(){return u(this,je).name}get data(){return u(this,je).data}clearData(){u(this,je).clearData()}get cssFontInfo(){return u(this,je).cssFontInfo}get systemFontInfo(){return u(this,je).systemFontInfo}get defaultVMetrics(){return u(this,je).defaultVMetrics}}je=new WeakMap;var Jd,Xd,Im,Wd,vy;const fd=class fd{constructor(e){A(this,Wd);A(this,Jd);A(this,Xd);A(this,Im);x(this,Jd,e),x(this,Xd,new DataView(u(this,Jd))),x(this,Im,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const c of fd.strings){const d=t.encode(e[c]);s[c]=d,i+=4+d.length}const r=new ArrayBuffer(i),a=new Uint8Array(r),o=new DataView(r);let l=0;for(const c of fd.strings){const d=s[c],h=d.length;o.setUint32(l,h),a.set(d,l+4),l+=4+h}return Te(l===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return C(this,Wd,vy).call(this,0)}get fontWeight(){return C(this,Wd,vy).call(this,1)}get italicAngle(){return C(this,Wd,vy).call(this,2)}};Jd=new WeakMap,Xd=new WeakMap,Im=new WeakMap,Wd=new WeakSet,vy=function(e){Te(e<fd.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=u(this,Xd).getUint32(t)+4;const s=u(this,Xd).getUint32(t);return u(this,Im).decode(new Uint8Array(u(this,Jd),t+4,s))},z(fd,"strings",["fontFamily","fontWeight","italicAngle"]);let Tv=fd;var Co,pr,uc,dc,tp;const pd=class pd{constructor(e){A(this,dc);A(this,Co);A(this,pr);A(this,uc);x(this,Co,e),x(this,pr,new DataView(u(this,Co))),x(this,uc,new TextDecoder)}static write(e){const t=new TextEncoder,s={};let i=0;for(const p of pd.strings){const y=t.encode(e[p]);s[p]=y,i+=4+y.length}i+=4;let r,a,o=1+i;e.style&&(r=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+r.length+4+a.length);const l=new ArrayBuffer(o),c=new Uint8Array(l),d=new DataView(l);let h=0;d.setUint8(h++,e.guessFallback?1:0),d.setUint32(h,0),h+=4,i=0;for(const p of pd.strings){const y=s[p],v=y.length;i+=4+v,d.setUint32(h,v),c.set(y,h+4),h+=4+v}return d.setUint32(h-i-4,i),e.style&&(d.setUint32(h,r.length),c.set(r,h+4),h+=4+r.length,d.setUint32(h,a.length),c.set(a,h+4),h+=4+a.length),Te(h<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(h)}get guessFallback(){return u(this,pr).getUint8(0)!==0}get css(){return C(this,dc,tp).call(this,0)}get loadedName(){return C(this,dc,tp).call(this,1)}get baseFontName(){return C(this,dc,tp).call(this,2)}get src(){return C(this,dc,tp).call(this,3)}get style(){let e=1;e+=4+u(this,pr).getUint32(e);const t=u(this,pr).getUint32(e),s=u(this,uc).decode(new Uint8Array(u(this,Co),e+4,t));e+=4+t;const i=u(this,pr).getUint32(e),r=u(this,uc).decode(new Uint8Array(u(this,Co),e+4,i));return{style:s,weight:r}}};Co=new WeakMap,pr=new WeakMap,uc=new WeakMap,dc=new WeakSet,tp=function(e){Te(e<pd.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=u(this,pr).getUint32(t)+4;const s=u(this,pr).getUint32(t);return u(this,uc).decode(new Uint8Array(u(this,Co),t+4,s))},z(pd,"strings",["css","loadedName","baseFontName","src"]);let Cv=pd;var Qd,Zd,eh,th,xs,mr,Dm,Ge,Rt,ki,by,np;const ge=class ge{constructor({data:e,extra:t}){A(this,Rt);A(this,mr);A(this,Dm);A(this,Ge);x(this,mr,e),x(this,Dm,new TextDecoder),x(this,Ge,new DataView(u(this,mr))),t&&Object.assign(this,t)}get black(){return C(this,Rt,ki).call(this,0)}get bold(){return C(this,Rt,ki).call(this,1)}get disableFontFace(){return C(this,Rt,ki).call(this,2)}get fontExtraProperties(){return C(this,Rt,ki).call(this,3)}get isInvalidPDFjsFont(){return C(this,Rt,ki).call(this,4)}get isType3Font(){return C(this,Rt,ki).call(this,5)}get italic(){return C(this,Rt,ki).call(this,6)}get missingFile(){return C(this,Rt,ki).call(this,7)}get remeasure(){return C(this,Rt,ki).call(this,8)}get vertical(){return C(this,Rt,ki).call(this,9)}get ascent(){return C(this,Rt,by).call(this,0)}get defaultWidth(){return C(this,Rt,by).call(this,1)}get descent(){return C(this,Rt,by).call(this,2)}get bbox(){let e=u(ge,Zd);if(u(this,Ge).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<4;i++)s.push(u(this,Ge).getInt16(e,!0)),e+=2;return s}get fontMatrix(){let e=u(ge,eh);if(u(this,Ge).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<6;i++)s.push(u(this,Ge).getFloat64(e,!0)),e+=8;return s}get defaultVMetrics(){let e=u(ge,th);if(u(this,Ge).getUint8(e)===0)return;e+=1;const s=[];for(let i=0;i<3;i++)s.push(u(this,Ge).getInt16(e,!0)),e+=2;return s}get fallbackName(){return C(this,Rt,np).call(this,0)}get loadedName(){return C(this,Rt,np).call(this,1)}get mimetype(){return C(this,Rt,np).call(this,2)}get name(){return C(this,Rt,np).call(this,3)}get data(){let e=u(ge,xs);const t=u(this,Ge).getUint32(e);e+=4+t;const s=u(this,Ge).getUint32(e);e+=4+s;const i=u(this,Ge).getUint32(e);e+=4+i;const r=u(this,Ge).getUint32(e);if(r!==0)return new Uint8Array(u(this,mr),e+4,r)}clearData(){let e=u(ge,xs);const t=u(this,Ge).getUint32(e);e+=4+t;const s=u(this,Ge).getUint32(e);e+=4+s;const i=u(this,Ge).getUint32(e);e+=4+i;const r=u(this,Ge).getUint32(e);new Uint8Array(u(this,mr),e+4,r).fill(0),u(this,Ge).setUint32(e,0)}get cssFontInfo(){let e=u(ge,xs);const t=u(this,Ge).getUint32(e);e+=4+t;const s=u(this,Ge).getUint32(e);e+=4+s;const i=u(this,Ge).getUint32(e);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(u(this,mr),e+4,i)),new Tv(r.buffer)}get systemFontInfo(){let e=u(ge,xs);const t=u(this,Ge).getUint32(e);e+=4+t;const s=u(this,Ge).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(u(this,mr),e+4,s)),new Cv(i.buffer)}static write(e){const t=e.systemFontInfo?Cv.write(e.systemFontInfo):null,s=e.cssFontInfo?Tv.write(e.cssFontInfo):null,i=new TextEncoder,r={};let a=0;for(const _ of ge.strings)r[_]=i.encode(e[_]),a+=4+r[_].length;const o=u(ge,xs)+4+a+4+(t?t.byteLength:0)+4+(s?s.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),c=new Uint8Array(l),d=new DataView(l);let h=0;const p=ge.bools.length;let y=0,v=0;for(let _=0;_<p;_++){const E=e[ge.bools[_]];y|=(E===void 0?0:E?2:1)<<v,v+=2,(v===8||_===p-1)&&(d.setUint8(h++,y),y=0,v=0)}Te(h===u(ge,Qd),"FontInfo.write: Boolean properties offset mismatch");for(const _ of ge.numbers)d.setFloat64(h,e[_]),h+=8;if(Te(h===u(ge,Zd),"FontInfo.write: Number properties offset mismatch"),e.bbox){d.setUint8(h++,4);for(const _ of e.bbox)d.setInt16(h,_,!0),h+=2}else d.setUint8(h++,0),h+=2*4;if(Te(h===u(ge,eh),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){d.setUint8(h++,6);for(const _ of e.fontMatrix)d.setFloat64(h,_,!0),h+=8}else d.setUint8(h++,0),h+=8*6;if(Te(h===u(ge,th),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){d.setUint8(h++,1);for(const _ of e.defaultVMetrics)d.setInt16(h,_,!0),h+=2}else d.setUint8(h++,0),h+=3*2;Te(h===u(ge,xs),"FontInfo.write: DefaultVMetrics properties offset mismatch"),d.setUint32(u(ge,xs),0),h+=4;for(const _ of ge.strings){const E=r[_],b=E.length;d.setUint32(h,b),c.set(E,h+4),h+=4+b}if(d.setUint32(u(ge,xs),h-u(ge,xs)-4),!t)d.setUint32(h,0),h+=4;else{const _=t.byteLength;d.setUint32(h,_),Te(h+4+_<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),c.set(new Uint8Array(t),h+4),h+=4+_}if(!s)d.setUint32(h,0),h+=4;else{const _=s.byteLength;d.setUint32(h,_),Te(h+4+_<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),c.set(new Uint8Array(s),h+4),h+=4+_}return e.data===void 0?(d.setUint32(h,0),h+=4):(d.setUint32(h,e.data.length),c.set(e.data,h+4),h+=4+e.data.length),Te(h<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(h)}};Qd=new WeakMap,Zd=new WeakMap,eh=new WeakMap,th=new WeakMap,xs=new WeakMap,mr=new WeakMap,Dm=new WeakMap,Ge=new WeakMap,Rt=new WeakSet,ki=function(e){Te(e<ge.bools.length,"Invalid boolean index");const t=Math.floor(e/4),s=e*2%8,i=u(this,Ge).getUint8(t)>>s&3;return i===0?void 0:i===2},by=function(e){return Te(e<ge.numbers.length,"Invalid number index"),u(this,Ge).getFloat64(u(ge,Qd)+e*8)},np=function(e){Te(e<ge.strings.length,"Invalid string index");let t=u(ge,xs)+4;for(let r=0;r<e;r++)t+=u(this,Ge).getUint32(t)+4;const s=u(this,Ge).getUint32(t),i=new Uint8Array(s);return i.set(new Uint8Array(u(this,mr),t+4,s)),u(this,Dm).decode(i)},z(ge,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),z(ge,"numbers",["ascent","defaultWidth","descent"]),z(ge,"strings",["fallbackName","loadedName","mimetype","name"]),A(ge,Qd,Math.ceil(ge.bools.length*2/8)),A(ge,Zd,u(ge,Qd)+ge.numbers.length*8),A(ge,eh,u(ge,Zd)+1+2*4),A(ge,th,u(ge,eh)+1+8*6),A(ge,xs,u(ge,th)+1+2*3);let Nw=ge;var Pm,Lm,Om,Um,Bm,Fm,zm,Hm;const st=class st{constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,s=null,i=[],r=[],a=[],o=[],l=null,c=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,s=e[2],a=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,l=e[1],i=e[2],r=e[3],o=e[4]||[],s=e[6],c=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const d=Math.floor(i.length/2),h=Math.floor(r.length/3),p=a.length,y=o.length;let v=0;for(const N of o)v+=1,v=Math.ceil(v/4)*4,v+=4+N.coords.length*4,v+=4+N.colors.length*4,N.verticesPerRow!==void 0&&(v+=4);const _=20+d*8+h*3+p*8+(s?16:0)+(c?3:0)+v,E=new ArrayBuffer(_),b=new DataView(E),w=new Uint8Array(E);b.setUint8(u(st,Pm),t),b.setUint8(u(st,Lm),s?1:0),b.setUint8(u(st,Om),c?1:0),b.setUint8(u(st,Um),l),b.setUint32(u(st,Bm),d,!0),b.setUint32(u(st,Fm),h,!0),b.setUint32(u(st,zm),p,!0),b.setUint32(u(st,Hm),y,!0);let S=20;new Float32Array(E,S,d*2).set(i),S+=d*8,w.set(r,S),S+=h*3;for(const[N,R]of a)b.setFloat32(S,N,!0),S+=4,b.setUint32(S,parseInt(R.slice(1),16),!0),S+=4;if(s)for(const N of s)b.setFloat32(S,N,!0),S+=4;c&&(w.set(c,S),S+=3);for(let N=0;N<o.length;N++){const R=o[N];b.setUint8(S,R.type),S+=1,S=Math.ceil(S/4)*4,b.setUint32(S,R.coords.length,!0),S+=4,new Int32Array(E,S,R.coords.length).set(R.coords),S+=R.coords.length*4,b.setUint32(S,R.colors.length,!0),S+=4,new Int32Array(E,S,R.colors.length).set(R.colors),S+=R.colors.length*4,R.verticesPerRow!==void 0&&(b.setUint32(S,R.verticesPerRow,!0),S+=4)}return E}getIR(){const e=this.view,t=this.data[u(st,Pm)],s=!!this.data[u(st,Lm)],i=!!this.data[u(st,Om)],r=e.getUint32(u(st,Bm),!0),a=e.getUint32(u(st,Fm),!0),o=e.getUint32(u(st,zm),!0),l=e.getUint32(u(st,Hm),!0);let c=20;const d=new Float32Array(this.buffer,c,r*2);c+=r*8;const h=new Uint8Array(this.buffer,c,a*3);c+=a*3;const p=[];for(let E=0;E<o;++E){const b=e.getFloat32(c,!0);c+=4;const w=e.getUint32(c,!0);c+=4,p.push([b,`#${w.toString(16).padStart(6,"0")}`])}let y=null;if(s){y=[];for(let E=0;E<4;++E)y.push(e.getFloat32(c,!0)),c+=4}let v=null;i&&(v=new Uint8Array(this.buffer,c,3),c+=3);const _=[];for(let E=0;E<l;++E){const b=e.getUint8(c);c+=1,c=Math.ceil(c/4)*4;const w=e.getUint32(c,!0);c+=4;const S=new Int32Array(this.buffer,c,w);c+=w*4;const T=e.getUint32(c,!0);c+=4;const N=new Int32Array(this.buffer,c,T);c+=T*4;const R={type:b,coords:S,colors:N};b===aw.LATTICE&&(R.verticesPerRow=e.getUint32(c,!0),c+=4),_.push(R)}if(t===1)return["RadialAxial","axial",y,p,Array.from(d.slice(0,2)),Array.from(d.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",y,p,[d[0],d[1]],[d[3],d[4]],d[2],d[5]];if(t===3){const E=this.data[u(st,Um)];let b=null;if(d.length>0){let w=d[0],S=d[0],T=d[1],N=d[1];for(let R=0;R<d.length;R+=2){const k=d[R],I=d[R+1];w=w>k?k:w,T=T>I?I:T,S=S<k?k:S,N=N<I?I:N}b=[w,T,S,N]}return["Mesh",E,d,h,_,b,y,v]}throw new Error(`Unsupported pattern kind: ${t}`)}};Pm=new WeakMap,Lm=new WeakMap,Om=new WeakMap,Um=new WeakMap,Bm=new WeakMap,Fm=new WeakMap,zm=new WeakMap,Hm=new WeakMap,A(st,Pm,0),A(st,Lm,1),A(st,Om,2),A(st,Um,3),A(st,Bm,4),A(st,Fm,8),A(st,zm,12),A(st,Hm,16);let Rw=st;var nh;class NU{constructor(e){A(this,nh);x(this,nh,e)}static write(e){let t,s;return en.isFloat16ArraySupported?(s=new ArrayBuffer(e.length*2),t=new Float16Array(s)):(s=new ArrayBuffer(e.length*4),t=new Float32Array(s)),t.set(e),s}get path(){return en.isFloat16ArraySupported?new Float16Array(u(this,nh)):new Float32Array(u(this,nh))}}nh=new WeakMap;function RU(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if($n)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function kU(n){if($n&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return a0(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function I0(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const kw=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,MU=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",IU=dU.bind(null,kw,MU);var ra,eb;class DU{constructor(){A(this,ra,new Map);A(this,eb,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};u(this,eb).then(()=>{for(const[i]of u(this,ra))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ue("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}u(this,ra).set(t,i)}removeEventListener(e,t){const s=u(this,ra).get(t);s==null||s(),u(this,ra).delete(t)}terminate(){for(const[,e]of u(this,ra))e==null||e();u(this,ra).clear()}}ra=new WeakMap,eb=new WeakMap;const D0={DATA:1,ERROR:2},Ot={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function LT(){}function ts(n){if(n instanceof yl||n instanceof ow||n instanceof CT||n instanceof wv||n instanceof z_)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ze('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new yl(n.message);case"InvalidPDFException":return new ow(n.message);case"PasswordException":return new CT(n.message,n.code);case"ResponseException":return new wv(n.message,n.status,n.missing);case"UnknownErrorException":return new z_(n.message,n.details)}return new z_(n.message,n.toString())}var sh,Ei,JM,XM,WM,_y;class sp{constructor(e,t,s){A(this,Ei);A(this,sh,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",C(this,Ei,JM).bind(this),{signal:u(this,sh).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[r]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:c.desiredSize},i),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[r].pullCall=d,l.postMessage({sourceName:a,targetName:o,stream:Ot.PULL,streamId:r,desiredSize:c.desiredSize}),d.promise},cancel:c=>{Te(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[r].cancelCall=d,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Ot.CANCEL,streamId:r,reason:ts(c)}),d.promise}},s)}destroy(){var e;(e=u(this,sh))==null||e.abort(),x(this,sh,null)}}sh=new WeakMap,Ei=new WeakSet,JM=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){C(this,Ei,WM).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===D0.DATA)i.resolve(e.data);else if(e.callback===D0.ERROR)i.reject(ts(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:D0.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:D0.ERROR,callbackId:e.callbackId,reason:ts(a)})});return}if(e.streamId){C(this,Ei,XM).call(this,e);return}t(e.data)},XM=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,d=1,h){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=d,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Ot.ENQUEUE,streamId:t,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ot.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){Te(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Ot.ERROR,streamId:t,reason:ts(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ot.START_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:Ot.START_COMPLETE,streamId:t,reason:ts(c)})})},WM=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Ot.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ts(e.reason));break;case Ot.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ts(e.reason));break;case Ot.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Ot.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||LT).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ot.PULL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:Ot.PULL_COMPLETE,streamId:t,reason:ts(c)})});break;case Ot.ENQUEUE:if(Te(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Ot.CLOSE:if(Te(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),C(this,Ei,_y).call(this,a,t);break;case Ot.ERROR:Te(a,"error should have stream controller"),a.controller.error(ts(e.reason)),C(this,Ei,_y).call(this,a,t);break;case Ot.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ts(e.reason)),C(this,Ei,_y).call(this,a,t);break;case Ot.CANCEL:if(!o)break;const l=ts(e.reason);Promise.try(o.onCancel||LT,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Ot.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){r.postMessage({sourceName:s,targetName:i,stream:Ot.CANCEL_COMPLETE,streamId:t,reason:ts(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},_y=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var jm;class QM{constructor({enableHWA:e=!1}){A(this,jm,!1);x(this,jm,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!u(this,jm)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ze("Abstract method `_createCanvas` called.")}}jm=new WeakMap;class PU extends QM{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class ZM{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ze("Abstract method `_fetch` called.")}}class OT extends ZM{async _fetch(e){const t=await o0(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):a0(t)}}class eI{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var hc,ih,aa,oa,Ln,fc,pc,W,Mn,ip,zu,xy,Hu,tI,Mw,ju,rp,ap,Iw,op;class LU extends eI{constructor({docId:t,ownerDocument:s=globalThis.document}){super();A(this,W);A(this,hc);A(this,ih);A(this,aa);A(this,oa);A(this,Ln);A(this,fc);A(this,pc,0);x(this,oa,t),x(this,Ln,s)}addFilter(t){if(!t)return"none";let s=u(this,W,Mn).get(t);if(s)return s;const[i,r,a]=C(this,W,xy).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=u(this,W,Mn).get(o),s)return u(this,W,Mn).set(t,s),s;const l=`g_${u(this,oa)}_transfer_map_${Vt(this,pc)._++}`,c=C(this,W,Hu).call(this,l);u(this,W,Mn).set(t,c),u(this,W,Mn).set(o,c);const d=C(this,W,ju).call(this,l);return C(this,W,ap).call(this,i,r,a,d),c}addHCMFilter(t,s){var v;const i=`${t}-${s}`,r="base";let a=u(this,W,ip).get(r);if((a==null?void 0:a.key)===i||(a?((v=a.filter)==null||v.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},u(this,W,ip).set(r,a)),!t||!s))return a.url;const o=C(this,W,op).call(this,t);t=X.makeHexColor(...o);const l=C(this,W,op).call(this,s);if(s=X.makeHexColor(...l),u(this,W,zu).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const c=new Array(256);for(let _=0;_<=255;_++){const E=_/255;c[_]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=c.join(","),h=`g_${u(this,oa)}_hcm_filter`,p=a.filter=C(this,W,ju).call(this,h);C(this,W,ap).call(this,d,d,d,p),C(this,W,Mw).call(this,p);const y=(_,E)=>{const b=o[_]/255,w=l[_]/255,S=new Array(E+1);for(let T=0;T<=E;T++)S[T]=b+T/E*(w-b);return S.join(",")};return C(this,W,ap).call(this,y(0,5),y(1,5),y(2,5),p),a.url=C(this,W,Hu).call(this,h),a.url}addAlphaFilter(t){let s=u(this,W,Mn).get(t);if(s)return s;const[i]=C(this,W,xy).call(this,[t]),r=`alpha_${i}`;if(s=u(this,W,Mn).get(r),s)return u(this,W,Mn).set(t,s),s;const a=`g_${u(this,oa)}_alpha_map_${Vt(this,pc)._++}`,o=C(this,W,Hu).call(this,a);u(this,W,Mn).set(t,o),u(this,W,Mn).set(r,o);const l=C(this,W,ju).call(this,a);return C(this,W,Iw).call(this,i,l),o}addLuminosityFilter(t){let s=u(this,W,Mn).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=C(this,W,xy).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=u(this,W,Mn).get(r),s)return u(this,W,Mn).set(t,s),s;const a=`g_${u(this,oa)}_luminosity_map_${Vt(this,pc)._++}`,o=C(this,W,Hu).call(this,a);u(this,W,Mn).set(t,o),u(this,W,Mn).set(r,o);const l=C(this,W,ju).call(this,a);return C(this,W,tI).call(this,l),t&&C(this,W,Iw).call(this,i,l),o}addHighlightHCMFilter(t,s,i,r,a){var w;const o=`${s}-${i}-${r}-${a}`;let l=u(this,W,ip).get(t);if((l==null?void 0:l.key)===o||(l?((w=l.filter)==null||w.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},u(this,W,ip).set(t,l)),!s||!i))return l.url;const[c,d]=[s,i].map(C(this,W,op).bind(this));let h=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[y,v]=[r,a].map(C(this,W,op).bind(this));p<h&&([h,p,y,v]=[p,h,v,y]),u(this,W,zu).style.color="";const _=(S,T,N)=>{const R=new Array(256),k=(p-h)/N,I=S/255,M=(T-S)/(255*N);let D=0;for(let O=0;O<=N;O++){const L=Math.round(h+O*k),$=I+O*M;for(let G=D;G<=L;G++)R[G]=$;D=L+1}for(let O=D;O<256;O++)R[O]=R[D-1];return R.join(",")},E=`g_${u(this,oa)}_hcm_${t}_filter`,b=l.filter=C(this,W,ju).call(this,E);return C(this,W,Mw).call(this,b),C(this,W,ap).call(this,_(y[0],v[0],5),_(y[1],v[1],5),_(y[2],v[2],5),b),l.url=C(this,W,Hu).call(this,E),l.url}destroy(t=!1){var s,i,r,a;t&&((s=u(this,fc))!=null&&s.size)||((i=u(this,aa))==null||i.parentNode.parentNode.remove(),x(this,aa,null),(r=u(this,ih))==null||r.clear(),x(this,ih,null),(a=u(this,fc))==null||a.clear(),x(this,fc,null),x(this,pc,0))}}hc=new WeakMap,ih=new WeakMap,aa=new WeakMap,oa=new WeakMap,Ln=new WeakMap,fc=new WeakMap,pc=new WeakMap,W=new WeakSet,Mn=function(){return u(this,ih)||x(this,ih,new Map)},ip=function(){return u(this,fc)||x(this,fc,new Map)},zu=function(){if(!u(this,aa)){const t=u(this,Ln).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=u(this,Ln).createElementNS(Hr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),x(this,aa,u(this,Ln).createElementNS(Hr,"defs")),t.append(i),i.append(u(this,aa)),u(this,Ln).body.append(t)}return u(this,aa)},xy=function(t){if(t.length===1){const c=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=c[p]/255;const h=d.join(",");return[h,h,h]}const[s,i,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=s[c]/255,o[c]=i[c]/255,l[c]=r[c]/255;return[a.join(","),o.join(","),l.join(",")]},Hu=function(t){if(u(this,hc)===void 0){x(this,hc,"");const s=u(this,Ln).URL;s!==u(this,Ln).baseURI&&(Pb(s)?ue('#createUrl: ignore "data:"-URL for performance reasons.'):x(this,hc,lM(s,"")))}return`url(${u(this,hc)}#${t})`},tI=function(t){const s=u(this,Ln).createElementNS(Hr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Mw=function(t){const s=u(this,Ln).createElementNS(Hr,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},ju=function(t){const s=u(this,Ln).createElementNS(Hr,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),u(this,W,zu).append(s),s},rp=function(t,s,i){const r=u(this,Ln).createElementNS(Hr,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},ap=function(t,s,i,r){const a=u(this,Ln).createElementNS(Hr,"feComponentTransfer");r.append(a),C(this,W,rp).call(this,a,"feFuncR",t),C(this,W,rp).call(this,a,"feFuncG",s),C(this,W,rp).call(this,a,"feFuncB",i)},Iw=function(t,s){const i=u(this,Ln).createElementNS(Hr,"feComponentTransfer");s.append(i),C(this,W,rp).call(this,i,"feFuncA",t)},op=function(t){return u(this,W,zu).style.color=t,c0(getComputedStyle(u(this,W,zu)).getPropertyValue("color"))};class nI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ze("Abstract method `_fetch` called.")}}class UT extends nI{async _fetch(e){const t=await o0(e,"arraybuffer");return new Uint8Array(t)}}class sI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Ze("Abstract method `_fetch` called.")}}class BT extends sI{async _fetch(e){const t=await o0(e,"arraybuffer");return new Uint8Array(t)}}$n&&ue("Please use the `legacy` build in Node.js environments.");async function fA(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class OU extends eI{}class UU extends QM{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class BU extends ZM{async _fetch(e){return fA(e)}}class FU extends nI{async _fetch(e){return fA(e)}}class zU extends sI{async _fetch(e){return fA(e)}}const Nu="__forcedDependency",{floor:FT,ceil:zT}=Math;function P0(n,e,t,s,i,r){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],s),n[e*4+2]=Math.max(n[e*4+2],i),n[e*4+3]=Math.max(n[e*4+3],r)}const Dw=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var rh,No;class HU{constructor(e,t){A(this,rh);A(this,No);x(this,rh,e),x(this,No,t)}get length(){return u(this,rh).length}isEmpty(e){return u(this,rh)[e]===Dw}minX(e){return u(this,No)[e*4+0]/256}minY(e){return u(this,No)[e*4+1]/256}maxX(e){return(u(this,No)[e*4+2]+1)/256}maxY(e){return(u(this,No)[e*4+3]+1)/256}}rh=new WeakMap,No=new WeakMap;const L0=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var is,rs,mc,Ui,gc,la,Be,qe,ca,as,Gm,ah,yc,vc,ua,On,gr,qm,Pw;class jU{constructor(e,t,s=!1){A(this,qm);A(this,is,{__proto__:null});A(this,rs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Nu]:[]});A(this,mc,new Map);A(this,Ui,[]);A(this,gc,[]);A(this,la,[[1,0,0,1,0,0]]);A(this,Be,[-1/0,-1/0,1/0,1/0]);A(this,qe,new Float64Array([1/0,1/0,-1/0,-1/0]));A(this,ca,-1);A(this,as,new Set);A(this,Gm,new Map);A(this,ah,new Map);A(this,yc);A(this,vc);A(this,ua);A(this,On);A(this,gr);x(this,yc,e.width),x(this,vc,e.height),C(this,qm,Pw).call(this,t),s&&x(this,gr,new Map)}growOperationsCount(e){e>=u(this,On).length&&C(this,qm,Pw).call(this,e,u(this,On))}save(e){return x(this,is,{__proto__:u(this,is)}),x(this,rs,{__proto__:u(this,rs),transform:{__proto__:u(this,rs).transform},moveText:{__proto__:u(this,rs).moveText},sameLineText:{__proto__:u(this,rs).sameLineText},[Nu]:{__proto__:u(this,rs)[Nu]}}),x(this,Be,{__proto__:u(this,Be)}),u(this,Ui).push(e),this}restore(e){var i;const t=Object.getPrototypeOf(u(this,is));if(t===null)return this;x(this,is,t),x(this,rs,Object.getPrototypeOf(u(this,rs))),x(this,Be,Object.getPrototypeOf(u(this,Be)));const s=u(this,Ui).pop();return s!==void 0&&((i=L0(u(this,gr),e))==null||i.dependencies.add(s),u(this,On)[e]=u(this,On)[s]),this}recordOpenMarker(e){return u(this,Ui).push(e),this}getOpenMarker(){return u(this,Ui).length===0?null:u(this,Ui).at(-1)}recordCloseMarker(e){var s;const t=u(this,Ui).pop();return t!==void 0&&((s=L0(u(this,gr),e))==null||s.dependencies.add(t),u(this,On)[e]=u(this,On)[t]),this}beginMarkedContent(e){return u(this,gc).push(e),this}endMarkedContent(e){var s;const t=u(this,gc).pop();return t!==void 0&&((s=L0(u(this,gr),e))==null||s.dependencies.add(t),u(this,On)[e]=u(this,On)[t]),this}pushBaseTransform(e){return u(this,la).push(X.multiplyByDOMMatrix(u(this,la).at(-1),e.getTransform())),this}popBaseTransform(){return u(this,la).length>1&&u(this,la).pop(),this}recordSimpleData(e,t){return u(this,is)[e]=t,this}recordIncrementalData(e,t){return u(this,rs)[e].push(t),this}resetIncrementalData(e,t){return u(this,rs)[e].length=0,this}recordNamedData(e,t){return u(this,mc).set(e,t),this}recordSimpleDataFromNamed(e,t,s){u(this,is)[e]=u(this,mc).get(t)??s}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Nu,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in u(this,is)&&this.recordFutureForcedDependency(t,u(this,is)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of u(this,as))this.recordFutureForcedDependency(Nu,e);return this}resetBBox(e){return u(this,ca)!==e&&(x(this,ca,e),u(this,qe)[0]=1/0,u(this,qe)[1]=1/0,u(this,qe)[2]=-1/0,u(this,qe)[3]=-1/0),this}recordClipBox(e,t,s,i,r,a){const o=X.multiplyByDOMMatrix(u(this,la).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];X.axialAlignedBoundingBox([s,r,i,a],o,l);const c=X.intersect(u(this,Be),l);return c?(u(this,Be)[0]=c[0],u(this,Be)[1]=c[1],u(this,Be)[2]=c[2],u(this,Be)[3]=c[3]):(u(this,Be)[0]=u(this,Be)[1]=1/0,u(this,Be)[2]=u(this,Be)[3]=-1/0),this}recordBBox(e,t,s,i,r,a){const o=u(this,Be);if(o[0]===1/0)return this;const l=X.multiplyByDOMMatrix(u(this,la).at(-1),t.getTransform());if(o[0]===-1/0)return X.axialAlignedBoundingBox([s,r,i,a],l,u(this,qe)),this;const c=[1/0,1/0,-1/0,-1/0];return X.axialAlignedBoundingBox([s,r,i,a],l,c),u(this,qe)[0]=Math.min(u(this,qe)[0],Math.max(c[0],o[0])),u(this,qe)[1]=Math.min(u(this,qe)[1],Math.max(c[1],o[1])),u(this,qe)[2]=Math.max(u(this,qe)[2],Math.min(c[2],o[2])),u(this,qe)[3]=Math.max(u(this,qe)[3],Math.min(c[3],o[3])),this}recordCharacterBBox(e,t,s,i=1,r=0,a=0,o){const l=s.bbox;let c,d;if(l&&(c=l[2]!==l[0]&&l[3]!==l[1]&&u(this,ah).get(s),c!==!1&&(d=[0,0,0,0],X.axialAlignedBoundingBox(l,s.fontMatrix,d),(i!==1||r!==0||a!==0)&&X.scaleMinMax([i,0,0,-i,r,a],d),c)))return this.recordBBox(e,t,d[0],d[2],d[1],d[3]);if(!o)return this.recordFullPageBBox(e);const h=o();return l&&d&&c===void 0&&(c=d[0]<=r-h.actualBoundingBoxLeft&&d[2]>=r+h.actualBoundingBoxRight&&d[1]<=a-h.actualBoundingBoxAscent&&d[3]>=a+h.actualBoundingBoxDescent,u(this,ah).set(s,c),c)?this.recordBBox(e,t,d[0],d[2],d[1],d[3]):this.recordBBox(e,t,r-h.actualBoundingBoxLeft,r+h.actualBoundingBoxRight,a-h.actualBoundingBoxAscent,a+h.actualBoundingBoxDescent)}recordFullPageBBox(e){return u(this,qe)[0]=Math.max(0,u(this,Be)[0]),u(this,qe)[1]=Math.max(0,u(this,Be)[1]),u(this,qe)[2]=Math.min(u(this,yc),u(this,Be)[2]),u(this,qe)[3]=Math.min(u(this,vc),u(this,Be)[3]),this}getSimpleIndex(e){return u(this,is)[e]}recordDependencies(e,t){const s=u(this,as),i=u(this,is),r=u(this,rs);for(const a of t)a in u(this,is)?s.add(i[a]):a in r&&r[a].forEach(s.add,s);return this}recordNamedDependency(e,t){return u(this,mc).has(t)&&u(this,as).add(u(this,mc).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Nu]),u(this,gr)){const s=L0(u(this,gr),e),{dependencies:i}=s;u(this,as).forEach(i.add,i),u(this,Ui).forEach(i.add,i),u(this,gc).forEach(i.add,i),i.delete(e),s.isRenderingOperation=!0}if(u(this,ca)===e){const s=FT(u(this,qe)[0]*256/u(this,yc)),i=FT(u(this,qe)[1]*256/u(this,vc)),r=zT(u(this,qe)[2]*256/u(this,yc)),a=zT(u(this,qe)[3]*256/u(this,vc));P0(u(this,ua),e,s,i,r,a);for(const o of u(this,as))o!==e&&P0(u(this,ua),o,s,i,r,a);for(const o of u(this,Ui))o!==e&&P0(u(this,ua),o,s,i,r,a);for(const o of u(this,gc))o!==e&&P0(u(this,ua),o,s,i,r,a);t||(u(this,as).clear(),x(this,ca,-1))}return this}recordShowTextOperation(e,t=!1){const s=Array.from(u(this,as));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of s)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return u(this,ca)===e&&(x(this,ca,-1),u(this,Be)[0]=Math.max(u(this,Be)[0],u(this,qe)[0]),u(this,Be)[1]=Math.max(u(this,Be)[1],u(this,qe)[1]),u(this,Be)[2]=Math.min(u(this,Be)[2],u(this,qe)[2]),u(this,Be)[3]=Math.min(u(this,Be)[3],u(this,qe)[3]),t||u(this,as).clear()),this}_takePendingDependencies(){const e=u(this,as);return x(this,as,new Set),e}_extractOperation(e){const t=u(this,Gm).get(e);return u(this,Gm).delete(e),t}_pushPendingDependencies(e){for(const t of e)u(this,as).add(t)}take(){return u(this,ah).clear(),new HU(u(this,On),u(this,ua))}takeDebugMetadata(){return u(this,gr)}}is=new WeakMap,rs=new WeakMap,mc=new WeakMap,Ui=new WeakMap,gc=new WeakMap,la=new WeakMap,Be=new WeakMap,qe=new WeakMap,ca=new WeakMap,as=new WeakMap,Gm=new WeakMap,ah=new WeakMap,yc=new WeakMap,vc=new WeakMap,ua=new WeakMap,On=new WeakMap,gr=new WeakMap,qm=new WeakSet,Pw=function(e,t){const s=new ArrayBuffer(e*4);x(this,ua,new Uint8ClampedArray(s)),x(this,On,new Uint32Array(s)),t&&t.length>0?(u(this,On).set(t),u(this,On).fill(Dw,t.length)):u(this,On).fill(Dw)};var We,Tt,Bi,oh,lh;const VA=class VA{constructor(e,t,s){A(this,We);A(this,Tt);A(this,Bi);A(this,oh,0);A(this,lh,0);if(e instanceof VA&&u(e,Bi)===!!s)return e;x(this,We,e),x(this,Tt,t),x(this,Bi,!!s)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Vt(this,lh)._++,u(this,We).save(u(this,Tt)),this}restore(e){return u(this,lh)>0&&(u(this,We).restore(u(this,Tt)),Vt(this,lh)._--),this}recordOpenMarker(e){return Vt(this,oh)._++,this}getOpenMarker(){return u(this,oh)>0?u(this,Tt):u(this,We).getOpenMarker()}recordCloseMarker(e){return Vt(this,oh)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return u(this,We).pushBaseTransform(e),this}popBaseTransform(){return u(this,We).popBaseTransform(),this}recordSimpleData(e,t){return u(this,We).recordSimpleData(e,u(this,Tt)),this}recordIncrementalData(e,t){return u(this,We).recordIncrementalData(e,u(this,Tt)),this}resetIncrementalData(e,t){return u(this,We).resetIncrementalData(e,u(this,Tt)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,s){return u(this,We).recordSimpleDataFromNamed(e,t,u(this,Tt)),this}recordFutureForcedDependency(e,t){return u(this,We).recordFutureForcedDependency(e,u(this,Tt)),this}inheritSimpleDataAsFutureForcedDependencies(e){return u(this,We).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return u(this,We).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return u(this,Bi)||u(this,We).resetBBox(u(this,Tt)),this}recordClipBox(e,t,s,i,r,a){return u(this,Bi)||u(this,We).recordClipBox(u(this,Tt),t,s,i,r,a),this}recordBBox(e,t,s,i,r,a){return u(this,Bi)||u(this,We).recordBBox(u(this,Tt),t,s,i,r,a),this}recordCharacterBBox(e,t,s,i,r,a,o){return u(this,Bi)||u(this,We).recordCharacterBBox(u(this,Tt),t,s,i,r,a,o),this}recordFullPageBBox(e){return u(this,Bi)||u(this,We).recordFullPageBBox(u(this,Tt)),this}getSimpleIndex(e){return u(this,We).getSimpleIndex(e)}recordDependencies(e,t){return u(this,We).recordDependencies(u(this,Tt),t),this}recordNamedDependency(e,t){return u(this,We).recordNamedDependency(u(this,Tt),t),this}recordOperation(e){return u(this,We).recordOperation(u(this,Tt),!0),this}recordShowTextOperation(e){return u(this,We).recordShowTextOperation(u(this,Tt),!0),this}bboxToClipBoxDropOperation(e){return u(this,Bi)||u(this,We).bboxToClipBoxDropOperation(u(this,Tt),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};We=new WeakMap,Tt=new WeakMap,Bi=new WeakMap,oh=new WeakMap,lh=new WeakMap;let Nv=VA;const ei={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},En={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Lw(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class pA{isModifyingCurrentTransform(){return!1}getPattern(){Ze("Abstract method `getPattern` called.")}}class GU extends pA{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let s,i=this._p0,r=this._p1;if(t&&(i=i.slice(),r=r.slice(),X.applyTransform(i,t),X.applyTransform(r,t)),this._type==="axial")s=e.createLinearGradient(i[0],i[1],r[0],r[1]);else if(this._type==="radial"){let a=this._r0,o=this._r1;if(t){const l=new Float32Array(2);X.singularValueDecompose2dScale(t,l),a*=l[0],o*=l[0]}s=e.createRadialGradient(i[0],i[1],a,r[0],r[1],o)}for(const a of this._colorStops)s.addColorStop(a[0],a[1]);return s}getPattern(e,t,s,i){let r;if(i===En.STROKE||i===En.FILL){if(this.isOriginBased()){let p=X.transform(s,t.baseTransform);this.matrix&&(p=X.transform(p,this.matrix));const y=.001,v=Math.hypot(p[0],p[1]),_=Math.hypot(p[2],p[3]),E=(p[0]*p[2]+p[1]*p[3])/(v*_);if(Math.abs(E)<y)if(this.isRadial()){if(Math.abs(v-_)<y)return this._createGradient(e,p)}else return this._createGradient(e,p)}const a=t.current.getClippedPathBoundingBox(i,vt(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),s=X.transform(s,[1,0,0,1,a[0],a[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Lw(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),r=e.createPattern(c.canvas,"no-repeat");const h=new DOMMatrix(s);r.setTransform(h)}else Lw(e,this._bbox),r=this._createGradient(e);return r}}function G_(n,e,t,s,i,r,a,o){const l=e.coords,c=e.colors,d=n.data,h=n.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p),l[s+1]>l[i+1]&&(p=s,s=i,i=p,p=a,a=o,o=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p);const y=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,_=(l[s]+e.offsetX)*e.scaleX,E=(l[s+1]+e.offsetY)*e.scaleY,b=(l[i]+e.offsetX)*e.scaleX,w=(l[i+1]+e.offsetY)*e.scaleY;if(v>=w)return;const S=c[r],T=c[r+1],N=c[r+2],R=c[a],k=c[a+1],I=c[a+2],M=c[o],D=c[o+1],O=c[o+2],L=Math.round(v),$=Math.round(w);let G,ee,P,F,H,U,K,se;for(let le=L;le<=$;le++){if(le<E){const ht=le<v?0:(v-le)/(v-E);G=y-(y-_)*ht,ee=S-(S-R)*ht,P=T-(T-k)*ht,F=N-(N-I)*ht}else{let ht;le>w?ht=1:E===w?ht=0:ht=(E-le)/(E-w),G=_-(_-b)*ht,ee=R-(R-M)*ht,P=k-(k-D)*ht,F=I-(I-O)*ht}let he;le<v?he=0:le>w?he=1:he=(v-le)/(v-w),H=y-(y-b)*he,U=S-(S-M)*he,K=T-(T-D)*he,se=N-(N-O)*he;const Je=Math.round(Math.min(G,H)),Le=Math.round(Math.max(G,H));let wt=h*le+Je*4;for(let ht=Je;ht<=Le;ht++)he=(G-ht)/(G-H),he<0?he=0:he>1&&(he=1),d[wt++]=ee-(ee-U)*he|0,d[wt++]=P-(P-K)*he|0,d[wt++]=F-(F-se)*he|0,d[wt++]=255}}function qU(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case aw.LATTICE:const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,c=o-1;for(r=0;r<l;r++){let d=r*o;for(let h=0;h<c;h++,d++)G_(n,t,s[d],s[d+1],s[d+o],i[d],i[d+1],i[d+o]),G_(n,t,s[d+o+1],s[d+1],s[d+o],i[d+o+1],i[d+1],i[d+o])}break;case aw.TRIANGLES:for(r=0,a=s.length;r<a;r+=3)G_(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class VU extends pA{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-l,h=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),y=c/h,v=d/p,_={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/y,scaleY:1/v},E=h+2*2,b=p+2*2,w=s.getCanvas("mesh",E,b),S=w.context,T=S.createImageData(h,p);if(t){const R=T.data;for(let k=0,I=R.length;k<I;k+=4)R[k]=t[0],R[k+1]=t[1],R[k+2]=t[2],R[k+3]=255}for(const R of this._figures)qU(T,R,_);return S.putImageData(T,2,2),{canvas:w.canvas,offsetX:o-2*y,offsetY:l-2*v,scaleX:y,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,s,i){Lw(e,this._bbox);const r=new Float32Array(2);if(i===En.SHADING)X.singularValueDecompose2dScale(vt(e),r);else if(this.matrix){X.singularValueDecompose2dScale(this.matrix,r);const[o,l]=r;X.singularValueDecompose2dScale(t.baseTransform,r),r[0]*=o,r[1]*=l}else X.singularValueDecompose2dScale(t.baseTransform,r);const a=this._createMeshCanvas(r,i===En.SHADING?null:this._background,t.cachedCanvases);return i!==En.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class $U extends pA{getPattern(){return"hotpink"}}function YU(n){switch(n[0]){case"RadialAxial":return new GU(n);case"Mesh":return new VU(n);case"Dummy":return new $U}throw new Error(`Unknown IR type: ${n[0]}`)}const HT={COLORED:1,UNCOLORED:2},tb=class tb{constructor(e,t,s,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=s,this.baseTransform=i}createPatternCanvas(e,t){var U,K;const{bbox:s,operatorList:i,paintType:r,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:d}=this;c=Math.abs(c),d=Math.abs(d),Db("TilingType: "+a);const h=s[0],p=s[1],y=s[2],v=s[3],_=y-h,E=v-p,b=new Float32Array(2);X.singularValueDecompose2dScale(this.matrix,b);const[w,S]=b;X.singularValueDecompose2dScale(this.baseTransform,b);const T=w*b[0],N=S*b[1];let R=_,k=E,I=!1,M=!1;const D=Math.ceil(c*T),O=Math.ceil(d*N),L=Math.ceil(_*T),$=Math.ceil(E*N);D>=L?R=c:I=!0,O>=$?k=d:M=!0;const G=this.getSizeAndScale(R,this.ctx.canvas.width,T),ee=this.getSizeAndScale(k,this.ctx.canvas.height,N),P=e.cachedCanvases.getCanvas("pattern",G.size,ee.size),F=P.context,H=l.createCanvasGraphics(F,t);if(H.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(H,r,o),F.translate(-G.scale*h,-ee.scale*p),H.transform(0,G.scale,0,0,ee.scale,0,0),F.save(),(U=H.dependencyTracker)==null||U.save(),this.clipBbox(H,h,p,y,v),H.baseTransform=vt(H.ctx),H.executeOperatorList(i),H.endDrawing(),(K=H.dependencyTracker)==null||K.restore(),F.restore(),I||M){const se=P.canvas;I&&(R=c),M&&(k=d);const le=this.getSizeAndScale(R,this.ctx.canvas.width,T),he=this.getSizeAndScale(k,this.ctx.canvas.height,N),Je=le.size,Le=he.size,wt=e.cachedCanvases.getCanvas("pattern-workaround",Je,Le),ht=wt.context,Nf=I?Math.floor(_/c):0,Au=M?Math.floor(E/d):0;for(let Sl=0;Sl<=Nf;Sl++)for(let er=0;er<=Au;er++)ht.drawImage(se,Je*Sl,Le*er,Je,Le,0,0,Je,Le);return{canvas:wt.canvas,scaleX:le.scale,scaleY:he.scale,offsetX:h,offsetY:p}}return{canvas:P.canvas,scaleX:G.scale,scaleY:ee.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,s){const i=Math.max(tb.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),X.axialAlignedBoundingBox([t,s,i,r],vt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case HT.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;i.fillStyle=r.fillColor=a,i.strokeStyle=r.strokeColor=o;break;case HT.UNCOLORED:i.fillStyle=i.strokeStyle=s,r.fillColor=r.strokeColor=s;break;default:throw new rU(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,s,i,r){let a=s;i!==En.SHADING&&(a=X.transform(a,t.baseTransform),this.matrix&&(a=X.transform(a,this.matrix)));const o=this.createPatternCanvas(t,r);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");return c.setTransform(l),c}};z(tb,"MAX_PATTERN_SIZE",3e3);let Ow=tb;function KU({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=en.isLittleEndian?4278190080:255,[l,c]=a?[r,o]:[o,r],d=s>>3,h=s&7,p=n.length;t=new Uint32Array(t.buffer);let y=0;for(let v=0;v<i;v++){for(const E=e+d;e<E;e++){const b=e<p?n[e]:255;t[y++]=b&128?c:l,t[y++]=b&64?c:l,t[y++]=b&32?c:l,t[y++]=b&16?c:l,t[y++]=b&8?c:l,t[y++]=b&4?c:l,t[y++]=b&2?c:l,t[y++]=b&1?c:l}if(h===0)continue;const _=e<p?n[e++]:255;for(let E=0;E<h;E++)t[y++]=_&1<<7-E?c:l}return{srcPos:e,destPos:y}}const jT=16,GT=100,JU=15,qT=10,ds=16,q_=new DOMMatrix,Fs=new Float32Array(2),ld=new Float32Array([1/0,1/0,-1/0,-1/0]);function XU(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,s){e.translate(t,s),this.__originalTranslate(t,s)},n.scale=function(t,s){e.scale(t,s),this.__originalScale(t,s)},n.transform=function(t,s,i,r,a,o){e.transform(t,s,i,r,a,o),this.__originalTransform(t,s,i,r,a,o)},n.setTransform=function(t,s,i,r,a,o){e.setTransform(t,s,i,r,a,o),this.__originalSetTransform(t,s,i,r,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class WU{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function O0(n,e,t,s,i,r,a,o,l,c){const[d,h,p,y,v,_]=vt(n);if(h===0&&p===0){const w=a*d+v,S=Math.round(w),T=o*y+_,N=Math.round(T),R=(a+l)*d+v,k=Math.abs(Math.round(R)-S)||1,I=(o+c)*y+_,M=Math.abs(Math.round(I)-N)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(y),S,N),n.drawImage(e,t,s,i,r,0,0,k,M),n.setTransform(d,h,p,y,v,_),[k,M]}if(d===0&&y===0){const w=o*p+v,S=Math.round(w),T=a*h+_,N=Math.round(T),R=(o+c)*p+v,k=Math.abs(Math.round(R)-S)||1,I=(a+l)*h+_,M=Math.abs(Math.round(I)-N)||1;return n.setTransform(0,Math.sign(h),Math.sign(p),0,S,N),n.drawImage(e,t,s,i,r,0,0,M,k),n.setTransform(d,h,p,y,v,_),[M,k]}n.drawImage(e,t,s,i,r,a,o,l,c);const E=Math.hypot(d,h),b=Math.hypot(p,y);return[E*l,b*c]}class VT{constructor(e,t,s){z(this,"alphaIsShape",!1);z(this,"fontSize",0);z(this,"fontSizeScale",1);z(this,"textMatrix",null);z(this,"textMatrixScale",1);z(this,"fontMatrix",rw);z(this,"leading",0);z(this,"x",0);z(this,"y",0);z(this,"lineX",0);z(this,"lineY",0);z(this,"charSpacing",0);z(this,"wordSpacing",0);z(this,"textHScale",1);z(this,"textRenderingMode",$t.FILL);z(this,"textRise",0);z(this,"fillColor","#000000");z(this,"strokeColor","#000000");z(this,"patternFill",!1);z(this,"patternStroke",!1);z(this,"fillAlpha",1);z(this,"strokeAlpha",1);z(this,"lineWidth",1);z(this,"activeSMask",null);z(this,"transferMaps","none");s==null||s(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=ld.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=En.FILL,t=null){const s=this.minMax.slice();if(e===En.STROKE){t||Ze("Stroke bounding box must include transform."),X.singularValueDecompose2dScale(t,Fs);const i=Fs[0]*this.lineWidth/2,r=Fs[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=X.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(ld,0)}getClippedPathBoundingBox(e=En.FILL,t=null){return X.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function $T(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%ds,r=(t-i)/ds,a=i===0?r:r+1,o=n.createImageData(s,ds);let l=0,c;const d=e.data,h=o.data;let p,y,v,_;if(e.kind===dy.GRAYSCALE_1BPP){const E=d.byteLength,b=new Uint32Array(h.buffer,0,h.byteLength>>2),w=b.length,S=s+7>>3,T=4294967295,N=en.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(v=p<r?ds:i,c=0,y=0;y<v;y++){const R=E-l;let k=0;const I=R>S?s:R*8-7,M=I&-8;let D=0,O=0;for(;k<M;k+=8)O=d[l++],b[c++]=O&128?T:N,b[c++]=O&64?T:N,b[c++]=O&32?T:N,b[c++]=O&16?T:N,b[c++]=O&8?T:N,b[c++]=O&4?T:N,b[c++]=O&2?T:N,b[c++]=O&1?T:N;for(;k<I;k++)D===0&&(O=d[l++],D=128),b[c++]=O&D?T:N,D>>=1}for(;c<w;)b[c++]=0;n.putImageData(o,0,p*ds)}}else if(e.kind===dy.RGBA_32BPP){for(y=0,_=s*ds*4,p=0;p<r;p++)h.set(d.subarray(l,l+_)),l+=_,n.putImageData(o,0,y),y+=ds;p<a&&(_=s*i*4,h.set(d.subarray(l,l+_)),n.putImageData(o,0,y))}else if(e.kind===dy.RGB_24BPP)for(v=ds,_=s*v,p=0;p<a;p++){for(p>=r&&(v=i,_=s*v),c=0,y=_;y--;)h[c++]=d[l++],h[c++]=d[l++],h[c++]=d[l++],h[c++]=255;n.putImageData(o,0,p*ds)}else throw new Error(`bad image kind: ${e.kind}`)}function YT(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%ds,r=(t-i)/ds,a=i===0?r:r+1,o=n.createImageData(s,ds);let l=0;const c=e.data,d=o.data;for(let h=0;h<a;h++){const p=h<r?ds:i;({srcPos:l}=KU({src:c,srcPos:l,dest:d,width:s,height:p,nonBlackColor:0})),n.putImageData(o,0,h*ds)}}function Uf(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function U0(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function KT(n,e){if(e)return!0;X.singularValueDecompose2dScale(n,Fs);const t=Math.fround(Ir.pixelRatio*vl.PDF_TO_CSS_UNITS);return Fs[0]<=t&&Fs[1]<=t}const QU=["butt","round","square"],ZU=["miter","round","bevel"],e5={},JT={};var Wi,Uw,Bw,Fw;const $A=class $A{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},l,c,d){A(this,Wi);this.ctx=e,this.current=new VT(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new WU(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=d??null}getObject(e,t,s=null){var i;return typeof t=="string"?((i=this.dependencyTracker)==null||i.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):s}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...vt(this.compositeCtx))}this.ctx.save(),U0(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=vt(this.ctx)}executeOperatorList(e,t,s,i,r){var b;const a=e.argsArray,o=e.fnArray;let l=t||0;const c=a.length;if(c===l)return l;const d=c-l>qT&&typeof s=="function",h=d?Date.now()+JU:0;let p=0;const y=this.commonObjs,v=this.objs;let _,E;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,s),l;if(!r||r(l))if(_=o[l],E=a[l]??null,_!==Jp.dependency)E===null?this[_](l):this[_](l,...E);else for(const w of E){(b=this.dependencyTracker)==null||b.recordNamedData(w,l);const S=w.startsWith("g_")?y:v;if(!S.has(w))return S.get(w,s),l}if(l++,l===c)return l;if(d&&++p>qT){if(Date.now()>h)return s(),l;p=0}}}endDrawing(){C(this,Wi,Uw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),C(this,Wi,Bw).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=i,c="prescale1",d,h;for(;r>2&&o>1||a>2&&l>1;){let p=o,y=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(y=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/y),d=this.cachedCanvases.getCanvas(c,p,y),h=d.context,h.clearRect(0,0,p,y),h.drawImage(e,0,0,o,l,0,0,p,y),e=d.canvas,o=p,l=y,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var D,O;const s=this.ctx,{width:i,height:r}=t,a=this.current.fillColor,o=this.current.patternFill,l=vt(s);let c,d,h,p;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;d=JSON.stringify(o?l:[l.slice(0,4),a]),c=this._cachedBitmapsMap.get(L),c||(c=new Map,this._cachedBitmapsMap.set(L,c));const $=c.get(d);if($&&!o){const G=Math.round(Math.min(l[0],l[2])+l[4]),ee=Math.round(Math.min(l[1],l[3])+l[5]);return(D=this.dependencyTracker)==null||D.recordDependencies(e,ei.transformAndFill),{canvas:$,offsetX:G,offsetY:ee}}h=$}h||(p=this.cachedCanvases.getCanvas("maskCanvas",i,r),YT(p.context,t));let y=X.transform(l,[1/i,0,0,-1/r,0,0]);y=X.transform(y,[1,0,0,1,0,-r]);const v=ld.slice();X.axialAlignedBoundingBox([0,0,i,r],y,v);const[_,E,b,w]=v,S=Math.round(b-_)||1,T=Math.round(w-E)||1,N=this.cachedCanvases.getCanvas("fillCanvas",S,T),R=N.context,k=_,I=E;R.translate(-k,-I),R.transform(...y),h||(h=this._scaleImage(p.canvas,nr(R)),h=h.img,c&&o&&c.set(d,h)),R.imageSmoothingEnabled=KT(vt(R),t.interpolate),O0(R,h,0,0,h.width,h.height,0,0,i,r),R.globalCompositeOperation="source-in";const M=X.transform(nr(R),[1,0,0,1,-k,-I]);return R.fillStyle=o?a.getPattern(s,this,M,En.FILL,e):a,R.fillRect(0,0,i,r),c&&!o&&(this.cachedCanvases.delete("fillCanvas"),c.set(d,N.canvas)),(O=this.dependencyTracker)==null||O.recordDependencies(e,ei.transformAndFill),{canvas:N.canvas,offsetX:Math.round(k),offsetY:Math.round(I)}}setLineWidth(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineCap",e),this.ctx.lineCap=QU[t]}setLineJoin(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("lineJoin",e),this.ctx.lineJoin=ZU[t]}setMiterLimit(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,s){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=s)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var s,i,r,a,o;for(const[l,c]of t)switch(l){case"LW":this.setLineWidth(e,c);break;case"LC":this.setLineCap(e,c);break;case"LJ":this.setLineJoin(e,c);break;case"ML":this.setMiterLimit(e,c);break;case"D":this.setDash(e,c[0],c[1]);break;case"RI":this.setRenderingIntent(e,c);break;case"FL":this.setFlatness(e,c);break;case"Font":this.setFont(e,c[0],c[1]);break;case"CA":(s=this.dependencyTracker)==null||s.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=c;break;case"ca":(i=this.dependencyTracker)==null||i.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=c;break;case"BM":(r=this.dependencyTracker)==null||r.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=c;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,s);this.suspendedCtx=this.ctx;const a=this.ctx=r.context;a.setTransform(this.suspendedCtx.getTransform()),Uf(this.suspendedCtx,a),XU(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Uf(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,l,c,d,h){let p=e.canvas,y=l-d,v=c-h;if(a)if(y<0||v<0||y+s>p.width||v+i>p.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,i),b=E.context;b.drawImage(p,-y,-v),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,s,i),b.globalCompositeOperation="source-over",p=E.canvas,y=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(y,v,s,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(y,v,s,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const _=new Path2D;_.rect(l,c,s,i),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(p,y,v,s,i,l,c,s,i),t.restore()}save(e){var s;this.inSMaskMode&&Uf(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(s=this.dependencyTracker)==null||s.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Uf(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,s,i,r,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,s,i,r,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s,i){let[r]=s;if(!i){r||(r=s[0]=new Path2D),this[t](e,r);return}if(this.dependencyTracker!==null){const a=t===Jp.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}r instanceof Path2D||(r=s[0]=pM(r)),X.axialAlignedBoundingBox(i,vt(this.ctx),this.current.minMax),this[t](e,r),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,s=!0){var a;const i=this.ctx,r=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const o=r.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=r.getPattern(i,this,nr(i),En.STROKE,e),o){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,ei.stroke),s&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(En.STROKE,vt(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,s=!0){var c,d,h;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const p=r.isModifyingCurrentTransform()?i.getTransform():null;if((c=this.dependencyTracker)==null||c.save(e),i.save(),i.fillStyle=r.getPattern(i,this,nr(i),En.FILL,e),p){const y=new Path2D;y.addPath(t,i.getTransform().invertSelf().multiplySelf(p)),t=y}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),(d=this.dependencyTracker)==null||d.recordDependencies(e,ei.fill),o&&(i.restore(),(h=this.dependencyTracker)==null||h.restore(e)),s&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var s;this.ctx.fill(t),(s=this.dependencyTracker)==null||s.recordDependencies(e,ei.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=e5}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=JT}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,s=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,r=s.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:c,path:d}of t)d&&i.addPath(d,new DOMMatrix(a).preMultiplySelf(r).translate(o,l).scale(c,-c));s.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,s){var h,p;(h=this.dependencyTracker)==null||h.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),r=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=i.fontMatrix||rw,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&ue("Invalid font matrix for font "+t),s<0?(s=-s,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const a=i.loadedName||"sans-serif",o=((p=i.systemFontInfo)==null?void 0:p.css)||`"${a}", ${i.fallbackName}`;let l="normal";i.black?l="900":i.bold&&(l="bold");const c=i.italic?"italic":"normal";let d=s;s<jT?d=jT:s>GT&&(d=GT),this.current.fontSizeScale=s/d,this.ctx.font=`${c} ${l} ${d}px ${o}`}setTextRenderingMode(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,s){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(e,t,s){this.setLeading(e,-s),this.moveText(e,t,s)}setTextMatrix(e,t){var i;(i=this.dependencyTracker)==null||i.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:s}=this;s.textMatrix=t,s.textMatrixScale=Math.hypot(t[0],t[1]),s.x=s.lineX=0,s.y=s.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,s,i,r,a){var b,w,S,T;const o=this.ctx,l=this.current,c=l.font,d=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,p=d&$t.FILL_STROKE_MASK,y=!!(d&$t.ADD_TO_PATH_FLAG),v=l.patternFill&&!c.missingFile,_=l.patternStroke&&!c.missingFile;let E;if((c.disableFontFace||y||v||_)&&!c.missingFile&&(E=c.getPathGenerator(this.commonObjs,t)),E&&(c.disableFontFace||v||_)){o.save(),o.translate(s,i),o.scale(h,-h),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,c);let N;if(p===$t.FILL||p===$t.FILL_STROKE)if(r){N=o.getTransform(),o.setTransform(...r);const R=C(this,Wi,Fw).call(this,E,N,r);o.fill(R)}else o.fill(E);if(p===$t.STROKE||p===$t.FILL_STROKE)if(a){N||(N=o.getTransform()),o.setTransform(...a);const{a:R,b:k,c:I,d:M}=N,D=X.inverseTransform(a),O=X.transform([R,k,I,M,0,0],D);X.singularValueDecompose2dScale(O,Fs),o.lineWidth*=Math.max(Fs[0],Fs[1])/h,o.stroke(C(this,Wi,Fw).call(this,E,N,a))}else o.lineWidth/=h,o.stroke(E);o.restore()}else(p===$t.FILL||p===$t.FILL_STROKE)&&(o.fillText(t,s,i),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,c,h,s,i,()=>o.measureText(t))),(p===$t.STROKE||p===$t.FILL_STROKE)&&(this.dependencyTracker&&((S=this.dependencyTracker)==null||S.recordCharacterBBox(e,o,c,h,s,i,()=>o.measureText(t)).recordDependencies(e,ei.stroke)),o.strokeText(t,s,i));y&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:vt(o),x:s,y:i,fontSize:h,path:E}),(T=this.dependencyTracker)==null||T.recordCharacterBBox(e,o,c,h,s,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return de(this,"isFontSubpixelAAEnabled",s)}showText(e,t){var O,L,$,G;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,ei.showText).resetBBox(e),this.current.textRenderingMode&$t.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const s=this.current,i=s.font;if(i.isType3Font){this.showType3Text(e,t),(O=this.dependencyTracker)==null||O.recordShowTextOperation(e);return}const r=s.fontSize;if(r===0){(L=this.dependencyTracker)==null||L.recordOperation(e);return}const a=this.ctx,o=s.fontSizeScale,l=s.charSpacing,c=s.wordSpacing,d=s.fontDirection,h=s.textHScale*d,p=t.length,y=i.vertical,v=y?1:-1,_=i.defaultVMetrics,E=r*s.fontMatrix[0],b=s.textRenderingMode===$t.FILL&&!i.disableFontFace&&!s.patternFill;a.save(),s.textMatrix&&a.transform(...s.textMatrix),a.translate(s.x,s.y+s.textRise),d>0?a.scale(h,-1):a.scale(h,1);let w,S;const T=s.textRenderingMode&$t.FILL_STROKE_MASK,N=T===$t.FILL||T===$t.FILL_STROKE,R=T===$t.STROKE||T===$t.FILL_STROKE;if(N&&s.patternFill){a.save();const ee=s.fillColor.getPattern(a,this,nr(a),En.FILL,e);w=vt(a),a.restore(),a.fillStyle=ee}if(R&&s.patternStroke){a.save();const ee=s.strokeColor.getPattern(a,this,nr(a),En.STROKE,e);S=vt(a),a.restore(),a.strokeStyle=ee}let k=s.lineWidth;const I=s.textMatrixScale;if(I===0||k===0?R&&(k=this.getSinglePixelWidth()):k/=I,o!==1&&(a.scale(o,o),k/=o),a.lineWidth=k,i.isInvalidPDFjsFont){const ee=[];let P=0;for(const H of t)ee.push(H.unicode),P+=H.width;const F=ee.join("");if(a.fillText(F,0,0),this.dependencyTracker!==null){const H=a.measureText(F);this.dependencyTracker.recordBBox(e,this.ctx,-H.actualBoundingBoxLeft,H.actualBoundingBoxRight,-H.actualBoundingBoxAscent,H.actualBoundingBoxDescent).recordShowTextOperation(e)}s.x+=P*E*h,a.restore(),this.compose();return}let M=0,D;for(D=0;D<p;++D){const ee=t[D];if(typeof ee=="number"){M+=v*ee*r/1e3;continue}let P=!1;const F=(ee.isSpace?c:0)+l,H=ee.fontChar,U=ee.accent;let K,se,le=ee.width;if(y){const Le=ee.vmetric||_,wt=-(ee.vmetric?Le[1]:le*.5)*E,ht=Le[2]*E;le=Le?-Le[0]:le,K=wt/o,se=(M+ht)/o}else K=M/o,se=0;let he;if(i.remeasure&&le>0){he=a.measureText(H);const Le=he.width*1e3/r*o;if(le<Le&&this.isFontSubpixelAAEnabled){const wt=le/Le;P=!0,a.save(),a.scale(wt,1),K/=wt}else le!==Le&&(K+=(le-Le)/2e3*r/o)}if(this.contentVisible&&(ee.isInFont||i.missingFile)){if(b&&!U)a.fillText(H,K,se),($=this.dependencyTracker)==null||$.recordCharacterBBox(e,a,he?{bbox:null}:i,r/o,K,se,()=>he??a.measureText(H));else if(this.paintChar(e,H,K,se,w,S),U){const Le=K+r*U.offset.x/o,wt=se-r*U.offset.y/o;this.paintChar(e,U.fontChar,Le,wt,w,S)}}const Je=y?le*E-F*d:le*E+F*d;M+=Je,P&&a.restore()}y?s.y-=M:s.x+=M*h,a.restore(),this.compose(),(G=this.dependencyTracker)==null||G.recordShowTextOperation(e)}showType3Text(e,t){const s=this.ctx,i=this.current,r=i.font,a=i.fontSize,o=i.fontDirection,l=r.vertical?1:-1,c=i.charSpacing,d=i.wordSpacing,h=i.textHScale*o,p=i.fontMatrix||rw,y=t.length,v=i.textRenderingMode===$t.INVISIBLE;let _,E,b,w;if(v||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),i.textMatrix&&s.transform(...i.textMatrix),s.translate(i.x,i.y+i.textRise),s.scale(h,o);const S=this.dependencyTracker;for(this.dependencyTracker=S?new Nv(S,e):null,_=0;_<y;++_){if(E=t[_],typeof E=="number"){w=l*E*a/1e3,this.ctx.translate(w,0),i.x+=w*h;continue}const T=(E.isSpace?d:0)+c,N=r.charProcOperatorList[E.operatorListId];N?this.contentVisible&&(this.save(),s.scale(a,a),s.transform(...p),this.executeOperatorList(N),this.restore()):ue(`Type3 character "${E.operatorListId}" is not available.`);const R=[E.width,0];X.applyTransform(R,p),b=R[0]*a+T,s.translate(b,0),i.x+=b*h}s.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,s){}setCharWidthAndBounds(e,t,s,i,r,a,o){var c;const l=new Path2D;l.rect(i,r,a-i,o-r),this.ctx.clip(l),(c=this.dependencyTracker)==null||c.recordBBox(e,this.ctx,i,a,r,o).recordClipBox(e,this.ctx,i,a,r,o),this.endPath(e)}getColorN_Pattern(e,t){let s;if(t[0]==="TilingPattern"){const i=this.baseTransform||vt(this.ctx),r={createCanvasGraphics:(a,o)=>new $A(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Nv(this.dependencyTracker,o,!0):null)};s=new Ow(t,this.ctx,r,i)}else s=this._getPattern(e,t[1],t[2]);return s}setStrokeColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,s=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=YU(this.getObject(e,t)),this.cachedPatterns.set(t,i)),s&&(i.matrix=s),i}shadingFill(e,t){var a;if(!this.contentVisible)return;const s=this.ctx;this.save(e);const i=this._getPattern(e,t);s.fillStyle=i.getPattern(s,this,nr(s),En.SHADING,e);const r=nr(s);if(r){const{width:o,height:l}=s.canvas,c=ld.slice();X.axialAlignedBoundingBox([0,0,o,l],r,c);const[d,h,p,y]=c;this.ctx.fillRect(d,h,p-d,y-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,ei.transform).recordDependencies(e,ei.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Ze("Should not call beginInlineImage")}beginImageData(){Ze("Should not call beginImageData")}paintFormXObjectBegin(e,t,s){var i;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=vt(this.ctx),s)){X.axialAlignedBoundingBox(s,this.baseTransform,this.current.minMax);const[r,a,o,l]=s,c=new Path2D;c.rect(r,a,o-r,l-a),this.ctx.clip(c),(i=this.dependencyTracker)==null||i.recordClipBox(e,this.ctx,r,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var S;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||Db("TODO: Support non-isolated groups."),t.knockout&&ue("Knockout groups not supported.");const i=vt(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=ld.slice();X.axialAlignedBoundingBox(t.bbox,vt(s),r);const a=[0,0,s.canvas.width,s.canvas.height];r=X.intersect(r,a)||[0,0,0,0];const o=Math.floor(r[0]),l=Math.floor(r[1]),c=Math.max(Math.ceil(r[2])-o,1),d=Math.max(Math.ceil(r[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,d]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,c,d),y=p.context;y.translate(-o,-l),y.transform(...i);let v=new Path2D;const[_,E,b,w]=t.bbox;if(v.rect(_,E,b-_,w-E),t.matrix){const T=new Path2D;T.addPath(v,new DOMMatrix(t.matrix)),v=T}y.clip(v),t.smask&&this.smaskStack.push({canvas:p.canvas,context:y,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(s.setTransform(1,0,0,1,0,0),s.translate(o,l),s.save()),Uf(s,y),this.ctx=y,(S=this.dependencyTracker)==null||S.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(s),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(e,t){var r;if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,(r=this.dependencyTracker)==null||r.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=vt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=ld.slice();X.axialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],a,o),this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,s,i,r,a){if(C(this,Wi,Uw).call(this),U0(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const o=s[2]-s[0],l=s[3]-s[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=s[0],i[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=o,s[3]=l,X.singularValueDecompose2dScale(vt(this.ctx),Fs);const{viewportScale:c}=this,d=Math.ceil(o*this.outputScaleX*c),h=Math.ceil(l*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:p,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(Fs[0],0,0,-Fs[1],0,l*Fs[1]),U0(this.ctx)}else{U0(this.ctx),this.endPath(e);const c=new Path2D;c.rect(s[0],s[1],o,l),this.ctx.clip(c)}}this.current=new VT(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...r)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),C(this,Wi,Bw).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const s=t.count;t=this.getObject(e,t.data,t),t.count=s;const i=this.ctx,r=this._createMaskCanvas(e,t),a=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,r.offsetX,r.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,r.offsetX,r.offsetX+a.width,r.offsetY,r.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s,i=0,r=0,a,o){var h,p,y;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const c=vt(l);l.transform(s,i,r,a,0,0);const d=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,d.offsetX-c[4],d.offsetY-c[5]),(h=this.dependencyTracker)==null||h.resetBBox(e);for(let v=0,_=o.length;v<_;v+=2){const E=X.transform(c,[s,i,r,a,o[v],o[v+1]]);l.drawImage(d.canvas,E[4],E[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,E[4],E[4]+d.canvas.width,E[5],E[5]+d.canvas.height)}l.restore(),this.compose(),(y=this.dependencyTracker)==null||y.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const s=this.ctx,i=this.current.fillColor,r=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,ei.transformAndFill);for(const c of t){const{data:d,width:h,height:p,transform:y}=c,v=this.cachedCanvases.getCanvas("maskCanvas",h,p),_=v.context;_.save();const E=this.getObject(e,d,c);YT(_,E),_.globalCompositeOperation="source-in",_.fillStyle=r?i.getPattern(_,this,nr(s),En.FILL,e):i,_.fillRect(0,0,h,p),_.restore(),s.save(),s.transform(...y),s.scale(1,-1),O0(s,v.canvas,0,0,h,p,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,h,0,p),s.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const s=this.getObject(e,t);if(!s){ue("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,s)}paintImageXObjectRepeat(e,t,s,i,r){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){ue("Dependent image isn't ready yet");return}const o=a.width,l=a.height,c=[];for(let d=0,h=r.length;d<h;d+=2)c.push({transform:[s,0,0,i,r[d],r[d+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e,t){var c;if(!this.contentVisible)return;const s=t.width,i=t.height,r=this.ctx;this.save(e);const{filter:a}=r;a!=="none"&&a!==""&&(r.filter="none"),r.scale(1/s,-1/i);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",s,i).context;$T(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,nr(r));r.imageSmoothingEnabled=KT(vt(r),t.interpolate),(c=this.dependencyTracker)==null||c.resetBBox(e).recordBBox(e,r,0,s,-i,0).recordDependencies(e,ei.imageXObject).recordOperation(e),O0(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-i,s,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,s){var a,o,l;if(!this.contentVisible)return;const i=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const c=t.width,d=t.height,p=this.cachedCanvases.getCanvas("inlineImage",c,d).context;$T(p,t),r=this.applyTransferMapsToCanvas(p)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const c of s)i.save(),i.transform(...c.transform),i.scale(1,-1),O0(i,r,c.x,c.y,c.w,c.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,i,0,1,-1,0),i.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,ei.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,s){}beginMarkedContent(e,t){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,s){var i;(i=this.dependencyTracker)==null||i.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,s){var a,o;const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const r=this.ctx;this.pendingClip?(i||(this.pendingClip===JT?r.clip(t,"evenodd"):r.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=vt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const l=Math.abs(t),c=Math.abs(r);if(l===c)if(e===0)a=o=1/l;else{const d=l*e;a=o=d<1?1/d:1}else if(e===0)a=1/l,o=1/c;else{const d=l*e,h=c*e;a=d<1?1/d:1,o=h<1?1/h:1}}else{const l=Math.abs(t*r-s*i),c=Math.hypot(t,s),d=Math.hypot(i,r);if(e===0)a=d/l,o=c/l;else{const h=e*l;a=d>h?d/h:1,o=c>h?c/h:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:s,current:{lineWidth:i}}=this,[r,a]=this.getScaleForStroking();if(r===a){s.lineWidth=(i||1)*r,s.stroke(e);return}const o=s.getLineDash();t&&s.save(),s.scale(r,a),q_.a=1/r,q_.d=1/a;const l=new Path2D;if(l.addPath(e,q_),o.length>0){const c=Math.max(r,a);s.setLineDash(o.map(d=>d/c)),s.lineDashOffset/=c}s.lineWidth=i||1,s.stroke(l),t&&s.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Wi=new WeakSet,Uw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Bw=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Fw=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let Sd=$A;for(const n in Jp)Sd.prototype[n]!==void 0&&(Sd.prototype[Jp[n]]=Sd.prototype[n]);var Vm,$m;class Cr{static get workerPort(){return u(this,Vm)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");x(this,Vm,e)}static get workerSrc(){return u(this,$m)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");x(this,$m,e)}}Vm=new WeakMap,$m=new WeakMap,A(Cr,Vm,null),A(Cr,$m,"");var ch,Ym;class t5{constructor({parsedData:e,rawData:t}){A(this,ch);A(this,Ym);x(this,ch,e),x(this,Ym,t)}getRaw(){return u(this,Ym)}get(e){return u(this,ch).get(e)??null}[Symbol.iterator](){return u(this,ch).entries()}}ch=new WeakMap,Ym=new WeakMap;const Gu=Symbol("INTERNAL");var Km,Jm,Xm,uh;class n5{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){A(this,Km,!1);A(this,Jm,!1);A(this,Xm,!1);A(this,uh,!0);x(this,Km,!!(e&Us.DISPLAY)),x(this,Jm,!!(e&Us.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(u(this,Xm))return u(this,uh);if(!u(this,uh))return!1;const{print:e,view:t}=this.usage;return u(this,Km)?(t==null?void 0:t.viewState)!=="OFF":u(this,Jm)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Gu&&Ze("Internal method `_setVisible` called."),x(this,Xm,s),x(this,uh,t)}}Km=new WeakMap,Jm=new WeakMap,Xm=new WeakMap,uh=new WeakMap;var Ro,Ve,dh,hh,Wm,zw;class s5{constructor(e,t=Us.DISPLAY){A(this,Wm);A(this,Ro,null);A(this,Ve,new Map);A(this,dh,null);A(this,hh,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,x(this,hh,e.order);for(const s of e.groups)u(this,Ve).set(s.id,new n5(t,s));if(e.baseState==="OFF")for(const s of u(this,Ve).values())s._setVisible(Gu,!1);for(const s of e.on)u(this,Ve).get(s)._setVisible(Gu,!0);for(const s of e.off)u(this,Ve).get(s)._setVisible(Gu,!1);x(this,dh,this.getHash())}}isVisible(e){if(u(this,Ve).size===0)return!0;if(!e)return Db("Optional content group not defined."),!0;if(e.type==="OCG")return u(this,Ve).has(e.id)?u(this,Ve).get(e.id).visible:(ue(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return C(this,Wm,zw).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!u(this,Ve).has(t))return ue(`Optional content group not found: ${t}`),!0;if(u(this,Ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!u(this,Ve).has(t))return ue(`Optional content group not found: ${t}`),!0;if(!u(this,Ve).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!u(this,Ve).has(t))return ue(`Optional content group not found: ${t}`),!0;if(!u(this,Ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!u(this,Ve).has(t))return ue(`Optional content group not found: ${t}`),!0;if(u(this,Ve).get(t).visible)return!1}return!0}return ue(`Unknown optional content policy ${e.policy}.`),!0}return ue(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=u(this,Ve).get(e);if(!i){ue(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=u(this,Ve).get(o))==null||r._setVisible(Gu,!1,!0));i._setVisible(Gu,!!t,!0),x(this,Ro,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=u(this,Ve).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}x(this,Ro,null)}get hasInitialVisibility(){return u(this,dh)===null||this.getHash()===u(this,dh)}getOrder(){return u(this,Ve).size?u(this,hh)?u(this,hh).slice():[...u(this,Ve).keys()]:null}getGroup(e){return u(this,Ve).get(e)||null}getHash(){if(u(this,Ro)!==null)return u(this,Ro);const e=new $M;for(const[t,s]of u(this,Ve))e.update(`${t}:${s.visible}`);return x(this,Ro,e.hexdigest())}[Symbol.iterator](){return u(this,Ve).entries()}}Ro=new WeakMap,Ve=new WeakMap,dh=new WeakMap,hh=new WeakMap,Wm=new WeakSet,zw=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=C(this,Wm,zw).call(this,r);else if(u(this,Ve).has(r))a=u(this,Ve).get(r).visible;else return ue(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class i5{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Te(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Te(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Te(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new r5(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new a5(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class r5{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=dA(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class a5{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function o5(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let d=o(t);return d=unescape(d),d=l(d),d=c(d),r(d)}if(t=a(n),t){const d=c(t);return r(d)}if(t=s("filename","i").exec(n),t){t=t[1];let d=o(t);return d=c(d),r(d)}function s(d,h){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',h)}function i(d,h){if(d){if(!/^[\x00-\xFF]+$/.test(h))return h;try{const p=new TextDecoder(d,{fatal:!0}),y=a0(h);h=p.decode(y),e=!1}catch{}}return h}function r(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function a(d){const h=[];let p;const y=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=y.exec(d))!==null;){let[,_,E,b]=p;if(_=parseInt(_,10),_ in h){if(_===0)break;continue}h[_]=[E,b]}const v=[];for(let _=0;_<h.length&&_ in h;++_){let[E,b]=h[_];b=o(b),E&&(b=unescape(b),_===0&&(b=l(b))),v.push(b)}return v.join("")}function o(d){if(d.startsWith('"')){const h=d.slice(1).split('\\"');for(let p=0;p<h.length;++p){const y=h[p].indexOf('"');y!==-1&&(h[p]=h[p].slice(0,y),h.length=p+1),h[p]=h[p].replaceAll(/\\(.)/g,"$1")}d=h.join('"')}return d}function l(d){const h=d.indexOf("'");if(h===-1)return d;const p=d.slice(0,h),v=d.slice(h+1).replace(/^[^']*'/,"");return i(p,v)}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(h,p,y,v){if(y==="q"||y==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,E){return String.fromCharCode(parseInt(E,16))}),i(p,v);try{v=atob(v)}catch{}return i(p,v)})}return""}function iI(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function Lb(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function rI({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function aI(n){const e=n.get("Content-Disposition");if(e){let t=o5(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(dA(t))return t}return null}function d0(n,e){return new wv(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function oI(n){return n===200||n===206}function lI(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function cI(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ue(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class l5{constructor(e){z(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=iI(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Te(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new c5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new u5(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class c5{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,lI(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Lb(r.url),!oI(r.status))throw d0(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=rI({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=aI(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new yl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:cI(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class u5{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,lI(r,this._withCredentials,this._abortController)).then(o=>{const l=Lb(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!oI(o.status))throw d0(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:cI(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const V_=200,$_=206;function d5(n){const e=n.response;return typeof e!="string"?e:a0(e).buffer}class h5{constructor({url:e,httpHeaders:t,withCredentials:s}){z(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=iI(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=$_):i.expectedStatus=V_,t.responseType="arraybuffer",Te(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||V_;if(!(r===V_&&s.expectedStatus===$_)&&r!==s.expectedStatus){s.onError(i.status);return}const o=d5(i);if(r===$_){const l=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?s.onDone({begin:parseInt(c[1],10),chunk:o}):(ue('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class f5{constructor(e){this._source=e,this._manager=new h5(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Te(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p5(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new m5(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class p5{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Lb(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=rI({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=aI(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=d0(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class m5{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Lb((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=d0(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const g5=/^[a-z][a-z0-9\-+.]+:/i;function y5(n){if(g5.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class v5{constructor(e){this.source=e,this.url=y5(e.url),Te(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Te(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new b5(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new _5(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class b5{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=d0(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new yl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _5{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Bf=Symbol("INITIAL_DATA");var ws,Qm,Hw;class uI{constructor(){A(this,Qm);A(this,ws,Object.create(null))}get(e,t=null){if(t){const i=C(this,Qm,Hw).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=u(this,ws)[e];if(!s||s.data===Bf)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=u(this,ws)[e];return!!t&&t.data!==Bf}delete(e){const t=u(this,ws)[e];return!t||t.data===Bf?!1:(delete u(this,ws)[e],!0)}resolve(e,t=null){const s=C(this,Qm,Hw).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in u(this,ws)){const{data:s}=u(this,ws)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}x(this,ws,Object.create(null))}*[Symbol.iterator](){for(const e in u(this,ws)){const{data:t}=u(this,ws)[e];t!==Bf&&(yield[e,t])}}}ws=new WeakMap,Qm=new WeakSet,Hw=function(e){var t;return(t=u(this,ws))[e]||(t[e]={...Promise.withResolvers(),data:Bf})};const x5=1e5,XT=30;var n2,ko,Ss,Zm,eg,bc,da,tg,ng,_c,sg,fh,Mo,ph,ig,mh,xc,rg,ag,gh,wc,og,yh,vh,$a,dI,hI,jw,Xs,wy,Gw,fI,pI;const gn=class gn{constructor({textContentSource:e,container:t,viewport:s}){A(this,$a);A(this,ko,Promise.withResolvers());A(this,Ss,null);A(this,Zm,!1);A(this,eg,!!((n2=globalThis.FontInspector)!=null&&n2.enabled));A(this,bc,null);A(this,da,null);A(this,tg,0);A(this,ng,0);A(this,_c,null);A(this,sg,null);A(this,fh,0);A(this,Mo,0);A(this,ph,Object.create(null));A(this,ig,[]);A(this,mh,null);A(this,xc,[]);A(this,rg,new WeakMap);A(this,ag,null);var l;if(e instanceof ReadableStream)x(this,mh,e);else if(typeof e=="object")x(this,mh,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');x(this,Ss,x(this,sg,t)),x(this,Mo,s.scale*Ir.pixelRatio),x(this,fh,s.rotation),x(this,da,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;x(this,ag,[1,0,0,-1,-a,o+r]),x(this,ng,i),x(this,tg,r),C(l=gn,Xs,fI).call(l),t.style.setProperty("--min-font-size",u(gn,yh)),fu(t,s),u(this,ko).promise.finally(()=>{u(gn,vh).delete(this),x(this,da,null),x(this,ph,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=en.platform;return de(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{u(this,_c).read().then(({value:t,done:s})=>{if(s){u(this,ko).resolve();return}u(this,bc)??x(this,bc,t.lang),Object.assign(u(this,ph),t.styles),C(this,$a,dI).call(this,t.items),e()},u(this,ko).reject)};return x(this,_c,u(this,mh).getReader()),u(gn,vh).add(this),e(),u(this,ko).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*Ir.pixelRatio,i=e.rotation;if(i!==u(this,fh)&&(t==null||t(),x(this,fh,i),fu(u(this,sg),{rotation:i})),s!==u(this,Mo)){t==null||t(),x(this,Mo,s);const a={div:null,properties:null,ctx:C(r=gn,Xs,wy).call(r,u(this,bc))};for(const o of u(this,xc))a.properties=u(this,rg).get(o),a.div=o,C(this,$a,jw).call(this,a)}}cancel(){var t;const e=new yl("TextLayer task cancelled.");(t=u(this,_c))==null||t.cancel(e).catch(()=>{}),x(this,_c,null),u(this,ko).reject(e)}get textDivs(){return u(this,xc)}get textContentItemsStr(){return u(this,ig)}static cleanup(){if(!(u(this,vh).size>0)){u(this,gh).clear();for(const{canvas:e}of u(this,wc).values())e.remove();u(this,wc).clear()}}};ko=new WeakMap,Ss=new WeakMap,Zm=new WeakMap,eg=new WeakMap,bc=new WeakMap,da=new WeakMap,tg=new WeakMap,ng=new WeakMap,_c=new WeakMap,sg=new WeakMap,fh=new WeakMap,Mo=new WeakMap,ph=new WeakMap,ig=new WeakMap,mh=new WeakMap,xc=new WeakMap,rg=new WeakMap,ag=new WeakMap,gh=new WeakMap,wc=new WeakMap,og=new WeakMap,yh=new WeakMap,vh=new WeakMap,$a=new WeakSet,dI=function(e){var i,r;if(u(this,Zm))return;(r=u(this,da)).ctx??(r.ctx=C(i=gn,Xs,wy).call(i,u(this,bc)));const t=u(this,xc),s=u(this,ig);for(const a of e){if(t.length>x5){ue("Ignoring additional textDivs for performance reasons."),x(this,Zm,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=u(this,Ss);x(this,Ss,document.createElement("span")),u(this,Ss).classList.add("markedContent"),a.id&&u(this,Ss).setAttribute("id",`${a.id}`),o.append(u(this,Ss))}else a.type==="endMarkedContent"&&x(this,Ss,u(this,Ss).parentNode);continue}s.push(a.str),C(this,$a,hI).call(this,a)}},hI=function(e){var v;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};u(this,xc).push(t);const i=X.transform(u(this,ag),e.transform);let r=Math.atan2(i[1],i[0]);const a=u(this,ph)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=u(this,eg)&&a.fontSubstitution||a.fontFamily;o=gn.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),c=l*C(v=gn,Xs,pI).call(v,o,a,u(this,bc));let d,h;r===0?(d=i[4],h=i[5]-c):(d=i[4]+c*Math.sin(r),h=i[5]-c*Math.cos(r));const p=t.style;p.left=`${(100*d/u(this,ng)).toFixed(2)}%`,p.top=`${(100*h/u(this,tg)).toFixed(2)}%`,p.setProperty("--font-height",`${l.toFixed(2)}px`),p.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,u(this,eg)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),E=Math.abs(e.transform[3]);_!==E&&Math.max(_,E)/Math.min(_,E)>1.5&&(y=!0)}if(y&&(s.canvasWidth=a.vertical?e.height:e.width),u(this,rg).set(t,s),u(this,da).div=t,u(this,da).properties=s,C(this,$a,jw).call(this,u(this,da)),s.hasText&&u(this,Ss).append(t),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),u(this,Ss).append(_)}},jw=function(e){var a;const{div:t,properties:s,ctx:i}=e,{style:r}=t;if(s.canvasWidth!==0&&s.hasText){const{fontFamily:o}=r,{canvasWidth:l,fontSize:c}=s;C(a=gn,Xs,Gw).call(a,i,c*u(this,Mo),o);const{width:d}=i.measureText(t.textContent);d>0&&r.setProperty("--scale-x",l*u(this,Mo)/d)}s.angle!==0&&r.setProperty("--rotate",`${s.angle}deg`)},Xs=new WeakSet,wy=function(e=null){let t=u(this,wc).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),u(this,wc).set(e,t),u(this,og).set(t,{size:0,family:""})}return t},Gw=function(e,t,s){const i=u(this,og).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},fI=function(){if(u(this,yh)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),x(this,yh,e.getBoundingClientRect().height),e.remove()},pI=function(e,t,s){const i=u(this,gh).get(e);if(i)return i;const r=C(this,Xs,wy).call(this,s);r.canvas.width=r.canvas.height=XT,C(this,Xs,Gw).call(this,r,XT,e);const a=r.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);r.canvas.width=r.canvas.height=0;let c=.8;return o?c=o/(o+l):(en.platform.isFirefox&&ue("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),u(this,gh).set(e,c),c},A(gn,Xs),A(gn,gh,new Map),A(gn,wc,new Map),A(gn,og,new WeakMap),A(gn,yh,null),A(gn,vh,new Set);let Wp=gn;const w5=100;function mI(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new qw,{docId:t}=e,s=n.url?RU(n.url):null,i=n.data?kU(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof gI?n.range:null,c=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let d=n.worker instanceof Qp?n.worker:null;const h=n.verbosity,p=typeof n.docBaseUrl=="string"&&!Pb(n.docBaseUrl)?n.docBaseUrl:null,y=I0(n.cMapUrl),v=n.cMapPacked!==!1,_=n.CMapReaderFactory||($n?BU:OT),E=I0(n.iccUrl),b=I0(n.standardFontDataUrl),w=n.StandardFontDataFactory||($n?FU:UT),S=I0(n.wasmUrl),T=n.WasmFactory||($n?zU:BT),N=n.stopAtErrors!==!0,R=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!$n,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!$n&&(en.platform.isFirefox||!globalThis.chrome),D=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,O=typeof n.disableFontFace=="boolean"?n.disableFontFace:$n,L=n.fontExtraProperties===!0,$=n.enableXfa===!0,G=n.ownerDocument||globalThis.document,ee=n.disableRange===!0,P=n.disableStream===!0,F=n.disableAutoFetch===!0,H=n.pdfBug===!0,U=n.CanvasFactory||($n?UU:PU),K=n.FilterFactory||($n?OU:LU),se=n.enableHWA===!0,le=n.useWasm!==!1,he=l?l.length:n.length??NaN,Je=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!$n&&!O,Le=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===OT&&w===UT&&T===BT&&y&&b&&S&&Jf(y,document.baseURI)&&Jf(b,document.baseURI)&&Jf(S,document.baseURI)),wt=null;nU(h);const ht={canvasFactory:new U({ownerDocument:G,enableHWA:se}),filterFactory:new K({docId:t,ownerDocument:G}),cMapReaderFactory:Le?null:new _({baseUrl:y,isCompressed:v}),standardFontDataFactory:Le?null:new w({baseUrl:b}),wasmFactory:Le?null:new T({baseUrl:S})};d||(d=Qp.create({verbosity:h,port:Cr.workerPort}),e._worker=d);const Nf={docId:t,apiVersion:"5.4.530",data:i,password:o,disableAutoFetch:F,rangeChunkSize:c,length:he,docBaseUrl:p,enableXfa:$,evaluatorOptions:{maxImageSize:R,disableFontFace:O,ignoreErrors:N,isEvalSupported:k,isOffscreenCanvasSupported:I,isImageDecoderSupported:M,canvasMaxAreaInBytes:D,fontExtraProperties:L,useSystemFonts:Je,useWasm:le,useWorkerFetch:Le,cMapUrl:y,iccUrl:E,standardFontDataUrl:b,wasmUrl:S}},Au={ownerDocument:G,pdfBug:H,styleElement:wt,loadingParams:{disableAutoFetch:F,enableXfa:$}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Sl=d.messageHandler.sendWithPromise("GetDocRequest",Nf,i?[i.buffer]:null);let er;if(l)er=new i5(l,{disableRange:ee,disableStream:P});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");const Z=Jf(s)?l5:$n?v5:f5;er=new Z({url:s,length:he,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:ee,disableStream:P})}return Sl.then(Z=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const ke=new sp(t,Z,d.port),tt=new A5(ke,e,er,Au,ht,se);e._transport=tt,ke.send("Ready",null)})}).catch(e._capability.reject),e}var nb;const sb=class sb{constructor(){z(this,"_capability",Promise.withResolvers());z(this,"_transport",null);z(this,"_worker",null);z(this,"docId",`d${Vt(sb,nb)._++}`);z(this,"destroyed",!1);z(this,"onPassword",null);z(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}async getData(){return this._transport.getData()}};nb=new WeakMap,A(sb,nb,0);let qw=sb;var Sc,lg,cg,ug,dg;class gI{constructor(e,t,s=!1,i=null){A(this,Sc,Promise.withResolvers());A(this,lg,[]);A(this,cg,[]);A(this,ug,[]);A(this,dg,[]);this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i}addRangeListener(e){u(this,dg).push(e)}addProgressListener(e){u(this,ug).push(e)}addProgressiveReadListener(e){u(this,cg).push(e)}addProgressiveDoneListener(e){u(this,lg).push(e)}onDataRange(e,t){for(const s of u(this,dg))s(e,t)}onDataProgress(e,t){u(this,Sc).promise.then(()=>{for(const s of u(this,ug))s(e,t)})}onDataProgressiveRead(e){u(this,Sc).promise.then(()=>{for(const t of u(this,cg))t(e)})}onDataProgressiveDone(){u(this,Sc).promise.then(()=>{for(const e of u(this,lg))e()})}transportReady(){u(this,Sc).resolve()}requestDataRange(e,t){Ze("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}Sc=new WeakMap,lg=new WeakMap,cg=new WeakMap,ug=new WeakMap,dg=new WeakMap;class S5{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return de(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ha,Ec,lp;class E5{constructor(e,t,s,i=!1){A(this,Ec);A(this,ha,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new RT:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new uI,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new l0({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return de(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:s,intent:i="display",annotationMode:r=ao.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:h=null,isEditing:p=!1,recordOperations:y=!1,operationsFilter:v=null}){var M,D,O;(M=this._stats)==null||M.time("Overall");const _=this._transport.getRenderingIntent(i,r,h,p),{renderingIntent:E,cacheKey:b}=_;x(this,ha,!1),l||(l=this._transport.getOptionalContentConfig(E));let w=this._intentStates.get(b);w||(w=Object.create(null),this._intentStates.set(b,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const S=!!(E&Us.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(D=this._stats)==null||D.time("Page Request"),this._pumpOperatorList(_));const T=!!(this._pdfBug&&((O=globalThis.StepperManager)!=null&&O.enabled)),N=!this.recordedBBoxes&&(y||T),R=L=>{var $,G;if(w.renderTasks.delete(k),N){const ee=($=k.gfx)==null?void 0:$.dependencyTracker.take();ee&&(k.stepper&&k.stepper.setOperatorBBoxes(ee,k.gfx.dependencyTracker.takeDebugMetadata()),y&&(this.recordedBBoxes=ee))}S&&x(this,ha,!0),C(this,Ec,lp).call(this),L?(k.capability.reject(L),this._abortOperatorList({intentState:w,reason:L instanceof Error?L:new Error(L)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(G=globalThis.Stats)!=null&&G.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new Vw({callback:R,params:{canvas:t,canvasContext:e,dependencyTracker:N?new jU(t,w.operatorList.length,T):null,viewport:s,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:d,enableHWA:this._transport.enableHWA,operationsFilter:v});(w.renderTasks||(w.renderTasks=new Set)).add(k);const I=k.task;return Promise.all([w.displayReadyCapability.promise,l]).then(([L,$])=>{var G;if(this.destroyed){R();return}if((G=this._stats)==null||G.time("Rendering"),!($.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:L,optionalContentConfig:$}),k.operatorListChanged()}).catch(R),I}getOperatorList({intent:e="display",annotationMode:t=ao.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var c;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Xp.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:l,done:c}){if(c){s(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),x(this,ha,!1),Promise.all(e)}cleanup(e=!1){x(this,ha,!0);const t=C(this,Ec,lp).call(this);return e&&t&&this._stats&&(this._stats=new RT),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&C(this,Ec,lp).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const d=()=>{l.read().then(({value:h,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),d())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();C(this,Ec,lp).call(this)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof uA){let i=w5;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new yl(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}ha=new WeakMap,Ec=new WeakSet,lp=function(){if(!u(this,ha)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),x(this,ha,!1),!0};var Io,Fi,fa,Ac,ib,Tc,Cc,Jn,Sy,yI,vI,cp,bh,Ey;const ft=class ft{constructor({name:e=null,port:t=null,verbosity:s=sU()}={}){A(this,Jn);A(this,Io,Promise.withResolvers());A(this,Fi,null);A(this,fa,null);A(this,Ac,null);if(this.name=e,this.destroyed=!1,this.verbosity=s,t){if(u(ft,Cc).has(t))throw new Error("Cannot use more than one PDFWorker per port.");u(ft,Cc).set(t,this),C(this,Jn,yI).call(this,t)}else C(this,Jn,vI).call(this)}get promise(){return u(this,Io).promise}get port(){return u(this,fa)}get messageHandler(){return u(this,Fi)}destroy(){var e,t;this.destroyed=!0,(e=u(this,Ac))==null||e.terminate(),x(this,Ac,null),u(ft,Cc).delete(u(this,fa)),x(this,fa,null),(t=u(this,Fi))==null||t.destroy(),x(this,Fi,null)}static create(e){const t=u(this,Cc).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ft(e)}static get workerSrc(){if(Cr.workerSrc)return Cr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return de(this,"_setupFakeWorkerGlobal",(async()=>u(this,bh,Ey)?u(this,bh,Ey):(await import(this.workerSrc)).WorkerMessageHandler)())}};Io=new WeakMap,Fi=new WeakMap,fa=new WeakMap,Ac=new WeakMap,ib=new WeakMap,Tc=new WeakMap,Cc=new WeakMap,Jn=new WeakSet,Sy=function(){u(this,Io).resolve(),u(this,Fi).send("configure",{verbosity:this.verbosity})},yI=function(e){x(this,fa,e),x(this,Fi,new sp("main","worker",e)),u(this,Fi).on("ready",()=>{}),C(this,Jn,Sy).call(this)},vI=function(){if(u(ft,Tc)||u(ft,bh,Ey)){C(this,Jn,cp).call(this);return}let{workerSrc:e}=ft;try{ft._isSameOrigin(window.location,e)||(e=ft._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new sp("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?u(this,Io).reject(new Error("Worker was destroyed")):C(this,Jn,cp).call(this)},r=new AbortController;t.addEventListener("error",()=>{u(this,Ac)||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}x(this,Fi,s),x(this,fa,t),x(this,Ac,t),C(this,Jn,Sy).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{C(this,Jn,cp).call(this)}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{Db("The worker has been disabled.")}C(this,Jn,cp).call(this)},cp=function(){u(ft,Tc)||(ue("Setting up fake worker."),x(ft,Tc,!0)),ft._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){u(this,Io).reject(new Error("Worker was destroyed"));return}const t=new DU;x(this,fa,t);const s=`fake${Vt(ft,ib)._++}`,i=new sp(s+"_worker",s,t);e.setup(i,t),x(this,Fi,new sp(s,s+"_worker",t)),C(this,Jn,Sy).call(this)}).catch(e=>{u(this,Io).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},bh=new WeakSet,Ey=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},A(ft,bh),A(ft,ib,0),A(ft,Tc,!1),A(ft,Cc,new WeakMap),$n&&(x(ft,Tc,!0),Cr.workerSrc||(Cr.workerSrc="./pdf.worker.mjs")),ft._isSameOrigin=(e,t)=>{const s=URL.parse(e);if(!(s!=null&&s.origin)||s.origin==="null")return!1;const i=new URL(t,s);return s.origin===i.origin},ft._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},ft.fromPort=e=>{if(mU("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return ft.create(e)};let Qp=ft;var pa,yr,_h,xh,ma,Nc,up;class A5{constructor(e,t,s,i,r,a){A(this,Nc);A(this,pa,new Map);A(this,yr,new Map);A(this,_h,new Map);A(this,xh,new Map);A(this,ma,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new uI,this.fontLoader=new TU({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.wasmFactory=r.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return de(this,"annotationStorage",new hA)}getRenderingIntent(e,t=ao.ENABLE,s=null,i=!1,r=!1){let a=Us.DISPLAY,o=Cw;switch(e){case"any":a=Us.ANY;break;case"display":break;case"print":a=Us.PRINT;break;default:ue(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Us.PRINT&&s instanceof KM?s:this.annotationStorage;switch(t){case ao.DISABLE:a+=Us.ANNOTATIONS_DISABLE;break;case ao.ENABLE:break;case ao.ENABLE_FORMS:a+=Us.ANNOTATIONS_FORMS;break;case ao.ENABLE_STORAGE:a+=Us.ANNOTATIONS_STORAGE,o=l.serializable;break;default:ue(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Us.IS_EDITING),r&&(a+=Us.OPLIST);const{ids:c,hash:d}=l.modifiedIds,h=[a,o.hash,d];return{renderingIntent:a,cacheKey:h.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=u(this,ma))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of u(this,yr).values())e.push(i._destroy());u(this,yr).clear(),u(this,_h).clear(),u(this,xh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),u(this,pa).clear(),this.filterFactory.destroy(),Wp.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new yl("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Te(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Te(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Te(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}Te(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new S5(s,this))}),e.on("DocException",s=>{t._capability.reject(ts(s))}),e.on("PasswordRequest",s=>{x(this,ma,Promise.withResolvers());try{if(!t.onPassword)throw ts(s);const i=r=>{r instanceof Error?u(this,ma).reject(r):u(this,ma).resolve({password:r})};t.onPassword(i,s.code)}catch(i){u(this,ma).reject(i)}return u(this,ma).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;u(this,yr).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":if("error"in r){const p=r.error;ue(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const o=new Nw(r),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(p,y)=>globalThis.FontInspector.fontAdded(p,y):null,c=new CU(o,l,r.extra,r.charProcOperatorList);this.fontLoader.bind(c).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c.fontExtraProperties&&c.data&&c.clearData(),this.commonObjs.resolve(s,c)});break;case"CopyLocalImage":const{imageRef:d}=r;Te(d,"The imageRef must be defined.");for(const p of u(this,yr).values())for(const[,y]of p.objs)if((y==null?void 0:y.ref)===d)return y.dataLen?(this.commonObjs.resolve(s,structuredClone(y)),y.dataLen):null;break;case"FontPath":this.commonObjs.resolve(s,new NU(r));break;case"Image":this.commonObjs.resolve(s,r);break;case"Pattern":const h=new Rw(r);this.commonObjs.resolve(s,h.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var l;if(this.destroyed)return;const o=u(this,yr).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBinaryData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[s.type];if(!i)throw new Error(`${s.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ue("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=u(this,_h).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&u(this,xh).set(r.refStr,e);const a=new E5(t,r,this,this._params.pdfBug);return u(this,yr).set(t,a),a});return u(this,_h).set(t,i),i}getPageIndex(e){return kw(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return C(this,Nc,up).call(this,"GetFieldObjects")}hasJSActions(){return C(this,Nc,up).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return C(this,Nc,up).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return C(this,Nc,up).call(this,"GetOptionalContentConfig").then(t=>new s5(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=u(this,pa).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new t5(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null,hasStructTree:i[2]}});return u(this,pa).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of u(this,yr).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),u(this,pa).clear(),this.filterFactory.destroy(!0),Wp.cleanup()}}cachedPageNumber(e){if(!kw(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return u(this,xh).get(t)??null}}pa=new WeakMap,yr=new WeakMap,_h=new WeakMap,xh=new WeakMap,ma=new WeakMap,Nc=new WeakSet,up=function(e,t=null){const s=u(this,pa).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return u(this,pa).set(e,i),i};var Do;class T5{constructor(e){A(this,Do,null);z(this,"onContinue",null);z(this,"onError",null);x(this,Do,e)}get promise(){return u(this,Do).capability.promise}cancel(e=0){u(this,Do).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=u(this,Do).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=u(this,Do);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Do=new WeakMap;var Po,Rc;const Fl=class Fl{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:p=null,enableHWA:y=!1,operationsFilter:v=null}){A(this,Po,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new T5(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=y,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,c;if(this.cancelled)return;if(this._canvas){if(u(Fl,Rc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");u(Fl,Rc).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:s,transform:i,background:r,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Sd(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:s,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s,i,r;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),u(this,Po)&&(window.cancelAnimationFrame(u(this,Po)),x(this,Po,null)),u(Fl,Rc).delete(this._canvas),e||(e=new uA(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(r=(i=this.task).onError)==null||r.call(i,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?x(this,Po,window.requestAnimationFrame(()=>{x(this,Po,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),u(Fl,Rc).delete(this._canvas),this.callback())))}};Po=new WeakMap,Rc=new WeakMap,A(Fl,Rc,new WeakSet);let Vw=Fl;const mA="5.4.530",C5="50cc4adac";var Es,kc,wh,Xt,hg,Sh,ga,fg,Lo,zi,pg,Ke,$w,Yw,Kw,Ml,bI,Qa;const ns=class ns{constructor({editor:e=null,uiManager:t=null}){A(this,Ke);A(this,Es,null);A(this,kc,null);A(this,wh);A(this,Xt,null);A(this,hg,!1);A(this,Sh,!1);A(this,ga,null);A(this,fg);A(this,Lo,null);A(this,zi,null);var s,i;e?(x(this,Sh,!1),x(this,ga,e)):x(this,Sh,!0),x(this,zi,(e==null?void 0:e._uiManager)||t),x(this,fg,u(this,zi)._eventBus),x(this,wh,((s=e==null?void 0:e.color)==null?void 0:s.toUpperCase())||((i=u(this,zi))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),u(ns,pg)||x(ns,pg,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return de(this,"_keyboardManager",new u0([[["Escape","mac+Escape"],ns.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ns.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ns.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ns.prototype._moveToPrevious],[["Home","mac+Home"],ns.prototype._moveToBeginning],[["End","mac+End"],ns.prototype._moveToEnd]]))}renderButton(){const e=x(this,Es,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",u(this,ga)&&(e.ariaControls=`${u(this,ga).id}_colorpicker_dropdown`);const t=u(this,zi)._signal;e.addEventListener("click",C(this,Ke,Ml).bind(this),{signal:t}),e.addEventListener("keydown",C(this,Ke,Kw).bind(this),{signal:t});const s=x(this,kc,document.createElement("span"));return s.className="swatch",s.ariaHidden="true",s.style.backgroundColor=u(this,wh),e.append(s),e}renderMainDropdown(){const e=x(this,Xt,C(this,Ke,$w).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===u(this,Es)){C(this,Ke,Ml).call(this,e);return}const t=e.target.getAttribute("data-color");t&&C(this,Ke,Yw).call(this,t,e)}_moveToNext(e){var t,s;if(!u(this,Ke,Qa)){C(this,Ke,Ml).call(this,e);return}if(e.target===u(this,Es)){(t=u(this,Xt).firstElementChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=u(this,Xt))==null?void 0:t.firstElementChild)||e.target===u(this,Es)){u(this,Ke,Qa)&&this._hideDropdownFromKeyboard();return}u(this,Ke,Qa)||C(this,Ke,Ml).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!u(this,Ke,Qa)){C(this,Ke,Ml).call(this,e);return}(t=u(this,Xt).firstElementChild)==null||t.focus()}_moveToEnd(e){var t;if(!u(this,Ke,Qa)){C(this,Ke,Ml).call(this,e);return}(t=u(this,Xt).lastElementChild)==null||t.focus()}hideDropdown(){var e,t;(e=u(this,Xt))==null||e.classList.add("hidden"),u(this,Es).ariaExpanded="false",(t=u(this,Lo))==null||t.abort(),x(this,Lo,null)}_hideDropdownFromKeyboard(){var e;if(!u(this,Sh)){if(!u(this,Ke,Qa)){(e=u(this,ga))==null||e.unselect();return}this.hideDropdown(),u(this,Es).focus({preventScroll:!0,focusVisible:u(this,hg)})}}updateColor(e){if(u(this,kc)&&(u(this,kc).style.backgroundColor=e),!u(this,Xt))return;const t=u(this,zi).highlightColors.values();for(const s of u(this,Xt).children)s.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=u(this,Es))==null||e.remove(),x(this,Es,null),x(this,kc,null),(t=u(this,Xt))==null||t.remove(),x(this,Xt,null)}};Es=new WeakMap,kc=new WeakMap,wh=new WeakMap,Xt=new WeakMap,hg=new WeakMap,Sh=new WeakMap,ga=new WeakMap,fg=new WeakMap,Lo=new WeakMap,zi=new WeakMap,pg=new WeakMap,Ke=new WeakSet,$w=function(){const e=document.createElement("div"),t=u(this,zi)._signal;e.addEventListener("contextmenu",Ci,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),u(this,ga)&&(e.id=`${u(this,ga).id}_colorpicker_dropdown`);for(const[s,i]of u(this,zi).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",u(ns,pg)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.ariaSelected=i===u(this,wh),r.addEventListener("click",C(this,Ke,Yw).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",C(this,Ke,Kw).bind(this),{signal:t}),e},Yw=function(e,t){t.stopPropagation(),u(this,fg).dispatch("switchannotationeditorparams",{source:this,type:Ae.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Kw=function(e){ns._keyboardManager.exec(this,e)},Ml=function(e){if(u(this,Ke,Qa)){this.hideDropdown();return}if(x(this,hg,e.detail===0),u(this,Lo)||(x(this,Lo,new AbortController),window.addEventListener("pointerdown",C(this,Ke,bI).bind(this),{signal:u(this,zi).combinedSignal(u(this,Lo))})),u(this,Es).ariaExpanded="true",u(this,Xt)){u(this,Xt).classList.remove("hidden");return}const t=x(this,Xt,C(this,Ke,$w).call(this));u(this,Es).append(t)},bI=function(e){var t;(t=u(this,Xt))!=null&&t.contains(e.target)||this.hideDropdown()},Qa=function(){return u(this,Xt)&&!u(this,Xt).classList.contains("hidden")},A(ns,pg,null);let Rv=ns;var vr,mg,Eh,gg;const zl=class zl{constructor(e){A(this,vr,null);A(this,mg,null);A(this,Eh,null);x(this,mg,e),x(this,Eh,e._uiManager),u(zl,gg)||x(zl,gg,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(u(this,vr))return u(this,vr);const{editorType:e,colorType:t,color:s}=u(this,mg),i=x(this,vr,document.createElement("input"));return i.type="color",i.value=s||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",u(zl,gg)[e]),i.addEventListener("input",()=>{u(this,Eh).updateParams(t,i.value)},{signal:u(this,Eh)._signal}),i}update(e){u(this,vr)&&(u(this,vr).value=e)}destroy(){var e;(e=u(this,vr))==null||e.remove(),x(this,vr,null)}hideDropdown(){}};vr=new WeakMap,mg=new WeakMap,Eh=new WeakMap,gg=new WeakMap,A(zl,gg,null);let kv=zl;function WT(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Ff(n){return Math.max(0,Math.min(255,255*n))}class QT{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ff(e),[e,e,e]}static G_HTML([e]){const t=WT(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Ff)}static RGB_HTML(e){return`#${e.map(WT).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Ff(1-Math.min(1,e+i)),Ff(1-Math.min(1,s+i)),Ff(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class N5{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ze("Abstract method `_createSVG` called.")}}class Mv extends N5{_createSVG(e){return document.createElementNS(Hr,e)}}const R5=9,mu=new WeakSet,k5=new Date().getTimezoneOffset()*60*1e3;class Y_{static create(e){switch(e.data.annotationType){case Ut.LINK:return new gA(e);case Ut.TEXT:return new I5(e);case Ut.WIDGET:switch(e.data.fieldType){case"Tx":return new D5(e);case"Btn":return e.data.radioButton?new wI(e):e.data.checkBox?new L5(e):new O5(e);case"Ch":return new U5(e);case"Sig":return new P5(e)}return new Su(e);case Ut.POPUP:return new Xw(e);case Ut.FREETEXT:return new CI(e);case Ut.LINE:return new F5(e);case Ut.SQUARE:return new z5(e);case Ut.CIRCLE:return new H5(e);case Ut.POLYLINE:return new NI(e);case Ut.CARET:return new G5(e);case Ut.INK:return new yA(e);case Ut.POLYGON:return new j5(e);case Ut.HIGHLIGHT:return new RI(e);case Ut.UNDERLINE:return new q5(e);case Ut.SQUIGGLY:return new V5(e);case Ut.STRIKEOUT:return new $5(e);case Ut.STAMP:return new kI(e);case Ut.FILEATTACHMENT:return new Y5(e);default:return new xt(e)}}}var Mc,Ah,ui,yg,Jw;const YA=class YA{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){A(this,yg);A(this,Mc,null);A(this,Ah,!1);A(this,ui,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return YA._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var s;const{data:e}=this,t=(s=this.annotationStorage)==null?void 0:s.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:s,rect:i}=this.data;let r=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],r=t[l+2]):t[l+1]===a&&(r=Math.max(r,t[l+2]));return[r,a]}if((s==null?void 0:s.length)>=1){for(const l of s)for(let c=0,d=l.length;c<d;c+=2)l[c+1]>a?(a=l[c+1],r=l[c]):l[c+1]===a&&(r=Math.max(r,l[c]));if(r!==1/0)return[r,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-r)/s,e[1]=100*(e[1]-a)/i,e}get commentText(){var t,s,i;const{data:e}=this;return((s=(t=this.annotationStorage.getRawValue(`${Kp}${e.id}`))==null?void 0:t.popup)==null?void 0:s.contents)||((i=e.contentsObj)==null?void 0:i.str)||""}set commentText(e){const{data:t}=this,s={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:s})||this.annotationStorage.setValue(`${Kp}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:s,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=u(this,ui))==null?void 0:e.popup)||this.popup)==null||t.remove(),x(this,ui,this.popup=null)}updateEdited(e){var r;if(!this.container)return;e.rect&&(u(this,Mc)||x(this,Mc,{rect:this.data.rect.slice(0)}));const{rect:t,popup:s}=e;t&&C(this,yg,Jw).call(this,t);let i=((r=u(this,ui))==null?void 0:r.popup)||this.popup;!i&&(s!=null&&s.text)&&(this._createPopup(s),i=u(this,ui).popup),i&&(i.updateEdited(e),s!=null&&s.deleted&&(i.remove(),x(this,ui,null),this.popup=null))}resetEdited(){var e;u(this,Mc)&&(C(this,yg,Jw).call(this,u(this,Mc).rect),(e=u(this,ui))==null||e.popup.resetEdited(),x(this,Mc,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),!(this instanceof Su)&&!(this instanceof gA)&&(r.tabIndex=0);const{style:a}=r;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Xw){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,r),r}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(_>0||E>0){const w=`calc(${_}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;a.borderRadius=w}else if(this instanceof wI){const w=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=w}switch(t.borderStyle.style){case Bu.SOLID:a.borderStyle="solid";break;case Bu.DASHED:a.borderStyle="dashed";break;case Bu.BEVELED:ue("Unimplemented border style: beveled");break;case Bu.INSET:ue("Unimplemented border style: inset");break;case Bu.UNDERLINE:a.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(x(this,Ah,!0),a.borderColor=X.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const c=X.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:h,pageX:p,pageY:y}=i.rawDims;a.left=`${100*(c[0]-p)/d}%`,a.top=`${100*(c[1]-y)/h}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*o/d}%`,a.height=`${100*l/h}%`):this.setRotation(v,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims;let{width:r,height:a}=this;e%180!==0&&([r,a]=[a,r]),t.style.width=`${100*r/s}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=QT[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:QT[`${a}_rgb`](o)})};return de(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,E,b,w]=e.subarray(2,6);if(i===_&&r===E&&t===b&&s===w)return}const{style:a}=this.container;let o;if(u(this,Ah)){const{borderColor:_,borderWidth:E}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const l=i-t,c=r-s,{svgFactory:d}=this,h=d.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0),h.role="none";const p=d.createElement("defs");h.append(p);const y=d.createElement("clipPath"),v=`clippath_${this.data.id}`;y.setAttribute("id",v),y.setAttribute("clipPathUnits","objectBoundingBox"),p.append(y);for(let _=2,E=e.length;_<E;_+=8){const b=e[_],w=e[_+1],S=e[_+2],T=e[_+3],N=d.createElement("rect"),R=(S-t)/l,k=(r-w)/c,I=(b-S)/l,M=(w-T)/c;N.setAttribute("x",R),N.setAttribute("y",k),N.setAttribute("width",I),N.setAttribute("height",M),y.append(N),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${k}" width="${I}" height="${M}"/>`)}u(this,Ah)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(h),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let s,i;e?(s={str:e.text},i=e.date):(s=t.contentsObj,i=t.modificationDate),x(this,ui,new Xw({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:s,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(u(this,ui)||this.popup||this.data.popupRef)}get extraPopupElement(){return u(this,ui)}render(){Ze("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!mu.has(c)){ue(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:c})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&mu.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Mc=new WeakMap,Ah=new WeakMap,ui=new WeakMap,yg=new WeakSet,Jw=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;s==null||s.splice(0,4,...e),t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/r}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)};let xt=YA;class M5 extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var Hs,Il,_I,xI;class gA extends xt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Hs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(C(this,Hs,_I).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(C(this,Hs,xI).call(this,i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=i,this.container.append(i)),this.container}_bindLink(t,s,i=""){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&C(this,Hs,Il).call(this),i&&(t.title=i)}_bindNamedAction(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),i&&(t.title=i),C(this,Hs,Il).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}s.overlaidText&&(t.title=s.overlaidText),t.onclick||(t.onclick=()=>!1),C(this,Hs,Il).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),C(this,Hs,Il).call(this),!this._fieldObjects){ue('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var h;i==null||i();const{fields:r,refs:a,include:o}=s,l=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const y of r){const v=this._fieldObjects[y]||[];for(const{id:_}of v)p.add(_)}for(const y of Object.values(this._fieldObjects))for(const v of y)p.has(v.id)===o&&l.push(v)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const c=this.annotationStorage,d=[];for(const p of l){const{id:y}=p;switch(d.push(y),p.type){case"text":{const _=p.defaultValue||"";c.setValue(y,{value:_});break}case"checkbox":case"radiobutton":{const _=p.defaultValue===p.exportValues;c.setValue(y,{value:_});break}case"combobox":case"listbox":{const _=p.defaultValue||"";c.setValue(y,{value:_});break}default:continue}const v=document.querySelector(`[data-element-id="${y}"]`);if(v){if(!mu.has(v)){ue(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((h=this.linkService.eventBus)==null||h.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Hs=new WeakSet,Il=function(){this.container.setAttribute("data-internal-link","")},_I=function(t,s,i="",r=null){t.href=this.linkService.getAnchorUrl(""),s.description?t.title=s.description:i&&(t.title=i),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(s.content,s.filename,r),!1},C(this,Hs,Il).call(this)},xI=function(t,s,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),i&&(t.title=i),C(this,Hs,Il).call(this)};class I5 extends xt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class Su extends xt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return en.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[l,c]of s)(c==="Action"||(r=this.data.actions)!=null&&r[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,i),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":X.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||R5,r=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),d=Math.round(c/(F_*i))||1,h=c/d;a=Math.min(i,l(h/F_))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(c/F_))}r.fontSize=`calc(${a}px * var(--total-scale-factor))`,r.color=X.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class D5 extends Su{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=c??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type=this.data.password?"password":"text",s.setAttribute("value",c??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),mu.add(s),this.contentElement=s,s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=0;const{datetimeFormat:h,datetimeType:p,timeStep:y}=this.data,v=!!p&&this.enableScripting;h&&(s.title=h),this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",E=>{e.setValue(t,{value:E.target.value}),this.setPropertyOnSiblings(s,"value",E.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",E=>{const b=this.data.defaultFieldValue??"";s.value=d.userValue=b,d.formattedValue=null});let _=E=>{const{formattedValue:b}=d;b!=null&&(E.target.value=b),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",b=>{var S;if(d.focused)return;const{target:w}=b;if(v&&(w.type=p,y&&(w.step=y)),d.userValue){const T=d.userValue;if(v)if(p==="time"){const N=new Date(T),R=[N.getHours(),N.getMinutes(),N.getSeconds()];w.value=R.map(k=>k.toString().padStart(2,"0")).join(":")}else w.value=new Date(T-k5).toISOString().split(p==="date"?"T":".",1)[0];else w.value=T}d.lastCommittedValue=w.value,d.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",b=>{this.showElementAndHideCanvas(b.target);const w={value(S){d.userValue=S.detail.value??"",v||e.setValue(t,{value:d.userValue.toString()}),S.target.value=d.userValue},formattedValue(S){const{formattedValue:T}=S.detail;d.formattedValue=T,T!=null&&S.target!==document.activeElement&&(S.target.value=T);const N={formattedValue:T};v&&(N.value=T),e.setValue(t,N)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var k;const{charLimit:T}=S.detail,{target:N}=S;if(T===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",T);let R=d.userValue;!R||R.length<=T||(R=R.slice(0,T),N.value=d.userValue=R,e.setValue(t,{value:R}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(w,b)}),s.addEventListener("keydown",b=>{var T;d.commitKey=1;let w=-1;if(b.key==="Escape"?w=0:b.key==="Enter"&&!this.data.multiLine?w=2:b.key==="Tab"&&(d.commitKey=3),w===-1)return;const{value:S}=b.target;d.lastCommittedValue!==S&&(d.lastCommittedValue=S,d.userValue=S,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:w,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}}))});const E=_;_=null,s.addEventListener("blur",b=>{var T,N;if(!d.focused||!b.relatedTarget)return;(T=this.data.actions)!=null&&T.Blur||(d.focused=!1);const{target:w}=b;let{value:S}=w;if(v){if(S&&p==="time"){const R=S.split(":").map(k=>parseInt(k,10));S=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),w.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();w.type="text"}d.userValue=S,d.lastCommittedValue!==S&&((N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:d.commitKey,selStart:b.target.selectionStart,selEnd:b.target.selectionEnd}})),E(b)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",b=>{var M;d.lastCommittedValue=null;const{data:w,target:S}=b,{value:T,selectionStart:N,selectionEnd:R}=S;let k=N,I=R;switch(b.inputType){case"deleteWordBackward":{const D=T.substring(0,N).match(/\w*[^\w]*$/);D&&(k-=D[0].length);break}case"deleteWordForward":{const D=T.substring(N).match(/^[^\w]*\w*/);D&&(I+=D[0].length);break}case"deleteContentBackward":N===R&&(k-=1);break;case"deleteContentForward":N===R&&(I+=1);break}b.preventDefault(),(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:w||"",willCommit:!1,selStart:k,selEnd:I}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],b=>b.target.value)}if(_&&s.addEventListener("blur",_),this.data.comb){const b=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${b}px * var(--total-scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class P5 extends Su{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class L5 extends Su{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return mu.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s)){const d=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=d),e.setValue(c.id,{value:d})}e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class wI extends Su{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(mu.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=0,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,s))e.setValue(c.id,{value:!1});e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const d=a===c.detail.value;for(const h of this._getElementsByName(c.target.name)){const p=d&&h.id===s;h.domElement&&(h.domElement.checked=p),e.setValue(h.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class O5 extends gA{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class U5 extends Su{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");mu.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const h=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===h});for(const d of this.data.options){const h=document.createElement("option");h.textContent=d.displayValue,h.value=d.exportValue,s.value.includes(d.exportValue)&&(h.setAttribute("selected",!0),r=!1),i.append(h)}let a=null;if(r){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),a=()=>{d.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=d=>{const h=d?"value":"textContent",{options:p,multiple:y}=i;return y?Array.prototype.filter.call(p,v=>v.selected).map(v=>v[h]):p.selectedIndex===-1?null:p[p.selectedIndex][h]};let l=o(!1);const c=d=>{const h=d.target.options;return Array.prototype.map.call(h,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const h={value(p){a==null||a();const y=p.detail.value,v=new Set(Array.isArray(y)?y:[y]);for(const _ of i.options)_.selected=v.has(_.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){i.multiple=!0},remove(p){const y=i.options,v=p.detail.remove;y[v].selected=!1,i.remove(v),y.length>0&&Array.prototype.findIndex.call(y,E=>E.selected)===-1&&(y[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:y,displayValue:v,exportValue:_}=p.detail.insert,E=i.children[y],b=document.createElement("option");b.textContent=v,b.value=_,E?E.before(b):i.append(b),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:y}=p.detail;for(;i.length!==0;)i.remove(0);for(const v of y){const{displayValue:_,exportValue:E}=v,b=document.createElement("option");b.textContent=_,b.value=E,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const y=new Set(p.detail.indices);for(const v of p.target.options)v.selected=y.has(v.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(h,d)}),i.addEventListener("input",d=>{var y;const h=o(!0),p=o(!1);e.setValue(t,{value:h}),d.preventDefault(),(y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:h,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}var vg,Ww;class Xw extends xt{constructor(t){const{data:s,elements:i,parent:r}=t,a=!!r._commentManager;super(t,{isRenderable:!a&&xt._hasPopupData(s)});A(this,vg);if(this.elements=i,a&&xt._hasPopupData(s)){const o=this.popup=C(this,vg,Ww).call(this);for(const l of i)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const s=this.popup=C(this,vg,Ww).call(this),i=[];for(const r of this.elements)r.popup=s,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${od}${r}`).join(",")),this.container}}vg=new WeakSet,Ww=function(){return new B5({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var As,Oo,rb,ab,Th,Ch,Ct,br,Uo,Ic,Nh,Rh,_r,Ts,ya,va,Nt,ba,Bo,bg,_a,kh,Dc,Fo,sn,zo,be,Ay,Qw,Zw,eS,Ty,tS,SI,EI,AI,TI,Cy,Ny,nS;class B5{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:d,open:h,commentManager:p=null}){A(this,be);A(this,As,null);A(this,Oo,C(this,be,AI).bind(this));A(this,rb,C(this,be,nS).bind(this));A(this,ab,C(this,be,Ny).bind(this));A(this,Th,C(this,be,Cy).bind(this));A(this,Ch,null);A(this,Ct,null);A(this,br,null);A(this,Uo,null);A(this,Ic,null);A(this,Nh,null);A(this,Rh,null);A(this,_r,!1);A(this,Ts,null);A(this,ya,null);A(this,va,null);A(this,Nt,null);A(this,ba,null);A(this,Bo,null);A(this,bg,null);A(this,_a,null);A(this,kh,null);A(this,Dc,null);A(this,Fo,!1);A(this,sn,null);A(this,zo,null);x(this,Ct,e),x(this,kh,i),x(this,br,a),x(this,_a,o),x(this,Nh,l),x(this,Ch,t),x(this,bg,c),x(this,Rh,d),x(this,Ic,s),x(this,As,p),x(this,sn,s[0]),x(this,Uo,Sv.toDateObject(r)),this.trigger=s.flatMap(y=>y.getElementsToTriggerPopup()),p||(C(this,be,Ay).call(this),u(this,Ct).hidden=!0,h&&C(this,be,Cy).call(this))}renderCommentButton(){if(u(this,Nt)){u(this,Nt).parentNode||u(this,sn).container.after(u(this,Nt));return}if(u(this,ba)||C(this,be,Qw).call(this),!u(this,ba))return;const{signal:e}=x(this,ya,new AbortController),t=u(this,sn).hasOwnCommentButton,s=()=>{u(this,As).toggleCommentPopup(this,!0,void 0,!t)},i=()=>{u(this,As).toggleCommentPopup(this,!1,!0,!t)},r=()=>{u(this,As).toggleCommentPopup(this,!1,!1)};if(t){x(this,Nt,u(this,sn).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",u(this,Oo),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=x(this,Nt,document.createElement("button"));a.className="annotationCommentButton";const o=u(this,sn).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),C(this,be,eS).call(this),C(this,be,Zw).call(this),a.addEventListener("keydown",u(this,Oo),{signal:e}),a.addEventListener("click",s,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",r,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=u(this,sn).commentData;return e?u(this,Nh)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=u(this,Nt))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}=u(this,sn).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:s,creationDate:i,modificationDate:r}}get elementBeforePopup(){return u(this,Nt)}get comment(){return u(this,zo)||x(this,zo,u(this,sn).commentText),u(this,zo)}set comment(e){e!==this.comment&&(u(this,sn).commentText=x(this,zo,e))}focus(){var e;(e=u(this,sn).container)==null||e.focus()}get parentBoundingClientRect(){return u(this,sn).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){u(this,Nt)&&(u(this,Nt).classList.toggle("selected",e),u(this,Nt).ariaExpanded=t)}setSelectedCommentButton(e){u(this,Nt).classList.toggle("selected",e)}get commentPopupPosition(){if(u(this,Bo))return u(this,Bo);const{x:e,y:t,height:s}=u(this,Nt).getBoundingClientRect(),{x:i,y:r,width:a,height:o}=u(this,sn).layer.getBoundingClientRect();return[(e-i)/a,(t+s-r)/o]}set commentPopupPosition(e){x(this,Bo,e)}hasDefaultPopupPosition(){return u(this,Bo)===null}get commentButtonPosition(){return u(this,ba)}get commentButtonWidth(){return u(this,Nt).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,s]=u(this,Bo)||this.commentButtonPosition.map(c=>c/100),i=this.parentBoundingClientRect,{x:r,y:a,width:o,height:l}=i;u(this,As).showDialog(null,this,r+t*o,a+s*l,{...e,parentDimensions:i})}render(){var s,i;if(u(this,Ts))return;const e=x(this,Ts,document.createElement("div"));if(e.className="popup",u(this,Ch)){const r=e.style.outlineColor=X.makeHexColor(...u(this,Ch));e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const t=document.createElement("span");if(t.className="header",(s=u(this,kh))!=null&&s.str){const r=document.createElement("span");r.className="title",t.append(r),{dir:r.dir,str:r.textContent}=u(this,kh)}if(e.append(t),u(this,Uo)){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:u(this,Uo).valueOf()})),r.dateTime=u(this,Uo).toISOString(),t.append(r)}fM({html:u(this,be,Ty)||u(this,br).str,dir:(i=u(this,br))==null?void 0:i.dir,className:"popupContent"},e),u(this,Ct).append(e)}updateEdited({rect:e,popup:t,deleted:s}){var i;if(u(this,As)){s?(this.remove(),x(this,zo,null)):t&&(t.deleted?this.remove():(C(this,be,eS).call(this),x(this,zo,t.text))),e&&(x(this,ba,null),C(this,be,Qw).call(this),C(this,be,Zw).call(this));return}if(s||t!=null&&t.deleted){this.remove();return}C(this,be,Ay).call(this),u(this,Dc)||x(this,Dc,{contentsObj:u(this,br),richText:u(this,_a)}),e&&x(this,va,null),t&&t.text&&(x(this,_a,C(this,be,EI).call(this,t.text)),x(this,Uo,Sv.toDateObject(t.date)),x(this,br,null)),(i=u(this,Ts))==null||i.remove(),x(this,Ts,null)}resetEdited(){var e;u(this,Dc)&&({contentsObj:Vt(this,br)._,richText:Vt(this,_a)._}=u(this,Dc),x(this,Dc,null),(e=u(this,Ts))==null||e.remove(),x(this,Ts,null),x(this,va,null))}remove(){var e,t,s;if((e=u(this,ya))==null||e.abort(),x(this,ya,null),(t=u(this,Ts))==null||t.remove(),x(this,Ts,null),x(this,Fo,!1),x(this,_r,!1),(s=u(this,Nt))==null||s.remove(),x(this,Nt,null),this.trigger)for(const i of this.trigger)i.classList.remove("popupTriggerArea")}forceHide(){x(this,Fo,this.isVisible),u(this,Fo)&&(u(this,Ct).hidden=!0)}maybeShow(){u(this,As)||(C(this,be,Ay).call(this),u(this,Fo)&&(u(this,Ts)||C(this,be,Ny).call(this),x(this,Fo,!1),u(this,Ct).hidden=!1))}get isVisible(){return u(this,As)?!1:u(this,Ct).hidden===!1}}As=new WeakMap,Oo=new WeakMap,rb=new WeakMap,ab=new WeakMap,Th=new WeakMap,Ch=new WeakMap,Ct=new WeakMap,br=new WeakMap,Uo=new WeakMap,Ic=new WeakMap,Nh=new WeakMap,Rh=new WeakMap,_r=new WeakMap,Ts=new WeakMap,ya=new WeakMap,va=new WeakMap,Nt=new WeakMap,ba=new WeakMap,Bo=new WeakMap,bg=new WeakMap,_a=new WeakMap,kh=new WeakMap,Dc=new WeakMap,Fo=new WeakMap,sn=new WeakMap,zo=new WeakMap,be=new WeakSet,Ay=function(){var t;if(u(this,ya))return;x(this,ya,new AbortController);const{signal:e}=u(this,ya);for(const s of this.trigger)s.addEventListener("click",u(this,Th),{signal:e}),s.addEventListener("pointerenter",u(this,ab),{signal:e}),s.addEventListener("pointerleave",u(this,rb),{signal:e}),s.classList.add("popupTriggerArea");for(const s of u(this,Ic))(t=s.container)==null||t.addEventListener("keydown",u(this,Oo),{signal:e})},Qw=function(){const e=u(this,Ic).find(t=>t.hasCommentButton);e&&x(this,ba,e._normalizePoint(e.commentButtonPosition))},Zw=function(){if(u(this,sn).extraPopupElement&&!u(this,sn).editor)return;u(this,Nt)||this.renderCommentButton();const[e,t]=u(this,ba),{style:s}=u(this,Nt);s.left=`calc(${e}%)`,s.top=`calc(${t}% - var(--comment-button-dim))`},eS=function(){u(this,sn).extraPopupElement||(u(this,Nt)||this.renderCommentButton(),u(this,Nt).style.backgroundColor=this.commentButtonColor||"")},Ty=function(){const e=u(this,_a),t=u(this,br);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&u(this,_a).html||null},tS=function(){var e,t,s;return((s=(t=(e=u(this,be,Ty))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},SI=function(){var e,t,s;return((s=(t=(e=u(this,be,Ty))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},EI=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:u(this,be,SI),fontSize:u(this,be,tS)?`calc(${u(this,be,tS)}px * var(--total-scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},AI=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&u(this,_r))&&C(this,be,Cy).call(this)},TI=function(){if(u(this,va)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=u(this,Nh);let a=!!u(this,Rh),o=a?u(this,Rh):u(this,bg);for(const v of u(this,Ic))if(!o||X.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const l=X.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),d=a?o[2]-o[0]+5:0,h=l[0]+d,p=l[1];x(this,va,[100*(h-i)/t,100*(p-r)/s]);const{style:y}=u(this,Ct);y.left=`${u(this,va)[0]}%`,y.top=`${u(this,va)[1]}%`},Cy=function(){if(u(this,As)){u(this,As).toggleCommentPopup(this,!1);return}x(this,_r,!u(this,_r)),u(this,_r)?(C(this,be,Ny).call(this),u(this,Ct).addEventListener("click",u(this,Th)),u(this,Ct).addEventListener("keydown",u(this,Oo))):(C(this,be,nS).call(this),u(this,Ct).removeEventListener("click",u(this,Th)),u(this,Ct).removeEventListener("keydown",u(this,Oo)))},Ny=function(){u(this,Ts)||this.render(),this.isVisible?u(this,_r)&&u(this,Ct).classList.add("focused"):(C(this,be,TI).call(this),u(this,Ct).hidden=!1,u(this,Ct).style.zIndex=parseInt(u(this,Ct).style.zIndex)+1e3)},nS=function(){u(this,Ct).classList.remove("focused"),!(u(this,_r)||!this.isVisible)&&(u(this,Ct).hidden=!0,u(this,Ct).style.zIndex=parseInt(u(this,Ct).style.zIndex)-1e3)};class CI extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=pe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var _g;class F5 extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,_g,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=x(this,_g,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,_g)}addHighlightArea(){this.container.classList.add("highlightArea")}}_g=new WeakMap;var xg;class z5 extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,xg,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=x(this,xg,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,xg)}addHighlightArea(){this.container.classList.add("highlightArea")}}xg=new WeakMap;var wg;class H5 extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,wg,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:s,height:i}=this,r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=x(this,wg,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,wg)}addHighlightArea(){this.container.classList.add("highlightArea")}}wg=new WeakMap;var Sg;class NI extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Sg,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r},width:a,height:o}=this;if(!s)return this.container;const l=this.svgFactory.create(a,o,!0);let c=[];for(let h=0,p=s.length;h<p;h+=2){const y=s[h]-t[0],v=t[3]-s[h+1];c.push(`${y},${v}`)}c=c.join(" ");const d=x(this,Sg,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return u(this,Sg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sg=new WeakMap;class j5 extends NI{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class G5 extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var Eg,Pc,Ag,sS;class yA extends xt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Ag);A(this,Eg,null);A(this,Pc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?pe.HIGHLIGHT:pe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:c}=C(this,Ag,sS).call(this,s,t),d=this.svgFactory.create(l,c,!0),h=x(this,Eg,this.svgFactory.createElement("svg:g"));d.append(h),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",o);for(let p=0,y=i.length;p<y;p++){const v=this.svgFactory.createElement(this.svgElementName);u(this,Pc).push(v),v.setAttribute("points",i[p].join(",")),h.append(v)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=u(this,Eg);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,l=u(this,Pc).length;o<l;o++)u(this,Pc)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:l,height:c}=C(this,Ag,sS).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return u(this,Pc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Eg=new WeakMap,Pc=new WeakMap,Ag=new WeakSet,sS=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class RI extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=pe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const s=document.createElement("mark");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class q5 extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class V5 extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const s=document.createElement("u");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class $5 extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const s=document.createElement("s");s.classList.add("overlaidText"),s.textContent=e,this.container.append(s)}return this.container}}class kI extends xt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=pe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Tg,Cg,iS;class Y5 extends xt{constructor(t){var i;super(t,{isRenderable:!0});A(this,Cg);A(this,Tg,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",C(this,Cg,iS).bind(this)),x(this,Tg,i);const{isMac:r}=en.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&C(this,Cg,iS).call(this)}),!s.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return u(this,Tg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tg=new WeakMap,Cg=new WeakSet,iS=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Lc,Oc,Mh,Ho,Ng,Uc,Cs,Rg,Ua,Ry,aS;const KA=class KA{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o,commentManager:l,linkService:c,annotationStorage:d}){A(this,Ua);A(this,Lc,null);A(this,Oc,null);A(this,Mh,null);A(this,Ho,new Map);A(this,Ng,null);A(this,Uc,null);A(this,Cs,[]);A(this,Rg,!1);this.div=e,x(this,Lc,t),x(this,Oc,s),x(this,Ng,o||null),x(this,Uc,c||null),x(this,Mh,d||new hA),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=l||null}hasEditableAnnotations(){return u(this,Ho).size>0}async render(e){var o;const{annotations:t}=e,s=this.div;fu(s,this.viewport);const i=new Map,r=[],a={data:null,layer:s,linkService:u(this,Uc),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Mv,annotationStorage:u(this,Mh),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const c=l.annotationType===Ut.POPUP;if(c){const p=i.get(l.id);if(!p)continue;if(!this._commentManager){r.push(l);continue}a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const d=Y_.create(a);if(!d.isRenderable)continue;if(!c&&(u(this,Cs).push(d),l.popupRef)){const p=i.get(l.popupRef);p?p.push(d):i.set(l.popupRef,[d])}const h=d.render();l.hidden&&(h.style.visibility="hidden"),d._isEditable&&(u(this,Ho).set(d.data.id,d),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(d))}await C(this,Ua,Ry).call(this);for(const l of r){const c=a.elements=i.get(l.id);a.data=l;const d=Y_.create(a);if(!d.isRenderable)continue;const h=d.render();d.contentElement.id=`${od}${l.id}`,l.hidden&&(h.style.visibility="hidden"),c.at(-1).container.after(h)}C(this,Ua,aS).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:u(this,Uc),svgFactory:new Mv,parent:this};for(const s of e){s.borderStyle||(s.borderStyle=KA._defaultBorderStyle),t.data=s;const i=Y_.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${od}${s.id}`,u(this,Cs).push(i))}await C(this,Ua,Ry).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,fu(t,{rotation:e.rotation}),C(this,Ua,aS).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(u(this,Ho).values())}getEditableAnnotation(e){return u(this,Ho).get(e)}addFakeAnnotation(e){const{div:t}=this,{id:s,rotation:i}=e,r=new M5({data:{id:s,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:u(this,Uc),annotationStorage:u(this,Mh)});return r.render(),r.contentElement.id=`${od}${s}`,r.createOrUpdatePopup(),u(this,Cs).push(r),r}removeAnnotation(e){var i;const t=u(this,Cs).findIndex(r=>r.data.id===e);if(t<0)return;const[s]=u(this,Cs).splice(t,1);(i=u(this,Lc))==null||i.removePointerInTextLayer(s.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);C(this,Ua,Ry).call(this)}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return de(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Bu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};Lc=new WeakMap,Oc=new WeakMap,Mh=new WeakMap,Ho=new WeakMap,Ng=new WeakMap,Uc=new WeakMap,Cs=new WeakMap,Rg=new WeakMap,Ua=new WeakSet,Ry=async function(){var s,i,r;if(u(this,Cs).length===0)return;this.div.replaceChildren();const e=[];if(!u(this,Rg)){x(this,Rg,!0);for(const{contentElement:a,data:{id:o}}of u(this,Cs)){const l=a.id=`${od}${o}`;e.push((s=u(this,Ng))==null?void 0:s.getAriaAttributes(l).then(c=>{if(c)for(const[d,h]of c)a.setAttribute(d,h)}))}}u(this,Cs).sort(({data:{rect:[a,o,l,c]}},{data:{rect:[d,h,p,y]}})=>{if(a===l&&o===c)return 1;if(d===p&&h===y)return-1;const v=c,_=o,E=(o+c)/2,b=y,w=h,S=(h+y)/2;if(E>=b&&S<=_)return-1;if(S>=v&&E<=w)return 1;const T=(a+l)/2,N=(d+p)/2;return T-N});const t=document.createDocumentFragment();for(const a of u(this,Cs))t.append(a.container),this._commentManager?(r=((i=a.extraPopupElement)==null?void 0:i.popup)||a.popup)==null||r.renderCommentButton():a.extraPopupElement&&t.append(a.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),u(this,Lc))for(const a of u(this,Cs))u(this,Lc).addPointerInTextLayer(a.contentElement,!1)},aS=function(){var t;if(!u(this,Oc))return;const e=this.div;for(const[s,i]of u(this,Oc)){const r=e.querySelector(`[data-annotation-id="${s}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const o=u(this,Ho).get(s);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(s,r.id,i),o._hasNoCanvas=!1):o.canvas=i)}u(this,Oc).clear()};let rS=KA;const B0=/\r\n?|\n/g;var Ns,kg,Bc,Rs,qt,MI,II,DI,ky,Ba,My,Iy,PI,lS,LI;const lt=class lt extends rt{constructor(t){super({...t,name:"freeTextEditor"});A(this,qt);A(this,Ns,"");A(this,kg,`${this.id}-editor`);A(this,Bc,null);A(this,Rs);z(this,"_colorPicker",null);this.color=t.color||lt._defaultColor||rt._defaultLineColor,x(this,Rs,t.fontSize||lt._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const t=lt.prototype,s=a=>a.isEmpty(),i=pu.TRANSLATE_SMALL,r=pu.TRANSLATE_BIG;return de(this,"_keyboardManager",new u0([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){rt.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case Ae.FREETEXT_SIZE:lt._defaultFontSize=s;break;case Ae.FREETEXT_COLOR:lt._defaultColor=s;break}}updateParams(t,s){switch(t){case Ae.FREETEXT_SIZE:C(this,qt,MI).call(this,s);break;case Ae.FREETEXT_COLOR:C(this,qt,II).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Ae.FREETEXT_SIZE,lt._defaultFontSize],[Ae.FREETEXT_COLOR,lt._defaultColor||rt._defaultLineColor]]}get propertiesToUpdate(){return[[Ae.FREETEXT_SIZE,u(this,Rs)],[Ae.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new kv(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ae.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-lt._internalPadding*t,-(lt._internalPadding+u(this,Rs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),x(this,Bc,new AbortController);const t=this._uiManager.combinedSignal(u(this,Bc));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",u(this,kg)),this._isDraggable=!0,(t=u(this,Bc))==null||t.abort(),x(this,Bc,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=u(this,Ns),s=x(this,Ns,C(this,qt,DI).call(this).trimEnd());if(t===s)return;const i=r=>{if(x(this,Ns,r),!r){this.remove();return}C(this,qt,Iy).call(this),this._uiManager.rebuild(this),C(this,qt,ky).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),C(this,qt,ky).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){lt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,s;(this._isCopy||this.annotationElementId)&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",u(this,kg)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${u(this,Rs)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[d,h]=this.pageDimensions,[p,y]=this.pageTranslation;let v,_;switch(this.rotation){case 0:v=t+(o[0]-p)/d,_=s+this.height-(o[1]-y)/h;break;case 90:v=t+(o[0]-p)/d,_=s-(o[1]-y)/h,[l,c]=[c,-l];break;case 180:v=t-this.width+(o[0]-p)/d,_=s-(o[1]-y)/h,[l,c]=[-l,-c];break;case 270:v=t+(o[0]-p-this.height*h)/d,_=s+(o[1]-y-this.width*d)/h,[l,c]=[-c,l];break}this.setAt(v*r,_*a,l,c)}else this._moveAfterPaste(t,s);C(this,qt,Iy).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,_,E;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=C(v=lt,Ba,lS).call(v,s.getData("text")||"").replaceAll(B0,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,d=[],h=[];if(l.nodeType===Node.TEXT_NODE){const b=l.parentElement;if(h.push(l.nodeValue.slice(c).replaceAll(B0,"")),b!==this.editorDiv){let w=d;for(const S of this.editorDiv.childNodes){if(S===b){w=h;continue}w.push(C(_=lt,Ba,My).call(_,S))}}d.push(l.nodeValue.slice(0,c).replaceAll(B0,""))}else if(l===this.editorDiv){let b=d,w=0;for(const S of this.editorDiv.childNodes)w++===c&&(b=h),b.push(C(E=lt,Ba,My).call(E,S))}x(this,Ns,`${d.join(`
`)}${r}${h.join(`
`)}`),C(this,qt,Iy).call(this);const p=new Range;let y=Math.sumPrecise(d.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const w=b.nodeValue.length;if(y<=w){p.setStart(b,y),p.setEnd(b,y);break}y-=w}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=lt._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,s,i){var o;let r=null;if(t instanceof CI){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:d,rotation:h,id:p,popupRef:y,richText:v,contentsObj:_,creationDate:E,modificationDate:b},textContent:w,textPosition:S,parent:{page:{pageNumber:T}}}=t;if(!w||w.length===0)return null;r=t={annotationType:pe.FREETEXT,color:Array.from(c),fontSize:l,value:w.join(`
`),position:S,pageIndex:T-1,rect:d.slice(0),rotation:h,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:(_==null?void 0:_.str)||null,richText:v,creationDate:E,modificationDate:b}}const a=await super.deserialize(t,s,i);return x(a,Rs,t.fontSize),a.color=X.makeHexColor(...t.color),x(a,Ns,C(o=lt,Ba,lS).call(o,t.value)),a._initialData=r,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=rt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:s,fontSize:u(this,Rs),value:C(this,qt,PI).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!C(this,qt,LI).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(!s)return null;const{style:i}=s;i.fontSize=`calc(${u(this,Rs)}px * var(--total-scale-factor))`,i.color=this.color,s.replaceChildren();for(const r of u(this,Ns).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:u(this,Ns)}}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Ns=new WeakMap,kg=new WeakMap,Bc=new WeakMap,Rs=new WeakMap,qt=new WeakSet,MI=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-u(this,Rs))*this.parentScale),x(this,Rs,r),C(this,qt,ky).call(this)},i=u(this,Rs);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ae.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},II=function(t){const s=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ae.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},DI=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(C(i=lt,Ba,My).call(i,r)),s=r);return t.join(`
`)},ky=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Ba=new WeakSet,My=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(B0,"")},Iy=function(){if(this.editorDiv.replaceChildren(),!!u(this,Ns))for(const t of u(this,Ns).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},PI=function(){return u(this,Ns).replaceAll(""," ")},lS=function(t){return t.replaceAll(" ","")},LI=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},A(lt,Ba),z(lt,"_freeTextDefaultContent",""),z(lt,"_internalPadding",0),z(lt,"_defaultColor",null),z(lt,"_defaultFontSize",10),z(lt,"_type","freetext"),z(lt,"_editorType",pe.FREETEXT);let oS=lt;class Q{toSVGPath(){Ze("Abstract method `toSVGPath` must be implemented.")}get box(){Ze("Abstract getter `box` must be implemented.")}serialize(e,t){Ze("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}z(Q,"PRECISION",1e-4);var ks,Hi,Ih,Dh,xr,_e,Fc,zc,Mg,Ig,Ph,Lh,jo,Dg,ob,lb,Zt,dp,OI,UI,BI,FI,zI,HI;const $r=class $r{constructor({x:e,y:t},s,i,r,a,o=0){A(this,Zt);A(this,ks);A(this,Hi,[]);A(this,Ih);A(this,Dh);A(this,xr,[]);A(this,_e,new Float32Array(18));A(this,Fc);A(this,zc);A(this,Mg);A(this,Ig);A(this,Ph);A(this,Lh);A(this,jo,[]);x(this,ks,s),x(this,Lh,r*i),x(this,Dh,a),u(this,_e).set([NaN,NaN,NaN,NaN,e,t],6),x(this,Ih,o),x(this,Ig,u($r,Dg)*i),x(this,Mg,u($r,lb)*i),x(this,Ph,i),u(this,jo).push(e,t)}isEmpty(){return isNaN(u(this,_e)[8])}add({x:e,y:t}){var M;x(this,Fc,e),x(this,zc,t);const[s,i,r,a]=u(this,ks);let[o,l,c,d]=u(this,_e).subarray(8,12);const h=e-c,p=t-d,y=Math.hypot(h,p);if(y<u(this,Mg))return!1;const v=y-u(this,Ig),_=v/y,E=_*h,b=_*p;let w=o,S=l;o=c,l=d,c+=E,d+=b,(M=u(this,jo))==null||M.push(e,t);const T=-b/v,N=E/v,R=T*u(this,Lh),k=N*u(this,Lh);return u(this,_e).set(u(this,_e).subarray(2,8),0),u(this,_e).set([c+R,d+k],4),u(this,_e).set(u(this,_e).subarray(14,18),12),u(this,_e).set([c-R,d-k],16),isNaN(u(this,_e)[6])?(u(this,xr).length===0&&(u(this,_e).set([o+R,l+k],2),u(this,xr).push(NaN,NaN,NaN,NaN,(o+R-s)/r,(l+k-i)/a),u(this,_e).set([o-R,l-k],14),u(this,Hi).push(NaN,NaN,NaN,NaN,(o-R-s)/r,(l-k-i)/a)),u(this,_e).set([w,S,o,l,c,d],6),!this.isEmpty()):(u(this,_e).set([w,S,o,l,c,d],6),Math.abs(Math.atan2(S-l,w-o)-Math.atan2(b,E))<Math.PI/2?([o,l,c,d]=u(this,_e).subarray(2,6),u(this,xr).push(NaN,NaN,NaN,NaN,((o+c)/2-s)/r,((l+d)/2-i)/a),[o,l,w,S]=u(this,_e).subarray(14,18),u(this,Hi).push(NaN,NaN,NaN,NaN,((w+o)/2-s)/r,((S+l)/2-i)/a),!0):([w,S,o,l,c,d]=u(this,_e).subarray(0,6),u(this,xr).push(((w+5*o)/6-s)/r,((S+5*l)/6-i)/a,((5*o+c)/6-s)/r,((5*l+d)/6-i)/a,((o+c)/2-s)/r,((l+d)/2-i)/a),[c,d,o,l,w,S]=u(this,_e).subarray(12,18),u(this,Hi).push(((w+5*o)/6-s)/r,((S+5*l)/6-i)/a,((5*o+c)/6-s)/r,((5*l+d)/6-i)/a,((o+c)/2-s)/r,((l+d)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=u(this,xr),t=u(this,Hi);if(isNaN(u(this,_e)[6])&&!this.isEmpty())return C(this,Zt,OI).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);C(this,Zt,BI).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return C(this,Zt,UI).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new jI(e,t,s,i,r,a)}getOutlines(){var h;const e=u(this,xr),t=u(this,Hi),s=u(this,_e),[i,r,a,o]=u(this,ks),l=new Float32Array((((h=u(this,jo))==null?void 0:h.length)??0)+2);for(let p=0,y=l.length-2;p<y;p+=2)l[p]=(u(this,jo)[p]-i)/a,l[p+1]=(u(this,jo)[p+1]-r)/o;if(l[l.length-2]=(u(this,Fc)-i)/a,l[l.length-1]=(u(this,zc)-r)/o,isNaN(s[6])&&!this.isEmpty())return C(this,Zt,FI).call(this,l);const c=new Float32Array(u(this,xr).length+24+u(this,Hi).length);let d=e.length;for(let p=0;p<d;p+=2){if(isNaN(e[p])){c[p]=c[p+1]=NaN;continue}c[p]=e[p],c[p+1]=e[p+1]}d=C(this,Zt,HI).call(this,c,d);for(let p=t.length-6;p>=6;p-=6)for(let y=0;y<6;y+=2){if(isNaN(t[p+y])){c[d]=c[d+1]=NaN,d+=2;continue}c[d]=t[p+y],c[d+1]=t[p+y+1],d+=2}return C(this,Zt,zI).call(this,c,d),this.newFreeDrawOutline(c,l,u(this,ks),u(this,Ph),u(this,Ih),u(this,Dh))}};ks=new WeakMap,Hi=new WeakMap,Ih=new WeakMap,Dh=new WeakMap,xr=new WeakMap,_e=new WeakMap,Fc=new WeakMap,zc=new WeakMap,Mg=new WeakMap,Ig=new WeakMap,Ph=new WeakMap,Lh=new WeakMap,jo=new WeakMap,Dg=new WeakMap,ob=new WeakMap,lb=new WeakMap,Zt=new WeakSet,dp=function(){const e=u(this,_e).subarray(4,6),t=u(this,_e).subarray(16,18),[s,i,r,a]=u(this,ks);return[(u(this,Fc)+(e[0]-t[0])/2-s)/r,(u(this,zc)+(e[1]-t[1])/2-i)/a,(u(this,Fc)+(t[0]-e[0])/2-s)/r,(u(this,zc)+(t[1]-e[1])/2-i)/a]},OI=function(){const[e,t,s,i]=u(this,ks),[r,a,o,l]=C(this,Zt,dp).call(this);return`M${(u(this,_e)[2]-e)/s} ${(u(this,_e)[3]-t)/i} L${(u(this,_e)[4]-e)/s} ${(u(this,_e)[5]-t)/i} L${r} ${a} L${o} ${l} L${(u(this,_e)[16]-e)/s} ${(u(this,_e)[17]-t)/i} L${(u(this,_e)[14]-e)/s} ${(u(this,_e)[15]-t)/i} Z`},UI=function(e){const t=u(this,Hi);e.push(`L${t[4]} ${t[5]} Z`)},BI=function(e){const[t,s,i,r]=u(this,ks),a=u(this,_e).subarray(4,6),o=u(this,_e).subarray(16,18),[l,c,d,h]=C(this,Zt,dp).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${l} ${c} L${d} ${h} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},FI=function(e){const t=u(this,_e),[s,i,r,a]=u(this,ks),[o,l,c,d]=C(this,Zt,dp).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(h,e,u(this,ks),u(this,Ph),u(this,Ih),u(this,Dh))},zI=function(e,t){const s=u(this,Hi);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},HI=function(e,t){const s=u(this,_e).subarray(4,6),i=u(this,_e).subarray(16,18),[r,a,o,l]=u(this,ks),[c,d,h,p]=C(this,Zt,dp).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,h,p,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l],t),t+=24},A($r,Dg,8),A($r,ob,2),A($r,lb,u($r,Dg)+u($r,ob));let Iv=$r;var Oh,Hc,xa,Pg,Ms,Lg,Dt,cb,GI;class jI extends Q{constructor(t,s,i,r,a,o){super();A(this,cb);A(this,Oh);A(this,Hc,new Float32Array(4));A(this,xa);A(this,Pg);A(this,Ms);A(this,Lg);A(this,Dt);x(this,Dt,t),x(this,Ms,s),x(this,Oh,i),x(this,Lg,r),x(this,xa,a),x(this,Pg,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],C(this,cb,GI).call(this,o);const[l,c,d,h]=u(this,Hc);for(let p=0,y=t.length;p<y;p+=2)t[p]=(t[p]-l)/d,t[p+1]=(t[p+1]-c)/h;for(let p=0,y=s.length;p<y;p+=2)s[p]=(s[p]-l)/d,s[p+1]=(s[p+1]-c)/h}toSVGPath(){const t=[`M${u(this,Dt)[4]} ${u(this,Dt)[5]}`];for(let s=6,i=u(this,Dt).length;s<i;s+=6){if(isNaN(u(this,Dt)[s])){t.push(`L${u(this,Dt)[s+4]} ${u(this,Dt)[s+5]}`);continue}t.push(`C${u(this,Dt)[s]} ${u(this,Dt)[s+1]} ${u(this,Dt)[s+2]} ${u(this,Dt)[s+3]} ${u(this,Dt)[s+4]} ${u(this,Dt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,l=r-s;let c,d;switch(a){case 0:c=Q._rescale(u(this,Dt),t,r,o,-l),d=Q._rescale(u(this,Ms),t,r,o,-l);break;case 90:c=Q._rescaleAndSwap(u(this,Dt),t,s,o,l),d=Q._rescaleAndSwap(u(this,Ms),t,s,o,l);break;case 180:c=Q._rescale(u(this,Dt),i,s,-o,l),d=Q._rescale(u(this,Ms),i,s,-o,l);break;case 270:c=Q._rescaleAndSwap(u(this,Dt),i,r,-o,-l),d=Q._rescaleAndSwap(u(this,Ms),i,r,-o,-l);break}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return u(this,Hc)}newOutliner(t,s,i,r,a,o=0){return new Iv(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=u(this,Hc),[l,c,d,h]=u(this,Oh),p=a*d,y=o*h,v=i*d+l,_=r*h+c,E=this.newOutliner({x:u(this,Ms)[0]*p+v,y:u(this,Ms)[1]*y+_},u(this,Oh),u(this,Lg),t,u(this,Pg),s??u(this,xa));for(let b=2;b<u(this,Ms).length;b+=2)E.add({x:u(this,Ms)[b]*p+v,y:u(this,Ms)[b+1]*y+_});return E.getOutlines()}}Oh=new WeakMap,Hc=new WeakMap,xa=new WeakMap,Pg=new WeakMap,Ms=new WeakMap,Lg=new WeakMap,Dt=new WeakMap,cb=new WeakSet,GI=function(t){const s=u(this,Dt);let i=s[4],r=s[5];const a=[i,r,i,r];let o=i,l=r,c=i,d=r;const h=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,_=s.length;v<_;v+=6){const E=s[v+4],b=s[v+5];isNaN(s[v])?(X.pointBoundingBox(E,b,a),l>b?(o=E,l=b):l===b&&(o=h(o,E)),d<b?(c=E,d=b):d===b&&(c=h(c,E))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,X.bezierBoundingBox(i,r,...s.slice(v,v+6),p),X.rectBoundingBox(p[0],p[1],p[2],p[3],a),l>p[1]?(o=p[0],l=p[1]):l===p[1]&&(o=h(o,p[0])),d<p[3]?(c=p[2],d=p[3]):d===p[3]&&(c=h(c,p[2]))),i=E,r=b}const y=u(this,Hc);y[0]=a[0]-u(this,xa),y[1]=a[1]-u(this,xa),y[2]=a[2]-a[0]+2*u(this,xa),y[3]=a[3]-a[1]+2*u(this,xa),this.firstPoint=[o,l],this.lastPoint=[c,d]};var Og,Ug,Bg,Go,ji,Xn,qI,Dy,VI,$I,uS;class cS{constructor(e,t=0,s=0,i=!0){A(this,Xn);A(this,Og);A(this,Ug);A(this,Bg);A(this,Go,[]);A(this,ji,[]);const r=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x:_,y:E,width:b,height:w}of e){const S=Math.floor((_-t)/a)*a,T=Math.ceil((_+b+t)/a)*a,N=Math.floor((E-t)/a)*a,R=Math.ceil((E+w+t)/a)*a,k=[S,N,R,!0],I=[T,N,R,!1];u(this,Go).push(k,I),X.rectBoundingBox(S,N,T,R,r)}const o=r[2]-r[0]+2*s,l=r[3]-r[1]+2*s,c=r[0]-s,d=r[1]-s;let h=i?-1/0:1/0,p=1/0;const y=u(this,Go).at(i?-1:-2),v=[y[0],y[2]];for(const _ of u(this,Go)){const[E,b,w,S]=_;!S&&i?b<p?(p=b,h=E):b===p&&(h=Math.max(h,E)):S&&!i&&(b<p?(p=b,h=E):b===p&&(h=Math.min(h,E))),_[0]=(E-c)/o,_[1]=(b-d)/l,_[2]=(w-d)/l}x(this,Og,new Float32Array([c,d,o,l])),x(this,Ug,[h,p]),x(this,Bg,v)}getOutlines(){u(this,Go).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of u(this,Go))t[3]?(e.push(...C(this,Xn,uS).call(this,t)),C(this,Xn,VI).call(this,t)):(C(this,Xn,$I).call(this,t),e.push(...C(this,Xn,uS).call(this,t)));return C(this,Xn,qI).call(this,e)}}Og=new WeakMap,Ug=new WeakMap,Bg=new WeakMap,Go=new WeakMap,ji=new WeakMap,Xn=new WeakSet,qI=function(e){const t=[],s=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,l,c,d,h]=a;s.delete(a);let p=o,y=l;for(r=[o,c],i.push(r);;){let v;if(s.has(d))v=d;else if(s.has(h))v=h;else break;s.delete(v),[o,l,c,d,h]=v,p!==o&&(r.push(p,y,o,y===l?l:c),p=o),y=y===l?c:l}r.push(p,y)}return new K5(i,u(this,Og),u(this,Ug),u(this,Bg))},Dy=function(e){const t=u(this,ji);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},VI=function([,e,t]){const s=C(this,Xn,Dy).call(this,e);u(this,ji).splice(s,0,[e,t])},$I=function([,e,t]){const s=C(this,Xn,Dy).call(this,e);for(let i=s;i<u(this,ji).length;i++){const[r,a]=u(this,ji)[i];if(r!==e)break;if(r===e&&a===t){u(this,ji).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=u(this,ji)[i];if(r!==e)break;if(r===e&&a===t){u(this,ji).splice(i,1);return}}},uS=function(e){const[t,s,i]=e,r=[[t,s,i]],a=C(this,Xn,Dy).call(this,i);for(let o=0;o<a;o++){const[l,c]=u(this,ji)[o];for(let d=0,h=r.length;d<h;d++){const[,p,y]=r[d];if(!(c<=p||y<=l)){if(p>=l){if(y>c)r[d][1]=c;else{if(h===1)return[];r.splice(d,1),d--,h--}continue}r[d][2]=l,y>c&&r.push([t,c,y])}}}return r};var Fg,Uh;class K5 extends Q{constructor(t,s,i,r){super();A(this,Fg);A(this,Uh);x(this,Uh,t),x(this,Fg,s),this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const s of u(this,Uh)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],l=s[a+1];o===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],l=i-t,c=r-s;for(const d of u(this,Uh)){const h=new Array(d.length);for(let p=0;p<d.length;p+=2)h[p]=t+d[p]*l,h[p+1]=r-d[p+1]*c;o.push(h)}return o}get box(){return u(this,Fg)}get classNamesForOutlining(){return["highlightOutline"]}}Fg=new WeakMap,Uh=new WeakMap;class dS extends Iv{newFreeDrawOutline(e,t,s,i,r,a){return new J5(e,t,s,i,r,a)}}class J5 extends jI{newOutliner(e,t,s,i,r,a=0){return new dS(e,t,s,i,r,a)}}var Bh,zg,wa,jc,Hg,os,jg,Gg,Gc,Is,Ds,_n,Fh,zh,Un,Hh,di,qg,ve,hS,Py,YI,KI,JI,fS,Dl,_i,qu,XI,Ly,Oy,WI,QI,ZI,eD,tD;const Ie=class Ie extends rt{constructor(t){super({...t,name:"highlightEditor"});A(this,ve);A(this,Bh,null);A(this,zg,0);A(this,wa);A(this,jc,null);A(this,Hg,null);A(this,os,null);A(this,jg,null);A(this,Gg,0);A(this,Gc,null);A(this,Is,null);A(this,Ds,null);A(this,_n,!1);A(this,Fh,null);A(this,zh,null);A(this,Un,null);A(this,Hh,"");A(this,di);A(this,qg,"");this.color=t.color||Ie._defaultColor,x(this,di,t.thickness||Ie._defaultThickness),this.opacity=t.opacity||Ie._defaultOpacity,x(this,wa,t.boxes||null),x(this,qg,t.methodOfCreation||""),x(this,Hh,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(x(this,_n,!0),C(this,ve,Py).call(this,t),C(this,ve,Dl).call(this)):u(this,wa)&&(x(this,Bh,t.anchorNode),x(this,zg,t.anchorOffset),x(this,jg,t.focusNode),x(this,Gg,t.focusOffset),C(this,ve,hS).call(this),C(this,ve,Dl).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=Ie.prototype;return de(this,"_keyboardManager",new u0([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:u(this,_n)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:u(this,di),methodOfCreation:u(this,qg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;rt.initialize(t,s),Ie._defaultColor||(Ie._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case Ae.HIGHLIGHT_COLOR:Ie._defaultColor=s;break;case Ae.HIGHLIGHT_THICKNESS:Ie._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return u(this,zh)}get commentButtonPosition(){return u(this,Fh)}updateParams(t,s){switch(t){case Ae.HIGHLIGHT_COLOR:C(this,ve,YI).call(this,s);break;case Ae.HIGHLIGHT_THICKNESS:C(this,ve,KI).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[Ae.HIGHLIGHT_COLOR,Ie._defaultColor],[Ae.HIGHLIGHT_THICKNESS,Ie._defaultThickness]]}get propertiesToUpdate(){return[[Ae.HIGHLIGHT_COLOR,this.color||Ie._defaultColor],[Ae.HIGHLIGHT_THICKNESS,u(this,di)||Ie._defaultThickness],[Ae.HIGHLIGHT_FREE,u(this,_n)]]}onUpdatedColor(){var t,s;(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Ds),{root:{fill:this.color,"fill-opacity":this.opacity}}),(s=u(this,Hg))==null||s.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",x(this,Hg,new Rv({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,ve,Oy).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,C(this,ve,Oy).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){C(this,ve,fS).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,ve,Dl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?C(this,ve,fS).call(this):t&&(C(this,ve,Dl).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;u(this,_n)?(t=(t-this.rotation+360)%360,i=C(r=Ie,_i,qu).call(r,u(this,Is).box,t)):i=C(a=Ie,_i,qu).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(u(this,Ds),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(u(this,Un),{bbox:C(o=Ie,_i,qu).call(o,u(this,os).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();u(this,Hh)&&(t.setAttribute("aria-label",u(this,Hh)),t.setAttribute("role","mark")),u(this,_n)?t.classList.add("free"):this.div.addEventListener("keydown",C(this,ve,XI).bind(this),{signal:this._uiManager._signal});const s=x(this,Gc,document.createElement("div"));return t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=u(this,jc),this.setDims(),_M(this,u(this,Gc),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Un),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(u(this,Un),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:C(this,ve,Ly).call(this,!0);break;case 1:case 3:C(this,ve,Ly).call(this,!1);break}}select(){var t;super.select(),u(this,Un)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,Un),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),u(this,Un)&&((t=this.parent)==null||t.drawLayer.updateProperties(u(this,Un),{rootClass:{selected:!1}}),u(this,_n)||C(this,ve,Ly).call(this,!1))}get _mustFixPosition(){return!u(this,_n)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(u(this,Ds),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(u(this,Un),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:l,width:c,height:d}=i.getBoundingClientRect(),h=new AbortController,p=t.combinedSignal(h),y=v=>{h.abort(),C(this,_i,eD).call(this,t,v)};window.addEventListener("blur",y,{signal:p}),window.addEventListener("pointerup",y,{signal:p}),window.addEventListener("pointerdown",kt,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Ci,{signal:p}),i.addEventListener("pointermove",C(this,_i,ZI).bind(this,t),{signal:p}),this._freeHighlight=new dS({x:r,y:a},[o,l,c,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var _,E,b,w;let r=null;if(t instanceof RI){const{data:{quadPoints:S,rect:T,rotation:N,id:R,color:k,opacity:I,popupRef:M,richText:D,contentsObj:O,creationDate:L,modificationDate:$},parent:{page:{pageNumber:G}}}=t;r=t={annotationType:pe.HIGHLIGHT,color:Array.from(k),opacity:I,quadPoints:S,boxes:null,pageIndex:G-1,rect:T.slice(0),rotation:N,annotationElementId:R,id:R,deleted:!1,popupRef:M,richText:D,comment:(O==null?void 0:O.str)||null,creationDate:L,modificationDate:$}}else if(t instanceof yA){const{data:{inkLists:S,rect:T,rotation:N,id:R,color:k,borderStyle:{rawWidth:I},popupRef:M,richText:D,contentsObj:O,creationDate:L,modificationDate:$},parent:{page:{pageNumber:G}}}=t;r=t={annotationType:pe.HIGHLIGHT,color:Array.from(k),thickness:I,inkLists:S,boxes:null,pageIndex:G-1,rect:T.slice(0),rotation:N,annotationElementId:R,id:R,deleted:!1,popupRef:M,richText:D,comment:(O==null?void 0:O.str)||null,creationDate:L,modificationDate:$}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,d=await super.deserialize(t,s,i);d.color=X.makeHexColor(...a),d.opacity=c||1,l&&x(d,di,t.thickness),d._initialData=r,t.comment&&d.setCommentData(t);const[h,p]=d.pageDimensions,[y,v]=d.pageTranslation;if(o){const S=x(d,wa,[]);for(let T=0;T<o.length;T+=8)S.push({x:(o[T]-y)/h,y:1-(o[T+1]-v)/p,width:(o[T+2]-o[T])/h,height:(o[T+1]-o[T+5])/p});C(_=d,ve,hS).call(_),C(E=d,ve,Dl).call(E),d.rotate(d.rotation)}else if(l){x(d,_n,!0);const S=l[0],T={x:S[0]-y,y:p-(S[1]-v)},N=new dS(T,[0,0,h,p],1,u(d,di)/2,!0,.001);for(let I=0,M=S.length;I<M;I+=2)T.x=S[I]-y,T.y=p-(S[I+1]-v),N.add(T);const{id:R,clipPathId:k}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:N.toSVGPath()}},!0,!0);C(b=d,ve,Py).call(b,{highlightOutlines:N.getOutlines(),highlightId:R,clipPathId:k}),C(w=d,ve,Dl).call(w),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=rt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:s,opacity:this.opacity,thickness:u(this,di),quadPoints:C(this,ve,WI).call(this),outlines:C(this,ve,QI).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!C(this,ve,tD).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Bh=new WeakMap,zg=new WeakMap,wa=new WeakMap,jc=new WeakMap,Hg=new WeakMap,os=new WeakMap,jg=new WeakMap,Gg=new WeakMap,Gc=new WeakMap,Is=new WeakMap,Ds=new WeakMap,_n=new WeakMap,Fh=new WeakMap,zh=new WeakMap,Un=new WeakMap,Hh=new WeakMap,di=new WeakMap,qg=new WeakMap,ve=new WeakSet,hS=function(){const t=new cS(u(this,wa),.001);x(this,Is,t.getOutlines()),[this.x,this.y,this.width,this.height]=u(this,Is).box;const s=new cS(u(this,wa),.0025,.001,this._uiManager.direction==="ltr");x(this,os,s.getOutlines());const{firstPoint:i}=u(this,Is);x(this,Fh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:r}=u(this,os);x(this,zh,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},Py=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var p,y;if(x(this,Is,t),x(this,os,t.getNewOutline(u(this,di)/2+1.5,.0025)),s>=0)x(this,Ds,s),x(this,jc,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),x(this,Un,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:u(this,os).box,path:{d:u(this,os).toSVGPath()}},!0));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(u(this,Ds),{bbox:C(p=Ie,_i,qu).call(p,u(this,Is).box,(v-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(u(this,Un),{bbox:C(y=Ie,_i,qu).call(y,u(this,os).box,v),path:{d:u(this,os).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[v,_]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*_/v,this.height=c*v/_;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[v,_]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*_/v,this.height=c*v/_;break}}const{firstPoint:d}=t;x(this,Fh,[(d[0]-a)/l,(d[1]-o)/c]);const{lastPoint:h}=u(this,os);x(this,zh,[(h[0]-a)/l,(h[1]-o)/c])},YI=function(t){const s=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:s.bind(this,t,Ie._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ae.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},KI=function(t){const s=u(this,di),i=r=>{x(this,di,r),C(this,ve,JI).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Ae.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},JI=function(t){u(this,_n)&&(C(this,ve,Py).call(this,{highlightOutlines:u(this,Is).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())},fS=function(){u(this,Ds)===null||!this.parent||(this.parent.drawLayer.remove(u(this,Ds)),x(this,Ds,null),this.parent.drawLayer.remove(u(this,Un)),x(this,Un,null))},Dl=function(t=this.parent){u(this,Ds)===null&&({id:Vt(this,Ds)._,clipPathId:Vt(this,jc)._}=t.drawLayer.draw({bbox:u(this,Is).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:u(this,_n)},path:{d:u(this,Is).toSVGPath()}},!1,!0),x(this,Un,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:u(this,_n)},bbox:u(this,os).box,path:{d:u(this,os).toSVGPath()}},u(this,_n))),u(this,Gc)&&(u(this,Gc).style.clipPath=u(this,jc)))},_i=new WeakSet,qu=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},XI=function(t){Ie._keyboardManager.exec(this,t)},Ly=function(t){if(!u(this,Bh))return;const s=window.getSelection();t?s.setPosition(u(this,Bh),u(this,zg)):s.setPosition(u(this,jg),u(this,Gg))},Oy=function(){return u(this,_n)?this.rotation:0},WI=function(){if(u(this,_n))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=u(this,wa),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:d,width:h,height:p}of a){const y=c*t+i,v=(1-d)*s+r;o[l]=o[l+4]=y,o[l+1]=o[l+3]=v,o[l+2]=o[l+6]=y+h*t,o[l+5]=o[l+7]=v-p*s,l+=8}return o},QI=function(t){return u(this,Is).serialize(t,C(this,ve,Oy).call(this))},ZI=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},eD=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},tD=function(t){const{color:s}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==s[r])},A(Ie,_i),z(Ie,"_defaultColor",null),z(Ie,"_defaultOpacity",1),z(Ie,"_defaultThickness",12),z(Ie,"_type","highlight"),z(Ie,"_editorType",pe.HIGHLIGHT),z(Ie,"_freeHighlightId",-1),z(Ie,"_freeHighlight",null),z(Ie,"_freeHighlightClipId","");let Dv=Ie;var qc;class nD{constructor(){A(this,qc,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,s)}updateSVGProperty(e,t){u(this,qc)[e]=t}toSVGProperties(){const e=u(this,qc);return x(this,qc,Object.create(null)),{root:e}}reset(){x(this,qc,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ze("Not implemented")}}qc=new WeakMap;var Ps,jh,rn,Vc,$c,Ne,pS,mS,gS,hp,sD,Uy,fp,Vu;const Se=class Se extends rt{constructor(t){super(t);A(this,Ne);A(this,Ps,null);A(this,jh);z(this,"_colorPicker",null);z(this,"_drawId",null);x(this,jh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(C(this,Ne,pS).call(this,t),C(this,Ne,hp).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Ze("Not implemented")}static get typesMap(){Ze("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(u(Se,rn).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=l=>{var d;r.updateProperty(s,l);const c=u(this,Ps).updateProperty(s,l);c&&C(this,Ne,fp).call(this,c),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(u(this,Ps).getPathResizingSVGProperties(C(this,Ne,Uy).call(this)),{bbox:C(this,Ne,Vu).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(u(this,Ps).getPathResizedSVGProperties(C(this,Ne,Uy).call(this)),{bbox:C(this,Ne,Vu).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:C(this,Ne,Vu).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties(u(this,Ps).getPathTranslatedSVGProperties(C(this,Ne,Uy).call(this),this.parentDimensions),{bbox:C(this,Ne,Vu).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,u(this,jh)&&(x(this,jh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){C(this,Ne,gS).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,Ne,hp).call(this),C(this,Ne,fp).call(this,u(this,Ps).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),C(this,Ne,gS).call(this)):t&&(this._uiManager.addShouldRescale(this),C(this,Ne,hp).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Se._mergeSVGProperties({bbox:C(this,Ne,Vu).call(this)},u(this,Ps).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&C(this,Ne,fp).call(this,u(this,Ps).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,s;this._isCopy&&(t=this.x,s=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,s),i}static createDrawerInstance(t,s,i,r,a){Ze("Not implemented")}static startDrawing(t,s,i,r){var E;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:d}=r;if(In.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:h}}=t,{width:p,height:y}=a.getBoundingClientRect(),v=x(Se,Vc,new AbortController),_=t.combinedSignal(v);if(In.setPointer(d,c),window.addEventListener("pointerup",b=>{In.isSamePointerIdOrRemove(b.pointerId)&&this._endDraw(b)},{signal:_}),window.addEventListener("pointercancel",b=>{In.isSamePointerIdOrRemove(b.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",b=>{In.isSamePointerType(b.pointerType)&&(In.initializeAndAddPointerId(b.pointerId),u(Se,rn).isCancellable()&&(u(Se,rn).removeLastElement(),u(Se,rn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ci,{signal:_}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),a.addEventListener("touchmove",b=>{In.isSameTimeStamp(b.timeStamp)&&kt(b)},{signal:_}),t.toggleDrawing(),(E=s._editorUndoBar)==null||E.hide(),u(Se,rn)){t.drawLayer.updateProperties(this._currentDrawId,u(Se,rn).startNew(o,l,p,y,h));return}s.updateUIForDefaultProperties(this),x(Se,rn,this.createDrawerInstance(o,l,p,y,h)),x(Se,$c,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(u(Se,$c).toSVGProperties(),u(Se,rn).defaultSVGProperties),!0,!1)}static _drawMove(t){if(In.isSameTimeStamp(t.timeStamp),!u(Se,rn))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(In.isSamePointerId(r)){if(In.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,u(Se,rn).add(s,i)),In.setTimeStamp(t.timeStamp),kt(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,x(Se,rn,null),x(Se,$c,null),In.clearTimeStamp()),u(Se,Vc)&&(u(Se,Vc).abort(),x(Se,Vc,null),In.clearPointerIds())}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===s.div&&s.drawLayer.updateProperties(this._currentDrawId,u(Se,rn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=u(Se,rn),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:Ae.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(Ae.DRAW_STEP),!u(Se,rn).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:u(Se,rn).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:u(Se,$c),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){Ze("Not implemented")}static async deserialize(t,s,i){var h,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=s.viewport,c=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),d=await super.deserialize(t,s,i);return d.createDrawingOptions(t),C(h=d,Ne,pS).call(h,{drawOutlines:c}),C(p=d,Ne,hp).call(p),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return u(this,Ps).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Ps=new WeakMap,jh=new WeakMap,rn=new WeakMap,Vc=new WeakMap,$c=new WeakMap,Ne=new WeakSet,pS=function({drawOutlines:t,drawId:s,drawingOptions:i}){x(this,Ps,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=C(this,Ne,mS).call(this,t,this.parent),C(this,Ne,fp).call(this,t.box)},mS=function(t,s){const{id:i}=s.drawLayer.draw(Se._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},gS=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},hp=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=C(this,Ne,mS).call(this,u(this,Ps),t)}},sD=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Uy=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},fp=function(t){[this.x,this.y,this.width,this.height]=C(this,Ne,sD).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Vu=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(l/c),r*(c/l),i*(l/c)];case 5:return[1-s,t,i*(l/c),r*(c/l)];case 6:return[1-t-r*(c/l),1-s,r*(c/l),i*(l/c)];case 7:return[s-i*(l/c),1-t-r*(c/l),i*(l/c),r*(c/l)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(c/l),s,r*(c/l),i*(l/c)];case 13:return[1-s-i*(l/c),t-r*(c/l),i*(l/c),r*(c/l)];case 14:return[1-t,1-s-i*(l/c),r*(c/l),i*(l/c)];case 15:return[s,1-t,i*(l/c),r*(c/l)];default:return[t,s,i,r]}},z(Se,"_currentDrawId",-1),z(Se,"_currentParent",null),A(Se,rn,null),A(Se,Vc,null),A(Se,$c,null),z(Se,"_INNER_MARGIN",3);let Pv=Se;var wr,an,on,Yc,Gh,Hn,xn,hi,Kc,Jc,Xc,qh,By;class X5{constructor(e,t,s,i,r,a){A(this,qh);A(this,wr,new Float64Array(6));A(this,an);A(this,on);A(this,Yc);A(this,Gh);A(this,Hn);A(this,xn,"");A(this,hi,0);A(this,Kc,new h0);A(this,Jc);A(this,Xc);x(this,Jc,s),x(this,Xc,i),x(this,Yc,r),x(this,Gh,a),[e,t]=C(this,qh,By).call(this,e,t);const o=x(this,an,[NaN,NaN,NaN,NaN,e,t]);x(this,Hn,[e,t]),x(this,on,[{line:o,points:u(this,Hn)}]),u(this,wr).set(o,0)}updateProperty(e,t){e==="stroke-width"&&x(this,Gh,t)}isEmpty(){return!u(this,on)||u(this,on).length===0}isCancellable(){return u(this,Hn).length<=10}add(e,t){[e,t]=C(this,qh,By).call(this,e,t);const[s,i,r,a]=u(this,wr).subarray(2,6),o=e-r,l=t-a;return Math.hypot(u(this,Jc)*o,u(this,Xc)*l)<=2?null:(u(this,Hn).push(e,t),isNaN(s)?(u(this,wr).set([r,a,e,t],2),u(this,an).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(u(this,wr)[0])&&u(this,an).splice(6,6),u(this,wr).set([s,i,r,a,e,t],0),u(this,an).push(...Q.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(u(this,Hn).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){x(this,Jc,s),x(this,Xc,i),x(this,Yc,r),[e,t]=C(this,qh,By).call(this,e,t);const a=x(this,an,[NaN,NaN,NaN,NaN,e,t]);x(this,Hn,[e,t]);const o=u(this,on).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),u(this,on).push({line:a,points:u(this,Hn)}),u(this,wr).set(a,0),x(this,hi,0),this.toSVGPath(),null}getLastElement(){return u(this,on).at(-1)}setLastElement(e){return u(this,on)?(u(this,on).push(e),x(this,an,e.line),x(this,Hn,e.points),x(this,hi,0),{path:{d:this.toSVGPath()}}):u(this,Kc).setLastElement(e)}removeLastElement(){if(!u(this,on))return u(this,Kc).removeLastElement();u(this,on).pop(),x(this,xn,"");for(let e=0,t=u(this,on).length;e<t;e++){const{line:s,points:i}=u(this,on)[e];x(this,an,s),x(this,Hn,i),x(this,hi,0),this.toSVGPath()}return{path:{d:u(this,xn)}}}toSVGPath(){const e=Q.svgRound(u(this,an)[4]),t=Q.svgRound(u(this,an)[5]);if(u(this,Hn).length===2)return x(this,xn,`${u(this,xn)} M ${e} ${t} Z`),u(this,xn);if(u(this,Hn).length<=6){const i=u(this,xn).lastIndexOf("M");x(this,xn,`${u(this,xn).slice(0,i)} M ${e} ${t}`),x(this,hi,6)}if(u(this,Hn).length===4){const i=Q.svgRound(u(this,an)[10]),r=Q.svgRound(u(this,an)[11]);return x(this,xn,`${u(this,xn)} L ${i} ${r}`),x(this,hi,12),u(this,xn)}const s=[];u(this,hi)===0&&(s.push(`M ${e} ${t}`),x(this,hi,6));for(let i=u(this,hi),r=u(this,an).length;i<r;i+=6){const[a,o,l,c,d,h]=u(this,an).slice(i,i+6).map(Q.svgRound);s.push(`C${a} ${o} ${l} ${c} ${d} ${h}`)}return x(this,xn,u(this,xn)+s.join(" ")),x(this,hi,u(this,an).length),u(this,xn)}getOutlines(e,t,s,i){const r=u(this,on).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),u(this,Kc).build(u(this,on),e,t,s,u(this,Yc),u(this,Gh),i),x(this,wr,null),x(this,an,null),x(this,on,null),x(this,xn,null),u(this,Kc)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}wr=new WeakMap,an=new WeakMap,on=new WeakMap,Yc=new WeakMap,Gh=new WeakMap,Hn=new WeakMap,xn=new WeakMap,hi=new WeakMap,Kc=new WeakMap,Jc=new WeakMap,Xc=new WeakMap,qh=new WeakSet,By=function(e,t){return Q._normalizePoint(e,t,u(this,Jc),u(this,Xc),u(this,Yc))};var jn,Vg,$g,Ls,Sr,Er,Vh,$h,Wc,An,Gr,iD,rD,aD;class h0 extends Q{constructor(){super(...arguments);A(this,An);A(this,jn);A(this,Vg,0);A(this,$g);A(this,Ls);A(this,Sr);A(this,Er);A(this,Vh);A(this,$h);A(this,Wc)}build(t,s,i,r,a,o,l){x(this,Sr,s),x(this,Er,i),x(this,Vh,r),x(this,$h,a),x(this,Wc,o),x(this,$g,l??0),x(this,Ls,t),C(this,An,rD).call(this)}get thickness(){return u(this,Wc)}setLastElement(t){return u(this,Ls).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return u(this,Ls).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of u(this,Ls)){if(t.push(`M${Q.svgRound(s[4])} ${Q.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12&&isNaN(s[6])){t.push(`L${Q.svgRound(s[10])} ${Q.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,l,c,d,h]=s.subarray(i,i+6).map(Q.svgRound);t.push(`C${a} ${o} ${l} ${c} ${d} ${h}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],l=[],[c,d,h,p]=C(this,An,iD).call(this);let y,v,_,E,b,w,S,T,N;switch(u(this,$h)){case 0:N=Q._rescale,y=t,v=s+r,_=i,E=-r,b=t+c*i,w=s+(1-d-p)*r,S=t+(c+h)*i,T=s+(1-d)*r;break;case 90:N=Q._rescaleAndSwap,y=t,v=s,_=i,E=r,b=t+d*i,w=s+c*r,S=t+(d+p)*i,T=s+(c+h)*r;break;case 180:N=Q._rescale,y=t+i,v=s,_=-i,E=r,b=t+(1-c-h)*i,w=s+d*r,S=t+(1-c)*i,T=s+(d+p)*r;break;case 270:N=Q._rescaleAndSwap,y=t+i,v=s+r,_=-i,E=-r,b=t+(1-d-p)*i,w=s+(1-c-h)*r,S=t+(1-d)*i,T=s+(1-c)*r;break}for(const{line:R,points:k}of u(this,Ls))o.push(N(R,y,v,_,E,a?new Array(R.length):null)),l.push(N(k,y,v,_,E,a?new Array(k.length):null));return{lines:o,points:l,rect:[b,w,S,T]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:l},rotation:c,thickness:d}){const h=[];let p,y,v,_,E;switch(c){case 0:E=Q._rescale,p=-t/i,y=s/r+1,v=1/i,_=-1/r;break;case 90:E=Q._rescaleAndSwap,p=-s/r,y=-t/i,v=1/r,_=1/i;break;case 180:E=Q._rescale,p=t/i+1,y=-s/r,v=-1/i,_=1/r;break;case 270:E=Q._rescaleAndSwap,p=s/r+1,y=t/i+1,v=-1/r,_=-1/i;break}if(!o){o=[];for(const w of l){const S=w.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,w[0],w[1],NaN,NaN,NaN,NaN,w[2],w[3]]));continue}const T=new Float32Array(3*(S-2));o.push(T);let[N,R,k,I]=w.subarray(0,4);T.set([NaN,NaN,NaN,NaN,N,R],0);for(let M=4;M<S;M+=2){const D=w[M],O=w[M+1];T.set(Q.createBezierPoints(N,R,k,I,D,O),(M-2)*3),[N,R,k,I]=[k,I,D,O]}}}for(let w=0,S=o.length;w<S;w++)h.push({line:E(o[w].map(T=>T??NaN),p,y,v,_),points:E(l[w].map(T=>T??NaN),p,y,v,_)});const b=new this.prototype.constructor;return b.build(h,i,r,1,c,d,a),b}get box(){return u(this,jn)}updateProperty(t,s){return t==="stroke-width"?C(this,An,aD).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=C(this,An,Gr).call(this);x(this,Sr,t),x(this,Er,s),x(this,Vh,i);const[o,l]=C(this,An,Gr).call(this),c=o-r,d=l-a,h=u(this,jn);return h[0]-=c,h[1]-=d,h[2]+=2*c,h[3]+=2*d,h}updateRotation(t){return x(this,Vg,t),{path:{transform:this.rotationTransform}}}get viewBox(){return u(this,jn).map(Q.svgRound).join(" ")}get defaultProperties(){const[t,s]=u(this,jn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(t)} ${Q.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=u(this,jn);let i=0,r=0,a=0,o=0,l=0,c=0;switch(u(this,Vg)){case 90:r=s/t,a=-t/s,l=t;break;case 180:i=-1,o=-1,l=t,c=s;break;case 270:r=-s/t,a=t/s,c=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${Q.svgRound(l)} ${Q.svgRound(c)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=C(this,An,Gr).call(this),[l,c,d,h]=u(this,jn);if(Math.abs(d-a)<=Q.PRECISION||Math.abs(h-o)<=Q.PRECISION){const E=t+i/2-(l+d/2),b=s+r/2-(c+h/2);return{path:{"transform-origin":`${Q.svgRound(t)} ${Q.svgRound(s)}`,transform:`${this.rotationTransform} translate(${E} ${b})`}}}const p=(i-2*a)/(d-2*a),y=(r-2*o)/(h-2*o),v=d/i,_=h/r;return{path:{"transform-origin":`${Q.svgRound(l)} ${Q.svgRound(c)}`,transform:`${this.rotationTransform} scale(${v} ${_}) translate(${Q.svgRound(a)} ${Q.svgRound(o)}) scale(${p} ${y}) translate(${Q.svgRound(-a)} ${Q.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=C(this,An,Gr).call(this),l=u(this,jn),[c,d,h,p]=l;if(l[0]=t,l[1]=s,l[2]=i,l[3]=r,Math.abs(h-a)<=Q.PRECISION||Math.abs(p-o)<=Q.PRECISION){const b=t+i/2-(c+h/2),w=s+r/2-(d+p/2);for(const{line:S,points:T}of u(this,Ls))Q._translate(S,b,w,S),Q._translate(T,b,w,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(t)} ${Q.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(i-2*a)/(h-2*a),v=(r-2*o)/(p-2*o),_=-y*(c+a)+t+a,E=-v*(d+o)+s+o;if(y!==1||v!==1||_!==0||E!==0)for(const{line:b,points:w}of u(this,Ls))Q._rescale(b,_,E,y,v,b),Q._rescale(w,_,E,y,v,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(t)} ${Q.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=u(this,jn),l=t-o[0],c=s-o[1];if(u(this,Sr)===r&&u(this,Er)===a)for(const{line:d,points:h}of u(this,Ls))Q._translate(d,l,c,d),Q._translate(h,l,c,h);else{const d=u(this,Sr)/r,h=u(this,Er)/a;x(this,Sr,r),x(this,Er,a);for(const{line:p,points:y}of u(this,Ls))Q._rescale(p,l,c,d,h,p),Q._rescale(y,l,c,d,h,y);o[2]*=d,o[3]*=h}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(t)} ${Q.svgRound(s)}`}}}get defaultSVGProperties(){const t=u(this,jn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(t[0])} ${Q.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}jn=new WeakMap,Vg=new WeakMap,$g=new WeakMap,Ls=new WeakMap,Sr=new WeakMap,Er=new WeakMap,Vh=new WeakMap,$h=new WeakMap,Wc=new WeakMap,An=new WeakSet,Gr=function(t=u(this,Wc)){const s=u(this,$g)+t/2*u(this,Vh);return u(this,$h)%180===0?[s/u(this,Sr),s/u(this,Er)]:[s/u(this,Er),s/u(this,Sr)]},iD=function(){const[t,s,i,r]=u(this,jn),[a,o]=C(this,An,Gr).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},rD=function(){const t=x(this,jn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of u(this,Ls)){if(r.length<=12){for(let l=4,c=r.length;l<c;l+=6)X.pointBoundingBox(r[l],r[l+1],t);continue}let a=r[4],o=r[5];for(let l=6,c=r.length;l<c;l+=6){const[d,h,p,y,v,_]=r.subarray(l,l+6);X.bezierBoundingBox(a,o,d,h,p,y,v,_,t),a=v,o=_}}const[s,i]=C(this,An,Gr).call(this);t[0]=Yn(t[0]-s,0,1),t[1]=Yn(t[1]-i,0,1),t[2]=Yn(t[2]+s,0,1),t[3]=Yn(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},aD=function(t){const[s,i]=C(this,An,Gr).call(this);x(this,Wc,t);const[r,a]=C(this,An,Gr).call(this),[o,l]=[r-s,a-i],c=u(this,jn);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};class Ob extends nD{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:rt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Ob(this._viewParameters);return e.updateAll(this),e}}var ub,oD;const md=class md extends Pv{constructor(t){super({...t,name:"inkEditor"});A(this,ub);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,s){rt.initialize(t,s),this._defaultDrawingOptions=new Ob(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return de(this,"typesMap",new Map([[Ae.INK_THICKNESS,"stroke-width"],[Ae.INK_COLOR,"stroke"],[Ae.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new X5(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return h0.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof yA){const{data:{inkLists:o,rect:l,rotation:c,id:d,color:h,opacity:p,borderStyle:{rawWidth:y},popupRef:v,richText:_,contentsObj:E,creationDate:b,modificationDate:w},parent:{page:{pageNumber:S}}}=t;r=t={annotationType:pe.INK,color:Array.from(h),thickness:y,opacity:p,paths:{points:o},boxes:null,pageIndex:S-1,rect:l.slice(0),rotation:c,annotationElementId:d,id:d,deleted:!1,popupRef:v,richText:_,comment:(E==null?void 0:E.str)||null,creationDate:b,modificationDate:w}}const a=await super.deserialize(t,s,i);return a._initialData=r,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new kv(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Ae.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=md.getDefaultDrawingOptions({stroke:X.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:rt._colorManager.convert(r),opacity:a,thickness:o,paths:{lines:s,points:i}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!C(this,ub,oD).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s,popup:this.comment}),null}};ub=new WeakSet,oD=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==s[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},z(md,"_type","ink"),z(md,"_editorType",pe.INK),z(md,"_defaultDrawingOptions",null);let yS=md;class vS extends h0{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const F0=8,zf=3;var Qc,Oe,bS,Gi,lD,cD,_S,Fy,uD,dD,hD,xS,wS,fD;class Ra{static extractContoursFromText(e,{fontFamily:t,fontStyle:s,fontWeight:i},r,a,o,l){let c=new OffscreenCanvas(1,1),d=c.getContext("2d",{alpha:!1});const h=200,p=d.font=`${s} ${i} ${h}px ${t}`,{actualBoundingBoxLeft:y,actualBoundingBoxRight:v,actualBoundingBoxAscent:_,actualBoundingBoxDescent:E,fontBoundingBoxAscent:b,fontBoundingBoxDescent:w,width:S}=d.measureText(e),T=1.5,N=Math.ceil(Math.max(Math.abs(y)+Math.abs(v)||0,S)*T),R=Math.ceil(Math.max(Math.abs(_)+Math.abs(E)||h,Math.abs(b)+Math.abs(w)||h)*T);c=new OffscreenCanvas(N,R),d=c.getContext("2d",{alpha:!0,willReadFrequently:!0}),d.font=p,d.filter="grayscale(1)",d.fillStyle="white",d.fillRect(0,0,N,R),d.fillStyle="black",d.fillText(e,N*(T-1)/2,R*(3-T)/2);const k=C(this,Oe,xS).call(this,d.getImageData(0,0,N,R).data),I=C(this,Oe,hD).call(this,k),M=C(this,Oe,wS).call(this,I),D=C(this,Oe,_S).call(this,k,N,R,M);return this.processDrawnLines({lines:{curves:D,width:N,height:R},pageWidth:r,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,s,i,r){const[a,o,l]=C(this,Oe,fD).call(this,e),[c,d]=C(this,Oe,dD).call(this,a,o,l,Math.hypot(o,l)*u(this,Qc).sigmaSFactor,u(this,Qc).sigmaR,u(this,Qc).kernelSize),h=C(this,Oe,wS).call(this,d),p=C(this,Oe,_S).call(this,c,o,l,h);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:s,rotation:i,innerMargin:r,mustSmooth:a,areContours:o}){i%180!==0&&([t,s]=[s,t]);const{curves:l,width:c,height:d}=e,h=e.thickness??0,p=[],y=Math.min(t/c,s/d),v=y/t,_=y/s,E=[];for(const{points:w}of l){const S=a?C(this,Oe,uD).call(this,w):w;if(!S)continue;E.push(S);const T=S.length,N=new Float32Array(T),R=new Float32Array(3*(T===2?2:T-2));if(p.push({line:R,points:N}),T===2){N[0]=S[0]*v,N[1]=S[1]*_,R.set([NaN,NaN,NaN,NaN,N[0],N[1]],0);continue}let[k,I,M,D]=S;k*=v,I*=_,M*=v,D*=_,N.set([k,I,M,D],0),R.set([NaN,NaN,NaN,NaN,k,I],0);for(let O=4;O<T;O+=2){const L=N[O]=S[O]*v,$=N[O+1]=S[O+1]*_;R.set(Q.createBezierPoints(k,I,M,D,L,$),(O-2)*3),[k,I,M,D]=[M,D,L,$]}}if(p.length===0)return null;const b=o?new vS:new h0;return b.build(p,t,s,1,i,o?0:h,r),{outline:b,newCurves:E,areContours:o,thickness:h,width:c,height:d}}static async compressSignature({outlines:e,areContours:t,thickness:s,width:i,height:r}){let a=1/0,o=-1/0,l=0;for(const S of e){l+=S.length;for(let T=2,N=S.length;T<N;T++){const R=S[T]-S[T-2];a=Math.min(a,R),o=Math.max(o,R)}}let c;a>=-128&&o<=127?c=Int8Array:a>=-32768&&o<=32767?c=Int16Array:c=Int32Array;const d=e.length,h=F0+zf*d,p=new Uint32Array(h);let y=0;p[y++]=h*Uint32Array.BYTES_PER_ELEMENT+(l-2*d)*c.BYTES_PER_ELEMENT,p[y++]=0,p[y++]=i,p[y++]=r,p[y++]=t?0:1,p[y++]=Math.max(0,Math.floor(s??0)),p[y++]=d,p[y++]=c.BYTES_PER_ELEMENT;for(const S of e)p[y++]=S.length-2,p[y++]=S[0],p[y++]=S[1];const v=new CompressionStream("deflate-raw"),_=v.writable.getWriter();await _.ready,_.write(p);const E=c.prototype.constructor;for(const S of e){const T=new E(S.length-2);for(let N=2,R=S.length;N<R;N++)T[N-2]=S[N]-S[N-2];_.write(T)}_.close();const b=await new Response(v.readable).arrayBuffer(),w=new Uint8Array(b);return dM(w)}static async decompressSignature(e){try{const t=hU(e),{readable:s,writable:i}=new DecompressionStream("deflate-raw"),r=i.getWriter();await r.ready,r.write(t).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const S of s)a||(a=new Uint8Array(new Uint32Array(S.buffer,0,4)[0])),a.set(S,o),o+=S.length;const l=new Uint32Array(a.buffer,0,a.length>>2),c=l[1];if(c!==0)throw new Error(`Invalid version: ${c}`);const d=l[2],h=l[3],p=l[4]===0,y=l[5],v=l[6],_=l[7],E=[],b=(F0+zf*v)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(_){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(a.buffer,b);break}o=0;for(let S=0;S<v;S++){const T=l[zf*S+F0],N=new Float32Array(T+2);E.push(N);for(let R=0;R<zf-1;R++)N[R]=l[zf*S+F0+R+1];for(let R=0;R<T;R++)N[R+2]=N[R]+w[o++]}return{areContours:p,thickness:y,outlines:E,width:d,height:h}}catch(t){return ue(`decompressSignature: ${t}`),null}}}Qc=new WeakMap,Oe=new WeakSet,bS=function(e,t,s,i){return s-=e,i-=t,s===0?i>0?0:4:s===1?i+6:2-i},Gi=new WeakMap,lD=function(e,t,s,i,r,a,o){const l=C(this,Oe,bS).call(this,s,i,r,a);for(let c=0;c<8;c++){const d=(-c+l-o+16)%8,h=u(this,Gi)[2*d],p=u(this,Gi)[2*d+1];if(e[(s+h)*t+(i+p)]!==0)return d}return-1},cD=function(e,t,s,i,r,a,o){const l=C(this,Oe,bS).call(this,s,i,r,a);for(let c=0;c<8;c++){const d=(c+l+o+16)%8,h=u(this,Gi)[2*d],p=u(this,Gi)[2*d+1];if(e[(s+h)*t+(i+p)]!==0)return d}return-1},_S=function(e,t,s,i){const r=e.length,a=new Int32Array(r);for(let d=0;d<r;d++)a[d]=e[d]<=i?1:0;for(let d=1;d<s-1;d++)a[d*t]=a[d*t+t-1]=0;for(let d=0;d<t;d++)a[d]=a[t*s-1-d]=0;let o=1,l;const c=[];for(let d=1;d<s-1;d++){l=1;for(let h=1;h<t-1;h++){const p=d*t+h,y=a[p];if(y===0)continue;let v=d,_=h;if(y===1&&a[p-1]===0)o+=1,_-=1;else if(y>=1&&a[p+1]===0)o+=1,_+=1,y>1&&(l=y);else{y!==1&&(l=Math.abs(y));continue}const E=[h,d],b=_===h+1,w={isHole:b,points:E,id:o,parent:0};c.push(w);let S;for(const O of c)if(O.id===l){S=O;break}S?S.isHole?w.parent=b?S.parent:l:w.parent=b?l:S.parent:w.parent=b?l:0;const T=C(this,Oe,lD).call(this,a,t,d,h,v,_,0);if(T===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let N=u(this,Gi)[2*T],R=u(this,Gi)[2*T+1];const k=d+N,I=h+R;v=k,_=I;let M=d,D=h;for(;;){const O=C(this,Oe,cD).call(this,a,t,M,D,v,_,1);N=u(this,Gi)[2*O],R=u(this,Gi)[2*O+1];const L=M+N,$=D+R;E.push($,L);const G=M*t+D;if(a[G+1]===0?a[G]=-o:a[G]===1&&(a[G]=o),L===d&&$===h&&M===k&&D===I){a[p]!==1&&(l=Math.abs(a[p]));break}else v=M,_=D,M=L,D=$}}}return c},Fy=function(e,t,s,i){if(s-t<=4){for(let k=t;k<s-2;k+=2)i.push(e[k],e[k+1]);return}const r=e[t],a=e[t+1],o=e[s-4]-r,l=e[s-3]-a,c=Math.hypot(o,l),d=o/c,h=l/c,p=d*a-h*r,y=l/o,v=1/c,_=Math.atan(y),E=Math.cos(_),b=Math.sin(_),w=v*(Math.abs(E)+Math.abs(b)),S=v*(1-w+w**2),T=Math.max(Math.atan(Math.abs(b+E)*S),Math.atan(Math.abs(b-E)*S));let N=0,R=t;for(let k=t+2;k<s-2;k+=2){const I=Math.abs(p-d*e[k+1]+h*e[k]);I>N&&(R=k,N=I)}N>(c*T)**2?(C(this,Oe,Fy).call(this,e,t,R+2,i),C(this,Oe,Fy).call(this,e,R,s,i)):i.push(r,a)},uD=function(e){const t=[],s=e.length;return C(this,Oe,Fy).call(this,e,0,s,t),t.push(e[s-2],e[s-1]),t.length<=4?null:t},dD=function(e,t,s,i,r,a){const o=new Float32Array(a**2),l=-2*i**2,c=a>>1;for(let _=0;_<a;_++){const E=(_-c)**2;for(let b=0;b<a;b++)o[_*a+b]=Math.exp((E+(b-c)**2)/l)}const d=new Float32Array(256),h=-2*r**2;for(let _=0;_<256;_++)d[_]=Math.exp(_**2/h);const p=e.length,y=new Uint8Array(p),v=new Uint32Array(256);for(let _=0;_<s;_++)for(let E=0;E<t;E++){const b=_*t+E,w=e[b];let S=0,T=0;for(let R=0;R<a;R++){const k=_+R-c;if(!(k<0||k>=s))for(let I=0;I<a;I++){const M=E+I-c;if(M<0||M>=t)continue;const D=e[k*t+M],O=o[R*a+I]*d[Math.abs(D-w)];S+=D*O,T+=O}}const N=y[b]=Math.round(S/T);v[N]++}return[y,v]},hD=function(e){const t=new Uint32Array(256);for(const s of e)t[s]++;return t},xS=function(e){const t=e.length,s=new Uint8ClampedArray(t>>2);let i=-1/0,r=1/0;for(let o=0,l=s.length;o<l;o++){const c=s[o]=e[o<<2];i=Math.max(i,c),r=Math.min(r,c)}const a=255/(i-r);for(let o=0,l=s.length;o<l;o++)s[o]=(s[o]-r)*a;return s},wS=function(e){let t,s=-1/0,i=-1/0;const r=e.findIndex(l=>l!==0);let a=r,o=r;for(t=r;t<256;t++){const l=e[t];l>s&&(t-a>i&&(i=t-a,o=t-1),s=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},fD=function(e){const t=e,{width:s,height:i}=e,{maxDim:r}=u(this,Qc);let a=s,o=i;if(s>r||i>r){let p=s,y=i,v=Math.log2(Math.max(s,i)/r);const _=Math.floor(v);v=v===_?_-1:_;for(let b=0;b<v;b++){a=Math.ceil(p/2),o=Math.ceil(y/2);const w=new OffscreenCanvas(a,o);w.getContext("2d").drawImage(e,0,0,p,y,0,0,a,o),p=a,y=o,e!==t&&e.close(),e=w.transferToImageBitmap()}const E=Math.min(r/a,r/o);a=Math.round(a*E),o=Math.round(o*E)}const c=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});c.fillStyle="white",c.fillRect(0,0,a,o),c.filter="grayscale(1)",c.drawImage(e,0,0,e.width,e.height,0,0,a,o);const d=c.getImageData(0,0,a,o).data;return[C(this,Oe,xS).call(this,d),a,o]},A(Ra,Oe),A(Ra,Qc,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),A(Ra,Gi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class vA extends nD{constructor(){super(),super.updateProperties({fill:rt._defaultLineColor,"stroke-width":0})}clone(){const e=new vA;return e.updateAll(this),e}}class bA extends Ob{constructor(e){super(e),super.updateProperties({stroke:rt._defaultLineColor,"stroke-width":1})}clone(){const e=new bA(this._viewParameters);return e.updateAll(this),e}}var qo,Ar,Vo,Zc;const ys=class ys extends Pv{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});A(this,qo,!1);A(this,Ar,null);A(this,Vo,null);A(this,Zc,null);this._willKeepAspectRatio=!0,x(this,Vo,t.signatureData||null),x(this,Ar,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,s){rt.initialize(t,s),this._defaultDrawingOptions=new vA,this._defaultDrawnSignatureOptions=new bA(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!1}static get typesMap(){return de(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!u(this,Ar)}}static computeTelemetryFinalData(t){const s=t.get("hasDescription");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,s;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,s=this.y),super.render(),this._drawId===null)if(u(this,Vo)){const{lines:r,mustSmooth:a,areContours:o,description:l,uuid:c,heightInPage:d}=u(this,Vo),{rawDims:{pageWidth:h,pageHeight:p},rotation:y}=this.parent.viewport,v=Ra.processDrawnLines({lines:r,pageWidth:h,pageHeight:p,rotation:y,innerMargin:ys._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,d,l,c)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:u(this,Ar)||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,s)),this.div}setUuid(t){x(this,Zc,t),this.addEditToolbar()}getUuid(){return u(this,Zc)}get description(){return u(this,Ar)}set description(t){x(this,Ar,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(s=>{s==null||s.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:s,thickness:i,width:r,height:a}=u(this,Vo),o=Math.max(r,a),l=Ra.processDrawnLines({lines:{curves:t.map(c=>({points:c})),thickness:i,width:r,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:s});return{areContours:s,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,s,i,r){const{x:a,y:o}=this,{outline:l}=x(this,Vo,t);x(this,qo,l instanceof vS),this.description=i;let c;u(this,qo)?c=ys.getDefaultDrawingOptions():(c=ys._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:c});const[,d]=this.pageDimensions;let h=s/d;h=h>=1?.5:h,this.width*=h/this.height,this.width>=1&&(h*=.9/this.width,this.width=.9),this.height=h,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ra.process(t,s,i,r,ys._INNER_MARGIN)}getFromText(t,s){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return Ra.extractContoursFromText(t,s,i,r,a,ys._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:s,pageHeight:i},rotation:r}=this.parent.viewport;return Ra.processDrawnLines({lines:t,pageWidth:s,pageHeight:i,rotation:r,innerMargin:ys._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:s}){t?this._drawingOptions=ys.getDefaultDrawingOptions():(this._drawingOptions=ys._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":s}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:s,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:u(this,qo),color:[0,0,0],thickness:u(this,qo)?0:r});return this.addComment(a),t?(a.paths={lines:s,points:i},a.uuid=u(this,Zc),a.isCopy=!0):a.lines=s,u(this,Ar)&&(a.accessibilityData={type:"Figure",alt:u(this,Ar)}),a}static deserializeDraw(t,s,i,r,a,o){return o.areContours?vS.deserialize(t,s,i,r,a,o):h0.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){var a;const r=await super.deserialize(t,s,i);return x(r,qo,t.areContours),r.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",x(r,Zc,t.uuid),r}};qo=new WeakMap,Ar=new WeakMap,Vo=new WeakMap,Zc=new WeakMap,z(ys,"_type","signature"),z(ys,"_editorType",pe.SIGNATURE),z(ys,"_defaultDrawingOptions",null);let SS=ys;var mt,ln,$o,Sa,Yo,Yh,Ea,eu,Tr,Os,Kh,Re,pp,mp,zy,Hy,jy,AS,Gy,pD;class ES extends rt{constructor(t){super({...t,name:"stampEditor"});A(this,Re);A(this,mt,null);A(this,ln,null);A(this,$o,null);A(this,Sa,null);A(this,Yo,null);A(this,Yh,"");A(this,Ea,null);A(this,eu,!1);A(this,Tr,null);A(this,Os,!1);A(this,Kh,!1);x(this,Sa,t.bitmapUrl),x(this,Yo,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,s){rt.initialize(t,s)}static isHandlingMimeForPasting(t){return cw.includes(t)}static paste(t,s){s.pasteEditor({mode:pe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),s&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;u(this,ln)&&(x(this,mt,null),this._uiManager.imageManager.deleteId(u(this,ln)),(t=u(this,Ea))==null||t.remove(),x(this,Ea,null),u(this,Tr)&&(clearTimeout(u(this,Tr)),x(this,Tr,null))),super.remove()}rebuild(){if(!this.parent){u(this,ln)&&C(this,Re,zy).call(this);return}super.rebuild(),this.div!==null&&(u(this,ln)&&u(this,Ea)===null&&C(this,Re,zy).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(u(this,$o)||u(this,mt)||u(this,Sa)||u(this,Yo)||u(this,ln)||u(this,eu))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;return this._isCopy&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.createAltText(),u(this,eu)||(u(this,mt)?C(this,Re,Hy).call(this):C(this,Re,zy).call(this)),this._isCopy&&this._moveAfterPaste(t,s),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,s){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,s);s.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(x(this,ln,i),r&&x(this,mt,r),x(this,eu,!1),C(this,Re,Hy).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;u(this,Tr)!==null&&clearTimeout(u(this,Tr)),x(this,Tr,setTimeout(()=>{x(this,Tr,null),C(this,Re,AS).call(this)},200))}copyCanvas(t,s,i=!1){t||(t=224);const{width:r,height:a}=u(this,mt),o=new Ir;let l=u(this,mt),c=r,d=a,h=null;if(s){if(r>s||a>s){const k=Math.min(s/r,s/a);c=Math.floor(r*k),d=Math.floor(a*k)}h=document.createElement("canvas");const y=h.width=Math.ceil(c*o.sx),v=h.height=Math.ceil(d*o.sy);u(this,Os)||(l=C(this,Re,jy).call(this,y,v));const _=h.getContext("2d");_.filter=this._uiManager.hcmFilter;let E="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":vU.isDarkMode&&(E="#8f8f9d",b="#42414d");const w=15,S=w*o.sx,T=w*o.sy,N=new OffscreenCanvas(S*2,T*2),R=N.getContext("2d");R.fillStyle=E,R.fillRect(0,0,S*2,T*2),R.fillStyle=b,R.fillRect(0,0,S,T),R.fillRect(S,T,S,T),_.fillStyle=_.createPattern(N,"repeat"),_.fillRect(0,0,y,v),_.drawImage(l,0,0,l.width,l.height,0,0,y,v)}let p=null;if(i){let y,v;if(o.symmetric&&l.width<t&&l.height<t)y=l.width,v=l.height;else if(l=u(this,mt),r>t||a>t){const b=Math.min(t/r,t/a);y=Math.floor(r*b),v=Math.floor(a*b),u(this,Os)||(l=C(this,Re,jy).call(this,y,v))}const E=new OffscreenCanvas(y,v).getContext("2d",{willReadFrequently:!0});E.drawImage(l,0,0,l.width,l.height,0,0,y,v),p={width:y,height:v,data:E.getImageData(0,0,y,v).data}}return{canvas:h,width:c,height:d,imageData:p}}static async deserialize(t,s,i){var E;let r=null,a=!1;if(t instanceof kI){const{data:{rect:b,rotation:w,id:S,structParent:T,popupRef:N,richText:R,contentsObj:k,creationDate:I,modificationDate:M},container:D,parent:{page:{pageNumber:O}},canvas:L}=t;let $,G;L?(delete t.canvas,{id:$,bitmap:G}=i.imageManager.getFromCanvas(D.id,L),L.remove()):(a=!0,t._hasNoCanvas=!0);const ee=((E=await s._structTree.getAriaAttributes(`${od}${S}`))==null?void 0:E.get("aria-label"))||"";r=t={annotationType:pe.STAMP,bitmapId:$,bitmap:G,pageIndex:O-1,rect:b.slice(0),rotation:w,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:ee},isSvg:!1,structParent:T,popupRef:N,richText:R,comment:(k==null?void 0:k.str)||null,creationDate:I,modificationDate:M}}const o=await super.deserialize(t,s,i),{rect:l,bitmap:c,bitmapUrl:d,bitmapId:h,isSvg:p,accessibilityData:y}=t;a?(i.addMissingCanvas(t.id,o),x(o,eu,!0)):h&&i.imageManager.isValidId(h)?(x(o,ln,h),c&&x(o,mt,c)):x(o,Sa,d),x(o,Os,p);const[v,_]=o.pageDimensions;return o.width=(l[2]-l[0])/v,o.height=(l[3]-l[1])/_,y&&(o.altTextData=y),o._initialData=r,t.comment&&o.setCommentData(t),x(o,Kh,!!r),o}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:u(this,ln),isSvg:u(this,Os)});if(this.addComment(i),t)return i.bitmapUrl=C(this,Re,Gy).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=C(this,Re,pD).call(this,i);return l.isSame?null:(l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(s===null)return i;s.stamps||(s.stamps=new Map);const o=u(this,Os)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(u(this,ln)))s.stamps.set(u(this,ln),{area:o,serialized:i}),i.bitmap=C(this,Re,Gy).call(this,!1);else if(u(this,Os)){const l=s.stamps.get(u(this,ln));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=C(this,Re,Gy).call(this,!1))}return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}mt=new WeakMap,ln=new WeakMap,$o=new WeakMap,Sa=new WeakMap,Yo=new WeakMap,Yh=new WeakMap,Ea=new WeakMap,eu=new WeakMap,Tr=new WeakMap,Os=new WeakMap,Kh=new WeakMap,Re=new WeakSet,pp=function(t,s=!1){if(!t){this.remove();return}x(this,mt,t.bitmap),s||(x(this,ln,t.id),x(this,Os,t.isSvg)),t.file&&x(this,Yh,t.file.name),C(this,Re,Hy).call(this)},mp=function(){if(x(this,$o,null),this._uiManager.enableWaiting(!1),!!u(this,Ea)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,mt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&u(this,mt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},zy=function(){if(u(this,ln)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(u(this,ln)).then(i=>C(this,Re,pp).call(this,i,!0)).finally(()=>C(this,Re,mp).call(this));return}if(u(this,Sa)){const i=u(this,Sa);x(this,Sa,null),this._uiManager.enableWaiting(!0),x(this,$o,this._uiManager.imageManager.getFromUrl(i).then(r=>C(this,Re,pp).call(this,r)).finally(()=>C(this,Re,mp).call(this)));return}if(u(this,Yo)){const i=u(this,Yo);x(this,Yo,null),this._uiManager.enableWaiting(!0),x(this,$o,this._uiManager.imageManager.getFromFile(i).then(r=>C(this,Re,pp).call(this,r)).finally(()=>C(this,Re,mp).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=cw.join(",");const s=this._uiManager._signal;x(this,$o,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),C(this,Re,pp).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>C(this,Re,mp).call(this))),t.click()},Hy=function(){var c;const{div:t}=this;let{width:s,height:i}=u(this,mt);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const d=Math.min(o*r/s,o*a/i);s*=d,i*=d}this._uiManager.enableWaiting(!1);const l=x(this,Ea,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=s/r,this.height=i/a,this.setDims(),(c=this._initialOptions)!=null&&c.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),C(this,Re,AS).call(this),u(this,Kh)||(this.parent.addUndoableEditor(this),x(this,Kh,!0)),this._reportTelemetry({action:"inserted_image"}),u(this,Yh)&&this.div.setAttribute("aria-description",u(this,Yh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},jy=function(t,s){const{width:i,height:r}=u(this,mt);let a=i,o=r,l=u(this,mt);for(;a>2*t||o>2*s;){const c=a,d=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const h=new OffscreenCanvas(a,o);h.getContext("2d").drawImage(l,0,0,c,d,0,0,a,o),l=h.transferToImageBitmap()}return l},AS=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Ir,o=Math.ceil(i*t*a.sx),l=Math.ceil(r*s*a.sy),c=u(this,Ea);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const d=u(this,Os)?u(this,mt):C(this,Re,jy).call(this,o,l),h=c.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(d,0,0,d.width,d.height,0,0,o,l)},Gy=function(t){if(t){if(u(this,Os)){const r=this._uiManager.imageManager.getSvgUrl(u(this,ln));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=u(this,mt),s.getContext("2d").drawImage(u(this,mt),0,0),s.toDataURL()}if(u(this,Os)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*vl.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*vl.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(u(this,mt),0,0,u(this,mt).width,u(this,mt).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(u(this,mt))},pD=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},z(ES,"_type","stamp"),z(ES,"_editorType",pe.STAMP);var tu,Jh,Ko,Jo,Aa,ls,Xo,Xh,Wh,qi,Ta,cn,Ca,Wo,Qh,te,Qo,Qe,CS,mD,ir,NS,RS,qy;const Ii=class Ii{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:d}){A(this,Qe);A(this,tu);A(this,Jh,!1);A(this,Ko,null);A(this,Jo,null);A(this,Aa,null);A(this,ls,new Map);A(this,Xo,!1);A(this,Xh,!1);A(this,Wh,!1);A(this,qi,null);A(this,Ta,null);A(this,cn,null);A(this,Ca,null);A(this,Wo,null);A(this,Qh,-1);A(this,te);const h=[...u(Ii,Qo).values()];if(!Ii._initialized){Ii._initialized=!0;for(const p of h)p.initialize(d,e)}e.registerEditorTypes(h),x(this,te,e),this.pageIndex=t,this.div=s,x(this,tu,r),x(this,Ko,a),this.viewport=c,x(this,cn,l),this.drawLayer=o,this._structTree=i,u(this,te).addLayer(this)}get isEmpty(){return u(this,ls).size===0}get isInvisible(){return this.isEmpty&&u(this,te).getMode()===pe.NONE}updateToolbar(e){u(this,te).updateToolbar(e)}updateMode(e=u(this,te).getMode()){switch(C(this,Qe,qy).call(this),e){case pe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case pe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case pe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===pe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const s of u(Ii,Qo).values())t.toggle(`${s._type}Editing`,e===s._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=u(this,cn))==null?void 0:t.div)}setEditingState(e){u(this,te).setEditingState(e)}addCommands(e){u(this,te).addCommands(e)}cleanUndoStack(e){u(this,te).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=u(this,Ko))==null||t.togglePointerEvents(e)}async enable(){var s;x(this,Wh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(s=u(this,Wo))==null||s.abort(),x(this,Wo,null);const e=new Set;for(const i of u(this,Qe,CS))i.enableEditing(),i.show(!0),i.annotationElementId&&(u(this,te).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));const t=u(this,Ko);if(t)for(const i of t.getEditableAnnotations()){if(i.hide(),u(this,te).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}x(this,Wh,!1),u(this,te)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var i;if(x(this,Xh,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),u(this,cn)&&!u(this,Wo)){x(this,Wo,new AbortController);const r=u(this,te).combinedSignal(u(this,Wo));u(this,cn).div.addEventListener("pointerdown",a=>{const{clientX:l,clientY:c,timeStamp:d}=a,h=u(this,Qh);if(d-h>500){x(this,Qh,d);return}x(this,Qh,-1);const{classList:p}=this.div;p.toggle("getElements",!0);const y=document.elementsFromPoint(l,c);if(p.toggle("getElements",!1),!this.div.contains(y[0]))return;let v;const _=new RegExp(`^${Kp}[0-9]+$`);for(const b of y)if(_.test(b.id)){v=b.id;break}if(!v)return;const E=u(this,ls).get(v);(E==null?void 0:E.annotationElementId)===null&&(a.stopPropagation(),a.preventDefault(),E.dblclick(a))},{signal:r,capture:!0})}const e=u(this,Ko),t=[];if(e){const r=new Map,a=new Map;for(const l of u(this,Qe,CS)){if(l.disableEditing(),!l.annotationElementId){t.push(l);continue}if(l.serialize()!==null){r.set(l.annotationElementId,l);continue}else a.set(l.annotationElementId,l);(i=this.getEditableAnnotation(l.annotationElementId))==null||i.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:c}=l.data;if(u(this,te).isDeletedAnnotationElement(c)){l.updateEdited({deleted:!0});continue}let d=a.get(c);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=r.get(c),d&&(u(this,te).addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}C(this,Qe,qy).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of u(Ii,Qo).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e==null||e.updateFakeAnnotations(t),x(this,Xh,!1)}getEditableAnnotation(e){var t;return((t=u(this,Ko))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){u(this,te).getActive()!==e&&u(this,te).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=u(this,cn))!=null&&e.div&&!u(this,Ca)){x(this,Ca,new AbortController);const t=u(this,te).combinedSignal(u(this,Ca));u(this,cn).div.addEventListener("pointerdown",C(this,Qe,mD).bind(this),{signal:t}),u(this,cn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=u(this,cn))!=null&&e.div&&u(this,Ca)&&(u(this,Ca).abort(),x(this,Ca,null),u(this,cn).div.classList.remove("highlighting"))}enableClick(){if(u(this,Jo))return;x(this,Jo,new AbortController);const e=u(this,te).combinedSignal(u(this,Jo));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=u(this,Jo))==null||e.abort(),x(this,Jo,null)}attach(e){u(this,ls).set(e.id,e);const{annotationElementId:t}=e;t&&u(this,te).isDeletedAnnotationElement(t)&&u(this,te).removeDeletedAnnotationElement(e)}detach(e){var t;u(this,ls).delete(e.id),(t=u(this,tu))==null||t.removePointerInTextLayer(e.contentDiv),!u(this,Xh)&&e.annotationElementId&&u(this,te).addDeletedAnnotationElement(e)}remove(e){this.detach(e),u(this,te).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(u(this,te).addDeletedAnnotationElement(e),rt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),u(this,te).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!u(this,Wh)),u(this,te).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!u(this,Aa)&&(e._focusEventsAllowed=!1,x(this,Aa,setTimeout(()=>{x(this,Aa,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:u(this,te)._signal}),t.focus())},0))),e._structTreeParentId=(s=u(this,tu))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getEditorByUID(e){for(const t of u(this,ls).values())if(t.uid===e)return t;return null}getNextId(){return u(this,te).getId()}combinedSignal(e){return u(this,te).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=u(this,Qe,ir))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await u(this,te).updateMode(e.mode);const{offsetX:s,offsetY:i}=C(this,Qe,RS).call(this),r=this.getNextId(),a=C(this,Qe,NS).call(this,{parent:this,id:r,x:s,y:i,uiManager:u(this,te),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=u(Ii,Qo).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,u(this,te)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=C(this,Qe,NS).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:u(this,te),isCentered:t,...s});return r&&this.add(r),r}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(C(this,Qe,RS).call(this),!0,e)}setSelected(e){u(this,te).setSelected(e)}toggleSelected(e){u(this,te).toggleSelected(e)}unselect(e){u(this,te).unselect(e)}pointerup(e){var i;const{isMac:t}=en.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!u(this,Xo)||(x(this,Xo,!1),(i=u(this,Qe,ir))!=null&&i.isDrawer&&u(this,Qe,ir).supportMultipleDrawings))return;if(!u(this,Jh)){x(this,Jh,!0);return}const s=u(this,te).getMode();if(s===pe.STAMP||s===pe.SIGNATURE){u(this,te).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var i;if(u(this,te).getMode()===pe.HIGHLIGHT&&this.enableTextSelection(),u(this,Xo)){x(this,Xo,!1);return}const{isMac:t}=en.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(x(this,Xo,!0),(i=u(this,Qe,ir))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=u(this,te).getActive();x(this,Jh,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),u(this,qi)){u(this,Qe,ir).startDrawing(this,u(this,te),!1,e);return}u(this,te).setCurrentDrawingSession(this),x(this,qi,new AbortController);const t=u(this,te).combinedSignal(u(this,qi));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(x(this,Ta,null),this.commitOrRemove())},{signal:t}),u(this,Qe,ir).startDrawing(this,u(this,te),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&x(this,Ta,t);return}u(this,Ta)&&setTimeout(()=>{var t;(t=u(this,Ta))==null||t.focus(),x(this,Ta,null)},0)}endDrawingSession(e=!1){return u(this,qi)?(u(this,te).setCurrentDrawingSession(null),u(this,qi).abort(),x(this,qi,null),x(this,Ta,null),u(this,Qe,ir).endDrawing(e)):null}findNewParent(e,t,s){const i=u(this,te).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return u(this,qi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){u(this,qi)&&u(this,Qe,ir).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=u(this,te).getActive())==null?void 0:e.parent)===this&&(u(this,te).commitOrRemove(),u(this,te).setActiveEditor(null)),u(this,Aa)&&(clearTimeout(u(this,Aa)),x(this,Aa,null));for(const s of u(this,ls).values())(t=u(this,tu))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,u(this,ls).clear(),u(this,te).removeLayer(this)}render({viewport:e}){this.viewport=e,fu(this.div,e);for(const t of u(this,te).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){u(this,te).commitOrRemove(),C(this,Qe,qy).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,fu(this.div,{rotation:s}),t!==s)for(const i of u(this,ls).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return u(this,te).viewParameters.realScale}};tu=new WeakMap,Jh=new WeakMap,Ko=new WeakMap,Jo=new WeakMap,Aa=new WeakMap,ls=new WeakMap,Xo=new WeakMap,Xh=new WeakMap,Wh=new WeakMap,qi=new WeakMap,Ta=new WeakMap,cn=new WeakMap,Ca=new WeakMap,Wo=new WeakMap,Qh=new WeakMap,te=new WeakMap,Qo=new WeakMap,Qe=new WeakSet,CS=function(){return u(this,ls).size!==0?u(this,ls).values():u(this,te).getEditors(this.pageIndex)},mD=function(e){u(this,te).unselectAll();const{target:t}=e;if(t===u(this,cn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&u(this,cn).div.contains(t)){const{isMac:s}=en.platform;if(e.button!==0||e.ctrlKey&&s)return;u(this,te).showAllEditors("highlight",!0,!0),u(this,cn).div.classList.add("free"),this.toggleDrawing(),Dv.startHighlighting(this,u(this,te).direction==="ltr",{target:u(this,cn).div,x:e.x,y:e.y}),u(this,cn).div.addEventListener("pointerup",()=>{u(this,cn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:u(this,te)._signal}),e.preventDefault()}},ir=function(){return u(Ii,Qo).get(u(this,te).getMode())},NS=function(e){const t=u(this,Qe,ir);return t?new t.prototype.constructor(e):null},RS=function(){const{x:e,y:t,width:s,height:i}=this.boundingClientRect,r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+i),c=(r+o)/2-e,d=(a+l)/2-t,[h,p]=this.viewport.rotation%180===0?[c,d]:[d,c];return{offsetX:h,offsetY:p}},qy=function(){for(const e of u(this,ls).values())e.isEmpty()&&e.remove()},z(Ii,"_initialized",!1),A(Ii,Qo,new Map([oS,yS,ES,Dv,SS].map(e=>[e._editorType,e])));let TS=Ii;var Vi,Gn,nu,Yg,db,gD,Dr,MS,yD,IS;const Kt=class Kt{constructor({pageIndex:e}){A(this,Dr);A(this,Vi,null);A(this,Gn,new Map);A(this,nu,new Map);this.pageIndex=e}setParent(e){if(!u(this,Vi)){x(this,Vi,e);return}if(u(this,Vi)!==e){if(u(this,Gn).size>0)for(const t of u(this,Gn).values())t.remove(),e.append(t);x(this,Vi,e)}}static get _svgFactory(){return de(this,"_svgFactory",new Mv)}draw(e,t=!1,s=!1){const i=Vt(Kt,Yg)._++,r=C(this,Dr,MS).call(this),a=Kt._svgFactory.createElement("defs");r.append(a);const o=Kt._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&u(this,nu).set(i,o);const c=s?C(this,Dr,yD).call(this,a,l):null,d=Kt._svgFactory.createElement("use");return r.append(d),d.setAttribute("href",`#${l}`),this.updateProperties(r,e),u(this,Gn).set(i,r),{id:i,clipPathId:`url(#${c})`}}drawOutline(e,t){const s=Vt(Kt,Yg)._++,i=C(this,Dr,MS).call(this),r=Kt._svgFactory.createElement("defs");i.append(r);const a=Kt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const h=Kt._svgFactory.createElement("mask");r.append(h),l=`mask_p${this.pageIndex}_${s}`,h.setAttribute("id",l),h.setAttribute("maskUnits","objectBoundingBox");const p=Kt._svgFactory.createElement("rect");h.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const y=Kt._svgFactory.createElement("use");h.append(y),y.setAttribute("href",`#${o}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const c=Kt._svgFactory.createElement("use");i.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const d=c.cloneNode();return i.append(d),c.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(i,e),u(this,Gn).set(s,i),s}finalizeDraw(e,t){u(this,nu).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?u(this,Gn).get(e):e;if(o){if(s&&C(this,Dr,IS).call(this,o,s),i&&C(l=Kt,db,gD).call(l,o,i),r){const{classList:c}=o;for(const[d,h]of Object.entries(r))c.toggle(d,h)}if(a){const d=o.firstElementChild.firstElementChild;C(this,Dr,IS).call(this,d,a)}}}updateParent(e,t){if(t===this)return;const s=u(this,Gn).get(e);s&&(u(t,Vi).append(s),u(this,Gn).delete(e),u(t,Gn).set(e,s))}remove(e){u(this,nu).delete(e),u(this,Vi)!==null&&(u(this,Gn).get(e).remove(),u(this,Gn).delete(e))}destroy(){x(this,Vi,null);for(const e of u(this,Gn).values())e.remove();u(this,Gn).clear(),u(this,nu).clear()}};Vi=new WeakMap,Gn=new WeakMap,nu=new WeakMap,Yg=new WeakMap,db=new WeakSet,gD=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Dr=new WeakSet,MS=function(){const e=Kt._svgFactory.create(1,1,!0);return u(this,Vi).append(e),e.setAttribute("aria-hidden",!0),e},yD=function(e,t){const s=Kt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Kt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},IS=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},A(Kt,db),A(Kt,Yg,0);let kS=Kt;globalThis._pdfjsTestingUtils={HighlightOutliner:cS};globalThis.pdfjsLib={AbortException:yl,AnnotationEditorLayer:TS,AnnotationEditorParamsType:Ae,AnnotationEditorType:pe,AnnotationEditorUIManager:pu,AnnotationLayer:rS,AnnotationMode:ao,AnnotationType:Ut,applyOpacity:_U,build:C5,ColorPicker:Rv,createValidAbsoluteUrl:oM,CSSConstants:bU,DOMSVGFactory:Mv,DrawLayer:kS,FeatureTest:en,fetchData:o0,findContrastColor:xU,getDocument:mI,getFilenameFromUrl:fU,getPdfFilenameFromUrl:pU,getRGB:c0,getUuid:uM,getXfaPageViewport:gU,GlobalWorkerOptions:Cr,ImageKind:dy,InvalidPDFException:ow,isDataScheme:Pb,isPdfFile:dA,isValidExplicitDest:IU,MathClamp:Yn,noContextMenu:Ci,normalizeUnicode:uU,OPS:Jp,OutputScale:Ir,PasswordResponses:tU,PDFDataRangeTransport:gI,PDFDateString:Sv,PDFWorker:Qp,PermissionFlag:eU,PixelsPerInch:vl,RenderingCancelledException:uA,renderRichText:fM,ResponseException:wv,setLayerDimensions:fu,shadow:de,SignatureExtractor:Ra,stopEvent:kt,SupportedImageMimeTypes:cw,TextLayer:Wp,TouchManager:Av,updateUrlHash:lM,Util:X,VerbosityLevel:Mb,version:mA,XfaLayer:hM};Cr.workerSrc=`https://unpkg.com/pdfjs-dist@${mA}/build/pdf.worker.min.mjs`;const W5=async n=>{try{const e=await n.arrayBuffer(),s=await mI({data:e,cMapUrl:`https://unpkg.com/pdfjs-dist@${mA}/cmaps/`,cMapPacked:!0}).promise;let i="";const r=s.numPages;for(let a=1;a<=r;a++){const c=(await(await s.getPage(a)).getTextContent()).items.map(d=>d.str||"").join(" ");i+=`Page ${a}:
${c}

`}return i}catch(e){throw console.error("PDF Extraction Error:",e),new Error("    PDF.      .")}};var Q5={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Z5,e3;function t3(){return{geminiUrl:Z5,vertexUrl:e3}}function n3(n,e,t,s){var i,r;if(!(n!=null&&n.baseUrl)){const a=t3();return e?(i=a.vertexUrl)!==null&&i!==void 0?i:t:(r=a.geminiUrl)!==null&&r!==void 0?r:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ka{}function J(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const r=e[i];return r!=null?String(r):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function m(n,e,t){for(let r=0;r<e.length-1;r++){const a=e[r];if(a.endsWith("[]")){const o=a.slice(0,-2);if(!(o in n))if(Array.isArray(t))n[o]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(n[o])){const l=n[o];if(Array.isArray(t))for(let c=0;c<l.length;c++){const d=l[c];m(d,e.slice(r+1),t[c])}else for(const c of l)m(c,e.slice(r+1),t)}return}else if(a.endsWith("[0]")){const o=a.slice(0,-3);o in n||(n[o]=[{}]);const l=n[o];m(l[0],e.slice(r+1),t);return}(!n[a]||typeof n[a]!="object")&&(n[a]={}),n=n[a]}const s=e[e.length-1],i=n[s];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else s==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[s]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let s=0;s<e.length;s++){if(typeof n!="object"||n===null)return t;const i=e[s];if(i.endsWith("[]")){const r=i.slice(0,-2);if(r in n){const a=n[r];return Array.isArray(a)?a.map(o=>f(o,e.slice(s+1),t)):t}else return t}else n=n[i]}return n}catch(s){if(s instanceof TypeError)return t;throw s}}function s3(n,e){for(const[t,s]of Object.entries(e)){const i=t.split("."),r=s.split("."),a=new Set;let o=-1;for(let l=0;l<i.length;l++)if(i[l]==="*"){o=l;break}if(o!==-1&&r.length>o)for(let l=o;l<r.length;l++){const c=r[l];c!=="*"&&!c.endsWith("[]")&&!c.endsWith("[0]")&&a.add(c)}DS(n,i,r,0,a)}}function DS(n,e,t,s,i){if(s>=e.length||typeof n!="object"||n===null)return;const r=e[s];if(r.endsWith("[]")){const a=r.slice(0,-2),o=n;if(a in o&&Array.isArray(o[a]))for(const l of o[a])DS(l,e,t,s+1,i)}else if(r==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const a=n,o=Object.keys(a).filter(c=>!c.startsWith("_")&&!i.has(c)),l={};for(const c of o)l[c]=a[c];for(const[c,d]of Object.entries(l)){const h=[];for(const p of t.slice(s))p==="*"?h.push(c):h.push(p);m(a,h,d)}for(const c of o)delete a[c]}}else{const a=n;r in a&&DS(a[r],e,t,s+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _A(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i3(n){const e={},t=f(n,["operationName"]);t!=null&&m(e,["operationName"],t);const s=f(n,["resourceName"]);return s!=null&&m(e,["_url","resourceName"],s),e}function r3(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response","generateVideoResponse"]);return a!=null&&m(e,["response"],o3(a)),e}function a3(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response"]);return a!=null&&m(e,["response"],l3(a)),e}function o3(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>c3(a))),m(e,["generatedVideos"],r)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&m(e,["raiMediaFilteredCount"],s);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function l3(n){const e={},t=f(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>u3(a))),m(e,["generatedVideos"],r)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&m(e,["raiMediaFilteredCount"],s);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function c3(n){const e={},t=f(n,["video"]);return t!=null&&m(e,["video"],g3(t)),e}function u3(n){const e={},t=f(n,["_self"]);return t!=null&&m(e,["video"],y3(t)),e}function d3(n){const e={},t=f(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function h3(n){const e={},t=f(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function f3(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response"]);return a!=null&&m(e,["response"],p3(a)),e}function p3(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["parent"]);s!=null&&m(e,["parent"],s);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function vD(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response"]);return a!=null&&m(e,["response"],m3(a)),e}function m3(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["parent"]);s!=null&&m(e,["parent"],s);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function g3(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const s=f(n,["encodedVideo"]);s!=null&&m(e,["videoBytes"],_A(s));const i=f(n,["encoding"]);return i!=null&&m(e,["mimeType"],i),e}function y3(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&m(e,["videoBytes"],_A(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ZT;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ZT||(ZT={}));var eC;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(eC||(eC={}));var tC;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(tC||(tC={}));var Wt;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Wt||(Wt={}));var nC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(nC||(nC={}));var sC;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(sC||(sC={}));var iC;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(iC||(iC={}));var rC;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(rC||(rC={}));var aC;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(aC||(aC={}));var oC;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(oC||(oC={}));var lC;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(lC||(lC={}));var cC;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(cC||(cC={}));var uC;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(uC||(uC={}));var dC;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(dC||(dC={}));var hC;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(hC||(hC={}));var fC;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(fC||(fC={}));var pC;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(pC||(pC={}));var mC;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(mC||(mC={}));var gC;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(gC||(gC={}));var Lv;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Lv||(Lv={}));var yC;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(yC||(yC={}));var vC;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(vC||(vC={}));var bC;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(bC||(bC={}));var PS;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(PS||(PS={}));var _C;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(_C||(_C={}));var xC;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(xC||(xC={}));var wC;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(wC||(wC={}));var SC;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(SC||(SC={}));var EC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(EC||(EC={}));var AC;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(AC||(AC={}));var TC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(TC||(TC={}));var CC;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(CC||(CC={}));var NC;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(NC||(NC={}));var RC;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(RC||(RC={}));var kC;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(kC||(kC={}));var MC;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(MC||(MC={}));var IC;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(IC||(IC={}));var DC;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(DC||(DC={}));var PC;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(PC||(PC={}));var LC;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(LC||(LC={}));var OC;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(OC||(OC={}));var UC;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(UC||(UC={}));var BC;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(BC||(BC={}));var FC;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(FC||(FC={}));var zC;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(zC||(zC={}));var HC;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(HC||(HC={}));var jC;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(jC||(jC={}));var GC;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(GC||(GC={}));var qC;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(qC||(qC={}));var VC;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(VC||(VC={}));var $C;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})($C||($C={}));var YC;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(YC||(YC={}));var KC;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(KC||(KC={}));var JC;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(JC||(JC={}));var XC;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(XC||(XC={}));var cd;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(cd||(cd={}));class LS{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Hf{get text(){var e,t,s,i,r,a,o,l;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",d=!1;const h=[];for(const p of(l=(o=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[y,v]of Object.entries(p))y!=="text"&&y!=="thought"&&y!=="thoughtSignature"&&(v!==null||v!==void 0)&&h.push(y);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;d=!0,c+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?c:void 0}get data(){var e,t,s,i,r,a,o,l;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const d=[];for(const h of(l=(o=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[p,y]of Object.entries(h))p!=="inlineData"&&(y!==null||y!==void 0)&&d.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(c+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,s,i,r,a,o,l;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(o=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,s,i,r,a,o,l,c;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(o=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,s,i,r,a,o,l,c;if(((i=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(o=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(c=d==null?void 0:d[0])===null||c===void 0?void 0:c.output}}class WC{}class QC{}class v3{}class b3{}class _3{}class x3{}class ZC{}class eN{}class tN{}class w3{}class Ov{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new Ov;let i;const r=e;return t?i=a3(r):i=r3(r),Object.assign(s,i),s}}class nN{}class sN{}class iN{}class rN{}class S3{}class E3{}class A3{}class xA{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new xA,r=f3(e);return Object.assign(s,r),s}}class T3{}class C3{}class N3{}class aN{}class R3{get text(){var e,t,s;let i="",r=!1;const a=[];for(const o of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[l,c]of Object.entries(o))l!=="text"&&l!=="thought"&&c!==null&&a.push(l);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;r=!0,i+=o.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?i:void 0}get data(){var e,t,s;let i="";const r=[];for(const a of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[o,l]of Object.entries(a))o!=="inlineData"&&l!==null&&r.push(o);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class k3{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class wA{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const s=new wA,r=vD(e);return Object.assign(s,r),s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Me(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function bD(n,e){const t=Me(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function _D(n){return Array.isArray(n)?n.map(e=>Uv(e)):[Uv(n)]}function Uv(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function xD(n){const e=Uv(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function wD(n){const e=Uv(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function oN(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function SD(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>oN(e)):[oN(n)]}function OS(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function lN(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function cN(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Bn(n){if(n==null)throw new Error("ContentUnion is required");return OS(n)?n:{role:"user",parts:SD(n)}}function SA(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=Bn(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=Bn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Bn(t)):[Bn(e)]}function Si(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(lN(n)||cN(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Bn(n)]}const e=[],t=[],s=OS(n[0]);for(const i of n){const r=OS(i);if(r!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(i);else{if(lN(i)||cN(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return s||e.push({role:"user",parts:SD(t)}),e}function M3(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.values(Wt).includes(t[0].toUpperCase())?t[0].toUpperCase():Wt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.values(Wt).includes(s.toUpperCase())?s.toUpperCase():Wt.TYPE_UNSPECIFIED})}}function Ed(n){const e={},t=["items"],s=["anyOf"],i=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=n.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,n=r[1]):r[1].type==="null"&&(e.nullable=!0,n=r[0])),n.type instanceof Array&&M3(n.type,e);for(const[a,o]of Object.entries(n))if(o!=null)if(a=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;e.type=Object.values(Wt).includes(o.toUpperCase())?o.toUpperCase():Wt.TYPE_UNSPECIFIED}else if(t.includes(a))e[a]=Ed(o);else if(s.includes(a)){const l=[];for(const c of o){if(c.type=="null"){e.nullable=!0;continue}l.push(Ed(c))}e[a]=l}else if(i.includes(a)){const l={};for(const[c,d]of Object.entries(o))l[c]=Ed(d);e[a]=l}else{if(a==="additionalProperties")continue;e[a]=o}return e}function EA(n){return Ed(n)}function AA(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function TA(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Sf(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Ed(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Ed(e.response));return n}function Ef(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function I3(n,e,t,s=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function Ja(n,e){if(typeof e!="string")throw new Error("name must be a string");return I3(n,e,"cachedContents")}function ED(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function wl(n){return _A(n)}function D3(n){return n!=null&&typeof n=="object"&&"name"in n}function P3(n){return n!=null&&typeof n=="object"&&"video"in n}function L3(n){return n!=null&&typeof n=="object"&&"uri"in n}function AD(n){var e;let t;if(D3(n)&&(t=n.name),!(L3(n)&&(t=n.uri,t===void 0))&&!(P3(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function TD(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function CD(n){for(const e of["models","tunedModels","publisherModels"])if(O3(n,e))return n[e];return[]}function O3(n,e){return n!==null&&typeof n=="object"&&e in n}function U3(n,e={}){const t=n,s={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(s.responseJsonSchema=t.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function B3(n,e={}){const t=[],s=new Set;for(const i of n){const r=i.name;if(s.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);s.add(r);const a=U3(i,e);a.functionDeclarations&&t.push(...a.functionDeclarations)}return{functionDeclarations:t}}function ND(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const s=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(i>0||s!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(s>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function F3(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function RD(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return n;let r=!1;for(const a of i){if(typeof a!="object"||a===null)continue;const l=a.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Af(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function kD(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z3(n){const e={},t=f(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const s=f(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>_B(a))),m(e,["inlinedResponses"],r)}const i=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["inlinedEmbedContentResponses"],r)}return e}function H3(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const s=f(n,["gcsDestination","outputUriPrefix"]);s!=null&&m(e,["gcsUri"],s);const i=f(n,["bigqueryDestination","outputUri"]);return i!=null&&m(e,["bigqueryUri"],i),e}function j3(n){const e={},t=f(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const s=f(n,["gcsUri"]);s!=null&&m(e,["gcsDestination","outputUriPrefix"],s);const i=f(n,["bigqueryUri"]);if(i!=null&&m(e,["bigqueryDestination","outputUri"],i),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Vy(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata","displayName"]);s!=null&&m(e,["displayName"],s);const i=f(n,["metadata","state"]);i!=null&&m(e,["state"],kD(i));const r=f(n,["metadata","createTime"]);r!=null&&m(e,["createTime"],r);const a=f(n,["metadata","endTime"]);a!=null&&m(e,["endTime"],a);const o=f(n,["metadata","updateTime"]);o!=null&&m(e,["updateTime"],o);const l=f(n,["metadata","model"]);l!=null&&m(e,["model"],l);const c=f(n,["metadata","output"]);return c!=null&&m(e,["dest"],z3(RD(c))),e}function US(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["displayName"]);s!=null&&m(e,["displayName"],s);const i=f(n,["state"]);i!=null&&m(e,["state"],kD(i));const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["createTime"]);a!=null&&m(e,["createTime"],a);const o=f(n,["startTime"]);o!=null&&m(e,["startTime"],o);const l=f(n,["endTime"]);l!=null&&m(e,["endTime"],l);const c=f(n,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=f(n,["model"]);d!=null&&m(e,["model"],d);const h=f(n,["inputConfig"]);h!=null&&m(e,["src"],G3(h));const p=f(n,["outputConfig"]);p!=null&&m(e,["dest"],H3(RD(p)));const y=f(n,["completionStats"]);return y!=null&&m(e,["completionStats"],y),e}function G3(n){const e={},t=f(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const s=f(n,["gcsSource","uris"]);s!=null&&m(e,["gcsUri"],s);const i=f(n,["bigquerySource","inputUri"]);return i!=null&&m(e,["bigqueryUri"],i),e}function q3(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=f(e,["fileName"]);s!=null&&m(t,["fileName"],s);const i=f(e,["inlinedRequests"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>bB(n,a))),m(t,["requests","requests"],r)}return t}function V3(n){const e={},t=f(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const s=f(n,["gcsUri"]);s!=null&&m(e,["gcsSource","uris"],s);const i=f(n,["bigqueryUri"]);if(i!=null&&m(e,["bigquerySource","inputUri"],i),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function $3(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function Y3(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function K3(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function J3(n){const e={},t=f(n,["content"]);t!=null&&m(e,["content"],t);const s=f(n,["citationMetadata"]);s!=null&&m(e,["citationMetadata"],X3(s));const i=f(n,["tokenCount"]);i!=null&&m(e,["tokenCount"],i);const r=f(n,["finishReason"]);r!=null&&m(e,["finishReason"],r);const a=f(n,["avgLogprobs"]);a!=null&&m(e,["avgLogprobs"],a);const o=f(n,["groundingMetadata"]);o!=null&&m(e,["groundingMetadata"],o);const l=f(n,["index"]);l!=null&&m(e,["index"],l);const c=f(n,["logprobsResult"]);c!=null&&m(e,["logprobsResult"],c);const d=f(n,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(y=>y)),m(e,["safetyRatings"],p)}const h=f(n,["urlContextMetadata"]);return h!=null&&m(e,["urlContextMetadata"],h),e}function X3(n){const e={},t=f(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),m(e,["citations"],s)}return e}function MD(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>CB(r))),m(e,["parts"],i)}const s=f(n,["role"]);return s!=null&&m(e,["role"],s),e}function W3(n,e){const t={},s=f(n,["displayName"]);if(e!==void 0&&s!=null&&m(e,["batch","displayName"],s),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Q3(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const i=f(n,["dest"]);return e!==void 0&&i!=null&&m(e,["outputConfig"],j3(F3(i))),t}function uN(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["src"]);i!=null&&m(t,["batch","inputConfig"],q3(n,ND(n,i)));const r=f(e,["config"]);return r!=null&&W3(r,t),t}function Z3(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["model"],Me(n,s));const i=f(e,["src"]);i!=null&&m(t,["inputConfig"],V3(ND(n,i)));const r=f(e,["config"]);return r!=null&&Q3(r,t),t}function eB(n,e){const t={},s=f(n,["displayName"]);return e!==void 0&&s!=null&&m(e,["batch","displayName"],s),t}function tB(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["src"]);i!=null&&m(t,["batch","inputConfig"],lB(n,i));const r=f(e,["config"]);return r!=null&&eB(r,t),t}function nB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function sB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function iB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&m(e,["name"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);return r!=null&&m(e,["error"],r),e}function rB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["name"]);s!=null&&m(e,["name"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);return r!=null&&m(e,["error"],r),e}function aB(n,e){const t={},s=f(e,["contents"]);if(s!=null){let r=SA(n,s);Array.isArray(r)&&(r=r.map(a=>a)),m(t,["requests[]","request","content"],r)}const i=f(e,["config"]);return i!=null&&(m(t,["_self"],oB(i,t)),s3(t,{"requests[].*":"requests[].request.*"})),t}function oB(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&m(e,["requests[]","taskType"],s);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["requests[]","title"],i);const r=f(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&m(e,["requests[]","outputDimensionality"],r),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function lB(n,e){const t={},s=f(e,["fileName"]);s!=null&&m(t,["file_name"],s);const i=f(e,["inlinedRequests"]);return i!=null&&m(t,["requests"],aB(n,i)),t}function cB(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function uB(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const s=f(n,["args"]);s!=null&&m(e,["args"],s);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function dB(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const s=f(n,["allowedFunctionNames"]);if(s!=null&&m(e,["allowedFunctionNames"],s),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function hB(n,e,t){const s={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],MD(Bn(i)));const r=f(e,["temperature"]);r!=null&&m(s,["temperature"],r);const a=f(e,["topP"]);a!=null&&m(s,["topP"],a);const o=f(e,["topK"]);o!=null&&m(s,["topK"],o);const l=f(e,["candidateCount"]);l!=null&&m(s,["candidateCount"],l);const c=f(e,["maxOutputTokens"]);c!=null&&m(s,["maxOutputTokens"],c);const d=f(e,["stopSequences"]);d!=null&&m(s,["stopSequences"],d);const h=f(e,["responseLogprobs"]);h!=null&&m(s,["responseLogprobs"],h);const p=f(e,["logprobs"]);p!=null&&m(s,["logprobs"],p);const y=f(e,["presencePenalty"]);y!=null&&m(s,["presencePenalty"],y);const v=f(e,["frequencyPenalty"]);v!=null&&m(s,["frequencyPenalty"],v);const _=f(e,["seed"]);_!=null&&m(s,["seed"],_);const E=f(e,["responseMimeType"]);E!=null&&m(s,["responseMimeType"],E);const b=f(e,["responseSchema"]);b!=null&&m(s,["responseSchema"],EA(b));const w=f(e,["responseJsonSchema"]);if(w!=null&&m(s,["responseJsonSchema"],w),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=f(e,["safetySettings"]);if(t!==void 0&&S!=null){let $=S;Array.isArray($)&&($=$.map(G=>NB(G))),m(t,["safetySettings"],$)}const T=f(e,["tools"]);if(t!==void 0&&T!=null){let $=Ef(T);Array.isArray($)&&($=$.map(G=>kB(Sf(G)))),m(t,["tools"],$)}const N=f(e,["toolConfig"]);if(t!==void 0&&N!=null&&m(t,["toolConfig"],RB(N)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=f(e,["cachedContent"]);t!==void 0&&R!=null&&m(t,["cachedContent"],Ja(n,R));const k=f(e,["responseModalities"]);k!=null&&m(s,["responseModalities"],k);const I=f(e,["mediaResolution"]);I!=null&&m(s,["mediaResolution"],I);const M=f(e,["speechConfig"]);if(M!=null&&m(s,["speechConfig"],AA(M)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const D=f(e,["thinkingConfig"]);D!=null&&m(s,["thinkingConfig"],D);const O=f(e,["imageConfig"]);O!=null&&m(s,["imageConfig"],vB(O));const L=f(e,["enableEnhancedCivicAnswers"]);return L!=null&&m(s,["enableEnhancedCivicAnswers"],L),s}function fB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>J3(c))),m(e,["candidates"],l)}const i=f(n,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const r=f(n,["promptFeedback"]);r!=null&&m(e,["promptFeedback"],r);const a=f(n,["responseId"]);a!=null&&m(e,["responseId"],a);const o=f(n,["usageMetadata"]);return o!=null&&m(e,["usageMetadata"],o),e}function pB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function mB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Af(n,s)),t}function gB(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function yB(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function vB(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const s=f(n,["imageSize"]);if(s!=null&&m(e,["imageSize"],s),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function bB(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["request","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let o=Si(i);Array.isArray(o)&&(o=o.map(l=>MD(l))),m(t,["request","contents"],o)}const r=f(e,["metadata"]);r!=null&&m(t,["metadata"],r);const a=f(e,["config"]);return a!=null&&m(t,["request","generationConfig"],hB(n,a,f(t,["request"],{}))),t}function _B(n){const e={},t=f(n,["response"]);t!=null&&m(e,["response"],fB(t));const s=f(n,["error"]);return s!=null&&m(e,["error"],s),e}function xB(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);if(e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function wB(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);e!==void 0&&i!=null&&m(e,["_query","pageToken"],i);const r=f(n,["filter"]);return e!==void 0&&r!=null&&m(e,["_query","filter"],r),t}function SB(n){const e={},t=f(n,["config"]);return t!=null&&xB(t,e),e}function EB(n){const e={},t=f(n,["config"]);return t!=null&&wB(t,e),e}function AB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["operations"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>Vy(a))),m(e,["batchJobs"],r)}return e}function TB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["batchPredictionJobs"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>US(a))),m(e,["batchJobs"],r)}return e}function CB(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const s=f(n,["codeExecutionResult"]);s!=null&&m(e,["codeExecutionResult"],s);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const r=f(n,["fileData"]);r!=null&&m(e,["fileData"],cB(r));const a=f(n,["functionCall"]);a!=null&&m(e,["functionCall"],uB(a));const o=f(n,["functionResponse"]);o!=null&&m(e,["functionResponse"],o);const l=f(n,["inlineData"]);l!=null&&m(e,["inlineData"],$3(l));const c=f(n,["text"]);c!=null&&m(e,["text"],c);const d=f(n,["thought"]);d!=null&&m(e,["thought"],d);const h=f(n,["thoughtSignature"]);h!=null&&m(e,["thoughtSignature"],h);const p=f(n,["videoMetadata"]);return p!=null&&m(e,["videoMetadata"],p),e}function NB(n){const e={},t=f(n,["category"]);if(t!=null&&m(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=f(n,["threshold"]);return s!=null&&m(e,["threshold"],s),e}function RB(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],dB(t));const s=f(n,["retrievalConfig"]);return s!=null&&m(e,["retrievalConfig"],s),e}function kB(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(h=>h)),m(e,["functionDeclarations"],d)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const r=f(n,["fileSearch"]);r!=null&&m(e,["fileSearch"],r);const a=f(n,["codeExecution"]);if(a!=null&&m(e,["codeExecution"],a),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=f(n,["googleMaps"]);o!=null&&m(e,["googleMaps"],gB(o));const l=f(n,["googleSearch"]);l!=null&&m(e,["googleSearch"],yB(l));const c=f(n,["urlContext"]);return c!=null&&m(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var qa;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(qa||(qa={}));class Eu{constructor(e,t,s,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,i)}init(e,t,s){var i,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!s||Object.keys(s).length===0?a={config:{}}:typeof s=="object"?a=Object.assign({},s):a=s,a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(r=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MB extends Ka{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eu(qa.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=uN(this.apiClient,e),s=t._url,i=J("{model}:batchGenerateContent",s),o=t.batch.inputConfig.requests,l=o.requests,c=[];for(const d of l){const h=Object.assign({},d);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const y=h.request;y.systemInstruction=p,h.request=y}c.push(h)}return o.requests=c,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const s=t?Object.assign({},t):{},i=Date.now().toString();if(s.displayName||(s.displayName=`genaiBatchJob_${i}`),s.dest===void 0){const r=this.getGcsUri(e),a=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?s.dest=`${r.slice(0,-6)}/dest`:s.dest=`${r}_dest_${i}`;else if(a)s.dest=`${a}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return s}async createInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=Z3(this.apiClient,e);return o=J("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>US(d))}else{const c=uN(this.apiClient,e);return o=J("{model}:batchGenerateContent",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Vy(d))}}async createEmbeddingsInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=tB(this.apiClient,e);return r=J("{model}:asyncBatchEmbedContent",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>Vy(l))}}async get(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=mB(this.apiClient,e);return o=J("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>US(d))}else{const c=pB(this.apiClient,e);return o=J("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Vy(d))}}async cancel(e){var t,s,i,r;let a="",o={};if(this.apiClient.isVertexAI()){const l=K3(this.apiClient,e);a=J("batchPredictionJobs/{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const l=Y3(this.apiClient,e);a=J("batches/{name}:cancel",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=EB(e);return o=J("batchPredictionJobs",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=TB(d),p=new aN;return Object.assign(p,h),p})}else{const c=SB(e);return o=J("batches",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=AB(d),p=new aN;return Object.assign(p,h),p})}}async delete(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=sB(this.apiClient,e);return o=J("batchPredictionJobs/{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>rB(d))}else{const c=nB(this.apiClient,e);return o=J("batches/{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>iB(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IB(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function dN(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>tF(r))),m(e,["parts"],i)}const s=f(n,["role"]);return s!=null&&m(e,["role"],s),e}function DB(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&m(e,["ttl"],s);const i=f(n,["expireTime"]);e!==void 0&&i!=null&&m(e,["expireTime"],i);const r=f(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=f(n,["contents"]);if(e!==void 0&&a!=null){let d=Si(a);Array.isArray(d)&&(d=d.map(h=>dN(h))),m(e,["contents"],d)}const o=f(n,["systemInstruction"]);e!==void 0&&o!=null&&m(e,["systemInstruction"],dN(Bn(o)));const l=f(n,["tools"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(h=>sF(h))),m(e,["tools"],d)}const c=f(n,["toolConfig"]);if(e!==void 0&&c!=null&&m(e,["toolConfig"],nF(c)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function PB(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&m(e,["ttl"],s);const i=f(n,["expireTime"]);e!==void 0&&i!=null&&m(e,["expireTime"],i);const r=f(n,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=f(n,["contents"]);if(e!==void 0&&a!=null){let h=Si(a);Array.isArray(h)&&(h=h.map(p=>p)),m(e,["contents"],h)}const o=f(n,["systemInstruction"]);e!==void 0&&o!=null&&m(e,["systemInstruction"],Bn(o));const l=f(n,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>iF(p))),m(e,["tools"],h)}const c=f(n,["toolConfig"]);e!==void 0&&c!=null&&m(e,["toolConfig"],c);const d=f(n,["kmsKeyName"]);return e!==void 0&&d!=null&&m(e,["encryption_spec","kmsKeyName"],d),t}function LB(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["model"],bD(n,s));const i=f(e,["config"]);return i!=null&&DB(i,t),t}function OB(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["model"],bD(n,s));const i=f(e,["config"]);return i!=null&&PB(i,t),t}function UB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Ja(n,s)),t}function BB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Ja(n,s)),t}function FB(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function zB(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function HB(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function jB(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const s=f(n,["args"]);s!=null&&m(e,["args"],s);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function GB(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const s=f(n,["allowedFunctionNames"]);if(s!=null&&m(e,["allowedFunctionNames"],s),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function qB(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const s=f(n,["name"]);s!=null&&m(e,["name"],s);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const r=f(n,["parametersJsonSchema"]);r!=null&&m(e,["parametersJsonSchema"],r);const a=f(n,["response"]);a!=null&&m(e,["response"],a);const o=f(n,["responseJsonSchema"]);return o!=null&&m(e,["responseJsonSchema"],o),e}function VB(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Ja(n,s)),t}function $B(n,e){const t={},s=f(e,["name"]);return s!=null&&m(t,["_url","name"],Ja(n,s)),t}function YB(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function KB(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function JB(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function XB(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function WB(n){const e={},t=f(n,["config"]);return t!=null&&JB(t,e),e}function QB(n){const e={},t=f(n,["config"]);return t!=null&&XB(t,e),e}function ZB(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["cachedContents"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["cachedContents"],r)}return e}function eF(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["cachedContents"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["cachedContents"],r)}return e}function tF(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const s=f(n,["codeExecutionResult"]);s!=null&&m(e,["codeExecutionResult"],s);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const r=f(n,["fileData"]);r!=null&&m(e,["fileData"],HB(r));const a=f(n,["functionCall"]);a!=null&&m(e,["functionCall"],jB(a));const o=f(n,["functionResponse"]);o!=null&&m(e,["functionResponse"],o);const l=f(n,["inlineData"]);l!=null&&m(e,["inlineData"],IB(l));const c=f(n,["text"]);c!=null&&m(e,["text"],c);const d=f(n,["thought"]);d!=null&&m(e,["thought"],d);const h=f(n,["thoughtSignature"]);h!=null&&m(e,["thoughtSignature"],h);const p=f(n,["videoMetadata"]);return p!=null&&m(e,["videoMetadata"],p),e}function nF(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],GB(t));const s=f(n,["retrievalConfig"]);return s!=null&&m(e,["retrievalConfig"],s),e}function sF(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(h=>h)),m(e,["functionDeclarations"],d)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const r=f(n,["fileSearch"]);r!=null&&m(e,["fileSearch"],r);const a=f(n,["codeExecution"]);if(a!=null&&m(e,["codeExecution"],a),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=f(n,["googleMaps"]);o!=null&&m(e,["googleMaps"],YB(o));const l=f(n,["googleSearch"]);l!=null&&m(e,["googleSearch"],KB(l));const c=f(n,["urlContext"]);return c!=null&&m(e,["urlContext"],c),e}function iF(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>qB(p))),m(e,["functionDeclarations"],h)}const s=f(n,["retrieval"]);s!=null&&m(e,["retrieval"],s);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);if(r!=null&&m(e,["computerUse"],r),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=f(n,["codeExecution"]);a!=null&&m(e,["codeExecution"],a);const o=f(n,["enterpriseWebSearch"]);o!=null&&m(e,["enterpriseWebSearch"],o);const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],l);const c=f(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],c);const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function rF(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&m(e,["ttl"],s);const i=f(n,["expireTime"]);return e!==void 0&&i!=null&&m(e,["expireTime"],i),t}function aF(n,e){const t={},s=f(n,["ttl"]);e!==void 0&&s!=null&&m(e,["ttl"],s);const i=f(n,["expireTime"]);return e!==void 0&&i!=null&&m(e,["expireTime"],i),t}function oF(n,e){const t={},s=f(e,["name"]);s!=null&&m(t,["_url","name"],Ja(n,s));const i=f(e,["config"]);return i!=null&&rF(i,t),t}function lF(n,e){const t={},s=f(e,["name"]);s!=null&&m(t,["_url","name"],Ja(n,s));const i=f(e,["config"]);return i!=null&&aF(i,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cF extends Ka{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eu(qa.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=OB(this.apiClient,e);return o=J("cachedContents",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>d)}else{const c=LB(this.apiClient,e);return o=J("cachedContents",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async get(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=$B(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>d)}else{const c=VB(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async delete(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=BB(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=zB(d),p=new iN;return Object.assign(p,h),p})}else{const c=UB(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=FB(d),p=new iN;return Object.assign(p,h),p})}}async update(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=lF(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>d)}else{const c=oF(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>d)}}async listInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=QB(e);return o=J("cachedContents",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=eF(d),p=new rN;return Object.assign(p,h),p})}else{const c=WB(e);return o=J("cachedContents",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=ZB(d),p=new rN;return Object.assign(p,h),p})}}}function Bv(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t}function hN(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ce(n){return this instanceof ce?(this.v=n,this):new ce(n)}function Ji(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),i,r=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(y){return function(v){return Promise.resolve(v).then(y,h)}}function o(y,v){s[y]&&(i[y]=function(_){return new Promise(function(E,b){r.push([y,_,E,b])>1||l(y,_)})},v&&(i[y]=v(i[y])))}function l(y,v){try{c(s[y](v))}catch(_){p(r[0][3],_)}}function c(y){y.value instanceof ce?Promise.resolve(y.value.v).then(d,h):p(r[0][2],y)}function d(y){l("next",y)}function h(y){l("throw",y)}function p(y,v){y(v),r.shift(),r.length&&l(r[0][0],r[0][1])}}function Xi(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof hN=="function"?hN(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(r){t[r]=n[r]&&function(a){return new Promise(function(o,l){a=n[r](a),i(o,l,a.done,a.value)})}}function i(r,a,o,l){Promise.resolve(l).then(function(c){r({value:c,done:o})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uF(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:ID(t)}function ID(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function dF(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function fN(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const i=[];let r=!0;for(;s<t&&n[s].role==="model";)i.push(n[s]),r&&!ID(n[s])&&(r=!1),s++;r?e.push(...i):e.pop()}return e}class hF{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new fF(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class fF{constructor(e,t,s,i={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=i,this.history=r,this.sendPromise=Promise.resolve(),dF(r)}async sendMessage(e){var t;await this.sendPromise;const s=Bn(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,a,o;const l=await i,c=(a=(r=l.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content,d=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];d!=null&&(p=(o=d.slice(h))!==null&&o!==void 0?o:[]);const y=c?[c]:[];this.recordHistory(s,y,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const s=Bn(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const r=await i;return this.processStreamResponse(r,s)}getHistory(e=!1){const t=e?fN(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Ji(this,arguments,function*(){var i,r,a,o,l,c;const d=[];try{for(var h=!0,p=Xi(e),y;y=yield ce(p.next()),i=y.done,!i;h=!0){o=y.value,h=!1;const v=o;if(uF(v)){const _=(c=(l=v.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content;_!==void 0&&d.push(_)}yield yield ce(v)}}catch(v){r={error:v}}finally{try{!h&&!i&&(a=p.return)&&(yield ce(a.call(p)))}finally{if(r)throw r.error}}this.recordHistory(t,d)})}recordHistory(e,t,s){let i=[];t.length>0&&t.every(r=>r.role!==void 0)?i=t:i.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...fN(s)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ub extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ub.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pF(n){const e={},t=f(n,["file"]);return t!=null&&m(e,["file"],t),e}function mF(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function gF(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","file"],AD(t)),e}function yF(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function vF(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","file"],AD(t)),e}function bF(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function _F(n){const e={},t=f(n,["config"]);return t!=null&&bF(t,e),e}function xF(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["files"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wF extends Ka{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eu(qa.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=_F(e);return r=J("files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const c=xF(l),d=new T3;return Object.assign(d,c),d})}}async createInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=pF(e);return r=J("upload/v1beta/files",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=mF(l),d=new C3;return Object.assign(d,c),d})}}async get(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=vF(e);return r=J("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=gF(e);return r=J("files/{file}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const c=yF(l),d=new N3;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $y(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function SF(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>FF(r))),m(e,["parts"],i)}const s=f(n,["role"]);return s!=null&&m(e,["role"],s),e}function EF(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function AF(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const s=f(n,["args"]);s!=null&&m(e,["args"],s);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function TF(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const s=f(n,["name"]);s!=null&&m(e,["name"],s);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const r=f(n,["parametersJsonSchema"]);r!=null&&m(e,["parametersJsonSchema"],r);const a=f(n,["response"]);a!=null&&m(e,["response"],a);const o=f(n,["responseJsonSchema"]);return o!=null&&m(e,["responseJsonSchema"],o),e}function CF(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const s=f(n,["responseJsonSchema"]);s!=null&&m(e,["responseJsonSchema"],s);const i=f(n,["audioTimestamp"]);i!=null&&m(e,["audioTimestamp"],i);const r=f(n,["candidateCount"]);r!=null&&m(e,["candidateCount"],r);const a=f(n,["enableAffectiveDialog"]);a!=null&&m(e,["enableAffectiveDialog"],a);const o=f(n,["frequencyPenalty"]);o!=null&&m(e,["frequencyPenalty"],o);const l=f(n,["logprobs"]);l!=null&&m(e,["logprobs"],l);const c=f(n,["maxOutputTokens"]);c!=null&&m(e,["maxOutputTokens"],c);const d=f(n,["mediaResolution"]);d!=null&&m(e,["mediaResolution"],d);const h=f(n,["presencePenalty"]);h!=null&&m(e,["presencePenalty"],h);const p=f(n,["responseLogprobs"]);p!=null&&m(e,["responseLogprobs"],p);const y=f(n,["responseMimeType"]);y!=null&&m(e,["responseMimeType"],y);const v=f(n,["responseModalities"]);v!=null&&m(e,["responseModalities"],v);const _=f(n,["responseSchema"]);_!=null&&m(e,["responseSchema"],_);const E=f(n,["routingConfig"]);E!=null&&m(e,["routingConfig"],E);const b=f(n,["seed"]);b!=null&&m(e,["seed"],b);const w=f(n,["speechConfig"]);w!=null&&m(e,["speechConfig"],w);const S=f(n,["stopSequences"]);S!=null&&m(e,["stopSequences"],S);const T=f(n,["temperature"]);T!=null&&m(e,["temperature"],T);const N=f(n,["thinkingConfig"]);N!=null&&m(e,["thinkingConfig"],N);const R=f(n,["topK"]);R!=null&&m(e,["topK"],R);const k=f(n,["topP"]);if(k!=null&&m(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function NF(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function RF(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function kF(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig"],s);const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const r=f(n,["temperature"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","temperature"],r);const a=f(n,["topP"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","topP"],a);const o=f(n,["topK"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topK"],o);const l=f(n,["maxOutputTokens"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","maxOutputTokens"],l);const c=f(n,["mediaResolution"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","mediaResolution"],c);const d=f(n,["seed"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","seed"],d);const h=f(n,["speechConfig"]);e!==void 0&&h!=null&&m(e,["setup","generationConfig","speechConfig"],TA(h));const p=f(n,["thinkingConfig"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","thinkingConfig"],p);const y=f(n,["enableAffectiveDialog"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],y);const v=f(n,["systemInstruction"]);e!==void 0&&v!=null&&m(e,["setup","systemInstruction"],SF(Bn(v)));const _=f(n,["tools"]);if(e!==void 0&&_!=null){let R=Ef(_);Array.isArray(R)&&(R=R.map(k=>HF(Sf(k)))),m(e,["setup","tools"],R)}const E=f(n,["sessionResumption"]);e!==void 0&&E!=null&&m(e,["setup","sessionResumption"],zF(E));const b=f(n,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],b);const w=f(n,["outputAudioTranscription"]);e!==void 0&&w!=null&&m(e,["setup","outputAudioTranscription"],w);const S=f(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&m(e,["setup","realtimeInputConfig"],S);const T=f(n,["contextWindowCompression"]);e!==void 0&&T!=null&&m(e,["setup","contextWindowCompression"],T);const N=f(n,["proactivity"]);if(e!==void 0&&N!=null&&m(e,["setup","proactivity"],N),f(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function MF(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig"],CF(s));const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const r=f(n,["temperature"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","temperature"],r);const a=f(n,["topP"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","topP"],a);const o=f(n,["topK"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topK"],o);const l=f(n,["maxOutputTokens"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","maxOutputTokens"],l);const c=f(n,["mediaResolution"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","mediaResolution"],c);const d=f(n,["seed"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","seed"],d);const h=f(n,["speechConfig"]);e!==void 0&&h!=null&&m(e,["setup","generationConfig","speechConfig"],TA(h));const p=f(n,["thinkingConfig"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","thinkingConfig"],p);const y=f(n,["enableAffectiveDialog"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],y);const v=f(n,["systemInstruction"]);e!==void 0&&v!=null&&m(e,["setup","systemInstruction"],Bn(v));const _=f(n,["tools"]);if(e!==void 0&&_!=null){let k=Ef(_);Array.isArray(k)&&(k=k.map(I=>jF(Sf(I)))),m(e,["setup","tools"],k)}const E=f(n,["sessionResumption"]);e!==void 0&&E!=null&&m(e,["setup","sessionResumption"],E);const b=f(n,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],b);const w=f(n,["outputAudioTranscription"]);e!==void 0&&w!=null&&m(e,["setup","outputAudioTranscription"],w);const S=f(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&m(e,["setup","realtimeInputConfig"],S);const T=f(n,["contextWindowCompression"]);e!==void 0&&T!=null&&m(e,["setup","contextWindowCompression"],T);const N=f(n,["proactivity"]);e!==void 0&&N!=null&&m(e,["setup","proactivity"],N);const R=f(n,["explicitVadSignal"]);return e!==void 0&&R!=null&&m(e,["setup","explicitVadSignal"],R),t}function IF(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["setup","model"],Me(n,s));const i=f(e,["config"]);return i!=null&&m(t,["config"],kF(i,t)),t}function DF(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["setup","model"],Me(n,s));const i=f(e,["config"]);return i!=null&&m(t,["config"],MF(i,t)),t}function PF(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function LF(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),m(e,["weightedPrompts"],s)}return e}function OF(n){const e={},t=f(n,["media"]);if(t!=null){let c=_D(t);Array.isArray(c)&&(c=c.map(d=>$y(d))),m(e,["mediaChunks"],c)}const s=f(n,["audio"]);s!=null&&m(e,["audio"],$y(wD(s)));const i=f(n,["audioStreamEnd"]);i!=null&&m(e,["audioStreamEnd"],i);const r=f(n,["video"]);r!=null&&m(e,["video"],$y(xD(r)));const a=f(n,["text"]);a!=null&&m(e,["text"],a);const o=f(n,["activityStart"]);o!=null&&m(e,["activityStart"],o);const l=f(n,["activityEnd"]);return l!=null&&m(e,["activityEnd"],l),e}function UF(n){const e={},t=f(n,["media"]);if(t!=null){let c=_D(t);Array.isArray(c)&&(c=c.map(d=>d)),m(e,["mediaChunks"],c)}const s=f(n,["audio"]);s!=null&&m(e,["audio"],wD(s));const i=f(n,["audioStreamEnd"]);i!=null&&m(e,["audioStreamEnd"],i);const r=f(n,["video"]);r!=null&&m(e,["video"],xD(r));const a=f(n,["text"]);a!=null&&m(e,["text"],a);const o=f(n,["activityStart"]);o!=null&&m(e,["activityStart"],o);const l=f(n,["activityEnd"]);return l!=null&&m(e,["activityEnd"],l),e}function BF(n){const e={},t=f(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const s=f(n,["serverContent"]);s!=null&&m(e,["serverContent"],s);const i=f(n,["toolCall"]);i!=null&&m(e,["toolCall"],i);const r=f(n,["toolCallCancellation"]);r!=null&&m(e,["toolCallCancellation"],r);const a=f(n,["usageMetadata"]);a!=null&&m(e,["usageMetadata"],GF(a));const o=f(n,["goAway"]);o!=null&&m(e,["goAway"],o);const l=f(n,["sessionResumptionUpdate"]);l!=null&&m(e,["sessionResumptionUpdate"],l);const c=f(n,["voiceActivityDetectionSignal"]);return c!=null&&m(e,["voiceActivityDetectionSignal"],c),e}function FF(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const s=f(n,["codeExecutionResult"]);s!=null&&m(e,["codeExecutionResult"],s);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const r=f(n,["fileData"]);r!=null&&m(e,["fileData"],EF(r));const a=f(n,["functionCall"]);a!=null&&m(e,["functionCall"],AF(a));const o=f(n,["functionResponse"]);o!=null&&m(e,["functionResponse"],o);const l=f(n,["inlineData"]);l!=null&&m(e,["inlineData"],$y(l));const c=f(n,["text"]);c!=null&&m(e,["text"],c);const d=f(n,["thought"]);d!=null&&m(e,["thought"],d);const h=f(n,["thoughtSignature"]);h!=null&&m(e,["thoughtSignature"],h);const p=f(n,["videoMetadata"]);return p!=null&&m(e,["videoMetadata"],p),e}function zF(n){const e={},t=f(n,["handle"]);if(t!=null&&m(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function HF(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(h=>h)),m(e,["functionDeclarations"],d)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const r=f(n,["fileSearch"]);r!=null&&m(e,["fileSearch"],r);const a=f(n,["codeExecution"]);if(a!=null&&m(e,["codeExecution"],a),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=f(n,["googleMaps"]);o!=null&&m(e,["googleMaps"],NF(o));const l=f(n,["googleSearch"]);l!=null&&m(e,["googleSearch"],RF(l));const c=f(n,["urlContext"]);return c!=null&&m(e,["urlContext"],c),e}function jF(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>TF(p))),m(e,["functionDeclarations"],h)}const s=f(n,["retrieval"]);s!=null&&m(e,["retrieval"],s);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);if(r!=null&&m(e,["computerUse"],r),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=f(n,["codeExecution"]);a!=null&&m(e,["codeExecution"],a);const o=f(n,["enterpriseWebSearch"]);o!=null&&m(e,["enterpriseWebSearch"],o);const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],l);const c=f(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],c);const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function GF(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const s=f(n,["cachedContentTokenCount"]);s!=null&&m(e,["cachedContentTokenCount"],s);const i=f(n,["candidatesTokenCount"]);i!=null&&m(e,["responseTokenCount"],i);const r=f(n,["toolUsePromptTokenCount"]);r!=null&&m(e,["toolUsePromptTokenCount"],r);const a=f(n,["thoughtsTokenCount"]);a!=null&&m(e,["thoughtsTokenCount"],a);const o=f(n,["totalTokenCount"]);o!=null&&m(e,["totalTokenCount"],o);const l=f(n,["promptTokensDetails"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(v=>v)),m(e,["promptTokensDetails"],y)}const c=f(n,["cacheTokensDetails"]);if(c!=null){let y=c;Array.isArray(y)&&(y=y.map(v=>v)),m(e,["cacheTokensDetails"],y)}const d=f(n,["candidatesTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(v=>v)),m(e,["responseTokensDetails"],y)}const h=f(n,["toolUsePromptTokensDetails"]);if(h!=null){let y=h;Array.isArray(y)&&(y=y.map(v=>v)),m(e,["toolUsePromptTokensDetails"],y)}const p=f(n,["trafficType"]);return p!=null&&m(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qF(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function VF(n){const e={},t=f(n,["content"]);t!=null&&m(e,["content"],t);const s=f(n,["citationMetadata"]);s!=null&&m(e,["citationMetadata"],$F(s));const i=f(n,["tokenCount"]);i!=null&&m(e,["tokenCount"],i);const r=f(n,["finishReason"]);r!=null&&m(e,["finishReason"],r);const a=f(n,["avgLogprobs"]);a!=null&&m(e,["avgLogprobs"],a);const o=f(n,["groundingMetadata"]);o!=null&&m(e,["groundingMetadata"],o);const l=f(n,["index"]);l!=null&&m(e,["index"],l);const c=f(n,["logprobsResult"]);c!=null&&m(e,["logprobsResult"],c);const d=f(n,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(y=>y)),m(e,["safetyRatings"],p)}const h=f(n,["urlContextMetadata"]);return h!=null&&m(e,["urlContextMetadata"],h),e}function $F(n){const e={},t=f(n,["citationSources"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>i)),m(e,["citations"],s)}return e}function YF(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let r=Si(i);Array.isArray(r)&&(r=r.map(a=>a)),m(t,["contents"],r)}return t}function KF(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["tokensInfo"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),m(e,["tokensInfo"],i)}return e}function JF(n){const e={},t=f(n,["values"]);t!=null&&m(e,["values"],t);const s=f(n,["statistics"]);return s!=null&&m(e,["statistics"],XF(s)),e}function XF(n){const e={},t=f(n,["truncated"]);t!=null&&m(e,["truncated"],t);const s=f(n,["token_count"]);return s!=null&&m(e,["tokenCount"],s),e}function Bb(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>rz(r))),m(e,["parts"],i)}const s=f(n,["role"]);return s!=null&&m(e,["role"],s),e}function WF(n){const e={},t=f(n,["controlType"]);t!=null&&m(e,["controlType"],t);const s=f(n,["enableControlImageComputation"]);return s!=null&&m(e,["computeControl"],s),e}function QF(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function ZF(n,e){const t={},s=f(n,["systemInstruction"]);e!==void 0&&s!=null&&m(e,["systemInstruction"],Bn(s));const i=f(n,["tools"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>OD(o))),m(e,["tools"],a)}const r=f(n,["generationConfig"]);return e!==void 0&&r!=null&&m(e,["generationConfig"],q6(r)),t}function e6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let a=Si(i);Array.isArray(a)&&(a=a.map(o=>Bb(o))),m(t,["contents"],a)}const r=f(e,["config"]);return r!=null&&QF(r),t}function t6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let a=Si(i);Array.isArray(a)&&(a=a.map(o=>o)),m(t,["contents"],a)}const r=f(e,["config"]);return r!=null&&ZF(r,t),t}function n6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["totalTokens"]);s!=null&&m(e,["totalTokens"],s);const i=f(n,["cachedContentTokenCount"]);return i!=null&&m(e,["cachedContentTokenCount"],i),e}function s6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["totalTokens"]);return s!=null&&m(e,["totalTokens"],s),e}function i6(n,e){const t={},s=f(e,["model"]);return s!=null&&m(t,["_url","name"],Me(n,s)),t}function r6(n,e){const t={},s=f(e,["model"]);return s!=null&&m(t,["_url","name"],Me(n,s)),t}function a6(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function o6(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function l6(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const i=f(n,["negativePrompt"]);e!==void 0&&i!=null&&m(e,["parameters","negativePrompt"],i);const r=f(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=f(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const o=f(n,["guidanceScale"]);e!==void 0&&o!=null&&m(e,["parameters","guidanceScale"],o);const l=f(n,["seed"]);e!==void 0&&l!=null&&m(e,["parameters","seed"],l);const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&m(e,["parameters","safetySetting"],c);const d=f(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const h=f(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&m(e,["parameters","includeSafetyAttributes"],h);const p=f(n,["includeRaiReason"]);e!==void 0&&p!=null&&m(e,["parameters","includeRaiReason"],p);const y=f(n,["language"]);e!==void 0&&y!=null&&m(e,["parameters","language"],y);const v=f(n,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const _=f(n,["outputCompressionQuality"]);e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_);const E=f(n,["addWatermark"]);e!==void 0&&E!=null&&m(e,["parameters","addWatermark"],E);const b=f(n,["labels"]);e!==void 0&&b!=null&&m(e,["labels"],b);const w=f(n,["editMode"]);e!==void 0&&w!=null&&m(e,["parameters","editMode"],w);const S=f(n,["baseSteps"]);return e!==void 0&&S!=null&&m(e,["parameters","editConfig","baseSteps"],S),t}function c6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const r=f(e,["referenceImages"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>dz(l))),m(t,["instances[0]","referenceImages"],o)}const a=f(e,["config"]);return a!=null&&l6(a,t),t}function u6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>Fb(r))),m(e,["generatedImages"],i)}return e}function d6(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&m(e,["requests[]","taskType"],s);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["requests[]","title"],i);const r=f(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&m(e,["requests[]","outputDimensionality"],r),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function h6(n,e){const t={},s=f(n,["taskType"]);e!==void 0&&s!=null&&m(e,["instances[]","task_type"],s);const i=f(n,["title"]);e!==void 0&&i!=null&&m(e,["instances[]","title"],i);const r=f(n,["outputDimensionality"]);e!==void 0&&r!=null&&m(e,["parameters","outputDimensionality"],r);const a=f(n,["mimeType"]);e!==void 0&&a!=null&&m(e,["instances[]","mimeType"],a);const o=f(n,["autoTruncate"]);return e!==void 0&&o!=null&&m(e,["parameters","autoTruncate"],o),t}function f6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let o=SA(n,i);Array.isArray(o)&&(o=o.map(l=>l)),m(t,["requests[]","content"],o)}const r=f(e,["config"]);r!=null&&d6(r,t);const a=f(e,["model"]);return a!==void 0&&m(t,["requests[]","model"],Me(n,a)),t}function p6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let a=SA(n,i);Array.isArray(a)&&(a=a.map(o=>o)),m(t,["instances[]","content"],a)}const r=f(e,["config"]);return r!=null&&h6(r,t),t}function m6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["embeddings"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["embeddings"],r)}const i=f(n,["metadata"]);return i!=null&&m(e,["metadata"],i),e}function g6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["predictions[]","embeddings"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>JF(a))),m(e,["embeddings"],r)}const i=f(n,["metadata"]);return i!=null&&m(e,["metadata"],i),e}function y6(n){const e={},t=f(n,["endpoint"]);t!=null&&m(e,["name"],t);const s=f(n,["deployedModelId"]);return s!=null&&m(e,["deployedModelId"],s),e}function v6(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function b6(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const s=f(n,["args"]);s!=null&&m(e,["args"],s);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _6(n){const e={},t=f(n,["mode"]);t!=null&&m(e,["mode"],t);const s=f(n,["allowedFunctionNames"]);if(s!=null&&m(e,["allowedFunctionNames"],s),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function x6(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&m(e,["description"],t);const s=f(n,["name"]);s!=null&&m(e,["name"],s);const i=f(n,["parameters"]);i!=null&&m(e,["parameters"],i);const r=f(n,["parametersJsonSchema"]);r!=null&&m(e,["parametersJsonSchema"],r);const a=f(n,["response"]);a!=null&&m(e,["response"],a);const o=f(n,["responseJsonSchema"]);return o!=null&&m(e,["responseJsonSchema"],o),e}function w6(n,e,t){const s={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],Bb(Bn(i)));const r=f(e,["temperature"]);r!=null&&m(s,["temperature"],r);const a=f(e,["topP"]);a!=null&&m(s,["topP"],a);const o=f(e,["topK"]);o!=null&&m(s,["topK"],o);const l=f(e,["candidateCount"]);l!=null&&m(s,["candidateCount"],l);const c=f(e,["maxOutputTokens"]);c!=null&&m(s,["maxOutputTokens"],c);const d=f(e,["stopSequences"]);d!=null&&m(s,["stopSequences"],d);const h=f(e,["responseLogprobs"]);h!=null&&m(s,["responseLogprobs"],h);const p=f(e,["logprobs"]);p!=null&&m(s,["logprobs"],p);const y=f(e,["presencePenalty"]);y!=null&&m(s,["presencePenalty"],y);const v=f(e,["frequencyPenalty"]);v!=null&&m(s,["frequencyPenalty"],v);const _=f(e,["seed"]);_!=null&&m(s,["seed"],_);const E=f(e,["responseMimeType"]);E!=null&&m(s,["responseMimeType"],E);const b=f(e,["responseSchema"]);b!=null&&m(s,["responseSchema"],EA(b));const w=f(e,["responseJsonSchema"]);if(w!=null&&m(s,["responseJsonSchema"],w),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const S=f(e,["safetySettings"]);if(t!==void 0&&S!=null){let $=S;Array.isArray($)&&($=$.map(G=>hz(G))),m(t,["safetySettings"],$)}const T=f(e,["tools"]);if(t!==void 0&&T!=null){let $=Ef(T);Array.isArray($)&&($=$.map(G=>bz(Sf(G)))),m(t,["tools"],$)}const N=f(e,["toolConfig"]);if(t!==void 0&&N!=null&&m(t,["toolConfig"],vz(N)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=f(e,["cachedContent"]);t!==void 0&&R!=null&&m(t,["cachedContent"],Ja(n,R));const k=f(e,["responseModalities"]);k!=null&&m(s,["responseModalities"],k);const I=f(e,["mediaResolution"]);I!=null&&m(s,["mediaResolution"],I);const M=f(e,["speechConfig"]);if(M!=null&&m(s,["speechConfig"],AA(M)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const D=f(e,["thinkingConfig"]);D!=null&&m(s,["thinkingConfig"],D);const O=f(e,["imageConfig"]);O!=null&&m(s,["imageConfig"],J6(O));const L=f(e,["enableEnhancedCivicAnswers"]);return L!=null&&m(s,["enableEnhancedCivicAnswers"],L),s}function S6(n,e,t){const s={},i=f(e,["systemInstruction"]);t!==void 0&&i!=null&&m(t,["systemInstruction"],Bn(i));const r=f(e,["temperature"]);r!=null&&m(s,["temperature"],r);const a=f(e,["topP"]);a!=null&&m(s,["topP"],a);const o=f(e,["topK"]);o!=null&&m(s,["topK"],o);const l=f(e,["candidateCount"]);l!=null&&m(s,["candidateCount"],l);const c=f(e,["maxOutputTokens"]);c!=null&&m(s,["maxOutputTokens"],c);const d=f(e,["stopSequences"]);d!=null&&m(s,["stopSequences"],d);const h=f(e,["responseLogprobs"]);h!=null&&m(s,["responseLogprobs"],h);const p=f(e,["logprobs"]);p!=null&&m(s,["logprobs"],p);const y=f(e,["presencePenalty"]);y!=null&&m(s,["presencePenalty"],y);const v=f(e,["frequencyPenalty"]);v!=null&&m(s,["frequencyPenalty"],v);const _=f(e,["seed"]);_!=null&&m(s,["seed"],_);const E=f(e,["responseMimeType"]);E!=null&&m(s,["responseMimeType"],E);const b=f(e,["responseSchema"]);b!=null&&m(s,["responseSchema"],EA(b));const w=f(e,["responseJsonSchema"]);w!=null&&m(s,["responseJsonSchema"],w);const S=f(e,["routingConfig"]);S!=null&&m(s,["routingConfig"],S);const T=f(e,["modelSelectionConfig"]);T!=null&&m(s,["modelConfig"],T);const N=f(e,["safetySettings"]);if(t!==void 0&&N!=null){let P=N;Array.isArray(P)&&(P=P.map(F=>F)),m(t,["safetySettings"],P)}const R=f(e,["tools"]);if(t!==void 0&&R!=null){let P=Ef(R);Array.isArray(P)&&(P=P.map(F=>OD(Sf(F)))),m(t,["tools"],P)}const k=f(e,["toolConfig"]);t!==void 0&&k!=null&&m(t,["toolConfig"],k);const I=f(e,["labels"]);t!==void 0&&I!=null&&m(t,["labels"],I);const M=f(e,["cachedContent"]);t!==void 0&&M!=null&&m(t,["cachedContent"],Ja(n,M));const D=f(e,["responseModalities"]);D!=null&&m(s,["responseModalities"],D);const O=f(e,["mediaResolution"]);O!=null&&m(s,["mediaResolution"],O);const L=f(e,["speechConfig"]);L!=null&&m(s,["speechConfig"],AA(L));const $=f(e,["audioTimestamp"]);$!=null&&m(s,["audioTimestamp"],$);const G=f(e,["thinkingConfig"]);G!=null&&m(s,["thinkingConfig"],G);const ee=f(e,["imageConfig"]);if(ee!=null&&m(s,["imageConfig"],X6(ee)),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return s}function pN(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let a=Si(i);Array.isArray(a)&&(a=a.map(o=>Bb(o))),m(t,["contents"],a)}const r=f(e,["config"]);return r!=null&&m(t,["generationConfig"],w6(n,r,t)),t}function mN(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["contents"]);if(i!=null){let a=Si(i);Array.isArray(a)&&(a=a.map(o=>o)),m(t,["contents"],a)}const r=f(e,["config"]);return r!=null&&m(t,["generationConfig"],S6(n,r,t)),t}function gN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>VF(c))),m(e,["candidates"],l)}const i=f(n,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const r=f(n,["promptFeedback"]);r!=null&&m(e,["promptFeedback"],r);const a=f(n,["responseId"]);a!=null&&m(e,["responseId"],a);const o=f(n,["usageMetadata"]);return o!=null&&m(e,["usageMetadata"],o),e}function yN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["candidates"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>d)),m(e,["candidates"],c)}const i=f(n,["createTime"]);i!=null&&m(e,["createTime"],i);const r=f(n,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=f(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const o=f(n,["responseId"]);o!=null&&m(e,["responseId"],o);const l=f(n,["usageMetadata"]);return l!=null&&m(e,["usageMetadata"],l),e}function E6(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const i=f(n,["aspectRatio"]);e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i);const r=f(n,["guidanceScale"]);if(e!==void 0&&r!=null&&m(e,["parameters","guidanceScale"],r),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=f(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&m(e,["parameters","safetySetting"],a);const o=f(n,["personGeneration"]);e!==void 0&&o!=null&&m(e,["parameters","personGeneration"],o);const l=f(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&m(e,["parameters","includeSafetyAttributes"],l);const c=f(n,["includeRaiReason"]);e!==void 0&&c!=null&&m(e,["parameters","includeRaiReason"],c);const d=f(n,["language"]);e!==void 0&&d!=null&&m(e,["parameters","language"],d);const h=f(n,["outputMimeType"]);e!==void 0&&h!=null&&m(e,["parameters","outputOptions","mimeType"],h);const p=f(n,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&m(e,["parameters","outputOptions","compressionQuality"],p),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const y=f(n,["imageSize"]);if(e!==void 0&&y!=null&&m(e,["parameters","sampleImageSize"],y),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function A6(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const i=f(n,["negativePrompt"]);e!==void 0&&i!=null&&m(e,["parameters","negativePrompt"],i);const r=f(n,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=f(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const o=f(n,["guidanceScale"]);e!==void 0&&o!=null&&m(e,["parameters","guidanceScale"],o);const l=f(n,["seed"]);e!==void 0&&l!=null&&m(e,["parameters","seed"],l);const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&m(e,["parameters","safetySetting"],c);const d=f(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const h=f(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&m(e,["parameters","includeSafetyAttributes"],h);const p=f(n,["includeRaiReason"]);e!==void 0&&p!=null&&m(e,["parameters","includeRaiReason"],p);const y=f(n,["language"]);e!==void 0&&y!=null&&m(e,["parameters","language"],y);const v=f(n,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const _=f(n,["outputCompressionQuality"]);e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_);const E=f(n,["addWatermark"]);e!==void 0&&E!=null&&m(e,["parameters","addWatermark"],E);const b=f(n,["labels"]);e!==void 0&&b!=null&&m(e,["labels"],b);const w=f(n,["imageSize"]);e!==void 0&&w!=null&&m(e,["parameters","sampleImageSize"],w);const S=f(n,["enhancePrompt"]);return e!==void 0&&S!=null&&m(e,["parameters","enhancePrompt"],S),t}function T6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const r=f(e,["config"]);return r!=null&&E6(r,t),t}function C6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const r=f(e,["config"]);return r!=null&&A6(r,t),t}function N6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>z6(a))),m(e,["generatedImages"],r)}const i=f(n,["positivePromptSafetyAttributes"]);return i!=null&&m(e,["positivePromptSafetyAttributes"],PD(i)),e}function R6(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>Fb(a))),m(e,["generatedImages"],r)}const i=f(n,["positivePromptSafetyAttributes"]);return i!=null&&m(e,["positivePromptSafetyAttributes"],LD(i)),e}function k6(n,e){const t={},s=f(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(n,["durationSeconds"]);if(e!==void 0&&i!=null&&m(e,["parameters","durationSeconds"],i),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=f(n,["aspectRatio"]);e!==void 0&&r!=null&&m(e,["parameters","aspectRatio"],r);const a=f(n,["resolution"]);e!==void 0&&a!=null&&m(e,["parameters","resolution"],a);const o=f(n,["personGeneration"]);if(e!==void 0&&o!=null&&m(e,["parameters","personGeneration"],o),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=f(n,["negativePrompt"]);e!==void 0&&l!=null&&m(e,["parameters","negativePrompt"],l);const c=f(n,["enhancePrompt"]);if(e!==void 0&&c!=null&&m(e,["parameters","enhancePrompt"],c),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=f(n,["lastFrame"]);e!==void 0&&d!=null&&m(e,["instances[0]","lastFrame"],zb(d));const h=f(n,["referenceImages"]);if(e!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(y=>Iz(y))),m(e,["instances[0]","referenceImages"],p)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function M6(n,e){const t={},s=f(n,["numberOfVideos"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const r=f(n,["fps"]);e!==void 0&&r!=null&&m(e,["parameters","fps"],r);const a=f(n,["durationSeconds"]);e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a);const o=f(n,["seed"]);e!==void 0&&o!=null&&m(e,["parameters","seed"],o);const l=f(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=f(n,["resolution"]);e!==void 0&&c!=null&&m(e,["parameters","resolution"],c);const d=f(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const h=f(n,["pubsubTopic"]);e!==void 0&&h!=null&&m(e,["parameters","pubsubTopic"],h);const p=f(n,["negativePrompt"]);e!==void 0&&p!=null&&m(e,["parameters","negativePrompt"],p);const y=f(n,["enhancePrompt"]);e!==void 0&&y!=null&&m(e,["parameters","enhancePrompt"],y);const v=f(n,["generateAudio"]);e!==void 0&&v!=null&&m(e,["parameters","generateAudio"],v);const _=f(n,["lastFrame"]);e!==void 0&&_!=null&&m(e,["instances[0]","lastFrame"],Zi(_));const E=f(n,["referenceImages"]);if(e!==void 0&&E!=null){let S=E;Array.isArray(S)&&(S=S.map(T=>Dz(T))),m(e,["instances[0]","referenceImages"],S)}const b=f(n,["mask"]);e!==void 0&&b!=null&&m(e,["instances[0]","mask"],Mz(b));const w=f(n,["compressionQuality"]);return e!==void 0&&w!=null&&m(e,["parameters","compressionQuality"],w),t}function I6(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response","generateVideoResponse"]);return a!=null&&m(e,["response"],O6(a)),e}function D6(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response"]);return a!=null&&m(e,["response"],U6(a)),e}function P6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const r=f(e,["image"]);r!=null&&m(t,["instances[0]","image"],zb(r));const a=f(e,["video"]);a!=null&&m(t,["instances[0]","video"],UD(a));const o=f(e,["source"]);o!=null&&B6(o,t);const l=f(e,["config"]);return l!=null&&k6(l,t),t}function L6(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["prompt"]);i!=null&&m(t,["instances[0]","prompt"],i);const r=f(e,["image"]);r!=null&&m(t,["instances[0]","image"],Zi(r));const a=f(e,["video"]);a!=null&&m(t,["instances[0]","video"],BD(a));const o=f(e,["source"]);o!=null&&F6(o,t);const l=f(e,["config"]);return l!=null&&M6(l,t),t}function O6(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>j6(a))),m(e,["generatedVideos"],r)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&m(e,["raiMediaFilteredCount"],s);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function U6(n){const e={},t=f(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>G6(a))),m(e,["generatedVideos"],r)}const s=f(n,["raiMediaFilteredCount"]);s!=null&&m(e,["raiMediaFilteredCount"],s);const i=f(n,["raiMediaFilteredReasons"]);return i!=null&&m(e,["raiMediaFilteredReasons"],i),e}function B6(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&m(e,["instances[0]","prompt"],s);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],zb(i));const r=f(n,["video"]);return e!==void 0&&r!=null&&m(e,["instances[0]","video"],UD(r)),t}function F6(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&m(e,["instances[0]","prompt"],s);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],Zi(i));const r=f(n,["video"]);return e!==void 0&&r!=null&&m(e,["instances[0]","video"],BD(r)),t}function z6(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["image"],W6(t));const s=f(n,["raiFilteredReason"]);s!=null&&m(e,["raiFilteredReason"],s);const i=f(n,["_self"]);return i!=null&&m(e,["safetyAttributes"],PD(i)),e}function Fb(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["image"],DD(t));const s=f(n,["raiFilteredReason"]);s!=null&&m(e,["raiFilteredReason"],s);const i=f(n,["_self"]);i!=null&&m(e,["safetyAttributes"],LD(i));const r=f(n,["prompt"]);return r!=null&&m(e,["enhancedPrompt"],r),e}function H6(n){const e={},t=f(n,["_self"]);t!=null&&m(e,["mask"],DD(t));const s=f(n,["labels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),m(e,["labels"],i)}return e}function j6(n){const e={},t=f(n,["video"]);return t!=null&&m(e,["video"],Rz(t)),e}function G6(n){const e={},t=f(n,["_self"]);return t!=null&&m(e,["video"],kz(t)),e}function q6(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const s=f(n,["responseJsonSchema"]);s!=null&&m(e,["responseJsonSchema"],s);const i=f(n,["audioTimestamp"]);i!=null&&m(e,["audioTimestamp"],i);const r=f(n,["candidateCount"]);r!=null&&m(e,["candidateCount"],r);const a=f(n,["enableAffectiveDialog"]);a!=null&&m(e,["enableAffectiveDialog"],a);const o=f(n,["frequencyPenalty"]);o!=null&&m(e,["frequencyPenalty"],o);const l=f(n,["logprobs"]);l!=null&&m(e,["logprobs"],l);const c=f(n,["maxOutputTokens"]);c!=null&&m(e,["maxOutputTokens"],c);const d=f(n,["mediaResolution"]);d!=null&&m(e,["mediaResolution"],d);const h=f(n,["presencePenalty"]);h!=null&&m(e,["presencePenalty"],h);const p=f(n,["responseLogprobs"]);p!=null&&m(e,["responseLogprobs"],p);const y=f(n,["responseMimeType"]);y!=null&&m(e,["responseMimeType"],y);const v=f(n,["responseModalities"]);v!=null&&m(e,["responseModalities"],v);const _=f(n,["responseSchema"]);_!=null&&m(e,["responseSchema"],_);const E=f(n,["routingConfig"]);E!=null&&m(e,["routingConfig"],E);const b=f(n,["seed"]);b!=null&&m(e,["seed"],b);const w=f(n,["speechConfig"]);w!=null&&m(e,["speechConfig"],w);const S=f(n,["stopSequences"]);S!=null&&m(e,["stopSequences"],S);const T=f(n,["temperature"]);T!=null&&m(e,["temperature"],T);const N=f(n,["thinkingConfig"]);N!=null&&m(e,["thinkingConfig"],N);const R=f(n,["topK"]);R!=null&&m(e,["topK"],R);const k=f(n,["topP"]);if(k!=null&&m(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function V6(n,e){const t={},s=f(e,["model"]);return s!=null&&m(t,["_url","name"],Me(n,s)),t}function $6(n,e){const t={},s=f(e,["model"]);return s!=null&&m(t,["_url","name"],Me(n,s)),t}function Y6(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function K6(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function J6(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const s=f(n,["imageSize"]);if(s!=null&&m(e,["imageSize"],s),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function X6(n){const e={},t=f(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const s=f(n,["imageSize"]);s!=null&&m(e,["imageSize"],s);const i=f(n,["outputMimeType"]);i!=null&&m(e,["imageOutputOptions","mimeType"],i);const r=f(n,["outputCompressionQuality"]);return r!=null&&m(e,["imageOutputOptions","compressionQuality"],r),e}function W6(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&m(e,["imageBytes"],wl(t));const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function DD(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&m(e,["imageBytes"],wl(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function zb(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&m(e,["bytesBase64Encoded"],wl(t));const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function Zi(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const s=f(n,["imageBytes"]);s!=null&&m(e,["bytesBase64Encoded"],wl(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function Q6(n,e,t){const s={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=f(e,["pageToken"]);t!==void 0&&r!=null&&m(t,["_query","pageToken"],r);const a=f(e,["filter"]);t!==void 0&&a!=null&&m(t,["_query","filter"],a);const o=f(e,["queryBase"]);return t!==void 0&&o!=null&&m(t,["_url","models_url"],TD(n,o)),s}function Z6(n,e,t){const s={},i=f(e,["pageSize"]);t!==void 0&&i!=null&&m(t,["_query","pageSize"],i);const r=f(e,["pageToken"]);t!==void 0&&r!=null&&m(t,["_query","pageToken"],r);const a=f(e,["filter"]);t!==void 0&&a!=null&&m(t,["_query","filter"],a);const o=f(e,["queryBase"]);return t!==void 0&&o!=null&&m(t,["_url","models_url"],TD(n,o)),s}function ez(n,e){const t={},s=f(e,["config"]);return s!=null&&Q6(n,s,t),t}function tz(n,e){const t={},s=f(e,["config"]);return s!=null&&Z6(n,s,t),t}function nz(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["_self"]);if(i!=null){let r=CD(i);Array.isArray(r)&&(r=r.map(a=>BS(a))),m(e,["models"],r)}return e}function sz(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["_self"]);if(i!=null){let r=CD(i);Array.isArray(r)&&(r=r.map(a=>FS(a))),m(e,["models"],r)}return e}function iz(n){const e={},t=f(n,["maskMode"]);t!=null&&m(e,["maskMode"],t);const s=f(n,["segmentationClasses"]);s!=null&&m(e,["maskClasses"],s);const i=f(n,["maskDilation"]);return i!=null&&m(e,["dilation"],i),e}function BS(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["displayName"]);s!=null&&m(e,["displayName"],s);const i=f(n,["description"]);i!=null&&m(e,["description"],i);const r=f(n,["version"]);r!=null&&m(e,["version"],r);const a=f(n,["_self"]);a!=null&&m(e,["tunedModelInfo"],_z(a));const o=f(n,["inputTokenLimit"]);o!=null&&m(e,["inputTokenLimit"],o);const l=f(n,["outputTokenLimit"]);l!=null&&m(e,["outputTokenLimit"],l);const c=f(n,["supportedGenerationMethods"]);c!=null&&m(e,["supportedActions"],c);const d=f(n,["temperature"]);d!=null&&m(e,["temperature"],d);const h=f(n,["maxTemperature"]);h!=null&&m(e,["maxTemperature"],h);const p=f(n,["topP"]);p!=null&&m(e,["topP"],p);const y=f(n,["topK"]);y!=null&&m(e,["topK"],y);const v=f(n,["thinking"]);return v!=null&&m(e,["thinking"],v),e}function FS(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["displayName"]);s!=null&&m(e,["displayName"],s);const i=f(n,["description"]);i!=null&&m(e,["description"],i);const r=f(n,["versionId"]);r!=null&&m(e,["version"],r);const a=f(n,["deployedModels"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>y6(p))),m(e,["endpoints"],h)}const o=f(n,["labels"]);o!=null&&m(e,["labels"],o);const l=f(n,["_self"]);l!=null&&m(e,["tunedModelInfo"],xz(l));const c=f(n,["defaultCheckpointId"]);c!=null&&m(e,["defaultCheckpointId"],c);const d=f(n,["checkpoints"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>p)),m(e,["checkpoints"],h)}return e}function rz(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const s=f(n,["codeExecutionResult"]);s!=null&&m(e,["codeExecutionResult"],s);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const r=f(n,["fileData"]);r!=null&&m(e,["fileData"],v6(r));const a=f(n,["functionCall"]);a!=null&&m(e,["functionCall"],b6(a));const o=f(n,["functionResponse"]);o!=null&&m(e,["functionResponse"],o);const l=f(n,["inlineData"]);l!=null&&m(e,["inlineData"],qF(l));const c=f(n,["text"]);c!=null&&m(e,["text"],c);const d=f(n,["thought"]);d!=null&&m(e,["thought"],d);const h=f(n,["thoughtSignature"]);h!=null&&m(e,["thoughtSignature"],h);const p=f(n,["videoMetadata"]);return p!=null&&m(e,["videoMetadata"],p),e}function az(n){const e={},t=f(n,["productImage"]);return t!=null&&m(e,["image"],Zi(t)),e}function oz(n,e){const t={},s=f(n,["numberOfImages"]);e!==void 0&&s!=null&&m(e,["parameters","sampleCount"],s);const i=f(n,["baseSteps"]);e!==void 0&&i!=null&&m(e,["parameters","baseSteps"],i);const r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=f(n,["seed"]);e!==void 0&&a!=null&&m(e,["parameters","seed"],a);const o=f(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&m(e,["parameters","safetySetting"],o);const l=f(n,["personGeneration"]);e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l);const c=f(n,["addWatermark"]);e!==void 0&&c!=null&&m(e,["parameters","addWatermark"],c);const d=f(n,["outputMimeType"]);e!==void 0&&d!=null&&m(e,["parameters","outputOptions","mimeType"],d);const h=f(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&m(e,["parameters","outputOptions","compressionQuality"],h);const p=f(n,["enhancePrompt"]);e!==void 0&&p!=null&&m(e,["parameters","enhancePrompt"],p);const y=f(n,["labels"]);return e!==void 0&&y!=null&&m(e,["labels"],y),t}function lz(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["source"]);i!=null&&uz(i,t);const r=f(e,["config"]);return r!=null&&oz(r,t),t}function cz(n){const e={},t=f(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>Fb(i))),m(e,["generatedImages"],s)}return e}function uz(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&m(e,["instances[0]","prompt"],s);const i=f(n,["personImage"]);e!==void 0&&i!=null&&m(e,["instances[0]","personImage","image"],Zi(i));const r=f(n,["productImages"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>az(o))),m(e,["instances[0]","productImages"],a)}return t}function dz(n){const e={},t=f(n,["referenceImage"]);t!=null&&m(e,["referenceImage"],Zi(t));const s=f(n,["referenceId"]);s!=null&&m(e,["referenceId"],s);const i=f(n,["referenceType"]);i!=null&&m(e,["referenceType"],i);const r=f(n,["maskImageConfig"]);r!=null&&m(e,["maskImageConfig"],iz(r));const a=f(n,["controlImageConfig"]);a!=null&&m(e,["controlImageConfig"],WF(a));const o=f(n,["styleImageConfig"]);o!=null&&m(e,["styleImageConfig"],o);const l=f(n,["subjectImageConfig"]);return l!=null&&m(e,["subjectImageConfig"],l),e}function PD(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const s=f(n,["safetyAttributes","scores"]);s!=null&&m(e,["scores"],s);const i=f(n,["contentType"]);return i!=null&&m(e,["contentType"],i),e}function LD(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const s=f(n,["safetyAttributes","scores"]);s!=null&&m(e,["scores"],s);const i=f(n,["contentType"]);return i!=null&&m(e,["contentType"],i),e}function hz(n){const e={},t=f(n,["category"]);if(t!=null&&m(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=f(n,["threshold"]);return s!=null&&m(e,["threshold"],s),e}function fz(n){const e={},t=f(n,["image"]);return t!=null&&m(e,["image"],Zi(t)),e}function pz(n,e){const t={},s=f(n,["mode"]);e!==void 0&&s!=null&&m(e,["parameters","mode"],s);const i=f(n,["maxPredictions"]);e!==void 0&&i!=null&&m(e,["parameters","maxPredictions"],i);const r=f(n,["confidenceThreshold"]);e!==void 0&&r!=null&&m(e,["parameters","confidenceThreshold"],r);const a=f(n,["maskDilation"]);e!==void 0&&a!=null&&m(e,["parameters","maskDilation"],a);const o=f(n,["binaryColorThreshold"]);e!==void 0&&o!=null&&m(e,["parameters","binaryColorThreshold"],o);const l=f(n,["labels"]);return e!==void 0&&l!=null&&m(e,["labels"],l),t}function mz(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["source"]);i!=null&&yz(i,t);const r=f(e,["config"]);return r!=null&&pz(r,t),t}function gz(n){const e={},t=f(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(i=>H6(i))),m(e,["generatedMasks"],s)}return e}function yz(n,e){const t={},s=f(n,["prompt"]);e!==void 0&&s!=null&&m(e,["instances[0]","prompt"],s);const i=f(n,["image"]);e!==void 0&&i!=null&&m(e,["instances[0]","image"],Zi(i));const r=f(n,["scribbleImage"]);return e!==void 0&&r!=null&&m(e,["instances[0]","scribble"],fz(r)),t}function vz(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],_6(t));const s=f(n,["retrievalConfig"]);return s!=null&&m(e,["retrievalConfig"],s),e}function bz(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(h=>h)),m(e,["functionDeclarations"],d)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const r=f(n,["fileSearch"]);r!=null&&m(e,["fileSearch"],r);const a=f(n,["codeExecution"]);if(a!=null&&m(e,["codeExecution"],a),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=f(n,["googleMaps"]);o!=null&&m(e,["googleMaps"],Y6(o));const l=f(n,["googleSearch"]);l!=null&&m(e,["googleSearch"],K6(l));const c=f(n,["urlContext"]);return c!=null&&m(e,["urlContext"],c),e}function OD(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>x6(p))),m(e,["functionDeclarations"],h)}const s=f(n,["retrieval"]);s!=null&&m(e,["retrieval"],s);const i=f(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);if(r!=null&&m(e,["computerUse"],r),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=f(n,["codeExecution"]);a!=null&&m(e,["codeExecution"],a);const o=f(n,["enterpriseWebSearch"]);o!=null&&m(e,["enterpriseWebSearch"],o);const l=f(n,["googleMaps"]);l!=null&&m(e,["googleMaps"],l);const c=f(n,["googleSearch"]);c!=null&&m(e,["googleSearch"],c);const d=f(n,["urlContext"]);return d!=null&&m(e,["urlContext"],d),e}function _z(n){const e={},t=f(n,["baseModel"]);t!=null&&m(e,["baseModel"],t);const s=f(n,["createTime"]);s!=null&&m(e,["createTime"],s);const i=f(n,["updateTime"]);return i!=null&&m(e,["updateTime"],i),e}function xz(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&m(e,["baseModel"],t);const s=f(n,["createTime"]);s!=null&&m(e,["createTime"],s);const i=f(n,["updateTime"]);return i!=null&&m(e,["updateTime"],i),e}function wz(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const i=f(n,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const r=f(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&m(e,["defaultCheckpointId"],r),t}function Sz(n,e){const t={},s=f(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const i=f(n,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const r=f(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&m(e,["defaultCheckpointId"],r),t}function Ez(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","name"],Me(n,s));const i=f(e,["config"]);return i!=null&&wz(i,t),t}function Az(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["config"]);return i!=null&&Sz(i,t),t}function Tz(n,e){const t={},s=f(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const i=f(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&m(e,["parameters","safetySetting"],i);const r=f(n,["personGeneration"]);e!==void 0&&r!=null&&m(e,["parameters","personGeneration"],r);const a=f(n,["includeRaiReason"]);e!==void 0&&a!=null&&m(e,["parameters","includeRaiReason"],a);const o=f(n,["outputMimeType"]);e!==void 0&&o!=null&&m(e,["parameters","outputOptions","mimeType"],o);const l=f(n,["outputCompressionQuality"]);e!==void 0&&l!=null&&m(e,["parameters","outputOptions","compressionQuality"],l);const c=f(n,["enhanceInputImage"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],c);const d=f(n,["imagePreservationFactor"]);e!==void 0&&d!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],d);const h=f(n,["labels"]);e!==void 0&&h!=null&&m(e,["labels"],h);const p=f(n,["numberOfImages"]);e!==void 0&&p!=null&&m(e,["parameters","sampleCount"],p);const y=f(n,["mode"]);return e!==void 0&&y!=null&&m(e,["parameters","mode"],y),t}function Cz(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["_url","model"],Me(n,s));const i=f(e,["image"]);i!=null&&m(t,["instances[0]","image"],Zi(i));const r=f(e,["upscaleFactor"]);r!=null&&m(t,["parameters","upscaleConfig","upscaleFactor"],r);const a=f(e,["config"]);return a!=null&&Tz(a,t),t}function Nz(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>Fb(r))),m(e,["generatedImages"],i)}return e}function Rz(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const s=f(n,["encodedVideo"]);s!=null&&m(e,["videoBytes"],wl(s));const i=f(n,["encoding"]);return i!=null&&m(e,["mimeType"],i),e}function kz(n){const e={},t=f(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const s=f(n,["bytesBase64Encoded"]);s!=null&&m(e,["videoBytes"],wl(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function Mz(n){const e={},t=f(n,["image"]);t!=null&&m(e,["_self"],Zi(t));const s=f(n,["maskMode"]);return s!=null&&m(e,["maskMode"],s),e}function Iz(n){const e={},t=f(n,["image"]);t!=null&&m(e,["image"],zb(t));const s=f(n,["referenceType"]);return s!=null&&m(e,["referenceType"],s),e}function Dz(n){const e={},t=f(n,["image"]);t!=null&&m(e,["image"],Zi(t));const s=f(n,["referenceType"]);return s!=null&&m(e,["referenceType"],s),e}function UD(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["uri"],t);const s=f(n,["videoBytes"]);s!=null&&m(e,["encodedVideo"],wl(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["encoding"],i),e}function BD(n){const e={},t=f(n,["uri"]);t!=null&&m(e,["gcsUri"],t);const s=f(n,["videoBytes"]);s!=null&&m(e,["bytesBase64Encoded"],wl(s));const i=f(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pz(n,e){const t={},s=f(n,["displayName"]);return e!==void 0&&s!=null&&m(e,["displayName"],s),t}function Lz(n){const e={},t=f(n,["config"]);return t!=null&&Pz(t,e),e}function Oz(n,e){const t={},s=f(n,["force"]);return e!==void 0&&s!=null&&m(e,["_query","force"],s),t}function Uz(n){const e={},t=f(n,["name"]);t!=null&&m(e,["_url","name"],t);const s=f(n,["config"]);return s!=null&&Oz(s,e),e}function Bz(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function Fz(n,e){const t={},s=f(n,["customMetadata"]);if(e!==void 0&&s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["customMetadata"],r)}const i=f(n,["chunkingConfig"]);return e!==void 0&&i!=null&&m(e,["chunkingConfig"],i),t}function zz(n){const e={},t=f(n,["name"]);t!=null&&m(e,["name"],t);const s=f(n,["metadata"]);s!=null&&m(e,["metadata"],s);const i=f(n,["done"]);i!=null&&m(e,["done"],i);const r=f(n,["error"]);r!=null&&m(e,["error"],r);const a=f(n,["response"]);return a!=null&&m(e,["response"],jz(a)),e}function Hz(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const s=f(n,["fileName"]);s!=null&&m(e,["fileName"],s);const i=f(n,["config"]);return i!=null&&Fz(i,e),e}function jz(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["parent"]);s!=null&&m(e,["parent"],s);const i=f(n,["documentName"]);return i!=null&&m(e,["documentName"],i),e}function Gz(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function qz(n){const e={},t=f(n,["config"]);return t!=null&&Gz(t,e),e}function Vz(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["fileSearchStores"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["fileSearchStores"],r)}return e}function FD(n,e){const t={},s=f(n,["mimeType"]);e!==void 0&&s!=null&&m(e,["mimeType"],s);const i=f(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const r=f(n,["customMetadata"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>l)),m(e,["customMetadata"],o)}const a=f(n,["chunkingConfig"]);return e!==void 0&&a!=null&&m(e,["chunkingConfig"],a),t}function $z(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const s=f(n,["config"]);return s!=null&&FD(s,e),e}function Yz(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kz="Content-Type",Jz="X-Server-Timeout",Xz="User-Agent",zS="x-goog-api-client",Wz="1.34.0",Qz=`google-genai-sdk/${Wz}`,Zz="v1beta1",eH="v1beta";class tH{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:Zz,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:eH,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const i=[this.getRequestUrlInternal(t)];return s&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[a,o]of Object.entries(e.queryParams))i.searchParams.append(a,String(o));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.unaryApiCall(i,r,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[i,r]of Object.entries(t))typeof r=="object"?s[i]=Object.assign(Object.assign({},s[i]),r):r!==void 0&&(s[i]=r);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,s);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.streamApiCall(i,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s,i){if(t&&t.timeout||i){const r=new AbortController,a=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const o=setTimeout(()=>r.abort(),t.timeout);o&&typeof o.unref=="function"&&o.unref()}i&&i.addEventListener("abort",()=>{r.abort()}),e.signal=a}return t&&t.extraBody!==null&&nH(e,t.extraBody),e.headers=await this.getHeadersInternal(t,s),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async i=>(await vN(i),new LS(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async i=>(await vN(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Ji(this,arguments,function*(){var s;const i=(s=e==null?void 0:e.body)===null||s===void 0?void 0:s.getReader(),r=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";const o="data:",l=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:c,value:d}=yield ce(i.read());if(c){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=r.decode(d,{stream:!0});try{const v=JSON.parse(h);if("error"in v){const _=JSON.parse(JSON.stringify(v.error)),E=_.status,b=_.code,w=`got status: ${E}. ${JSON.stringify(v)}`;if(b>=400&&b<600)throw new Ub({message:w,status:b})}}catch(v){if(v.name==="ApiError")throw v}a+=h;let p=-1,y=0;for(;;){p=-1,y=0;for(const E of l){const b=a.indexOf(E);b!==-1&&(p===-1||b<p)&&(p=b,y=E.length)}if(p===-1)break;const v=a.substring(0,p);a=a.substring(p+y);const _=v.trim();if(_.startsWith(o)){const E=_.substring(o.length).trim();try{const b=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ce(new LS(b))}catch(b){throw new Error(`exception parsing stream chunk ${E}. ${b}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=Qz+" "+this.clientOptions.userAgentExtra;return e[Xz]=t,e[zS]=t,e[Kz]="application/json",e}async getHeadersInternal(e,t){const s=new Headers;if(e&&e.headers){for(const[i,r]of Object.entries(e.headers))s.append(i,r);e.timeout&&e.timeout>0&&s.append(Jz,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(s,t),s}getFileName(e){var t;let s="";return typeof e=="string"&&(s=e.replace(/[/\\]+$/,""),s=(t=s.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),s}async uploadFile(e,t){var s;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const r=this.clientOptions.uploader,a=await r.stat(e);i.sizeBytes=String(a.size);const o=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:a.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;const l={file:i},c=this.getFileName(e),d=J("upload/v1beta/files",l._url),h=await this.fetchUploadUrl(d,i.sizeBytes,i.mimeType,c,l,t==null?void 0:t.httpOptions);return r.upload(e,h,this)}async uploadFileToFileSearchStore(e,t,s){var i;const r=this.clientOptions.uploader,a=await r.stat(t),o=String(a.size),l=(i=s==null?void 0:s.mimeType)!==null&&i!==void 0?i:a.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const c=`upload/v1beta/${e}:uploadToFileSearchStore`,d=this.getFileName(t),h={};s!=null&&FD(s,h);const p=await this.fetchUploadUrl(c,o,l,d,h,s==null?void 0:s.httpOptions);return r.uploadToFileSearchStore(t,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,s,i,r,a){var o;let l={};a?l=a:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${s}`},i?{"X-Goog-Upload-File-Name":i}:{})};const c=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:l});if(!c||!(c!=null&&c.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(o=c==null?void 0:c.headers)===null||o===void 0?void 0:o["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function vN(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=JSON.stringify(s);throw t>=400&&t<600?new Ub({message:i,status:t}):new Error(i)}}function nH(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const r=JSON.parse(n.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(r,a){const o=Object.assign({},r);for(const l in a)if(Object.prototype.hasOwnProperty.call(a,l)){const c=a[l],d=o[l];c&&typeof c=="object"&&!Array.isArray(c)&&d&&typeof d=="object"&&!Array.isArray(d)?o[l]=s(d,c):(d&&c&&typeof d!=typeof c&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof c}. Overwriting.`),o[l]=c)}return o}const i=s(t,e);n.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sH="mcp_used/unknown";let iH=!1;function zD(n){for(const e of n)if(rH(e)||typeof e=="object"&&"inputSchema"in e)return!0;return iH}function HD(n){var e;const t=(e=n[zS])!==null&&e!==void 0?e:"";n[zS]=(t+` ${sH}`).trimStart()}function rH(n){return n!==null&&typeof n=="object"&&n instanceof CA}function aH(n){return Ji(this,arguments,function*(t,s=100){let i,r=0;for(;r<s;){const a=yield ce(t.listTools({cursor:i}));for(const o of a.tools)yield yield ce(o),r++;if(!a.nextCursor)break;i=a.nextCursor}})}class CA{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new CA(e,t)}async initialize(){var e,t,s,i;if(this.mcpTools.length>0)return;const r={},a=[];for(const d of this.mcpClients)try{for(var o=!0,l=(t=void 0,Xi(aH(d))),c;c=await l.next(),e=c.done,!e;o=!0){i=c.value,o=!1;const h=i;a.push(h);const p=h.name;if(r[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);r[p]=d}}catch(h){t={error:h}}finally{try{!o&&!e&&(s=l.return)&&await s.call(l)}finally{if(t)throw t.error}}this.mcpTools=a,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),B3(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[s.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const a=await i.callTool({name:s.name,arguments:s.args},void 0,r);t.push({functionResponse:{name:s.name,response:a.isError?{error:a}:a}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function oH(n,e,t){const s=new k3;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(s,i),e(s)}class lH{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),a=dH(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${o}`;let c=()=>{};const d=new Promise(S=>{c=S}),h=e.callbacks,p=function(){c({})},y=this.apiClient,v={onopen:p,onmessage:S=>{oH(y,h.onmessage,S)},onerror:(t=h==null?void 0:h.onerror)!==null&&t!==void 0?t:function(S){},onclose:(s=h==null?void 0:h.onclose)!==null&&s!==void 0?s:function(S){}},_=this.webSocketFactory.create(l,uH(a),v);_.connect(),await d;const w={setup:{model:Me(this.apiClient,e.model)}};return _.send(JSON.stringify(w)),new cH(_,this.apiClient)}}class cH{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=LF(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=PF(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(cd.PLAY)}pause(){this.sendPlaybackControl(cd.PAUSE)}stop(){this.sendPlaybackControl(cd.STOP)}resetContext(){this.sendPlaybackControl(cd.RESET_CONTEXT)}close(){this.conn.close()}}function uH(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function dH(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hH="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function fH(n,e,t){const s=new R3;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const r=JSON.parse(i);if(n.isVertexAI()){const a=BF(r);Object.assign(s,a)}else Object.assign(s,r);e(s)}class pH{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new lH(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,i,r,a,o;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion();let d;const h=this.apiClient.getHeaders();e.config&&e.config.tools&&zD(e.config.tools)&&HD(h);const p=vH(h);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${c}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,d);else{const M=this.apiClient.getApiKey();let D="BidiGenerateContent",O="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),c!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),D="BidiGenerateContentConstrained",O="access_token"),d=`${l}/ws/google.ai.generativelanguage.${c}.GenerativeService.${D}?${O}=${M}`}let y=()=>{};const v=new Promise(M=>{y=M}),_=e.callbacks,E=function(){var M;(M=_==null?void 0:_.onopen)===null||M===void 0||M.call(_),y({})},b=this.apiClient,w={onopen:E,onmessage:M=>{fH(b,_.onmessage,M)},onerror:(t=_==null?void 0:_.onerror)!==null&&t!==void 0?t:function(M){},onclose:(s=_==null?void 0:_.onclose)!==null&&s!==void 0?s:function(M){}},S=this.webSocketFactory.create(d,yH(p),w);S.connect(),await v;let T=Me(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const M=this.apiClient.getProject(),D=this.apiClient.getLocation();T=`projects/${M}/locations/${D}/`+T}let N={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Lv.AUDIO]}:e.config.responseModalities=[Lv.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R=(o=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[],k=[];for(const M of R)if(this.isCallableTool(M)){const D=M;k.push(await D.tool())}else k.push(M);k.length>0&&(e.config.tools=k);const I={model:T,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?N=DF(this.apiClient,I):N=IF(this.apiClient,I),delete N.config,S.send(JSON.stringify(N)),new gH(S,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const mH={turnComplete:!0};class gH{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=Si(t.turns),e.isVertexAI()||(s=s.map(i=>Bb(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const r of s){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(hH)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},mH),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:UF(e)}:t={realtimeInput:OF(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function yH(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function vH(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bN=10;function _N(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const a of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Ad(a)){i=!0;break}if(!i)return!0;const r=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function Ad(n){return"callTool"in n&&typeof n.callTool=="function"}function bH(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>Ad(i)))!==null&&s!==void 0?s:!1}function xN(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((s,i)=>{if(Ad(s))return;const r=s;r.functionDeclarations&&r.functionDeclarations.length>0&&t.push(i)}),t}function wN(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _H extends Ka{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,i,r,a,o;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!bH(t)||_N(t.config))return await this.generateContentInternal(l);const c=xN(t);if(c.length>0){const _=c.map(E=>`tools[${E}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${_}.`)}let d,h;const p=Si(l.contents),y=(r=(i=(s=l.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:bN;let v=0;for(;v<y&&(d=await this.generateContentInternal(l),!(!d.functionCalls||d.functionCalls.length===0));){const _=d.candidates[0].content,E=[];for(const b of(o=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[])if(Ad(b)){const S=await b.callTool(d.functionCalls);E.push(...S)}v++,h={role:"user",parts:E},l.contents=Si(l.contents),l.contents.push(_),l.contents.push(h),wN(l.config)&&(p.push(_),p.push(h))}return wN(l.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{var s,i,r,a,o;if(this.maybeMoveToResponseJsonSchem(t),_N(t.config)){const h=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(h)}const l=xN(t);if(l.length>0){const h=l.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const c=(r=(i=(s=t==null?void 0:t.config)===null||s===void 0?void 0:s.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,d=(o=(a=t==null?void 0:t.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||o===void 0?void 0:o.disable;if(c&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var i;let r;const a=[];if(s!=null&&s.generatedImages)for(const l of s.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?r=l==null?void 0:l.safetyAttributes:a.push(l);let o;return r?o={generatedImages:a,positivePromptSafetyAttributes:r,sdkHttpResponse:s.sdkHttpResponse}:o={generatedImages:a,sdkHttpResponse:s.sdkHttpResponse},o}),this.list=async t=>{var s;const a={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((s=a.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new Eu(qa.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(a),a)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var s,i,r,a,o,l;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((s=t.video)===null||s===void 0)&&s.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((a=(r=t.source)===null||r===void 0?void 0:r.video)===null||a===void 0)&&a.uri&&(!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,s,i;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const a=await Promise.all(r.map(async l=>Ad(l)?await l.tool():l)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(o.config.tools=a,e.config&&e.config.tools&&zD(e.config.tools)){const l=(i=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&i!==void 0?i:{};let c=Object.assign({},l);Object.keys(c).length===0&&(c=this.apiClient.getDefaultHeaders()),HD(c),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:c})}return o}async initAfcToolsMap(e){var t,s,i;const r=new Map;for(const a of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(Ad(a)){const o=a,l=await o.tool();for(const c of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!c.name)throw new Error("Function declaration name is required.");if(r.has(c.name))throw new Error(`Duplicate tool declaration name: ${c.name}`);r.set(c.name,o)}}return r}async processAfcStream(e){var t,s,i;const r=(i=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&i!==void 0?i:bN;let a=!1,o=0;const l=await this.initAfcToolsMap(e);return function(c,d,h){return Ji(this,arguments,function*(){for(var p,y,v,_,E,b;o<r;){a&&(o++,a=!1);const N=yield ce(c.processParamsMaybeAddMcpUsage(h)),R=yield ce(c.generateContentStreamInternal(N)),k=[],I=[];try{for(var w=!0,S=(y=void 0,Xi(R)),T;T=yield ce(S.next()),p=T.done,!p;w=!0){_=T.value,w=!1;const M=_;if(yield yield ce(M),M.candidates&&(!((E=M.candidates[0])===null||E===void 0)&&E.content)){I.push(M.candidates[0].content);for(const D of(b=M.candidates[0].content.parts)!==null&&b!==void 0?b:[])if(o<r&&D.functionCall){if(!D.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(D.functionCall.name)){const O=yield ce(d.get(D.functionCall.name).callTool([D.functionCall]));k.push(...O)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${D.functionCall.name}`)}}}}catch(M){y={error:M}}finally{try{!w&&!p&&(v=S.return)&&(yield ce(v.call(S)))}finally{if(y)throw y.error}}if(k.length>0){a=!0;const M=new Hf;M.candidates=[{content:{role:"user",parts:k}}],yield yield ce(M);const D=[];D.push(...I),D.push({role:"user",parts:k});const O=Si(h.contents).concat(D);h.contents=O}else break}})}(this,l,e)}async generateContentInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=mN(this.apiClient,e);return o=J("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=yN(d),p=new Hf;return Object.assign(p,h),p})}else{const c=pN(this.apiClient,e);return o=J("{model}:generateContent",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=gN(d),p=new Hf;return Object.assign(p,h),p})}}async generateContentStreamInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=mN(this.apiClient,e);return o=J("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(h){return Ji(this,arguments,function*(){var p,y,v,_;try{for(var E=!0,b=Xi(h),w;w=yield ce(b.next()),p=w.done,!p;E=!0){_=w.value,E=!1;const S=_,T=yN(yield ce(S.json()));T.sdkHttpResponse={headers:S.headers};const N=new Hf;Object.assign(N,T),yield yield ce(N)}}catch(S){y={error:S}}finally{try{!E&&!p&&(v=b.return)&&(yield ce(v.call(b)))}finally{if(y)throw y.error}}})})}else{const c=pN(this.apiClient,e);return o=J("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),a.then(function(h){return Ji(this,arguments,function*(){var p,y,v,_;try{for(var E=!0,b=Xi(h),w;w=yield ce(b.next()),p=w.done,!p;E=!0){_=w.value,E=!1;const S=_,T=gN(yield ce(S.json()));T.sdkHttpResponse={headers:S.headers};const N=new Hf;Object.assign(N,T),yield yield ce(N)}}catch(S){y={error:S}}finally{try{!E&&!p&&(v=b.return)&&(yield ce(v.call(b)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=p6(this.apiClient,e);return o=J("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=g6(d),p=new WC;return Object.assign(p,h),p})}else{const c=f6(this.apiClient,e);return o=J("{model}:batchEmbedContents",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=m6(d),p=new WC;return Object.assign(p,h),p})}}async generateImagesInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=C6(this.apiClient,e);return o=J("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=R6(d),p=new QC;return Object.assign(p,h),p})}else{const c=T6(this.apiClient,e);return o=J("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=N6(d),p=new QC;return Object.assign(p,h),p})}}async editImageInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=c6(this.apiClient,e);return r=J("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const c=u6(l),d=new v3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=Cz(this.apiClient,e);return r=J("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const c=Nz(l),d=new b3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=lz(this.apiClient,e);return r=J("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=cz(l),d=new _3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=mz(this.apiClient,e);return r=J("{model}:predict",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=gz(l),d=new x3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=$6(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>FS(d))}else{const c=V6(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>BS(d))}}async listInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=tz(this.apiClient,e);return o=J("{models_url}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=sz(d),p=new ZC;return Object.assign(p,h),p})}else{const c=ez(this.apiClient,e);return o=J("{models_url}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=nz(d),p=new ZC;return Object.assign(p,h),p})}}async update(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=Az(this.apiClient,e);return o=J("{model}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>FS(d))}else{const c=Ez(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>BS(d))}}async delete(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=r6(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=o6(d),p=new eN;return Object.assign(p,h),p})}else{const c=i6(this.apiClient,e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=a6(d),p=new eN;return Object.assign(p,h),p})}}async countTokens(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=t6(this.apiClient,e);return o=J("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=s6(d),p=new tN;return Object.assign(p,h),p})}else{const c=e6(this.apiClient,e);return o=J("{model}:countTokens",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=n6(d),p=new tN;return Object.assign(p,h),p})}}async computeTokens(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=YF(this.apiClient,e);return r=J("{model}:computeTokens",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>{const c=KF(l),d=new w3;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=L6(this.apiClient,e);return o=J("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a.then(d=>{const h=D6(d),p=new Ov;return Object.assign(p,h),p})}else{const c=P6(this.apiClient,e);return o=J("{model}:predictLongRunning",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const h=I6(d),p=new Ov;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xH extends Ka{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let r;s&&"httpOptions"in s&&(r=s.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let r;s&&"httpOptions"in s&&(r=s.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=h3(e);return o=J("{operationName}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),a}else{const c=d3(e);return o=J("{operationName}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a}}async fetchPredictVideosOperationInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=i3(e);return r=J("{resourceName}:fetchPredictOperation",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wH(n){const e={},t=f(n,["data"]);if(t!=null&&m(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function SH(n){const e={},t=f(n,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>IH(r))),m(e,["parts"],i)}const s=f(n,["role"]);return s!=null&&m(e,["role"],s),e}function EH(n,e,t){const s={},i=f(e,["expireTime"]);t!==void 0&&i!=null&&m(t,["expireTime"],i);const r=f(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&m(t,["newSessionExpireTime"],r);const a=f(e,["uses"]);t!==void 0&&a!=null&&m(t,["uses"],a);const o=f(e,["liveConnectConstraints"]);t!==void 0&&o!=null&&m(t,["bidiGenerateContentSetup"],MH(n,o));const l=f(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&m(t,["fieldMask"],l),s}function AH(n,e){const t={},s=f(e,["config"]);return s!=null&&m(t,["config"],EH(n,s,t)),t}function TH(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const s=f(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function CH(n){const e={},t=f(n,["id"]);t!=null&&m(e,["id"],t);const s=f(n,["args"]);s!=null&&m(e,["args"],s);const i=f(n,["name"]);if(i!=null&&m(e,["name"],i),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function NH(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function RH(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function kH(n,e){const t={},s=f(n,["generationConfig"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig"],s);const i=f(n,["responseModalities"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","responseModalities"],i);const r=f(n,["temperature"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig","temperature"],r);const a=f(n,["topP"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","topP"],a);const o=f(n,["topK"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","topK"],o);const l=f(n,["maxOutputTokens"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","maxOutputTokens"],l);const c=f(n,["mediaResolution"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","mediaResolution"],c);const d=f(n,["seed"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","seed"],d);const h=f(n,["speechConfig"]);e!==void 0&&h!=null&&m(e,["setup","generationConfig","speechConfig"],TA(h));const p=f(n,["thinkingConfig"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","thinkingConfig"],p);const y=f(n,["enableAffectiveDialog"]);e!==void 0&&y!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],y);const v=f(n,["systemInstruction"]);e!==void 0&&v!=null&&m(e,["setup","systemInstruction"],SH(Bn(v)));const _=f(n,["tools"]);if(e!==void 0&&_!=null){let R=Ef(_);Array.isArray(R)&&(R=R.map(k=>PH(Sf(k)))),m(e,["setup","tools"],R)}const E=f(n,["sessionResumption"]);e!==void 0&&E!=null&&m(e,["setup","sessionResumption"],DH(E));const b=f(n,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],b);const w=f(n,["outputAudioTranscription"]);e!==void 0&&w!=null&&m(e,["setup","outputAudioTranscription"],w);const S=f(n,["realtimeInputConfig"]);e!==void 0&&S!=null&&m(e,["setup","realtimeInputConfig"],S);const T=f(n,["contextWindowCompression"]);e!==void 0&&T!=null&&m(e,["setup","contextWindowCompression"],T);const N=f(n,["proactivity"]);if(e!==void 0&&N!=null&&m(e,["setup","proactivity"],N),f(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function MH(n,e){const t={},s=f(e,["model"]);s!=null&&m(t,["setup","model"],Me(n,s));const i=f(e,["config"]);return i!=null&&m(t,["config"],kH(i,t)),t}function IH(n){const e={},t=f(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const s=f(n,["codeExecutionResult"]);s!=null&&m(e,["codeExecutionResult"],s);const i=f(n,["executableCode"]);i!=null&&m(e,["executableCode"],i);const r=f(n,["fileData"]);r!=null&&m(e,["fileData"],TH(r));const a=f(n,["functionCall"]);a!=null&&m(e,["functionCall"],CH(a));const o=f(n,["functionResponse"]);o!=null&&m(e,["functionResponse"],o);const l=f(n,["inlineData"]);l!=null&&m(e,["inlineData"],wH(l));const c=f(n,["text"]);c!=null&&m(e,["text"],c);const d=f(n,["thought"]);d!=null&&m(e,["thought"],d);const h=f(n,["thoughtSignature"]);h!=null&&m(e,["thoughtSignature"],h);const p=f(n,["videoMetadata"]);return p!=null&&m(e,["videoMetadata"],p),e}function DH(n){const e={},t=f(n,["handle"]);if(t!=null&&m(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function PH(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let d=t;Array.isArray(d)&&(d=d.map(h=>h)),m(e,["functionDeclarations"],d)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=f(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const i=f(n,["computerUse"]);i!=null&&m(e,["computerUse"],i);const r=f(n,["fileSearch"]);r!=null&&m(e,["fileSearch"],r);const a=f(n,["codeExecution"]);if(a!=null&&m(e,["codeExecution"],a),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const o=f(n,["googleMaps"]);o!=null&&m(e,["googleMaps"],NH(o));const l=f(n,["googleSearch"]);l!=null&&m(e,["googleSearch"],RH(l));const c=f(n,["urlContext"]);return c!=null&&m(e,["urlContext"],c),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LH(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const i=Object.keys(s).map(r=>`${t}.${r}`);e.push(...i)}else e.push(t)}return e.join(",")}function OH(n,e){let t=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const r=s.setup;typeof r=="object"&&r!==null?(n.bidiGenerateContentSetup=r,t=r):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const i=n.fieldMask;if(t){const r=LH(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?n.fieldMask=r:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];i.length>0&&(o=i.map(c=>a.includes(c)?`generationConfig.${c}`:c));const l=[];r&&l.push(r),o.length>0&&l.push(...o),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?n.fieldMask=i.join(","):delete n.fieldMask;return n}class UH extends Ka{constructor(e){super(),this.apiClient=e}async create(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=AH(this.apiClient,e);r=J("auth_tokens",o._url),a=o._query,delete o.config,delete o._url,delete o._query;const l=OH(o,e.config);return i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),i.then(c=>c)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BH(n,e){const t={},s=f(n,["force"]);return e!==void 0&&s!=null&&m(e,["_query","force"],s),t}function FH(n){const e={},t=f(n,["name"]);t!=null&&m(e,["_url","name"],t);const s=f(n,["config"]);return s!=null&&BH(s,e),e}function zH(n){const e={},t=f(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function HH(n,e){const t={},s=f(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const i=f(n,["pageToken"]);return e!==void 0&&i!=null&&m(e,["_query","pageToken"],i),t}function jH(n){const e={},t=f(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const s=f(n,["config"]);return s!=null&&HH(s,e),e}function GH(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const s=f(n,["nextPageToken"]);s!=null&&m(e,["nextPageToken"],s);const i=f(n,["documents"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),m(e,["documents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qH extends Ka{constructor(e){super(),this.apiClient=e,this.list=async t=>new Eu(qa.PAGED_ITEM_DOCUMENTS,s=>this.listInternal({parent:t.parent,config:s.config}),await this.listInternal(t),t)}async get(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=zH(e);return r=J("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,s;let i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=FH(e);i=J("{name}",a._url),r=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=jH(e);return r=J("{parent}/documents",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=GH(l),d=new S3;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VH extends Ka{constructor(e,t=new qH(e)){super(),this.apiClient=e,this.documents=t,this.list=async(s={})=>new Eu(qa.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(s),s)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Lz(e);return r=J("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async get(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Bz(e);return r=J("{name}",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>l)}}async delete(e){var t,s;let i="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Uz(e);i=J("{name}",a._url),r=a._query,delete a._url,delete a._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=qz(e);return r=J("fileSearchStores",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=Vz(l),d=new E3;return Object.assign(d,c),d})}}async uploadToFileSearchStoreInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=$z(e);return r=J("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=Yz(l),d=new A3;return Object.assign(d,c),d})}}async importFile(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=Hz(e);return r=J("{file_search_store_name}:importFile",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),i.then(l=>{const c=zz(l),d=new xA;return Object.assign(d,c),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jD=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return jD=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^t()&15>>+s/4).toString(16))};const $H=()=>jD();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HS(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const jS=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ni extends Error{}class Wn extends Ni{constructor(e,t,s,i){super(`${Wn.makeMessage(e,t,s)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,s){const i=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,s,i){if(!e||!i)return new Hb({message:s,cause:jS(t)});const r=t;return e===400?new qD(e,r,s,i):e===401?new VD(e,r,s,i):e===403?new $D(e,r,s,i):e===404?new YD(e,r,s,i):e===409?new KD(e,r,s,i):e===422?new JD(e,r,s,i):e===429?new XD(e,r,s,i):e>=500?new WD(e,r,s,i):new Wn(e,r,s,i)}}class GS extends Wn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Hb extends Wn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class GD extends Hb{constructor({message:e}={}){super({message:e??"Request timed out."})}}class qD extends Wn{}class VD extends Wn{}class $D extends Wn{}class YD extends Wn{}class KD extends Wn{}class JD extends Wn{}class XD extends Wn{}class WD extends Wn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YH=/^[a-z][a-z0-9+.-]*:/i,KH=n=>YH.test(n);let qS=n=>(qS=Array.isArray,qS(n));const JH=qS;let XH=JH;const SN=XH;function WH(n){if(!n)return!0;for(const e in n)return!1;return!0}function QH(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const ZH=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Ni(`${n} must be an integer`);if(e<0)throw new Ni(`${n} must be a positive integer`);return e},e8=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const t8=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $u="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n8(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const s8=()=>{var n,e,t,s,i;const r=n8();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$u,"X-Stainless-OS":AN(Deno.build.os),"X-Stainless-Arch":EN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$u,"X-Stainless-OS":AN((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":EN((s=globalThis.process.arch)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const a=i8();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":$u,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function i8(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const s=t.exec(navigator.userAgent);if(s){const i=s[1]||0,r=s[2]||0,a=s[3]||0;return{browser:e,version:`${i}.${r}.${a}`}}}return null}const EN=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",AN=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let z0;const r8=()=>z0??(z0=s8());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a8(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function QD(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function o8(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return QD({start(){},async pull(t){const{done:s,value:i}=await e.next();s?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function ZD(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function l8(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const s=n.getReader(),i=s.cancel();s.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const c8=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eP=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function K_(n,e,t){return eP(),new File(n,e??"unknown_file",t)}function u8(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const d8=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tP=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",h8=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&tP(n),f8=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function p8(n,e,t){if(eP(),n=await n,h8(n))return n instanceof File?n:K_([await n.arrayBuffer()],n.name);if(f8(n)){const i=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),K_(await VS(i),e,t)}const s=await VS(n);if(e||(e=u8(n)),!(t!=null&&t.type)){const i=s.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return K_(s,e,t)}async function VS(n){var e,t,s,i,r;let a=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)a.push(n);else if(tP(n))a.push(n instanceof Blob?n:await n.arrayBuffer());else if(d8(n))try{for(var o=!0,l=Xi(n),c;c=await l.next(),e=c.done,!e;o=!0){i=c.value,o=!1;const d=i;a.push(...await VS(d))}}catch(d){t={error:d}}finally{try{!o&&!e&&(s=l.return)&&await s.call(l)}finally{if(t)throw t.error}}else{const d=(r=n==null?void 0:n.constructor)===null||r===void 0?void 0:r.name;throw new Error(`Unexpected data type: ${typeof n}${d?`; constructor: ${d}`:""}${m8(n)}`)}return a}function m8(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nP{constructor(e){this._client=e}}nP._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sP(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const TN=Object.freeze(Object.create(null)),g8=(n=sP)=>function(t,...s){if(t.length===1)return t[0];let i=!1;const r=[],a=t.reduce((d,h,p)=>{var y,v,_;/[?#]/.test(h)&&(i=!0);const E=s[p];let b=(i?encodeURIComponent:n)(""+E);return p!==s.length&&(E==null||typeof E=="object"&&E.toString===((_=Object.getPrototypeOf((v=Object.getPrototypeOf((y=E.hasOwnProperty)!==null&&y!==void 0?y:TN))!==null&&v!==void 0?v:TN))===null||_===void 0?void 0:_.toString))&&(b=E+"",r.push({start:d.length+h.length,length:b.length,error:`Value of type ${Object.prototype.toString.call(E).slice(8,-1)} is not a valid path parameter`})),d+h+(p===s.length?"":b)},""),o=a.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(o))!==null;)r.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(r.sort((d,h)=>d.start-h.start),r.length>0){let d=0;const h=r.reduce((p,y)=>{const v=" ".repeat(y.start-d),_="^".repeat(y.length);return d=y.start+y.length,p+v+_},"");throw new Ni(`Path parameters result in path with invalid segments:
${r.map(p=>p.error).join(`
`)}
${a}
${h}`)}return a},H0=g8(sP);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iP extends nP{create(e,t){var s;const{api_version:i=this._client.apiVersion}=e,r=Bv(e,["api_version"]);if("model"in r&&"agent_config"in r)throw new Ni("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in r&&"generation_config"in r)throw new Ni("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(H0`/${i}/interactions`,Object.assign(Object.assign({body:r},t),{stream:(s=e.stream)!==null&&s!==void 0?s:!1}))}delete(e,t={},s){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(H0`/${i}/interactions/${e}`,s)}cancel(e,t={},s){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(H0`/${i}/interactions/${e}/cancel`,s)}get(e,t={},s){var i;const r=t??{},{api_version:a=this._client.apiVersion}=r,o=Bv(r,["api_version"]);return this._client.get(H0`/${a}/interactions/${e}`,Object.assign(Object.assign({query:o},s),{stream:(i=t==null?void 0:t.stream)!==null&&i!==void 0?i:!1}))}}iP._key=Object.freeze(["interactions"]);class rP extends iP{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y8(n){let e=0;for(const i of n)e+=i.length;const t=new Uint8Array(e);let s=0;for(const i of n)t.set(i,s),s+=i.length;return t}let j0;function NA(n){let e;return(j0??(e=new globalThis.TextEncoder,j0=e.encode.bind(e)))(n)}let G0;function CN(n){let e;return(G0??(e=new globalThis.TextDecoder,G0=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jb{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?NA(e):e;this.buffer=y8([this.buffer,t]);const s=[];let i;for(;(i=v8(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){s.push(CN(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const r=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,a=CN(this.buffer.subarray(0,r));s.push(a),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return s}flush(){return this.buffer.length?this.decode(`
`):[]}}jb.NEWLINE_CHARS=new Set([`
`,"\r"]);jb.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function v8(n,e){for(let i=e??0;i<n.length;i++){if(n[i]===10)return{preceding:i,index:i+1,carriage:!1};if(n[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function b8(n){for(let s=0;s<n.length-1;s++){if(n[s]===10&&n[s+1]===10||n[s]===13&&n[s+1]===13)return s+2;if(n[s]===13&&n[s+1]===10&&s+3<n.length&&n[s+2]===13&&n[s+3]===10)return s+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Fv={off:0,error:200,warn:300,info:400,debug:500},NN=(n,e,t)=>{if(n){if(QH(Fv,n))return n;Vn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Fv))}`)}};function gp(){}function q0(n,e,t){return!e||Fv[n]>Fv[t]?gp:e[n].bind(e)}const _8={error:gp,warn:gp,info:gp,debug:gp};let RN=new WeakMap;function Vn(n){var e;const t=n.logger,s=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return _8;const i=RN.get(t);if(i&&i[0]===s)return i[1];const r={error:q0("error",t,s),warn:q0("warn",t,s),info:q0("info",t,s),debug:q0("debug",t,s)};return RN.set(t,[s,r]),r}const Pl=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ud{constructor(e,t,s){this.iterator=e,this.controller=t,this.client=s}static fromSSEResponse(e,t,s){let i=!1;const r=s?Vn(s):console;function a(){return Ji(this,arguments,function*(){var l,c,d,h;if(i)throw new Ni("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var y=!0,v=Xi(x8(e,t)),_;_=yield ce(v.next()),l=_.done,!l;y=!0){h=_.value,y=!1;const E=h;if(!p)if(E.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield ce(JSON.parse(E.data))}catch(b){throw r.error("Could not parse message into JSON:",E.data),r.error("From chunk:",E.raw),b}}}catch(E){c={error:E}}finally{try{!y&&!l&&(d=v.return)&&(yield ce(d.call(v)))}finally{if(c)throw c.error}}p=!0}catch(E){if(HS(E))return yield ce(void 0);throw E}finally{p||t.abort()}})}return new ud(a,t,s)}static fromReadableStream(e,t,s){let i=!1;function r(){return Ji(this,arguments,function*(){var l,c,d,h;const p=new jb,y=ZD(e);try{for(var v=!0,_=Xi(y),E;E=yield ce(_.next()),l=E.done,!l;v=!0){h=E.value,v=!1;const b=h;for(const w of p.decode(b))yield yield ce(w)}}catch(b){c={error:b}}finally{try{!v&&!l&&(d=_.return)&&(yield ce(d.call(_)))}finally{if(c)throw c.error}}for(const b of p.flush())yield yield ce(b)})}function a(){return Ji(this,arguments,function*(){var l,c,d,h;if(i)throw new Ni("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var y=!0,v=Xi(r()),_;_=yield ce(v.next()),l=_.done,!l;y=!0){h=_.value,y=!1;const E=h;p||E&&(yield yield ce(JSON.parse(E)))}}catch(E){c={error:E}}finally{try{!y&&!l&&(d=v.return)&&(yield ce(d.call(v)))}finally{if(c)throw c.error}}p=!0}catch(E){if(HS(E))return yield ce(void 0);throw E}finally{p||t.abort()}})}return new ud(a,t,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),i=r=>({next:()=>{if(r.length===0){const a=s.next();e.push(a),t.push(a)}return r.shift()}});return[new ud(()=>i(e),this.controller,this.client),new ud(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return QD({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:r}=await t.next();if(r)return s.close();const a=NA(JSON.stringify(i)+`
`);s.enqueue(a)}catch(i){s.error(i)}},async cancel(){var s;await((s=t.return)===null||s===void 0?void 0:s.call(t))}})}}function x8(n,e){return Ji(this,arguments,function*(){var s,i,r,a;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Ni("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Ni("Attempted to iterate over a response with no body");const o=new S8,l=new jb,c=ZD(n.body);try{for(var d=!0,h=Xi(w8(c)),p;p=yield ce(h.next()),s=p.done,!s;d=!0){a=p.value,d=!1;const y=a;for(const v of l.decode(y)){const _=o.decode(v);_&&(yield yield ce(_))}}}catch(y){i={error:y}}finally{try{!d&&!s&&(r=h.return)&&(yield ce(r.call(h)))}finally{if(i)throw i.error}}for(const y of l.flush()){const v=o.decode(y);v&&(yield yield ce(v))}})}function w8(n){return Ji(this,arguments,function*(){var t,s,i,r;let a=new Uint8Array;try{for(var o=!0,l=Xi(n),c;c=yield ce(l.next()),t=c.done,!t;o=!0){r=c.value,o=!1;const d=r;if(d==null)continue;const h=d instanceof ArrayBuffer?new Uint8Array(d):typeof d=="string"?NA(d):d;let p=new Uint8Array(a.length+h.length);p.set(a),p.set(h,a.length),a=p;let y;for(;(y=b8(a))!==-1;)yield yield ce(a.slice(0,y)),a=a.slice(y)}}catch(d){s={error:d}}finally{try{!o&&!t&&(i=l.return)&&(yield ce(i.call(l)))}finally{if(s)throw s.error}}a.length>0&&(yield yield ce(a))})}class S8{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,i]=E8(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function E8(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function A8(n,e){const{response:t,requestLogID:s,retryOfRequestLogID:i,startTime:r}=e,a=await(async()=>{var o;if(e.options.stream)return Vn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):ud.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const l=t.headers.get("content-type"),c=(o=l==null?void 0:l.split(";")[0])===null||o===void 0?void 0:o.trim();return(c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))?await t.json():await t.text()})();return Vn(n).debug(`[${s}] response parsed`,Pl({retryOfRequestLogID:i,url:t.url,status:t.status,body:a,durationMs:Date.now()-r})),a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RA extends Promise{constructor(e,t,s=A8){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=s,this.client=e}_thenUnwrap(e){return new RA(this.client,this.responsePromise,async(t,s)=>e(await this.parseResponse(t,s),s))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aP=Symbol("brand.privateNullableHeaders");function*T8(n){if(!n)return;if(aP in n){const{values:s,nulls:i}=n;yield*s.entries();for(const r of i)yield[r,null];return}let e=!1,t;n instanceof Headers?t=n.entries():SN(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let s of t){const i=s[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const r=SN(s[1])?s[1]:[s[1]];let a=!1;for(const o of r)o!==void 0&&(e&&!a&&(a=!0,yield[i,null]),yield[i,o])}}const jf=n=>{const e=new Headers,t=new Set;for(const s of n){const i=new Set;for(const[r,a]of T8(s)){const o=r.toLowerCase();i.has(o)||(e.delete(r),i.add(o)),a===null?(e.delete(r),t.add(o)):(e.append(r,a),t.delete(o))}}return{[aP]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const J_=n=>{var e,t,s,i,r,a;if(typeof globalThis.process<"u")return(s=(t=(e=Q5)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&s!==void 0?s:void 0;if(typeof globalThis.Deno<"u")return(a=(r=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||r===void 0?void 0:r.call(i,n))===null||a===void 0?void 0:a.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var oP;class Gb{constructor(e){var t,s,i,r,a,o,l,{baseURL:c=J_("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:d=(t=J_("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:h="v1beta"}=e,p=Bv(e,["baseURL","apiKey","apiVersion"]);const y=Object.assign(Object.assign({apiKey:d,apiVersion:h},p),{baseURL:c||"https://generativelanguage.googleapis.com"});this.baseURL=y.baseURL,this.timeout=(s=y.timeout)!==null&&s!==void 0?s:Gb.DEFAULT_TIMEOUT,this.logger=(i=y.logger)!==null&&i!==void 0?i:console;const v="warn";this.logLevel=v,this.logLevel=(a=(r=NN(y.logLevel,"ClientOptions.logLevel",this))!==null&&r!==void 0?r:NN(J_("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:v,this.fetchOptions=y.fetchOptions,this.maxRetries=(o=y.maxRetries)!==null&&o!==void 0?o:2,this.fetch=(l=y.fetch)!==null&&l!==void 0?l:a8(),this.encoder=c8,this._options=y,this.apiKey=d,this.apiVersion=h,this.clientAdapter=y.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=jf([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return jf([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return jf([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,s])=>typeof s<"u").map(([t,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(t)}=`;throw new Ni(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${$u}`}defaultIdempotencyKey(){return`stainless-node-retry-${$H()}`}makeStatusError(e,t,s,i){return Wn.generate(e,t,s,i)}buildURL(e,t,s){const i=!this.baseURLOverridden()&&s||this.baseURL,r=KH(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return WH(a)||(t=Object.assign(Object.assign({},a),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:s}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new RA(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,s){var i,r,a;const o=await e,l=(i=o.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=l),await this.prepareOptions(o);const{req:c,url:d,timeout:h}=await this.buildRequest(o,{retryCount:l-t});await this.prepareRequest(c,{url:d,options:o});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=s===void 0?"":`, retryOf: ${s}`,v=Date.now();if(Vn(this).debug(`[${p}] sending request`,Pl({retryOfRequestLogID:s,method:o.method,url:d,options:o,headers:c.headers})),!((r=o.signal)===null||r===void 0)&&r.aborted)throw new GS;const _=new AbortController,E=await this.fetchWithTimeout(d,c,h,_).catch(jS),b=Date.now();if(E instanceof globalThis.Error){const S=`retrying, ${t} attempts remaining`;if(!((a=o.signal)===null||a===void 0)&&a.aborted)throw new GS;const T=HS(E)||/timed? ?out/i.test(String(E)+("cause"in E?String(E.cause):""));if(t)return Vn(this).info(`[${p}] connection ${T?"timed out":"failed"} - ${S}`),Vn(this).debug(`[${p}] connection ${T?"timed out":"failed"} (${S})`,Pl({retryOfRequestLogID:s,url:d,durationMs:b-v,message:E.message})),this.retryRequest(o,t,s??p);throw Vn(this).info(`[${p}] connection ${T?"timed out":"failed"} - error; no more retries left`),Vn(this).debug(`[${p}] connection ${T?"timed out":"failed"} (error; no more retries left)`,Pl({retryOfRequestLogID:s,url:d,durationMs:b-v,message:E.message})),T?new GD:new Hb({cause:E})}const w=`[${p}${y}] ${c.method} ${d} ${E.ok?"succeeded":"failed"} with status ${E.status} in ${b-v}ms`;if(!E.ok){const S=await this.shouldRetry(E);if(t&&S){const M=`retrying, ${t} attempts remaining`;return await l8(E.body),Vn(this).info(`${w} - ${M}`),Vn(this).debug(`[${p}] response error (${M})`,Pl({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,durationMs:b-v})),this.retryRequest(o,t,s??p,E.headers)}const T=S?"error; no more retries left":"error; not retryable";Vn(this).info(`${w} - ${T}`);const N=await E.text().catch(M=>jS(M).message),R=e8(N),k=R?void 0:N;throw Vn(this).debug(`[${p}] response error (${T})`,Pl({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,message:k,durationMs:Date.now()-v})),this.makeStatusError(E.status,R,k,E.headers)}return Vn(this).info(w),Vn(this).debug(`[${p}] response start`,Pl({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,durationMs:b-v})),{response:E,options:o,controller:_,requestLogID:p,retryOfRequestLogID:s,startTime:v}}async fetchWithTimeout(e,t,s,i){const r=t||{},{signal:a,method:o}=r,l=Bv(r,["signal","method"]);a&&a.addEventListener("abort",()=>i.abort());const c=setTimeout(()=>i.abort(),s),d=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,h=Object.assign(Object.assign(Object.assign({signal:i.signal},d?{duplex:"half"}:{}),{method:"GET"}),l);o&&(h.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,h)}finally{clearTimeout(c)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,s,i){var r;let a;const o=i==null?void 0:i.get("retry-after-ms");if(o){const c=parseFloat(o);Number.isNaN(c)||(a=c)}const l=i==null?void 0:i.get("retry-after");if(l&&!a){const c=parseFloat(l);Number.isNaN(c)?a=Date.parse(l)-Date.now():a=c*1e3}if(!(a&&0<=a&&a<60*1e3)){const c=(r=e.maxRetries)!==null&&r!==void 0?r:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,c)}return await t8(a),this.makeRequest(e,t-1,s)}calculateDefaultRetryTimeoutMillis(e,t){const r=t-e,a=Math.min(.5*Math.pow(2,r),8),o=1-Math.random()*.25;return a*o*1e3}async buildRequest(e,{retryCount:t=0}={}){var s,i,r;const a=Object.assign({},e),{method:o,path:l,query:c,defaultBaseURL:d}=a,h=this.buildURL(l,c,d);"timeout"in a&&ZH("timeout",a.timeout),a.timeout=(s=a.timeout)!==null&&s!==void 0?s:this.timeout;const{bodyHeaders:p,body:y}=this.buildBody({options:a}),v=await this.buildHeaders({options:e,method:o,bodyHeaders:p,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:v},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&y instanceof globalThis.ReadableStream&&{duplex:"half"}),y&&{body:y}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(r=a.fetchOptions)!==null&&r!==void 0?r:{}),url:h,timeout:a.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:s,retryCount:i}){let r={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const a=await this.authHeaders(e);let o=jf([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),r8()),this._options.defaultHeaders,s,e.headers,a]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=jf([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:o8(e)}:this.encoder({body:e,headers:s})}}Gb.DEFAULT_TIMEOUT=6e4;class fn extends Gb{constructor(){super(...arguments),this.interactions=new rP(this)}}oP=fn;fn.GeminiNextGenAPIClient=oP;fn.GeminiNextGenAPIClientError=Ni;fn.APIError=Wn;fn.APIConnectionError=Hb;fn.APIConnectionTimeoutError=GD;fn.APIUserAbortError=GS;fn.NotFoundError=YD;fn.ConflictError=KD;fn.RateLimitError=XD;fn.BadRequestError=qD;fn.AuthenticationError=VD;fn.InternalServerError=WD;fn.PermissionDeniedError=$D;fn.UnprocessableEntityError=JD;fn.toFile=p8;fn.Interactions=rP;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C8(n,e){const t={},s=f(n,["name"]);return s!=null&&m(t,["_url","name"],s),t}function N8(n,e){const t={},s=f(n,["name"]);return s!=null&&m(t,["_url","name"],s),t}function R8(n,e){const t={},s=f(n,["sdkHttpResponse"]);return s!=null&&m(t,["sdkHttpResponse"],s),t}function k8(n,e){const t={},s=f(n,["sdkHttpResponse"]);return s!=null&&m(t,["sdkHttpResponse"],s),t}function M8(n,e,t){const s={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=f(n,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&m(e,["displayName"],i),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=f(n,["epochCount"]);e!==void 0&&r!=null&&m(e,["tuningTask","hyperparameters","epochCount"],r);const a=f(n,["learningRateMultiplier"]);if(a!=null&&m(s,["tuningTask","hyperparameters","learningRateMultiplier"],a),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=f(n,["batchSize"]);e!==void 0&&o!=null&&m(e,["tuningTask","hyperparameters","batchSize"],o);const l=f(n,["learningRate"]);if(e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","learningRate"],l),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return s}function I8(n,e,t){const s={};let i=f(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const y=f(n,["validationDataset"]);e!==void 0&&y!=null&&m(e,["supervisedTuningSpec"],kN(y))}else if(i==="PREFERENCE_TUNING"){const y=f(n,["validationDataset"]);e!==void 0&&y!=null&&m(e,["preferenceOptimizationSpec"],kN(y))}const r=f(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&m(e,["tunedModelDisplayName"],r);const a=f(n,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);let o=f(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const y=f(n,["epochCount"]);e!==void 0&&y!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],y)}else if(o==="PREFERENCE_TUNING"){const y=f(n,["epochCount"]);e!==void 0&&y!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],y)}let l=f(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const y=f(n,["learningRateMultiplier"]);e!==void 0&&y!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],y)}else if(l==="PREFERENCE_TUNING"){const y=f(n,["learningRateMultiplier"]);e!==void 0&&y!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],y)}let c=f(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const y=f(n,["exportLastCheckpointOnly"]);e!==void 0&&y!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],y)}else if(c==="PREFERENCE_TUNING"){const y=f(n,["exportLastCheckpointOnly"]);e!==void 0&&y!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],y)}let d=f(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const y=f(n,["adapterSize"]);e!==void 0&&y!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],y)}else if(d==="PREFERENCE_TUNING"){const y=f(n,["adapterSize"]);e!==void 0&&y!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],y)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=f(n,["labels"]);e!==void 0&&h!=null&&m(e,["labels"],h);const p=f(n,["beta"]);return e!==void 0&&p!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),s}function D8(n,e){const t={},s=f(n,["baseModel"]);s!=null&&m(t,["baseModel"],s);const i=f(n,["preTunedModel"]);i!=null&&m(t,["preTunedModel"],i);const r=f(n,["trainingDataset"]);r!=null&&q8(r);const a=f(n,["config"]);return a!=null&&M8(a,t),t}function P8(n,e){const t={},s=f(n,["baseModel"]);s!=null&&m(t,["baseModel"],s);const i=f(n,["preTunedModel"]);i!=null&&m(t,["preTunedModel"],i);const r=f(n,["trainingDataset"]);r!=null&&V8(r,t,e);const a=f(n,["config"]);return a!=null&&I8(a,t,e),t}function L8(n,e){const t={},s=f(n,["name"]);return s!=null&&m(t,["_url","name"],s),t}function O8(n,e){const t={},s=f(n,["name"]);return s!=null&&m(t,["_url","name"],s),t}function U8(n,e,t){const s={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);e!==void 0&&r!=null&&m(e,["_query","pageToken"],r);const a=f(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),s}function B8(n,e,t){const s={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);e!==void 0&&r!=null&&m(e,["_query","pageToken"],r);const a=f(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),s}function F8(n,e){const t={},s=f(n,["config"]);return s!=null&&U8(s,t),t}function z8(n,e){const t={},s=f(n,["config"]);return s!=null&&B8(s,t),t}function H8(n,e){const t={},s=f(n,["sdkHttpResponse"]);s!=null&&m(t,["sdkHttpResponse"],s);const i=f(n,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=f(n,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>lP(o))),m(t,["tuningJobs"],a)}return t}function j8(n,e){const t={},s=f(n,["sdkHttpResponse"]);s!=null&&m(t,["sdkHttpResponse"],s);const i=f(n,["nextPageToken"]);i!=null&&m(t,["nextPageToken"],i);const r=f(n,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>$S(o))),m(t,["tuningJobs"],a)}return t}function G8(n,e){const t={},s=f(n,["name"]);s!=null&&m(t,["model"],s);const i=f(n,["name"]);return i!=null&&m(t,["endpoint"],i),t}function q8(n,e){const t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const s=f(n,["examples"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(r=>r)),m(t,["examples","examples"],i)}return t}function V8(n,e,t){const s={};let i=f(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const a=f(n,["gcsUri"]);e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(i==="PREFERENCE_TUNING"){const a=f(n,["gcsUri"]);e!==void 0&&a!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const a=f(n,["vertexDatasetResource"]);e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(r==="PREFERENCE_TUNING"){const a=f(n,["vertexDatasetResource"]);e!==void 0&&a!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function lP(n,e){const t={},s=f(n,["sdkHttpResponse"]);s!=null&&m(t,["sdkHttpResponse"],s);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const r=f(n,["state"]);r!=null&&m(t,["state"],ED(r));const a=f(n,["createTime"]);a!=null&&m(t,["createTime"],a);const o=f(n,["tuningTask","startTime"]);o!=null&&m(t,["startTime"],o);const l=f(n,["tuningTask","completeTime"]);l!=null&&m(t,["endTime"],l);const c=f(n,["updateTime"]);c!=null&&m(t,["updateTime"],c);const d=f(n,["description"]);d!=null&&m(t,["description"],d);const h=f(n,["baseModel"]);h!=null&&m(t,["baseModel"],h);const p=f(n,["_self"]);return p!=null&&m(t,["tunedModel"],G8(p)),t}function $S(n,e){const t={},s=f(n,["sdkHttpResponse"]);s!=null&&m(t,["sdkHttpResponse"],s);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const r=f(n,["state"]);r!=null&&m(t,["state"],ED(r));const a=f(n,["createTime"]);a!=null&&m(t,["createTime"],a);const o=f(n,["startTime"]);o!=null&&m(t,["startTime"],o);const l=f(n,["endTime"]);l!=null&&m(t,["endTime"],l);const c=f(n,["updateTime"]);c!=null&&m(t,["updateTime"],c);const d=f(n,["error"]);d!=null&&m(t,["error"],d);const h=f(n,["description"]);h!=null&&m(t,["description"],h);const p=f(n,["baseModel"]);p!=null&&m(t,["baseModel"],p);const y=f(n,["tunedModel"]);y!=null&&m(t,["tunedModel"],y);const v=f(n,["preTunedModel"]);v!=null&&m(t,["preTunedModel"],v);const _=f(n,["supervisedTuningSpec"]);_!=null&&m(t,["supervisedTuningSpec"],_);const E=f(n,["preferenceOptimizationSpec"]);E!=null&&m(t,["preferenceOptimizationSpec"],E);const b=f(n,["tuningDataStats"]);b!=null&&m(t,["tuningDataStats"],b);const w=f(n,["encryptionSpec"]);w!=null&&m(t,["encryptionSpec"],w);const S=f(n,["partnerModelTuningSpec"]);S!=null&&m(t,["partnerModelTuningSpec"],S);const T=f(n,["customBaseModel"]);T!=null&&m(t,["customBaseModel"],T);const N=f(n,["experiment"]);N!=null&&m(t,["experiment"],N);const R=f(n,["labels"]);R!=null&&m(t,["labels"],R);const k=f(n,["outputUri"]);k!=null&&m(t,["outputUri"],k);const I=f(n,["pipelineJob"]);I!=null&&m(t,["pipelineJob"],I);const M=f(n,["serviceAccount"]);M!=null&&m(t,["serviceAccount"],M);const D=f(n,["tunedModelDisplayName"]);D!=null&&m(t,["tunedModelDisplayName"],D);const O=f(n,["veoTuningSpec"]);return O!=null&&m(t,["veoTuningSpec"],O),t}function $8(n,e){const t={},s=f(n,["sdkHttpResponse"]);s!=null&&m(t,["sdkHttpResponse"],s);const i=f(n,["name"]);i!=null&&m(t,["name"],i);const r=f(n,["metadata"]);r!=null&&m(t,["metadata"],r);const a=f(n,["done"]);a!=null&&m(t,["done"],a);const o=f(n,["error"]);return o!=null&&m(t,["error"],o),t}function kN(n,e){const t={},s=f(n,["gcsUri"]);s!=null&&m(t,["validationDatasetUri"],s);const i=f(n,["vertexDatasetResource"]);return i!=null&&m(t,["validationDatasetUri"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Y8 extends Ka{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eu(qa.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var s;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((s=t.config)===null||s===void 0)&&s.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},t),{preTunedModel:i});return r.baseModel=void 0,await this.tuneInternal(r)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),r=await this.tuneMldevInternal(i);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:PS.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=O8(e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>$S(d))}else{const c=L8(e);return o=J("{name}",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>lP(d))}}async listInternal(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=z8(e);return o=J("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=j8(d),p=new nN;return Object.assign(p,h),p})}else{const c=F8(e);return o=J("tunedModels",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=H8(d),p=new nN;return Object.assign(p,h),p})}}async cancel(e){var t,s,i,r;let a,o="",l={};if(this.apiClient.isVertexAI()){const c=N8(e);return o=J("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=k8(d),p=new sN;return Object.assign(p,h),p})}else{const c=C8(e);return o=J("{name}:cancel",c._url),l=c._query,delete c._url,delete c._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),a.then(d=>{const h=R8(d),p=new sN;return Object.assign(p,h),p})}}async tuneInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI()){const o=P8(e,e);return r=J("tuningJobs",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>$S(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let i,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=D8(e);return r=J("tunedModels",o._url),a=o._query,delete o._url,delete o._query,i=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(c=>{const d=c;return d.sdkHttpResponse={headers:l.headers},d})),i.then(l=>$8(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K8{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const J8=1024*1024*8,X8=3,W8=1e3,Q8=2,zv="x-goog-upload-status";async function Z8(n,e,t){var s;const i=await cP(n,e,t),r=await(i==null?void 0:i.json());if(((s=i==null?void 0:i.headers)===null||s===void 0?void 0:s[zv])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function ej(n,e,t){var s;const i=await cP(n,e,t),r=await(i==null?void 0:i.json());if(((s=i==null?void 0:i.headers)===null||s===void 0?void 0:s[zv])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=vD(r),o=new wA;return Object.assign(o,a),o}async function cP(n,e,t){var s,i;let r=0,a=0,o=new LS(new Response),l="upload";for(r=n.size;a<r;){const c=Math.min(J8,r-a),d=n.slice(a,a+c);a+c>=r&&(l+=", finalize");let h=0,p=W8;for(;h<X8&&(o=await t.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(a),"Content-Length":String(c)}}}),!(!((s=o==null?void 0:o.headers)===null||s===void 0)&&s[zv]));)h++,await nj(p),p=p*Q8;if(a+=c,((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[zv])!=="active")break;if(r<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return o}async function tj(n){return{size:n.size,type:n.type}}function nj(n){return new Promise(e=>setTimeout(e,n))}class sj{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Z8(e,t,s)}async uploadToFileSearchStore(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ej(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await tj(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ij{create(e,t,s){return new rj(e,t,s)}}class rj{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MN="x-goog-api-key";class aj{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(MN)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(MN,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oj="gl-node/";class lj{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new fn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=n3(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new aj(this.apiKey);this.apiClient=new tH({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:oj+"web",uploader:new sj,downloader:new K8}),this.models=new _H(this.apiClient),this.live=new pH(this.apiClient,i,new ij),this.batches=new MB(this.apiClient),this.chats=new hF(this.models,this.apiClient),this.caches=new cF(this.apiClient),this.files=new wF(this.apiClient),this.operations=new xH(this.apiClient),this.authTokens=new UH(this.apiClient),this.tunings=new Y8(this.apiClient),this.fileSearchStores=new VH(this.apiClient)}}var cj={};const uj=new lj({apiKey:cj.API_KEY}),dj=async(n,e)=>{try{const t=e.language==="ar"?"Arabic (All output MUST be in Arabic)":"English (All output MUST be in English)",s=e.questionCount,i=7e5;let r=n;if(n.length>i){const d=n.length-i;let h=0;if(e.focusTopic&&e.focusTopic.trim().length>2){const p=n.toLowerCase(),y=e.focusTopic.toLowerCase(),v=p.indexOf(y);v!==-1?h=Math.max(0,v-i/2):h=Math.floor(Math.random()*d)}else h=Math.floor(Math.random()*d);h>d&&(h=d),h<0&&(h=0),r=n.substring(h,h+i)}let a="";e.focusTopic&&e.focusTopic.trim()!==""?a=`
       MANDATORY FOCUS TOPIC: "${e.focusTopic}" 
      The user explicitly wants an exam testing their knowledge on: "${e.focusTopic}".
      `:a=`
      MISSION: Create a comprehensive and BALANCED exam covering major concepts in the provided text.
      `;const o=Math.floor(Math.random()*1e6),l=await uj.models.generateContent({model:"gemini-3-flash-preview",contents:`
      Role: Professional Academic Professor and Exam Designer.
      Seed: ${o}
      
      ${a}

      STRICT EXAM GUIDELINES:
      1. **ONLY TWO QUESTION TYPES**:
         - 'multiple_choice': A question with EXACTLY 4 options.
         - 'true_false': A statement that is either True or False.
      2. **CONCISE QUESTIONS**: Questions must be short to medium length. Avoid long paragraphs. Use a direct academic style (e.g., "The synonym of X is...", "Which of the following is correct regarding Y?").
      3. **SAMPLING & DIVERSITY**: Sample concepts from across the provided text. Ensure no duplicate concepts.
      4. **DIFFICULTY MIX**: Provide a natural mix of:
         - Easy (basic definitions/facts)
         - Medium (understanding/concepts)
         - Hard (analysis/application)
      5. **OPTIONS RULE**: For 'multiple_choice', you MUST provide EXACTLY 4 options.

      FORMATTING RULES:
      - Language: ${t}.
      - Total Questions: ${s}.
      - Return strictly VALID JSON.

      Output Schema (JSON):
      {
        "title": "Academic Exam Title",
        "questions": [
          {
            "id": 1,
            "type": "multiple_choice",
            "question": "Question text...",
            "options": ["Opt 1", "Opt 2", "Opt 3", "Opt 4"],
            "correctAnswerIndex": 0,
            "explanation": "Brief explanation..."
          }
        ]
      }
      
      Text Content:
      ${r}
      `,config:{responseMimeType:"application/json",responseSchema:{type:Wt.OBJECT,properties:{title:{type:Wt.STRING},questions:{type:Wt.ARRAY,items:{type:Wt.OBJECT,properties:{id:{type:Wt.INTEGER},type:{type:Wt.STRING,enum:["multiple_choice","true_false"]},question:{type:Wt.STRING},options:{type:Wt.ARRAY,items:{type:Wt.STRING}},correctAnswerIndex:{type:Wt.INTEGER},explanation:{type:Wt.STRING}},required:["id","type","question","options","correctAnswerIndex","explanation"]}}},required:["title","questions"]}}});return JSON.parse(l.text||"{}")}catch(t){throw console.error("Gemini API Error:",t),new Error("   .        .")}};function qb(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(n);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(n,s[i])&&(t[s[i]]=n[s[i]]);return t}function hj(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(d){try{c(s.next(d))}catch(h){a(h)}}function l(d){try{c(s.throw(d))}catch(h){a(h)}}function c(d){d.done?r(d.value):i(d.value).then(o,l)}c((s=s.apply(n,e||[])).next())})}const fj=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class kA extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class pj extends kA{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class IN extends kA{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class DN extends kA{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var YS;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(YS||(YS={}));class mj{constructor(e,{headers:t={},customFetch:s,region:i=YS.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=fj(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return hj(this,arguments,void 0,function*(t,s={}){var i;let r,a;try{const{headers:o,method:l,body:c,signal:d,timeout:h}=s;let p={},{region:y}=s;y||(y=this.region);const v=new URL(`${this.url}/${t}`);y&&y!=="any"&&(p["x-region"]=y,v.searchParams.set("forceFunctionRegion",y));let _;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",_=c):typeof c=="string"?(p["Content-Type"]="text/plain",_=c):typeof FormData<"u"&&c instanceof FormData?_=c:(p["Content-Type"]="application/json",_=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?_=JSON.stringify(c):_=c;let E=d;h&&(a=new AbortController,r=setTimeout(()=>a.abort(),h),d?(E=a.signal,d.addEventListener("abort",()=>a.abort())):E=a.signal);const b=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),o),body:_,signal:E}).catch(N=>{throw new pj(N)}),w=b.headers.get("x-relay-error");if(w&&w==="true")throw new IN(b);if(!b.ok)throw new DN(b);let S=((i=b.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),T;return S==="application/json"?T=yield b.json():S==="application/octet-stream"||S==="application/pdf"?T=yield b.blob():S==="text/event-stream"?T=b:S==="multipart/form-data"?T=yield b.formData():T=yield b.text(),{data:T,error:null,response:b}}catch(o){return{data:null,error:o,response:o instanceof DN||o instanceof IN?o.context:void 0}}finally{r&&clearTimeout(r)}})}}var hs={},MA={},Vb={},f0={},$b={},Yb={},gj=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},df=gj();const yj=df.fetch,uP=df.fetch.bind(df),dP=df.Headers,vj=df.Request,bj=df.Response,_j=Object.freeze(Object.defineProperty({__proto__:null,Headers:dP,Request:vj,Response:bj,default:uP,fetch:yj},Symbol.toStringTag,{value:"Module"})),xj=nL(_j);var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});let wj=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Kb.default=wj;var hP=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Yb,"__esModule",{value:!0});const Sj=hP(xj),Ej=hP(Kb);let Aj=class{constructor(e){var t,s;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(s=e.isMaybeSingle)!==null&&s!==void 0?s:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Sj.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var a,o,l,c;let d=null,h=null,p=null,y=r.status,v=r.statusText;if(r.ok){if(this.method!=="HEAD"){const w=await r.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?h=w:h=JSON.parse(w))}const E=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),b=(l=r.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");E&&b&&b.length>1&&(p=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,y=406,v="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const E=await r.text();try{d=JSON.parse(E),Array.isArray(d)&&r.status===404&&(h=[],d=null,y=200,v="OK")}catch{r.status===404&&E===""?(y=204,v="No Content"):d={message:E}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,y=200,v="OK"),d&&this.shouldThrowOnError)throw new Ej.default(d)}return{error:d,data:h,count:p,status:y,statusText:v}});return this.shouldThrowOnError||(i=i.catch(r=>{var a,o,l;return{error:{message:`${(a=r==null?void 0:r.name)!==null&&a!==void 0?a:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(o=r==null?void 0:r.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=r==null?void 0:r.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};Yb.default=Aj;var Tj=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty($b,"__esModule",{value:!0});const Cj=Tj(Yb);let Nj=class extends Cj.default{select(e){let t=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",s),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:r=i}={}){const a=r?`${r}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:i=s}={}){const r=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:r=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};$b.default=Nj;var Rj=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(f0,"__esModule",{value:!0});const kj=Rj($b);let Mj=class extends kj.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:i}={}){let r="";i==="plain"?r="pl":i==="phrase"?r="ph":i==="websearch"&&(r="w");const a=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,s])=>{this.url.searchParams.append(t,`eq.${s}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};f0.default=Mj;var Ij=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Vb,"__esModule",{value:!0});const Gf=Ij(f0);let Dj=class{constructor(e,{headers:t={},schema:s,fetch:i}){this.url=e,this.headers=new Headers(t),this.schema=s,this.fetch=i}select(e,{head:t=!1,count:s}={}){const i=t?"HEAD":"GET";let r=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!r?"":(o==='"'&&(r=!r),o)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new Gf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:s=!0}={}){var i;const r="POST";if(t&&this.headers.append("Prefer",`count=${t}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Gf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:r=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${s?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),i&&this.headers.append("Prefer",`count=${i}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Gf.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var s;const i="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Gf.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}delete({count:e}={}){var t;const s="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Gf.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};Vb.default=Dj;var fP=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(MA,"__esModule",{value:!0});const Pj=fP(Vb),Lj=fP(f0);let Oj=class pP{constructor(e,{headers:t={},schema:s,fetch:i}={}){this.url=e,this.headers=new Headers(t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new Pj.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new pP(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:i=!1,count:r}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||i?(o=s?"HEAD":"GET",Object.entries(t).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{l.searchParams.append(h,p)})):(o="POST",c=t);const d=new Headers(this.headers);return r&&d.set("Prefer",`count=${r}`),new Lj.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};MA.default=Oj;var Tf=Ai&&Ai.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(hs,"__esModule",{value:!0});hs.PostgrestError=hs.PostgrestBuilder=hs.PostgrestTransformBuilder=hs.PostgrestFilterBuilder=hs.PostgrestQueryBuilder=hs.PostgrestClient=void 0;const mP=Tf(MA);hs.PostgrestClient=mP.default;const gP=Tf(Vb);hs.PostgrestQueryBuilder=gP.default;const yP=Tf(f0);hs.PostgrestFilterBuilder=yP.default;const vP=Tf($b);hs.PostgrestTransformBuilder=vP.default;const bP=Tf(Yb);hs.PostgrestBuilder=bP.default;const _P=Tf(Kb);hs.PostgrestError=_P.default;var Uj=hs.default={PostgrestClient:mP.default,PostgrestQueryBuilder:gP.default,PostgrestFilterBuilder:yP.default,PostgrestTransformBuilder:vP.default,PostgrestBuilder:bP.default,PostgrestError:_P.default};const{PostgrestClient:Bj,PostgrestQueryBuilder:H9,PostgrestFilterBuilder:j9,PostgrestTransformBuilder:G9,PostgrestBuilder:q9,PostgrestError:V9}=Uj;class Fj{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const s=t.versions;if(s&&s.node){const i=s.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const zj="2.90.1",Hj=`realtime-js/${zj}`,xP="1.0.0",jj="2.0.0",PN=xP,KS=1e4,Gj=1e3,qj=100;var to;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(to||(to={}));var Yt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Yt||(Yt={}));var Yi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Yi||(Yi={}));var JS;(function(n){n.websocket="websocket"})(JS||(JS={}));var Ol;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ol||(Ol={}));class Vj{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const i=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(e){var t,s;const i=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},a=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,s){var i,r;const a=e.topic,o=(i=e.ref)!==null&&i!==void 0?i:"",l=(r=e.join_ref)!==null&&r!==void 0?r:"",c=e.payload.event,d=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(d).length===0?"":JSON.stringify(d);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`topic length ${a.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+a.length+c.length+h.length,y=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(y),_=0;v.setUint8(_++,this.KINDS.userBroadcastPush),v.setUint8(_++,l.length),v.setUint8(_++,o.length),v.setUint8(_++,a.length),v.setUint8(_++,c.length),v.setUint8(_++,h.length),v.setUint8(_++,t),Array.from(l,b=>v.setUint8(_++,b.charCodeAt(0))),Array.from(o,b=>v.setUint8(_++,b.charCodeAt(0))),Array.from(a,b=>v.setUint8(_++,b.charCodeAt(0))),Array.from(c,b=>v.setUint8(_++,b.charCodeAt(0))),Array.from(h,b=>v.setUint8(_++,b.charCodeAt(0)));var E=new Uint8Array(y.byteLength+s.byteLength);return E.set(new Uint8Array(y),0),E.set(new Uint8Array(s),y.byteLength),E.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[i,r,a,o,l]=s;return t({join_ref:i,ref:r,topic:a,event:o,payload:l})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),i=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,i)}}_decodeUserBroadcast(e,t,s){const i=t.getUint8(1),r=t.getUint8(2),a=t.getUint8(3),o=t.getUint8(4);let l=this.HEADER_LENGTH+4;const c=s.decode(e.slice(l,l+i));l=l+i;const d=s.decode(e.slice(l,l+r));l=l+r;const h=s.decode(e.slice(l,l+a));l=l+a;const p=e.slice(l,e.byteLength),y=o===this.JSON_ENCODING?JSON.parse(s.decode(p)):p,v={type:this.BROADCAST_EVENT,event:d,payload:y};return a>0&&(v.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>t.includes(s)))}}class wP{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(nt||(nt={}));const LN=(n,e,t={})=>{var s;const i=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((r,a)=>(r[a]=$j(a,n,e,i),r),{}):{}},$j=(n,e,t,s)=>{const i=e.find(o=>o.name===n),r=i==null?void 0:i.type,a=t[n];return r&&!s.includes(r)?SP(r,a):XS(a)},SP=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Xj(e,t)}switch(n){case nt.bool:return Yj(e);case nt.float4:case nt.float8:case nt.int2:case nt.int4:case nt.int8:case nt.numeric:case nt.oid:return Kj(e);case nt.json:case nt.jsonb:return Jj(e);case nt.timestamp:return Wj(e);case nt.abstime:case nt.date:case nt.daterange:case nt.int4range:case nt.int8range:case nt.money:case nt.reltime:case nt.text:case nt.time:case nt.timestamptz:case nt.timetz:case nt.tsrange:case nt.tstzrange:return XS(e);default:return XS(e)}},XS=n=>n,Yj=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Kj=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Jj=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},Xj=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let r;const a=n.slice(1,t);try{r=JSON.parse("["+a+"]")}catch{r=a?a.split(","):[]}return r.map(o=>SP(e,o))}return n},Wj=n=>typeof n=="string"?n.replace(" ","T"):n,EP=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class X_{constructor(e,t,s={},i=KS){this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ON;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ON||(ON={}));class Ip{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ip.syncState(this.state,i,r,a),this.pendingDiffs.forEach(l=>{this.state=Ip.syncDiff(this.state,l,r,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},i=>{const{onJoin:r,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ip.syncDiff(this.state,i,r,a),o())}),this.onJoin((i,r,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:a})}),this.onLeave((i,r,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,i){const r=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(r,(c,d)=>{a[c]||(l[c]=d)}),this.map(a,(c,d)=>{const h=r[c];if(h){const p=d.map(E=>E.presence_ref),y=h.map(E=>E.presence_ref),v=d.filter(E=>y.indexOf(E.presence_ref)<0),_=h.filter(E=>p.indexOf(E.presence_ref)<0);v.length>0&&(o[c]=v),_.length>0&&(l[c]=_)}else o[c]=d}),this.syncDiff(r,{joins:o,leaves:l},s,i)}static syncDiff(e,t,s,i){const{joins:r,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(r,(o,l)=>{var c;const d=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(y=>y.presence_ref),p=d.filter(y=>h.indexOf(y.presence_ref)<0);e[o].unshift(...p)}s(o,d,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const d=l.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=c,i(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const i=e[s];return"metas"in i?t[s]=i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[s]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var UN;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(UN||(UN={}));var Dp;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Dp||(Dp={}));var qr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(qr||(qr={}));class dd{constructor(e,t={config:{}},s){var i,r;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Yt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new X_(this,Yi.join,this.params,this.timeout),this.rejoinTimer=new wP(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Yt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Yi.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new Ip(this),this.broadcastEndpointURL=EP(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((r=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||r===void 0)&&r.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,i,r;if(this.socket.isConnected()||this.socket.connect(),this.state==Yt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(y=>y.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[Dp.PRESENCE]&&this.bindings[Dp.PRESENCE].length>0||((r=this.params.config.presence)===null||r===void 0?void 0:r.enabled)===!0,h={},p={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(qr.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(qr.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),y===void 0){e==null||e(qr.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,E=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,b=[];for(let w=0;w<E;w++){const S=_[w],{filter:{event:T,schema:N,table:R,filter:k}}=S,I=y&&y[w];if(I&&I.event===T&&dd.isFilterValueEqual(I.schema,N)&&dd.isFilterValueEqual(I.table,R)&&dd.isFilterValueEqual(I.filter,k))b.push(Object.assign(Object.assign({},S),{id:I.id}));else{this.unsubscribe(),this.state=Yt.errored,e==null||e(qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(qr.SUBSCRIBED);return}}).receive("error",y=>{this.state=Yt.errored,e==null||e(qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===Yt.joined&&e===Dp.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var i;if(t==null)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization=`Bearer ${this.socket.accessTokenValue}`);const a={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,a,(i=s.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,t={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:r,payload:a}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),c.receive("ok",()=>r("ok")),c.receive("error",()=>r("error")),c.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Yt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Yi.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new X_(this,Yi.leave,{},e),s.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Yt.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const i=new AbortController,r=setTimeout(()=>i.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(r),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new X_(this,e,t,s);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>qj){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,r;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:d}=Yi;if(s&&[o,l,c,d].indexOf(a)>=0&&s!==this._joinRef())return;let p=this._onMessage(a,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(y=>{var v,_,E;return((v=y.filter)===null||v===void 0?void 0:v.event)==="*"||((E=(_=y.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===a}).map(y=>y.callback(p,s)):(r=this.bindings[a])===null||r===void 0||r.filter(y=>{var v,_,E,b,w,S,T,N;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in y){const R=y.id,k=(v=y.filter)===null||v===void 0?void 0:v.event;return R&&((_=t.ids)===null||_===void 0?void 0:_.includes(R))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((E=t.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))&&(!(!((b=y.filter)===null||b===void 0)&&b.table)||y.filter.table===((w=t.data)===null||w===void 0?void 0:w.table))}else{const R=(T=(S=y==null?void 0:y.filter)===null||S===void 0?void 0:S.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return R==="*"||R===((N=t==null?void 0:t.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===a}).map(y=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:_,table:E,commit_timestamp:b,type:w,errors:S}=v;p=Object.assign(Object.assign({},{schema:_,table:E,commit_timestamp:b,eventType:w,new:{},old:{},errors:S}),this._getPayloadRecords(v))}y.callback(p,s)})}_isClosed(){return this.state===Yt.closed}_isJoined(){return this.state===Yt.joined}_isJoining(){return this.state===Yt.joining}_isLeaving(){return this.state===Yt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),r={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(i=>{var r;return!(((r=i.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&dd.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Yi.close,{},e)}_onError(e){this._on(Yi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=LN(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=LN(e.columns,e.old_record)),t}}const W_=()=>{},V0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Qj=[1e3,2e3,5e3,1e4],Zj=1e4,eG=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class tG{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=KS,this.transport=null,this.heartbeatIntervalMs=V0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=W_,this.ref=0,this.reconnectTimer=null,this.vsn=PN,this.logger=W_,this.conn=null,this.sendBuffer=[],this.serializer=new Vj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...r)=>i(...r):(...r)=>fetch(...r),!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${JS.websocket}`,this.httpEndpoint=EP(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Fj.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case to.connecting:return Ol.Connecting;case to.open:return Ol.Open;case to.closing:return Ol.Closing;default:return Ol.Closed}}isConnected(){return this.connectionState()===Ol.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(r=>r.topic===s);if(i)return i;{const r=new dd(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:s,payload:i,ref:r}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${r})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Gj,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},V0.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",c)}catch(d){this.log("error","error in heartbeat callback",d)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:i,payload:r,ref:a}=t,o=a?`(${a})`:"",l=r.status||"";this.log("receive",`${l} ${s} ${i} ${o}`.trim(),r),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(i,r,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===to.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===to.open||this.conn.readyState===to.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Yi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${s}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([eG],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,s=!1;if(e)t=e,s=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),t=this.accessTokenValue}else t=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(i=>{const r={access_token:t,version:Hj};t&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Yi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new wP(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},V0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,i,r,a,o,l,c,d,h,p,y;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:KS,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:V0.HEARTBEAT_INTERVAL,this.worker=(r=e==null?void 0:e.worker)!==null&&r!==void 0?r:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:W_,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:PN,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:v=>Qj[v-1]||Zj,this.vsn){case xP:this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(v,_)=>_(JSON.stringify(v)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(v,_)=>_(JSON.parse(v));break;case jj:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(y=e==null?void 0:e.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Zp=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function nG(n,e,t){const s=new URL(e,n);if(t)for(const[i,r]of Object.entries(t))r!==void 0&&s.searchParams.set(i,r);return s.toString()}async function sG(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function iG(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:s,query:i,body:r,headers:a}){const o=nG(n.baseUrl,s,i),l=await sG(n.auth),c=await e(o,{method:t,headers:{...r?{"Content-Type":"application/json"}:{},...l,...a},body:r?JSON.stringify(r):void 0}),d=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),p=h&&d?JSON.parse(d):d;if(!c.ok){const y=h?p:void 0,v=y==null?void 0:y.error;throw new Zp((v==null?void 0:v.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:y})}return{status:c.status,headers:c.headers,data:p}}}}function $0(n){return n.join("")}var rG=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:$0(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$0(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$0(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$0(n.namespace)}`}),!0}catch(e){if(e instanceof Zp&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Zp&&t.status===409)return;throw t}}};function Ru(n){return n.join("")}var aG=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ru(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Zp&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Zp&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},oG=class{constructor(n){var s;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=iG({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(s=n.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new rG(this.client,e),this.tableOps=new aG(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},Jb=class extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}};function bt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var lG=class extends Jb{constructor(n,e,t){super(n),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},WS=class extends Jb{constructor(n,e){super(n),this.name="StorageUnknownError",this.originalError=e}};const IA=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),cG=()=>Response,QS=n=>{if(Array.isArray(n))return n.map(t=>QS(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const i=t.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[i]=QS(s)}),e},uG=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},dG=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function em(n){"@babel/helpers - typeof";return em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},em(n)}function hG(n,e){if(em(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(em(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function fG(n){var e=hG(n,"string");return em(e)=="symbol"?e:e+""}function pG(n,e,t){return(e=fG(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function BN(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);e&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,s)}return t}function ae(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?BN(Object(t),!0).forEach(function(s){pG(n,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):BN(Object(t)).forEach(function(s){Object.defineProperty(n,s,Object.getOwnPropertyDescriptor(t,s))})}return n}const Q_=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},mG=async(n,e,t)=>{n instanceof await cG()&&!(t!=null&&t.noResolveJson)?n.json().then(s=>{const i=n.status||500,r=(s==null?void 0:s.statusCode)||i+"";e(new lG(Q_(s),i,r))}).catch(s=>{e(new WS(Q_(s),s))}):e(new WS(Q_(n),n))},gG=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?i:(uG(s)?(i.headers=ae({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,e!=null&&e.duplex&&(i.duplex=e.duplex),ae(ae({},i),t))};async function p0(n,e,t,s,i,r){return new Promise((a,o)=>{n(t,gG(e,s,i,r)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>mG(l,o,s))})}async function tm(n,e,t,s){return p0(n,"GET",e,t,s)}async function Di(n,e,t,s,i){return p0(n,"POST",e,s,i,t)}async function ZS(n,e,t,s,i){return p0(n,"PUT",e,s,i,t)}async function yG(n,e,t,s){return p0(n,"HEAD",e,ae(ae({},t),{},{noResolveJson:!0}),s)}async function DA(n,e,t,s,i){return p0(n,"DELETE",e,s,i,t)}var vG=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(bt(e))return{data:null,error:e};throw e}}};let AP;AP=Symbol.toStringTag;var bG=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[AP]="BlobDownloadBuilder",this.promise=null}asStream(){return new vG(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(bt(e))return{data:null,error:e};throw e}}};const _G={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},FN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var xG=class{constructor(n,e={},t,s){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.bucketId=t,this.fetch=IA(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(n,e,t,s){var i=this;try{let r;const a=ae(ae({},FN),s);let o=ae(ae({},i.headers),n==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&t instanceof Blob?(r=new FormData,r.append("cacheControl",a.cacheControl),l&&r.append("metadata",i.encodeMetadata(l)),r.append("",t)):typeof FormData<"u"&&t instanceof FormData?(r=t,r.has("cacheControl")||r.append("cacheControl",a.cacheControl),l&&!r.has("metadata")&&r.append("metadata",i.encodeMetadata(l))):(r=t,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&r instanceof ReadableStream||r&&typeof r=="object"&&"pipe"in r&&typeof r.pipe=="function")&&!a.duplex&&(a.duplex="half")),s!=null&&s.headers&&(o=ae(ae({},o),s.headers));const c=i._removeEmptyFolders(e),d=i._getFinalPath(c),h=await(n=="PUT"?ZS:Di)(i.fetch,`${i.url}/object/${d}`,r,ae({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(r){if(i.shouldThrowOnError)throw r;if(bt(r))return{data:null,error:r};throw r}}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,s){var i=this;const r=i._removeEmptyFolders(n),a=i._getFinalPath(r),o=new URL(i.url+`/object/upload/sign/${a}`);o.searchParams.set("token",e);try{let l;const c=ae({upsert:FN.upsert},s),d=ae(ae({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",c.cacheControl)):(l=t,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType),{data:{path:r,fullPath:(await ZS(i.fetch,o.toString(),l,{headers:d})).Key},error:null}}catch(l){if(i.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(n,e){var t=this;try{let s=t._getFinalPath(n);const i=ae({},t.headers);e!=null&&e.upsert&&(i["x-upsert"]="true");const r=await Di(t.fetch,`${t.url}/object/upload/sign/${s}`,{},{headers:i}),a=new URL(t.url+r.url),o=a.searchParams.get("token");if(!o)throw new Jb("No token returned by API");return{data:{signedUrl:a.toString(),path:n,token:o},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var s=this;try{return{data:await Di(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:s.headers}),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}async copy(n,e,t){var s=this;try{return{data:{path:(await Di(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:s.headers})).Key},error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}async createSignedUrl(n,e,t){var s=this;try{let i=s._getFinalPath(n),r=await Di(s.fetch,`${s.url}/object/sign/${i}`,ae({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:s.headers});const a=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return r={signedUrl:encodeURI(`${s.url}${r.signedURL}${a}`)},{data:r,error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}async createSignedUrls(n,e,t){var s=this;try{const i=await Di(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:n},{headers:s.headers}),r=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:i.map(a=>ae(ae({},a),{},{signedUrl:a.signedURL?encodeURI(`${s.url}${a.signedURL}${r}`):null})),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}download(n,e){const t=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),i=s?`?${s}`:"",r=this._getFinalPath(n),a=()=>tm(this.fetch,`${this.url}/${t}/${r}${i}`,{headers:this.headers,noResolveJson:!0});return new bG(a,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);try{return{data:QS(await tm(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await yG(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(bt(s)&&s instanceof WS){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}}getPublicUrl(n,e){const t=this._getFinalPath(n),s=[],i=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";i!==""&&s.push(i);const r=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});a!==""&&s.push(a);let o=s.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${t}${o}`)}}}async remove(n){var e=this;try{return{data:await DA(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async list(n,e,t){var s=this;try{const i=ae(ae(ae({},_G),e),{},{prefix:n||""});return{data:await Di(s.fetch,`${s.url}/object/list/${s.bucketId}`,i,{headers:s.headers},t),error:null}}catch(i){if(s.shouldThrowOnError)throw i;if(bt(i))return{data:null,error:i};throw i}}async listV2(n,e){var t=this;try{const s=ae({},n);return{data:await Di(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,s,{headers:t.headers},e),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const TP="2.90.1",CP={"X-Client-Info":`storage-js/${TP}`};var wG=class{constructor(n,e={},t,s){this.shouldThrowOnError=!1;const i=new URL(n);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=ae(ae({},CP),e),this.fetch=IA(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(n){var e=this;try{const t=e.listBucketOptionsToQueryString(n);return{data:await tm(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await tm(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async createBucket(n,e={public:!1}){var t=this;try{return{data:await Di(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async updateBucket(n,e){var t=this;try{return{data:await ZS(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}}async emptyBucket(n){var e=this;try{return{data:await Di(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await DA(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},SG=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ae(ae({},CP),e),this.fetch=IA(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await Di(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async listBuckets(n){var e=this;try{const t=new URLSearchParams;(n==null?void 0:n.limit)!==void 0&&t.set("limit",n.limit.toString()),(n==null?void 0:n.offset)!==void 0&&t.set("offset",n.offset.toString()),n!=null&&n.sortColumn&&t.set("sortColumn",n.sortColumn),n!=null&&n.sortOrder&&t.set("sortOrder",n.sortOrder),n!=null&&n.search&&t.set("search",n.search);const s=t.toString(),i=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await tm(e.fetch,i,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await DA(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(bt(t))return{data:null,error:t};throw t}}from(n){var e=this;if(!dG(n))throw new Jb("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new oG({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(t,{get(i,r){const a=i[r];return typeof a!="function"?a:async(...o)=>{try{return{data:await a.apply(i,o),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const PA={"X-Client-Info":`storage-js/${TP}`,"Content-Type":"application/json"};var NP=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Gs(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var Z_=class extends NP{constructor(n,e,t){super(n),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},EG=class extends NP{constructor(n,e){super(n),this.name="StorageVectorsUnknownError",this.originalError=e}};const LA=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),AG=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},zN=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),TG=async(n,e,t)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const s=n.status||500,i=n;if(typeof i.json=="function")i.json().then(r=>{const a=(r==null?void 0:r.statusCode)||(r==null?void 0:r.code)||s+"";e(new Z_(zN(r),s,a))}).catch(()=>{const r=s+"";e(new Z_(i.statusText||`HTTP ${s} error`,s,r))});else{const r=s+"";e(new Z_(i.statusText||`HTTP ${s} error`,s,r))}}else e(new EG(zN(n),n))},CG=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return s?(AG(s)?(i.headers=ae({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,ae(ae({},i),t)):i};async function NG(n,e,t,s,i,r){return new Promise((a,o)=>{n(t,CG(e,s,i,r)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>a(l)).catch(l=>TG(l,o,s))})}async function qs(n,e,t,s,i){return NG(n,"POST",e,s,i,t)}var RG=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ae(ae({},PA),e),this.fetch=LA(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async getIndex(n,e){var t=this;try{return{data:await qs(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Gs(s))return{data:null,error:s};throw s}}async listIndexes(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async deleteIndex(n,e){var t=this;try{return{data:await qs(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{},error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Gs(s))return{data:null,error:s};throw s}}},kG=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ae(ae({},PA),e),this.fetch=LA(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var e=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await qs(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async getVectors(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async listVectors(n){var e=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await qs(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async queryVectors(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async deleteVectors(n){var e=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await qs(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}},MG=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=ae(ae({},PA),e),this.fetch=LA(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async listBuckets(n={}){var e=this;try{return{data:await qs(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await qs(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Gs(t))return{data:null,error:t};throw t}}},IG=class extends MG{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new DG(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},DG=class extends RG{constructor(n,e,t,s){super(n,e,s),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new PG(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},PG=class extends kG{constructor(n,e,t,s,i){super(n,e,i),this.vectorBucketName=t,this.indexName=s}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,ae(ae({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},LG=class extends wG{constructor(n,e={},t,s){super(n,e,t,s)}from(n){return new xG(this.url,this.headers,n,this.fetch)}get vectors(){return new IG(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new SG(this.url+"/iceberg",this.headers,this.fetch)}};const OG="2.39.3";let yp="";typeof Deno<"u"?yp="deno":typeof document<"u"?yp="web":typeof navigator<"u"&&navigator.product==="ReactNative"?yp="react-native":yp="node";const UG={"X-Client-Info":`supabase-js-${yp}/${OG}`};var BG=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(d){try{c(s.next(d))}catch(h){a(h)}}function l(d){try{c(s.throw(d))}catch(h){a(h)}}function c(d){d.done?r(d.value):i(d.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const FG=n=>{let e;return n?e=n:typeof fetch>"u"?e=uP:e=fetch,(...t)=>e(...t)},zG=()=>typeof Headers>"u"?dP:Headers,HG=(n,e,t)=>{const s=FG(t),i=zG();return(r,a)=>BG(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(r,Object.assign(Object.assign({},a),{headers:c}))})};function jG(n){return n.replace(/\/$/,"")}function GG(n,e){const{db:t,auth:s,realtime:i,global:r}=n,{db:a,auth:o,realtime:l,global:c}=e;return{db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),r)}}const RP="2.90.1",Yu=30*1e3,eE=3,ex=eE*Yu,qG="http://localhost:9999",VG="supabase.auth.token",$G={"X-Client-Info":`gotrue-js/${RP}`},tE="X-Supabase-Api-Version",kP={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},YG=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,KG=10*60*1e3;class nm extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function ne(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class JG extends nm{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function XG(n){return ne(n)&&n.name==="AuthApiError"}class Ul extends nm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Xa extends nm{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class gs extends Xa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function WG(n){return ne(n)&&n.name==="AuthSessionMissingError"}class ku extends Xa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Y0 extends Xa{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class K0 extends Xa{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function QG(n){return ne(n)&&n.name==="AuthImplicitGrantRedirectError"}class HN extends Xa{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ZG extends Xa{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class nE extends Xa{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function tx(n){return ne(n)&&n.name==="AuthRetryableFetchError"}class jN extends Xa{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class sE extends Xa{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Hv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),GN=` 	
\r=`.split(""),eq=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<GN.length;e+=1)n[GN[e].charCodeAt(0)]=-2;for(let e=0;e<Hv.length;e+=1)n[Hv[e].charCodeAt(0)]=e;return n})();function qN(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Hv[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Hv[s]),e.queuedBits-=6}}function MP(n,e,t){const s=eq[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function VN(n){const e=[],t=a=>{e.push(String.fromCodePoint(a))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=a=>{sq(a,s,t)};for(let a=0;a<n.length;a+=1)MP(n.charCodeAt(a),i,r);return e.join("")}function tq(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function nq(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}tq(s,e)}}function sq(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Td(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<n.length;i+=1)MP(n.charCodeAt(i),t,s);return new Uint8Array(e)}function iq(n){const e=[];return nq(n,t=>e.push(t)),new Uint8Array(e)}function Hl(n){const e=[],t={queue:0,queuedBits:0},s=i=>{e.push(i)};return n.forEach(i=>qN(i,t,s)),qN(null,t,s),e.join("")}function rq(n){return Math.round(Date.now()/1e3)+n}function aq(){return Symbol("auth-callback")}const mn=()=>typeof window<"u"&&typeof document<"u",Al={tested:!1,writable:!1},IP=()=>{if(!mn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Al.tested)return Al.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Al.tested=!0,Al.writable=!0}catch{Al.tested=!0,Al.writable=!1}return Al.writable};function oq(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,r)=>{e[r]=i})}catch{}return t.searchParams.forEach((s,i)=>{e[i]=s}),e}const DP=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),lq=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Ku=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Tl=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},pn=async(n,e)=>{await n.removeItem(e)};class Xb{constructor(){this.promise=new Xb.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Xb.promiseConstructor=Promise;function nx(n){const e=n.split(".");if(e.length!==3)throw new sE("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!YG.test(e[s]))throw new sE("JWT not in base64url format");return{header:JSON.parse(VN(e[0])),payload:JSON.parse(VN(e[1])),signature:Td(e[2]),raw:{header:e[0],payload:e[1]}}}async function cq(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function uq(n,e){return new Promise((s,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const a=await n(r);if(!e(r,null,a)){s(a);return}}catch(a){if(!e(r,a)){i(a);return}}})()})}function dq(n){return("0"+n.toString(16)).substr(-2)}function hq(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let i="";for(let r=0;r<56;r++)i+=t.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,dq).join("")}async function fq(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map(r=>String.fromCharCode(r)).join("")}async function pq(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await fq(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mu(n,e,t=!1){const s=hq();let i=s;t&&(i+="/PASSWORD_RECOVERY"),await Ku(n,`${e}-code-verifier`,i);const r=await pq(s);return[r,s===r?"plain":"s256"]}const mq=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gq(n){const e=n.headers.get(tE);if(!e||!e.match(mq))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function yq(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function vq(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const bq=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Iu(n){if(!bq.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function sx(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function _q(n,e){return new Proxy(n,{get:(t,s,i)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const r=s.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)"||r==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,i)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,i)}})}function $N(n){return JSON.parse(JSON.stringify(n))}const Ll=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),xq=[502,503,504];async function YN(n){var e;if(!lq(n))throw new nE(Ll(n),0);if(xq.includes(n.status))throw new nE(Ll(n),n.status);let t;try{t=await n.json()}catch(r){throw new Ul(Ll(r),r)}let s;const i=gq(n);if(i&&i.getTime()>=kP["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new jN(Ll(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new gs}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0))throw new jN(Ll(t),n.status,t.weak_password.reasons);throw new JG(Ll(t),n.status||500,s)}const wq=(n,e,t,s)=>{const i={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),t))};async function re(n,e,t,s){var i;const r=Object.assign({},s==null?void 0:s.headers);r[tE]||(r[tE]=kP["2024-01-01"].name),s!=null&&s.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const a=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Sq(n,e,t+o,{headers:r,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Sq(n,e,t,s,i,r){const a=wq(e,s,i,r);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new nE(Ll(l),0)}if(o.ok||await YN(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await YN(l)}}function Mi(n){var e;let t=null;Tq(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=rq(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function KN(n){const e=Mi(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function oo(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Eq(n){return{data:n,error:null}}function Aq(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r}=n,a=qb(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:i,verification_type:r},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function JN(n){return n}function Tq(n){return n.access_token&&n.refresh_token&&n.expires_in}const ix=["global","local","others"];class Cq{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=DP(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=ix[0]){if(ix.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ix.join(", ")}`);try{return await re(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ne(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await re(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:oo})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=qb(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Aq,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ne(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await re(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:oo})}catch(t){if(ne(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,r,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},d=await re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:JN});if(d.error)throw d.error;const h=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,y=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(v=>{const _=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(v.split(";")[1].split("=")[1]);c[`${E}Page`]=_}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(ne(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Iu(e);try{return await re(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:oo})}catch(t){if(ne(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Iu(e);try{return await re(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:oo})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Iu(e);try{return await re(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:oo})}catch(s){if(ne(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Iu(e.userId);try{const{data:t,error:s}=await re(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:s}}catch(t){if(ne(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Iu(e.userId),Iu(e.id);try{return{data:await re(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,i,r,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},d=await re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:JN});if(d.error)throw d.error;const h=await d.json(),p=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,y=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return y.length>0&&(y.forEach(v=>{const _=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(v.split(";")[1].split("=")[1]);c[`${E}Page`]=_}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(ne(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ne(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ne(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await re(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ne(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ne(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ne(t))return{data:null,error:t};throw t}}}function XN(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Du={debug:!!(globalThis&&IP()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class PP extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Nq extends PP{}async function Rq(n,e,t){Du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Du.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){Du.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{Du.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw Du.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Nq(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Du.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function kq(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function LP(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function Mq(n){return parseInt(n,16)}function Iq(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Dq(n){var e;const{chainId:t,domain:s,expirationTime:i,issuedAt:r=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:d,uri:h,version:p}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const y=LP(n.address),v=d?`${d}://${s}`:s,_=n.statement?`${n.statement}
`:"",E=`${v} wants you to sign in with your Ethereum account:
${y}

${_}`;let b=`URI: ${h}
Version: ${p}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${r.toISOString()}`;if(i&&(b+=`
Expiration Time: ${i.toISOString()}`),o&&(b+=`
Not Before: ${o.toISOString()}`),l&&(b+=`
Request ID: ${l}`),c){let w=`
Resources:`;for(const S of c){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);w+=`
- ${S}`}b+=w}return`${E}
${b}`}class Ft extends Error{constructor({message:e,code:t,cause:s,name:i}){var r;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(r=i??(s instanceof Error?s.name:void 0))!==null&&r!==void 0?r:"Unknown Error",this.code=t}}class jv extends Ft{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Pq({error:n,options:e}){var t,s,i;const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ft({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=r.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Ft({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((s=r.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ft({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((i=r.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Ft({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Ft({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Ft({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return r.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Ft({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Ft({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const a=window.location.hostname;if(OP(a)){if(r.rp.id!==a)return new Ft({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Ft({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new Ft({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Ft({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Ft({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function Lq({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ft({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Ft({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const s=window.location.hostname;if(OP(s)){if(t.rpId!==s)return new Ft({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Ft({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Ft({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Ft({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class Oq{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Uq=new Oq;function Bq(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:s}=n,i=qb(n,["challenge","user","excludeCredentials"]),r=Td(e).buffer,a=Object.assign(Object.assign({},t),{id:Td(t.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:r,user:a});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const c=s[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Td(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function Fq(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,s=qb(n,["challenge","allowCredentials"]),i=Td(e).buffer,r=Object.assign(Object.assign({},s),{challenge:i});if(t&&t.length>0){r.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const o=t[a];r.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Td(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return r}function zq(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Hl(new Uint8Array(n.response.attestationObject)),clientDataJSON:Hl(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Hq(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,s=n.getClientExtensionResults(),i=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Hl(new Uint8Array(i.authenticatorData)),clientDataJSON:Hl(new Uint8Array(i.clientDataJSON)),signature:Hl(new Uint8Array(i.signature)),userHandle:i.userHandle?Hl(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function OP(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function WN(){var n,e;return!!(mn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function jq(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jv("Browser returned unexpected credential type",e)}:{data:null,error:new jv("Empty credential response",e)}}catch(e){return{data:null,error:Pq({error:e,options:n})}}}async function Gq(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new jv("Browser returned unexpected credential type",e)}:{data:null,error:new jv("Empty credential response",e)}}catch(e){return{data:null,error:Lq({error:e,options:n})}}}const qq={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Vq={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Gv(...n){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),t=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),s={};for(const i of n)if(i)for(const r in i){const a=i[r];if(a!==void 0)if(Array.isArray(a))s[r]=a;else if(t(a))s[r]=a;else if(e(a)){const o=s[r];e(o)?s[r]=Gv(o,a):s[r]=Gv(a)}else s[r]=a}return s}function $q(n,e){return Gv(qq,n,e||{})}function Yq(n,e){return Gv(Vq,n,e||{})}class Kq{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:i},r){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:o};const l=i??Uq.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=$q(a.webauthn.credential_options.publicKey,r==null?void 0:r.create),{data:d,error:h}=await jq({publicKey:c,signal:l});return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}case"request":{const c=Yq(a.webauthn.credential_options.publicKey,r==null?void 0:r.request),{data:d,error:h}=await Gq(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return d?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:d}},error:null}:{data:null,error:h}}}}catch(a){return ne(a)?{data:null,error:a}:{data:null,error:new Ul("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},r){if(!t)return{data:null,error:new nm("rpId is required for WebAuthn authentication")};try{if(!WN())return{data:null,error:new Ul("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:i},{request:r});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:s,credential_response:l.credential_response}})}catch(a){return ne(a)?{data:null,error:a}:{data:null,error:new Ul("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},r){if(!t)return{data:null,error:new nm("rpId is required for WebAuthn registration")};try{if(!WN())return{data:null,error:new Ul("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(d=>{var h;return(h=d.data)===null||h===void 0?void 0:h.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:i},{create:r});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return ne(a)?{data:null,error:a}:{data:null,error:new Ul("Unexpected error in register",a)}}}}kq();const Jq={url:qG,storageKey:VG,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:$G,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function QN(n,e,t){return await t()}const Pu={};class sm{get jwks(){var e,t;return(t=(e=Pu[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Pu[this.storageKey]=Object.assign(Object.assign({},Pu[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Pu[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Pu[this.storageKey]=Object.assign(Object.assign({},Pu[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},Jq),e);if(this.storageKey=r.storageKey,this.instanceID=(t=sm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,sm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.instanceID>0&&mn()){const a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Cq({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=DP(r.fetch),this.lock=r.lock||QN,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&mn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Rq:this.lock=QN,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Kq(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:IP()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=XN(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=XN(this.memoryStorage)),mn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${RP}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(mn()&&(t=oq(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),mn()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:r}=await this._getSessionFromURL(t,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),QG(r)){const l=(e=r.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:r}}return{error:r}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ne(t)?this._returnResult({error:t}):this._returnResult({error:new Ul("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const r=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Mi}),{data:a,error:o}=r;if(o||!a)return this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(r){if(ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,s,i;try{let r;if("email"in e){const{email:d,password:h,options:p}=e;let y=null,v=null;this.flowType==="pkce"&&([y,v]=await Mu(this.storage,this.storageKey)),r=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:v},xform:Mi})}else if("phone"in e){const{phone:d,password:h,options:p}=e;r=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Mi})}else throw new Y0("You must provide either an email or phone number and a password");const{data:a,error:o}=r;if(o||!a)return await pn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(r){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:a,options:o}=e;t=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:KN})}else if("phone"in e){const{phone:r,password:a,options:o}=e;t=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:KN})}else throw new Y0("You must provide either an email or phone number and a password");const{data:s,error:i}=t;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!s||!s.session||!s.user){const r=new ku;return this._returnResult({data:{user:null,session:null},error:r})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(t){if(ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,i,r,a,o,l,c,d,h,p;let y,v;if("message"in e)y=e.message,v=e.signature;else{const{chain:_,wallet:E,statement:b,options:w}=e;let S;if(mn())if(typeof E=="object")S=E;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")S=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=E}const T=new URL((t=w==null?void 0:w.url)!==null&&t!==void 0?t:window.location.href),N=await S.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=LP(N[0]);let k=(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!k){const M=await S.request({method:"eth_chainId"});k=Mq(M)}const I={domain:T.host,address:R,statement:b,uri:T.href,version:"1",chainId:k,nonce:(i=w==null?void 0:w.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(r=w==null?void 0:w.signInWithEthereum)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.resources};y=Dq(I),v=await S.request({method:"personal_sign",params:[Iq(y),R]})}try{const{data:_,error:E}=await re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:v},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Mi});if(E)throw E;if(!_||!_.session||!_.user){const b=new ku;return this._returnResult({data:{user:null,session:null},error:b})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:E})}catch(_){if(ne(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(e){var t,s,i,r,a,o,l,c,d,h,p,y;let v,_;if("message"in e)v=e.message,_=e.signature;else{const{chain:E,wallet:b,statement:w,options:S}=e;let T;if(mn())if(typeof b=="object")T=b;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))T=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(S!=null&&S.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=b}const N=new URL((t=S==null?void 0:S.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in T&&T.signIn){const R=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S==null?void 0:S.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),w?{statement:w}:null));let k;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")k=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)k=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)v=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),_=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${N.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(s=S==null?void 0:S.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((r=S==null?void 0:S.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((a=S==null?void 0:S.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((o=S==null?void 0:S.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((l=S==null?void 0:S.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((c=S==null?void 0:S.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((h=(d=S==null?void 0:S.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...S.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const R=await T.signMessage(new TextEncoder().encode(v),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=R}}try{const{data:E,error:b}=await re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Hl(_)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Mi});if(b)throw b;if(!E||!E.session||!E.user){const w=new ku;return this._returnResult({data:{user:null,session:null},error:w})}return E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),this._returnResult({data:Object.assign({},E),error:b})}catch(E){if(ne(E))return this._returnResult({data:{user:null,session:null},error:E});throw E}}async _exchangeCodeForSession(e){const t=await Tl(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(t??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ZG;const{data:r,error:a}=await re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Mi});if(await pn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!r||!r.session||!r.user){const o=new ku;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign(Object.assign({},r),{redirectType:i??null}),error:a})}catch(r){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:r,nonce:a}=e,o=await re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:r,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Mi}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const d=new ku;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(t){if(ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,i,r,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Mu(this.storage,this.storageKey));const{error:h}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:d}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d})}throw new Y0("You must provide either an email or phone number.")}catch(o){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(e){var t,s;try{let i,r;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:Mi});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(e){var t,s,i,r,a;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Mu(this.storage,this.storageKey));const c=await re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:Eq});return!((r=c.data)===null||r===void 0)&&r.url&&mn()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new gs;const{error:i}=await re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(e){if(ne(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:r}=e,{error:a}=await re(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:a})}else if("phone"in e){const{phone:s,type:i,options:r}=e,{data:a,error:o}=await re(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o})}throw new Y0("You must provide either an email or phone number and a type")}catch(t){if(ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Tl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ex:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const a=await Tl(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=sx()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const a={value:this.suppressGetSessionWarning};e.user=_q(e.user,a),a.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:oo}):await this._useSession(async t=>{var s,i,r;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gs}:await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:oo})})}catch(t){if(ne(t))return WG(t)&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:i,error:r}=s;if(r)throw r;if(!i.session)throw new gs;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Mu(this.storage,this.storageKey));const{data:c,error:d}=await re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:oo});if(d)throw d;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),this._returnResult({data:{user:a.user},error:null})})}catch(s){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gs;const t=Date.now()/1e3;let s=t,i=!0,r=null;const{payload:a}=nx(e.access_token);if(a.exp&&(s=a.exp,i=s<=t),i){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};r=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;r={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if(ne(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new gs;const{data:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ne(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!mn())throw new K0("No browser detected.");if(e.error||e.error_description||e.error_code)throw new K0(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new HN("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new K0("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new HN("No code detected.");const{data:w,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:r,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!r||!o||!a||!c)throw new K0("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let p=d+h;l&&(p=parseInt(l));const y=p-d;y*1e3<=Yu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${h}s`);const v=p-h;d-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,d):d-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,d);const{data:_,error:E}=await this._getUser(r);if(E)throw E;const b={provider_token:s,provider_refresh_token:i,access_token:r,expires_in:h,expires_at:p,refresh_token:a,token_type:c,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:b,redirectType:e.type},error:null})}catch(s){if(ne(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Tl(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return this._returnResult({error:r});const a=(s=i.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(XG(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return e!=="others"&&(await this._removeSession(),await pn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=aq(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,i;try{const{data:{session:r},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await Mu(this.storage,this.storageKey,!0));try{return await re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:i}=await this._useSession(async r=>{var a,o,l,c,d;const{data:h,error:p}=r;if(p)throw p;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await re(this.fetch,"GET",y,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return mn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(ne(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:i,data:{session:r}}=t;if(i)throw i;const{options:a,provider:o,token:l,access_token:c,nonce:d}=e,h=await re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=r==null?void 0:r.access_token)!==null&&s!==void 0?s:void 0,body:{provider:o,id_token:l,access_token:c,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Mi}),{data:p,error:y}=h;return y?this._returnResult({data:{user:null,session:null},error:y}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new ku}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:y}))}catch(i){if(await pn(this.storage,`${this.storageKey}-code-verifier`),ne(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)throw a;return await re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await uq(async i=>(i>0&&await cq(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Mi})),(i,r)=>{const a=200*Math.pow(2,i);return r&&tx(r)&&Date.now()+a-s<Yu})}catch(s){if(this._debug(t,"error",s),ne(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),mn()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await Tl(this.storage,this.storageKey);if(i&&this.userStorage){let a=await Tl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await Ku(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:sx()}else if(i&&!i.user&&!i.user){const a=await Tl(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(i.user=a.user,await pn(this.storage,this.storageKey+"-user"),await Ku(this.storage,this.storageKey,i)):i.user=sx()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const r=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ex;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${ex}s`),r){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),tx(a)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(i.access_token);!o&&(a!=null&&a.user)?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(s,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Xb;const{data:r,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!r.session)throw new gs;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const o={data:r.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(r){if(this._debug(i,"error",r),ne(r)){const a={data:null,error:r};return tx(r)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){r.push(l)}});if(await Promise.all(a),r.length>0){for(let o=0;o<r.length;o+=1)console.error(r[o]);throw r[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await pn(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await Ku(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const r=$N(i);await Ku(this.storage,this.storageKey,r)}else{const i=$N(t);await Ku(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await pn(this.storage,this.storageKey),await pn(this.storage,this.storageKey+"-code-verifier"),await pn(this.storage,this.storageKey+"-user"),this.userStorage&&await pn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&mn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Yu);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/Yu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Yu}ms, refresh threshold is ${eE} ticks`),i<=eE&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof PP)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!mn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,a]=await Mu(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(s!=null&&s.queryParams){const r=new URLSearchParams(s.queryParams);i.push(r.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;return r?this._returnResult({data:null,error:r}):await re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,i;const{data:r,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await re(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return this._returnResult({data:null,error:r});const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zq(e.webauthn.credential_response):Hq(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var s;const{data:i,error:r}=t;if(r)return this._returnResult({data:null,error:r});const a=await re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Bq(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Fq(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const i={all:[],phone:[],totp:[],webauthn:[]};for(const r of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])i.all.push(r),r.status==="verified"&&i[r.factor_type].push(r);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=nx(s.access_token);let a=null;r.aal&&(a=r.aal);let o=a;((t=(e=s.user.factors)===null||e===void 0?void 0:e.filter(d=>d.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(o="aal2");const c=r.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:i}=t;return i?this._returnResult({data:null,error:i}):s?await re(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new gs})})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:i},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!i)return this._returnResult({data:null,error:new gs});const a=await re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&mn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:i},error:r}=s;if(r)return this._returnResult({data:null,error:r});if(!i)return this._returnResult({data:null,error:new gs});const a=await re(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return a.data&&a.data.redirect_url&&mn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(a.data.redirect_url),a})}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;return s?this._returnResult({data:null,error:s}):t?await re(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new gs})})}catch(e){if(ne(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:s},error:i}=t;return i?this._returnResult({data:null,error:i}):s?(await re(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new gs})})}catch(t){if(ne(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+KG>i)return s;const{data:r,error:a}=await re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=i,s=r.keys.find(o=>o.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:y,error:v}=await this.getSession();if(v||!y.session)return this._returnResult({data:null,error:v});s=y.session.access_token}const{header:i,payload:r,signature:a,raw:{header:o,payload:l}}=nx(s);t!=null&&t.allowExpired||yq(r.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:y}=await this.getUser(s);if(y)throw y;return{data:{claims:r,header:i,signature:a},error:null}}const d=vq(i.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,iq(`${o}.${l}`)))throw new sE("Invalid JWT signature");return{data:{claims:r,header:i,signature:a},error:null}}catch(s){if(ne(s))return this._returnResult({data:null,error:s});throw s}}}sm.nextInstanceID={};class Xq extends sm{constructor(e){super(e)}}var Wq=function(n,e,t,s){function i(r){return r instanceof t?r:new t(function(a){a(r)})}return new(t||(t=Promise))(function(r,a){function o(d){try{c(s.next(d))}catch(h){a(h)}}function l(d){try{c(s.throw(d))}catch(h){a(h)}}function c(d){d.done?r(d.value):i(d.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const Qq={headers:UG},Zq={schema:"public"},eV={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tV={};class nV{constructor(e,t,s){var i,r,a,o,l,c,d,h;if(this.supabaseUrl=e,this.supabaseKey=t,this.from=E=>this.rest.from(E),this.schema=E=>this.rest.schema(E),this.rpc=(E,b={},w)=>this.rest.rpc(E,b,w),!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const p=jG(e);this.realtimeUrl=`${p}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${p}/auth/v1`,this.storageUrl=`${p}/storage/v1`,this.functionsUrl=`${p}/functions/v1`;const y=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,v={db:Zq,realtime:tV,auth:Object.assign(Object.assign({},eV),{storageKey:y}),global:Qq},_=GG(s??{},v);this.storageKey=(r=(i=_.auth)===null||i===void 0?void 0:i.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=(a=_.global)===null||a===void 0?void 0:a.headers)!==null&&o!==void 0?o:{},this.auth=this._initSupabaseAuthClient((l=_.auth)!==null&&l!==void 0?l:{},this.headers,(c=_.global)===null||c===void 0?void 0:c.fetch),this.fetch=HG(t,this._getAccessToken.bind(this),(d=_.global)===null||d===void 0?void 0:d.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},_.realtime)),this.rest=new Bj(`${p}/rest/v1`,{headers:this.headers,schema:(h=_.db)===null||h===void 0?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new mj(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new LG(this.storageUrl,this.headers,this.fetch)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Wq(this,void 0,void 0,function*(){const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,storageKey:r,flowType:a,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Xq({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:r,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:i,flowType:a,debug:o,fetch:c})}_initRealtimeClient(e){return new tG(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const sV=(n,e,t)=>new nV(n,e,t),iV="https://dnwczvokxloyzjnqqfbd.supabase.co",rV="sb_publishable_evp59khbQk9e0LE6YnjzxQ_4ByKuJaq",Sn=sV(iV,rV);var Y=(n=>(n.HOME="HOME",n.PROCESSING="PROCESSING",n.QUIZ="QUIZ",n.RESULT="RESULT",n.ERROR="ERROR",n.SERVICES="SERVICES",n.PROFILE="PROFILE",n.DEVAI="DEVAI",n.ABOUT="ABOUT",n))(Y||{});/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aV=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oV=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),ZN=n=>{const e=oV(n);return e.charAt(0).toUpperCase()+e.slice(1)},UP=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),lV=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uV=j.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:i="",children:r,iconNode:a,...o},l)=>j.createElement("svg",{ref:l,...cV,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:UP("lucide",i),...!r&&!lV(o)&&{"aria-hidden":"true"},...o},[...a.map(([c,d])=>j.createElement(c,d)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=(n,e)=>{const t=j.forwardRef(({className:s,...i},r)=>j.createElement(uV,{ref:r,iconNode:e,className:UP(`lucide-${aV(ZN(n))}`,`lucide-${n}`,s),...i}));return t.displayName=ZN(n),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dV=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],hV=q("activity",dV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fV=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],BP=q("arrow-left",fV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pV=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],mV=q("arrow-right",pV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],yV=q("arrow-up-down",gV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vV=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],bV=q("award",vV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _V=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],xV=q("bell",_V);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wV=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],SV=q("book-open",wV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EV=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],OA=q("brain-circuit",EV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AV=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],TV=q("briefcase",AV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CV=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],iE=q("building-2",CV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NV=[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]],FP=q("cake",NV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RV=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],rE=q("calculator",RV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kV=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],MV=q("calendar-days",kV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IV=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],e2=q("calendar",IV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DV=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],PV=q("chart-column",DV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LV=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],qv=q("chevron-left",LV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],UA=q("circle-alert",OV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Vv=q("circle-check",UV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],BA=q("circle-question-mark",BV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FV=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Wb=q("circle-user-round",FV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zV=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],HV=q("circle-x",zV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jV=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],FA=q("clock",jV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GV=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],qV=q("cloud-upload",GV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VV=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],zP=q("code-xml",VV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $V=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],aE=q("cpu",$V);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YV=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],HP=q("crown",YV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KV=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],JV=q("database",KV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XV=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],WV=q("facebook",XV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QV=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],jP=q("file-text",QV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZV=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Qb=q("graduation-cap",ZV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e$=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],t$=q("history",e$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n$=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Zb=q("house",n$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],GP=q("info",s$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i$=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],r$=q("languages",i$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a$=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],o$=q("layers",a$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l$=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],oE=q("library",l$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c$=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],u$=q("lightbulb",c$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d$=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],gu=q("loader-circle",d$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h$=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],zA=q("lock",h$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f$=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],qP=q("log-in",f$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p$=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],HA=q("log-out",p$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m$=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],g$=q("mail",m$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],v$=q("map-pin",y$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b$=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],VP=q("medal",b$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _$=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],x$=q("menu",_$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w$=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],lE=q("message-circle",w$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S$=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],$P=q("monitor",S$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E$=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],A$=q("palette",E$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T$=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],C$=q("panels-top-left",T$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N$=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],R$=q("pen",N$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k$=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],M$=q("percent",k$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I$=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],YP=q("plus",I$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D$=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],P$=q("puzzle",D$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L$=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],KP=q("refresh-cw",L$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O$=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],t2=q("repeat",O$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U$=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],B$=q("rocket",U$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F$=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],z$=q("save",F$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H$=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],j$=q("search",H$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G$=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],q$=q("send",G$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V$=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],$$=q("settings",V$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y$=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],hf=q("shield-alert",Y$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K$=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],J$=q("shield-check",K$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X$=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],JP=q("smartphone",X$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W$=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Cf=q("sparkles",W$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q$=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],jA=q("star",Q$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],e9=q("target",Z$);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],n9=q("trash-2",t9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],XP=q("triangle-alert",s9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],$v=q("trophy",i9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],a9=q("type",r9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],l9=q("user-plus",o9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]],u9=q("user-round",c9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],h9=q("user",d9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],WP=q("users",f9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],m9=q("wand-sparkles",p9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g9=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],e_=q("x",g9);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ff=q("zap",y9),v9=({onFileSelect:n,disabled:e})=>{const t=j.useRef(null),s=i=>{i.target.files&&i.target.files.length>0&&(n(i.target.files[0]),i.target.value="")};return g.jsx("div",{className:"flex justify-center w-full",children:g.jsxs("div",{className:`uiverse-upload-card ${e?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{var i;return!e&&((i=t.current)==null?void 0:i.click())},children:[g.jsx("input",{type:"file",accept:"application/pdf",className:"hidden",ref:t,onChange:s,disabled:e}),g.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-violet-500/20 to-fuchsia-500/20 text-violet-300 rounded-2xl flex items-center justify-center mb-4 border border-white/5 shadow-inner transition-transform duration-500",children:g.jsx(qV,{size:32,className:"drop-shadow-[0_0_10px_rgba(167,139,250,0.5)]"})}),g.jsx("h3",{className:"text-xl font-black text-white mb-2 tracking-tight transition-colors",children:"  PDF"}),g.jsx("p",{className:"text-slate-400 text-[10px] px-6 mb-6 leading-relaxed font-medium text-center",children:"         ."}),g.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-bold text-violet-300 bg-violet-500/10 border border-violet-500/20 px-3 py-1.5 rounded-full shadow-[0_0_15px_rgba(139,92,246,0.1)]",children:[g.jsx(Cf,{size:12}),g.jsx("span",{children:"  "})]})]})})},_t=({children:n,variant:e="primary",fullWidth:t=!1,className:s="",...i})=>{const r="px-6 py-3.5 rounded-xl font-bold transition-all duration-300 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 relative overflow-hidden",a={primary:"bg-gradient-to-r from-violet-600 via-purple-600 to-fuchsia-600 text-white shadow-[0_0_20px_rgba(139,92,246,0.3)] hover:shadow-[0_0_30px_rgba(139,92,246,0.5)] border border-white/10",secondary:"bg-white/5 hover:bg-white/10 text-white border border-white/10 hover:border-white/20 backdrop-blur-md",outline:"bg-transparent border border-white/20 text-slate-300 hover:text-white hover:border-violet-500 hover:shadow-[0_0_15px_rgba(139,92,246,0.2)]",danger:"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20"};return g.jsx("button",{className:`${r} ${a[e]} ${t?"w-full":""} ${s}`,...i,children:g.jsx("span",{className:"relative z-10 flex items-center gap-2",children:n})})},b9=({isOpen:n,onClose:e,onSuccess:t})=>{const[s,i]=j.useState("LOGIN"),[r,a]=j.useState(""),[o,l]=j.useState(""),[c,d]=j.useState(""),[h,p]=j.useState(!1),[y,v]=j.useState(""),[_,E]=j.useState(!1),[b,w]=j.useState(!1),[S,T]=j.useState(!1);if(!n)return null;const N=()=>{e(),setTimeout(()=>{i("LOGIN"),a(""),l(""),d(""),v(""),E(!1),p(!1),w(!1),T(!1)},300)},R=async I=>{if(I.preventDefault(),s!=="LOGIN"&&!b){v("     ");return}p(!0),v("");try{let M=null;if(s==="GUEST"){if(!c.trim())throw new Error("  ");const D=c.trim()==="2001",O=D?"":c,L={id:D?"admin-yazan-2001":"guest-"+Date.now(),email:D?"admin@idraak.ai":"guest@local",user_metadata:{full_name:O,role:D?"admin":"student",avatar:D?"Joshua":"Felix"},app_metadata:{provider:"guest"},aud:"authenticated",created_at:new Date().toISOString()};localStorage.setItem("guest_user",JSON.stringify(L)),M=L}else if(s==="LOGIN"){const D=await Sn.auth.signInWithPassword({email:r,password:o});if(D.error)throw D.error;M=D.data.user}else{if(!c.trim())throw new Error("   ");const D=await Sn.auth.signUp({email:r,password:o,options:{data:{full_name:c}}});if(D.error)throw D.error;M=D.data.user}M&&(E(!0),setTimeout(()=>{t(M),N()},1500))}catch(M){v(M.message||"   "),p(!1)}},k=()=>g.jsxs("div",{className:"absolute inset-0 bg-[#050505] z-50 p-8 flex flex-col",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[g.jsx("button",{onClick:()=>T(!1),className:"p-2 bg-white/5 rounded-full text-slate-400 hover:text-white transition-colors",children:g.jsx(BP,{size:18})}),g.jsx("h3",{className:"text-xl font-black text-white",children:" "})]}),g.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 text-slate-400 text-sm leading-relaxed space-y-4 text-right",dir:"rtl",children:[g.jsx("p",{className:"font-bold text-white text-lg",children:"   ."}),g.jsx("p",{children:"1.            ."}),g.jsx("p",{children:"2.   PDF                     ."}),g.jsx("p",{children:"3.        .             ."}),g.jsx("p",{children:"4.    Google Gemini         ."}),g.jsx("p",{children:"5.        ."})]}),g.jsx(_t,{onClick:()=>T(!1),className:"mt-6 shadow-lg shadow-emerald-500/10",children:" "})]});return g.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>!_&&N()}),g.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-8 relative border border-white/10 shadow-[0_0_50px_rgba(139,92,246,0.15)] min-h-[580px] flex flex-col justify-center overflow-hidden",children:[S&&k(),_?g.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-10",children:[g.jsx("div",{className:"w-24 h-24 bg-emerald-500/10 rounded-full flex items-center justify-center mb-6 border border-emerald-500/20 shadow-[0_0_30px_rgba(16,185,129,0.2)]",children:g.jsx(Vv,{className:"text-emerald-400 w-12 h-12"})}),g.jsx("h2",{className:"text-3xl font-black text-white mb-2 tracking-tight",children:" !"}),g.jsx("p",{className:"text-emerald-400 font-bold text-lg",children:"   "}),g.jsx("div",{className:"mt-8",children:g.jsx(gu,{className:"animate-spin text-slate-600"})})]}):g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:N,className:"absolute top-6 left-6 p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-full z-10 transition-all",children:g.jsx(e_,{size:20})}),g.jsxs("div",{className:"text-center mb-8",children:[g.jsxs("div",{className:"w-16 h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-violet-500/20 shadow-inner",children:[s==="LOGIN"&&g.jsx(qP,{className:"text-violet-400",size:32}),s==="SIGNUP"&&g.jsx(l9,{className:"text-violet-400",size:32}),s==="GUEST"&&g.jsx(Wb,{className:"text-violet-400",size:32})]}),g.jsx("h2",{className:"text-2xl font-black text-white mb-2 tracking-tight",children:s==="LOGIN"?" ":s==="SIGNUP"?"  ":" "}),g.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"    "})]}),g.jsxs("div",{className:"flex p-1 bg-white/5 rounded-2xl mb-8 relative z-10 border border-white/5 shadow-inner",children:[g.jsx("button",{onClick:()=>{i("LOGIN"),v("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${s==="LOGIN"||s==="SIGNUP"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""}),g.jsx("button",{onClick:()=>{i("GUEST"),v("")},className:`flex-1 py-3 text-sm font-black rounded-xl transition-all ${s==="GUEST"?"bg-violet-600 text-white shadow-lg shadow-violet-600/20":"text-slate-500 hover:text-white"}`,children:""})]}),y&&g.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-2xl flex items-start gap-3 animate-lux-up",children:[g.jsx(UA,{className:"text-red-400 shrink-0 mt-0.5",size:18}),g.jsx("p",{className:"text-red-300 text-sm font-bold leading-tight",children:y})]}),g.jsxs("form",{onSubmit:R,className:"space-y-5 flex-1 flex flex-col",children:[s==="GUEST"&&g.jsxs("div",{className:"bg-amber-500/5 border border-amber-500/10 p-4 rounded-2xl mb-2 flex items-start gap-3 text-right",children:[g.jsx(hf,{size:20,className:"text-amber-500 shrink-0 mt-0.5"}),g.jsxs("p",{className:"text-amber-200/80 text-[11px] leading-relaxed font-medium",children:[g.jsx("span",{className:"font-black text-amber-300 block mb-0.5",children:" :"}),"         .     ."]})]}),(s==="SIGNUP"||s==="GUEST")&&g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:s==="GUEST"?"   ":" "}),g.jsxs("div",{className:"relative",children:[g.jsx(h9,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),g.jsx("input",{type:"text",required:!0,value:c,onChange:I=>d(I.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:s==="GUEST"?"   ":" "})]})]}),s!=="GUEST"&&g.jsxs(g.Fragment,{children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),g.jsxs("div",{className:"relative",children:[g.jsx(g$,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),g.jsx("input",{type:"email",required:!0,value:r,onChange:I=>a(I.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:"name@example.com"})]})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx("label",{className:"text-[11px] font-black text-slate-500 uppercase tracking-widest block mr-1",children:" "}),g.jsxs("div",{className:"relative",children:[g.jsx(zA,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:18}),g.jsx("input",{type:"password",required:!0,minLength:6,value:o,onChange:I=>l(I.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-3.5 pr-12 pl-4 text-white focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700 font-bold",placeholder:""})]})]})]}),s!=="LOGIN"&&g.jsxs("div",{className:"flex items-start gap-3 mt-2 py-2 px-1",children:[g.jsx("input",{type:"checkbox",checked:b,onChange:I=>w(I.target.checked),className:"mt-1 w-5 h-5 rounded-lg border-white/10 accent-emerald-500 cursor-pointer transition-all"}),g.jsxs("label",{className:"text-xs text-slate-500 font-bold text-right leading-relaxed select-none",children:["  ",g.jsx("button",{type:"button",onClick:()=>T(!0),className:"text-emerald-400 underline hover:text-emerald-300 transition-colors",children:"   "}),"   ."]})]}),g.jsxs("div",{className:"mt-auto pt-4",children:[g.jsx(_t,{type:"submit",fullWidth:!0,disabled:h,className:"py-4 shadow-xl",children:h?g.jsxs("span",{className:"animate-pulse flex items-center gap-2",children:[g.jsx(gu,{className:"animate-spin",size:18}),"  ..."]}):s==="LOGIN"?"":" "}),s==="LOGIN"&&g.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),v("")},className:"w-full text-center mt-6 text-emerald-400 hover:text-emerald-300 transition-all font-black text-lg md:text-xl underline decoration-emerald-800 underline-offset-8 decoration-2",children:"      "}),s==="SIGNUP"&&g.jsx("button",{type:"button",onClick:()=>{i("LOGIN"),v("")},className:"w-full text-center mt-6 text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"      "}),s==="GUEST"&&g.jsx("button",{type:"button",onClick:()=>{i("SIGNUP"),v("")},className:"w-full text-center mt-6 text-xs font-bold text-slate-500 hover:text-emerald-400 transition-colors",children:"      "})]})]})]})]})]})},_9=()=>{const[n,e]=j.useState([]),[t,s]=j.useState(!0),[i,r]=j.useState(null),[a,o]=j.useState(null);j.useEffect(()=>{l();let y;try{y=Sn.channel("leaderboard-realtime").on("postgres_changes",{event:"*",schema:"public",table:"quiz_history"},()=>{l()}).subscribe()}catch{console.warn("Realtime subscription failed, falling back to manual fetch only.")}return()=>{y&&Sn.removeChannel(y)}},[]);const l=async()=>{try{o(null);const{data:y,error:v}=await Sn.from("quiz_history").select("*").order("created_at",{ascending:!1});if(v)throw v;if(!y){e([]);return}const _=new Map;y.forEach(b=>{const w=(b.score||0)*10,S=b.score||0,T=b.total_questions||10,N=b.player_name||" ",R=b.player_avatar||"Felix",k=b.player_university,I=b.player_major,M=b.player_age;if(_.has(b.user_id)){const D=_.get(b.user_id);_.set(b.user_id,{...D,exp:D.exp+w,quizCount:D.quizCount+1,rawScoreSum:D.rawScoreSum+S,maxScoreSum:D.maxScoreSum+T})}else _.set(b.user_id,{name:N,avatar:R,exp:w,quizCount:1,rawScoreSum:S,maxScoreSum:T,university:k,major:I,age:M})});const E=Array.from(_.entries()).map(([b,w])=>{const S=w.maxScoreSum>0?Math.round(w.rawScoreSum/w.maxScoreSum*100):0;return{userId:b,name:w.name,avatar:w.avatar,totalExp:w.exp,totalQuizzes:w.quizCount,averageScore:S,university:w.university,major:w.major,age:w.age,rank:0}}).sort((b,w)=>w.totalExp-b.totalExp).slice(0,10).map((b,w)=>({...b,rank:w+1}));e(E)}catch(y){console.error("Leaderboard fetch error:",y),o(y.message==="Failed to fetch"?"  .     .":"     .")}finally{s(!1)}},c=y=>{switch(y){case 1:return"bg-gradient-to-r from-black via-[#0a0a0a] to-[#453a15] border-[#d4af37]/20 shadow-[0_0_20px_rgba(0,0,0,0.5)]";case 2:return"bg-gradient-to-r from-[#0a0a0a] via-[#150a1c] to-[#420a15] border-[#c31432]/20 shadow-lg";case 3:return"bg-gradient-to-r from-[#030712] via-[#051125] to-[#3a3324] border-[#a89166]/20 shadow-lg";default:return"bg-gradient-to-r from-[#18181b] via-[#27272a] to-[#3f3f46] border-white/5 opacity-80 hover:opacity-100 transition-opacity"}},d=y=>["  "," "," "," "," ","  "," "," "," "," "][y-1]||" ",h=y=>["   !    ."," !      .","   !    .","     .  !"," !      .","  !      .","   .   !","    .    .","     .  !","   .    !"][y-1]||"    !",p=y=>y===1?g.jsx(HP,{size:28,className:"text-yellow-400/80 drop-shadow-[0_0_8px_rgba(250,204,21,0.6)] animate-bounce"}):y===2?g.jsx(jA,{size:24,className:"text-fuchsia-400/80 drop-shadow-[0_0_6px_rgba(192,38,211,0.5)]"}):y===3?g.jsx(VP,{size:24,className:"text-amber-500/80 drop-shadow-[0_0_6px_rgba(245,158,11,0.5)]"}):g.jsxs("span",{className:`text-lg font-black font-mono ${y<=5?"text-white/80":"text-slate-600"}`,children:["#",y]});return g.jsxs("div",{className:"w-full max-w-4xl mx-auto mt-2 mb-10 px-4",children:[g.jsxs("div",{className:"text-center mb-10 animate-lux-up",children:[g.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-gradient-to-br from-yellow-500/10 to-amber-600/10 text-yellow-500/70 mb-4 border border-yellow-500/20 shadow-[0_0_20px_rgba(234,179,8,0.1)]",children:g.jsx($v,{size:32})}),g.jsx("h2",{className:"text-3xl md:text-4xl font-black text-white mb-3",children:" "})]}),t?g.jsx("div",{className:"flex justify-center py-10",children:g.jsx(gu,{className:"animate-spin text-violet-500/50",size:32})}):a?g.jsxs("div",{className:"text-center py-8 bg-red-500/5 border border-red-500/10 rounded-3xl",children:[g.jsx("p",{className:"text-red-400 font-bold mb-4",children:a}),g.jsxs("button",{onClick:()=>{s(!0),l()},className:"flex items-center gap-2 mx-auto text-xs font-black text-slate-400 hover:text-white uppercase tracking-widest bg-white/5 px-4 py-2 rounded-xl transition-all",children:[g.jsx(KP,{size:14}),"  "]})]}):g.jsx("div",{className:"grid gap-4",children:n.map((y,v)=>g.jsxs("div",{onClick:()=>r(y),className:`relative flex items-center justify-between p-4 md:p-5 rounded-[1.8rem] md:rounded-[2.2rem] border transition-all duration-700 group hover:scale-[1.01] cursor-pointer ${c(y.rank)} animate-lux-up`,style:{animationDelay:`${v*.08}s`},children:[g.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[g.jsx("div",{className:"w-10 flex justify-center shrink-0",children:p(y.rank)}),g.jsx("div",{className:"relative",children:g.jsx("div",{className:`w-14 h-14 md:w-16 md:h-16 rounded-full border overflow-hidden bg-black/60 ${y.rank===1?"border-yellow-400/20 ring-4 ring-yellow-400/5":"border-white/5"}`,children:g.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${y.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:y.name,className:"w-full h-full object-cover opacity-90"})})}),g.jsxs("div",{children:[g.jsx("h3",{className:`font-black text-base md:text-lg tracking-tight ${y.rank<=5?"text-white/90":"text-slate-400"}`,children:y.name}),g.jsx("p",{className:`text-[10px] font-black uppercase tracking-widest ${y.rank===1?"text-yellow-500/60":"text-slate-500"}`,children:d(y.rank)})]})]}),g.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[g.jsxs("div",{className:"flex items-center gap-1.5",children:[g.jsx("span",{className:`text-xl md:text-2xl font-black font-mono leading-none ${y.rank===1?"text-yellow-500/80":"text-white/80"}`,children:y.totalExp}),g.jsx(OA,{size:14,className:"text-slate-600"})]}),g.jsx("span",{className:"text-[8px] font-black uppercase tracking-tighter text-slate-700",children:" "})]})]},y.userId))}),i&&b2.createPortal(g.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-3xl",onClick:()=>r(null)}),g.jsxs("div",{className:`glass-panel w-[90%] sm:w-full max-w-md rounded-[3rem] relative animate-lux-scale border border-white/10 shadow-[0_0_80px_rgba(0,0,0,1)] overflow-hidden ${c(i.rank)}`,children:[g.jsx("button",{onClick:()=>r(null),className:"absolute top-6 right-6 w-9 h-9 flex items-center justify-center bg-red-500/20 text-red-400 border border-red-500/30 hover:bg-red-500/30 hover:text-red-300 rounded-full transition-all z-20",children:g.jsx(e_,{size:22})}),g.jsx("div",{className:"p-8 md:p-10 flex flex-col items-center text-center relative z-10",children:(()=>{const y={1:"text-yellow-400",2:"text-fuchsia-400",3:"text-amber-500"},v=y[i.rank]||"text-white/80",_=y[i.rank]?y[i.rank].replace("400","300"):"text-white/70";return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"w-32 h-32 rounded-full border-2 shadow-2xl mb-6 overflow-hidden bg-black/80",children:g.jsx("img",{src:`https://api.dicebear.com/9.x/notionists/svg?seed=${i.avatar||"default"}&backgroundColor=b6e3f4,c0aede,d1d4f9`,alt:i.name,className:"w-full h-full object-cover opacity-90"})}),g.jsx("h3",{className:"text-3xl font-black text-white/90 mb-1 tracking-tight",children:i.name}),g.jsx("p",{className:"text-sm font-black text-white/40 mb-8",children:d(i.rank)}),g.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full mb-8 text-center",children:[g.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[g.jsx("span",{className:`text-3xl font-black ${v}`,children:i.totalQuizzes}),g.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]}),g.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-[2rem] p-6 border border-white/5 flex flex-col items-center",children:[g.jsxs("span",{className:`text-3xl font-black ${v}`,children:[i.averageScore,"%"]}),g.jsx("span",{className:"text-[10px] text-white/30 font-bold uppercase tracking-widest",children:" "})]})]}),g.jsxs("div",{className:"w-full space-y-3 mb-8",children:[g.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[g.jsx(iE,{size:20,className:"text-slate-500 shrink-0"}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:`text-sm font-bold ${_}`,children:i.university||" "})]})]}),g.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[g.jsx(oE,{size:20,className:"text-slate-500 shrink-0"}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:`text-sm font-bold ${_}`,children:i.major||" "})]})]}),g.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl bg-black/20 border border-white/5",children:[g.jsx(FP,{size:20,className:"text-slate-500 shrink-0"}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:`text-sm font-bold ${_}`,children:i.age||" "})]})]})]}),g.jsx("div",{className:"w-full text-center px-4 py-4 rounded-2xl bg-black/20 border border-white/5",children:g.jsxs("p",{className:"text-xs italic text-slate-400",children:['"',h(i.rank),'"']})})]})})()})]})]}),document.body)]})},x9=()=>{const[n,e]=j.useState({quizzes:0,students:125,loading:!0});j.useEffect(()=>{(async()=>{try{const{count:r,error:a}=await Sn.from("quiz_history").select("*",{count:"exact",head:!0}),{data:o,error:l}=await Sn.from("quiz_history").select("user_id");if(a||l)throw new Error("Error fetching stats");const c=new Set(o==null?void 0:o.map(d=>d.user_id)).size;e({quizzes:r||0,students:125+c,loading:!1})}catch(r){console.error("Failed to fetch live stats:",r),e(a=>({...a,loading:!1}))}})()},[]);const t=[{label:"  ",value:n.loading?"...":`+${n.quizzes.toLocaleString()}`,icon:g.jsx(ff,{size:20}),color:"text-amber-400",bg:"bg-amber-500/10"},{label:" ",value:n.loading?"...":`+${n.students.toLocaleString()}`,icon:g.jsx(WP,{size:20}),color:"text-violet-400",bg:"bg-violet-500/10"},{label:" ",value:"99.2%",icon:g.jsx(J$,{size:20}),color:"text-emerald-400",bg:"bg-emerald-500/10"}],s=[{title:"  ",desc:"   Gemini        .",icon:g.jsx(Cf,{className:"text-violet-400"})},{title:"  ",desc:"   10   100      .",icon:g.jsx(SV,{className:"text-blue-400"})},{title:"  ",desc:"            .",icon:g.jsx(PV,{className:"text-fuchsia-400"})}];return g.jsxs("div",{className:"w-full max-w-5xl mx-auto mt-16 mb-24 px-4",children:[g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-16",children:t.map((i,r)=>g.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] border border-white/5 flex items-center gap-5 hover:border-white/10 transition-all animate-lux-up",style:{animationDelay:`${r*.1}s`},children:[g.jsx("div",{className:`w-12 h-12 rounded-2xl ${i.bg} ${i.color} flex items-center justify-center shrink-0`,children:n.loading&&r<2?g.jsx(gu,{size:18,className:"animate-spin"}):i.icon}),g.jsxs("div",{children:[g.jsx("p",{className:"text-2xl font-black text-white leading-none mb-1",children:i.value}),g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:i.label})]})]},r))}),g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-600/5 blur-[100px] rounded-full pointer-events-none"}),g.jsxs("div",{className:"text-center mb-12 animate-lux-up",children:[g.jsx("h2",{className:"text-3xl font-black text-white mb-3",children:"   "}),g.jsx("div",{className:"h-1 w-20 bg-gradient-to-r from-violet-600 to-fuchsia-600 mx-auto rounded-full"})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative z-10",children:s.map((i,r)=>g.jsxs("div",{className:"group glass-panel p-8 rounded-[2.5rem] border border-white/5 hover:border-violet-500/30 transition-all animate-lux-up",style:{animationDelay:`${(r+3)*.1}s`},children:[g.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-6 group-hover:scale-110 group-hover:bg-violet-500/10 transition-all duration-500",children:mf.cloneElement(i.icon,{size:28})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-3 group-hover:text-violet-300 transition-colors",children:i.title}),g.jsx("p",{className:"text-sm text-slate-500 leading-relaxed font-medium",children:i.desc})]},r))})]}),g.jsx("div",{className:"mt-16 glass-panel p-1 border-white/5 rounded-[2rem] overflow-hidden animate-lux-up",style:{animationDelay:"0.8s"},children:g.jsxs("div",{className:"bg-gradient-to-r from-violet-900/20 via-black to-fuchsia-900/20 p-8 rounded-[1.9rem] flex flex-col items-center text-center",children:[g.jsx(jA,{className:"text-yellow-500/50 mb-4 animate-pulse",size:32,fill:"currentColor"}),g.jsx("p",{className:"text-xl md:text-2xl font-medium text-slate-300 italic leading-relaxed",children:'"      ."'}),g.jsx("p",{className:"mt-4 text-xs font-black text-violet-400 uppercase tracking-widest",children:"  "})]})})]})},w9=({onNavigate:n,onLogActivity:e})=>{const[t,s]=j.useState("selection");j.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[t]);const[i,r]=j.useState(""),[a,o]=j.useState(""),[l,c]=j.useState(""),[d,h]=j.useState(null),[p,y]=j.useState(""),[v,_]=j.useState("100to4"),[E,b]=j.useState(null),[w,S]=j.useState(""),[T,N]=j.useState(""),[R,k]=j.useState([{id:"1",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"2",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"3",grade:"",hours:"3",isRepeated:!1,isExcluded:!1},{id:"4",grade:"",hours:"3",isRepeated:!1,isExcluded:!1}]),[I,M]=j.useState(null),D=()=>{k([...R,{id:Date.now().toString(),grade:"",hours:"3",isRepeated:!1,isExcluded:!1}])},O=U=>{R.length>1&&k(R.filter(K=>K.id!==U))},L=(U,K)=>{k(R.map(se=>se.id===U?{...se,...K}:se))},$=()=>{const U=parseFloat(i),K=parseFloat(a),se=parseFloat(l);if(isNaN(U)||isNaN(K)||isNaN(se)){h({type:"error",message:"    "});return}const le=U*.45+K*.1,he=(se-le)/.45;he<0?h({type:"error",message:"    "}):(h({type:"success",message:"   :",value:he.toFixed(2)}),e==null||e("  "))},G=()=>{const U=parseFloat(p);if(isNaN(U)){b(null);return}if(v==="100to4"){if(U>100||U<0){b({type:"error",message:"     0  100"});return}let K="0.00",se="";U>=97?(K="4.00",se=" "):U>=50&&(K=(2.14+(U-50)*.04).toFixed(2),U>=90?se="":U>=80?se=" ":U>=70?se="":U>=60?se="":se=""),b({type:"success",message:"  4.00 :",value:K,label:se}),e==null||e("  (100  4)")}else{if(U>4||U<0){b({type:"error",message:"     0.00  4.00"});return}let K="< 50",se="";if(U>=4)K="97",se=" ";else if(U>=2.14){const le=Math.min(96,Math.round((U-2.14)/.04+50));K=le.toString(),le>=90?se="":le>=80?se=" ":le>=70?se="":le>=60?se="":se=""}b({type:"success",message:"  :",value:K,label:se}),e==null||e("  (4  100)")}},ee=()=>{let U=(parseFloat(w)||0)*(parseFloat(T)||0),K=parseFloat(T)||0;R.forEach(se=>{const le=parseFloat(se.grade),he=parseFloat(se.hours),Je=parseFloat(se.oldGrade||"");isNaN(le)||isNaN(he)||he<=0||se.isExcluded||le<60||(se.isRepeated?(!isNaN(Je)&&Je>=60&&(U-=Je*he),U+=le*he,(isNaN(Je)||Je<60)&&(K+=he)):(U+=le*he,K+=he))}),M({gpa:K>0?(U/K).toFixed(2):"0.00",hours:K}),e==null||e("  ")},P=()=>{const U=()=>{switch(t){case"final_calc":return"  ";case"gpa_calc":return" ";case"cumulative_gpa_100":return" ";default:return""}};return g.jsxs("div",{className:"flex items-center gap-2 mb-4 sm:mb-6 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[g.jsxs("button",{onClick:()=>n(Y.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[g.jsx(Zb,{size:14})," "]}),g.jsx(qv,{size:12,className:"shrink-0 opacity-40"}),g.jsx("button",{onClick:()=>s("selection"),className:`hover:text-white transition-colors ${t==="selection"?"text-violet-400":""}`,children:" "}),t!=="selection"&&g.jsxs(g.Fragment,{children:[g.jsx(qv,{size:12,className:"shrink-0 opacity-40"}),g.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:U()})]})]})},F=()=>g.jsxs("div",{className:"animate-fade-in space-y-10",children:[g.jsxs("div",{className:"text-center mb-12",children:[g.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-2xl bg-violet-500/10 text-violet-400 mb-6 border border-violet-500/20 shadow-xl",children:g.jsx(ff,{size:32})}),g.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white mb-4 tracking-tight",children:"  "}),g.jsx("p",{className:"text-slate-500 text-sm max-w-xl mx-auto font-medium",children:"        ."})]}),g.jsx("div",{className:"max-w-5xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"final_calc",title:"  ",desc:"    .",icon:g.jsx(rE,{}),color:"violet",view:"final_calc"},{id:"gpa_calc",title:"  ",desc:"   100%  4.0.",icon:g.jsx(yV,{}),color:"emerald",view:"gpa_calc"},{id:"cumulative_gpa_100",title:"  ",desc:"    .",icon:g.jsx(M$,{}),color:"blue",view:"cumulative_gpa_100"}].map(U=>g.jsxs("div",{onClick:()=>s(U.view),className:"glass-panel group p-6 rounded-[2rem] bg-[#080808] border border-white/5 hover:border-white/20 cursor-pointer transition-all flex flex-col items-center text-center h-full",children:[g.jsx("div",{className:`w-12 h-12 bg-${U.color}-500/10 rounded-xl flex items-center justify-center text-${U.color}-400 mb-4 group-hover:scale-110 transition-transform`,children:mf.cloneElement(U.icon,{size:24})}),g.jsx("h3",{className:"text-sm font-bold text-white mb-2 leading-tight px-2",children:U.title}),g.jsx("p",{className:"text-slate-500 text-[10px] leading-relaxed mb-5",children:U.desc}),g.jsxs("div",{className:"mt-auto w-full flex items-center justify-center gap-2 py-2.5 rounded-xl bg-white/5 group-hover:bg-white/10 transition-all text-[10px] font-black uppercase tracking-widest text-slate-400",children:["  ",g.jsx(mV,{size:14})]})]},U.id))})]}),H=()=>g.jsxs("div",{className:"animate-fade-in space-y-6",children:[g.jsx("div",{className:"flex items-center justify-between mb-4",children:g.jsx("div",{className:"text-[9px] font-black text-blue-400 uppercase tracking-[0.2em] bg-blue-500/5 px-3 py-1 rounded-full border border-blue-500/10",children:"   (100%)"})}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start text-right",children:[g.jsx("div",{className:"lg:col-span-7",children:g.jsxs("div",{className:"glass-panel p-6 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl relative overflow-hidden space-y-8",children:[g.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-600 to-indigo-600"}),g.jsxs("div",{children:[g.jsxs("h3",{className:"text-base font-bold text-white mb-2 flex items-center gap-2 justify-end",children:["  ",g.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-black/20 p-4 rounded-2xl border border-white/5",children:[g.jsxs("div",{className:"space-y-1",children:[g.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:"  "}),g.jsx("input",{type:"number",step:"0.01",value:w,onChange:U=>S(U.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"85.50"})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("label",{className:"text-[10px] font-bold text-slate-400 mr-1 block",children:" "}),g.jsx("input",{type:"number",value:T,onChange:U=>N(U.target.value),className:"w-full bg-white/[0.03] border border-white/10 rounded-xl py-3 px-4 text-white font-bold text-sm text-right focus:border-blue-500 outline-none",placeholder:"60"})]})]})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("button",{onClick:D,className:"p-2 bg-blue-500/10 text-blue-400 rounded-lg border border-blue-500/20 hover:bg-blue-500/20",children:g.jsx(YP,{size:16})}),g.jsxs("h3",{className:"text-base font-bold text-white flex items-center gap-2",children:["   ",g.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/10 text-blue-400 rounded-full",children:""})]})]}),R.map(U=>g.jsxs("div",{className:"p-4 rounded-2xl bg-white/[0.02] border border-white/5 space-y-4 transition-all",children:[g.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[g.jsxs("div",{className:"col-span-2",children:[g.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),g.jsxs("div",{className:"relative",children:[g.jsx(Qb,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),g.jsx("input",{type:"number",value:U.grade,onChange:K=>L(U.id,{grade:K.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:" 100"})]})]}),g.jsxs("div",{className:"col-span-2",children:[g.jsx("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right",children:""}),g.jsxs("div",{className:"relative",children:[g.jsx(FA,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),g.jsx("input",{type:"number",value:U.hours,onChange:K=>L(U.id,{hours:K.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"3"})]})]}),g.jsx("div",{className:"col-span-1 flex items-end",children:g.jsx("button",{onClick:()=>O(U.id),className:"w-full h-10 text-red-500/40 hover:text-red-500 flex justify-center items-center bg-black/40 border border-white/5 rounded-lg",children:g.jsx(n9,{size:16})})})]}),U.isRepeated&&g.jsxs("div",{className:"pt-3 border-t border-white/10 animate-fade-in",children:[g.jsxs("label",{className:"text-[10px] font-bold text-amber-400 block mb-1 text-right flex items-center gap-1.5 justify-end",children:[g.jsx(t2,{size:12}),"  "]}),g.jsxs("div",{className:"relative",children:[g.jsx(t2,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500"}),g.jsx("input",{type:"number",value:U.oldGrade||"",onChange:K=>L(U.id,{oldGrade:K.target.value}),className:"w-full bg-black/40 border border-amber-500/20 rounded-lg py-2.5 pr-9 text-white text-xs text-right",placeholder:"  "})]})]}),g.jsxs("div",{className:"flex justify-end gap-4 pt-3 border-t border-white/5",children:[g.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["  ",g.jsx("input",{type:"checkbox",checked:U.isRepeated,onChange:K=>L(U.id,{isRepeated:K.target.checked,oldGrade:""}),className:"w-4 h-4 accent-amber-500"})]}),g.jsxs("label",{className:"flex items-center gap-2 text-[10px] text-slate-400 font-bold cursor-pointer",children:["   ",g.jsx("input",{type:"checkbox",checked:U.isExcluded,onChange:K=>L(U.id,{isExcluded:K.target.checked}),className:"w-4 h-4 accent-slate-500"})]})]})]},U.id))]}),g.jsx(_t,{onClick:ee,fullWidth:!0,className:"!bg-blue-600 hover:!bg-blue-500 shadow-xl shadow-blue-900/30 !py-4",children:" "}),I&&g.jsxs("div",{className:"p-6 rounded-3xl bg-emerald-500/5 border border-emerald-500/10 text-center animate-fade-in",children:[g.jsx("p",{className:"text-[10px] font-bold text-emerald-400/60 mb-1 uppercase tracking-widest",children:"  "}),g.jsx("p",{className:"text-5xl font-black text-white italic",children:I.gpa}),g.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["  : ",g.jsx("span",{className:"font-bold text-white",children:I.hours})]})]})]})}),g.jsxs("div",{className:"lg:col-span-5 space-y-6",children:[g.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[g.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[g.jsx(GP,{size:18,className:"text-blue-400"}),"   "]}),g.jsxs("div",{className:"space-y-4 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[g.jsxs("p",{children:[g.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         ."]}),g.jsxs("p",{children:[g.jsx("strong",{className:"font-black text-blue-300",children:":"}),"         (    )."]}),g.jsxs("p",{children:[g.jsx("strong",{className:"font-black text-blue-300",children:":"}),"     .      ."]})]})]}),g.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-white/[0.02] border border-white/5",children:[g.jsxs("h3",{className:"text-base font-bold text-white mb-4 flex items-center gap-3 justify-end",children:[g.jsx(BA,{size:18,className:"text-amber-400"}),"  "]}),g.jsxs("div",{className:"space-y-3 text-xs text-slate-400 leading-relaxed border-t border-white/5 pt-4",children:[g.jsxs("p",{children:[g.jsx("strong",{className:"font-black text-amber-300",children:" :"}),"                  ."]}),g.jsxs("p",{children:[g.jsx("strong",{className:"font-black text-amber-300",children:"  :"}),"           ."]})]})]})]})]})]});return g.jsx("div",{className:"min-h-screen pt-20 sm:pt-28 pb-20 relative z-10 px-4",children:g.jsxs("div",{className:"max-w-6xl mx-auto",children:[g.jsx(P,{}),t==="selection"&&F(),t==="final_calc"&&g.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:g.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[g.jsx("h3",{className:"text-xl font-black text-white",children:"  "}),g.jsx("input",{type:"number",value:i,onChange:U=>r(U.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),g.jsx("input",{type:"number",value:a,onChange:U=>o(U.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"  (100)"}),g.jsx("input",{type:"number",value:l,onChange:U=>c(U.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-3 text-white text-right",placeholder:"   "}),g.jsx(_t,{onClick:$,fullWidth:!0,children:" "}),d&&g.jsxs("div",{className:"p-4 bg-white/5 rounded-2xl text-center",children:[g.jsx("p",{className:"text-xs text-slate-400",children:d.message}),g.jsx("p",{className:"text-3xl font-black text-white mt-1",children:d.value})]})]})}),t==="gpa_calc"&&g.jsx("div",{className:"animate-fade-in max-w-lg mx-auto space-y-6",children:g.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#080808] border border-white/10 shadow-2xl space-y-6 text-right",children:[g.jsxs("div",{className:"flex bg-white/5 p-1 rounded-xl",children:[g.jsx("button",{onClick:()=>_("100to4"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${v==="100to4"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"100  4"}),g.jsx("button",{onClick:()=>_("4to100"),className:`flex-1 py-2 rounded-lg text-xs font-bold ${v==="4to100"?"bg-emerald-600 text-white":"text-slate-500"}`,children:"4  100"})]}),g.jsx("input",{type:"number",step:"0.01",value:p,onChange:U=>y(U.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white text-right font-bold",placeholder:v==="100to4"?"  100":"  4.00"}),g.jsx(_t,{onClick:G,fullWidth:!0,className:"!bg-emerald-600",children:""}),E&&(E.type==="error"?g.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-xl text-center text-red-400 text-xs font-bold",children:E.message}):g.jsxs("div",{className:"p-6 bg-emerald-500/5 border border-emerald-500/10 rounded-3xl text-center",children:[g.jsx("p",{className:"text-xs text-emerald-500/60 mb-1",children:E.message}),g.jsx("p",{className:"text-5xl font-black text-white italic",children:E.value}),g.jsx("p",{className:"text-[10px] font-black text-emerald-400 mt-2 uppercase tracking-widest",children:E.label})]})),g.jsxs("div",{className:"pt-4 border-t border-white/5 grid grid-cols-2 gap-2 text-[9px] text-slate-600 text-center",children:[g.jsx("span",{children:"90+:  (3.74+)"}),g.jsx("span",{children:"80-89:   (3.34+)"}),g.jsx("span",{children:"70-79:  (2.94+)"}),g.jsx("span",{children:"60-69:  (2.54+)"})]})]})}),t==="cumulative_gpa_100"&&H()]})})},J0=()=>{const[n,e]=j.useState(!1),t=j.useRef(null);return j.useEffect(()=>{const s=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),s.unobserve(i.target))},{threshold:.1,rootMargin:"0px 0px -50px 0px"});return t.current&&s.observe(t.current),()=>{t.current&&s.unobserve(t.current)}},[]),{ref:t,isVisible:n}},S9=({onNavigate:n})=>{const e=J0(),t=J0(),s=J0(),i=J0(),r=()=>g.jsxs("div",{className:"flex items-center gap-2 mb-8 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[g.jsxs("button",{onClick:()=>n(Y.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[g.jsx(Zb,{size:14})," "]}),g.jsx(qv,{size:12,className:"shrink-0 opacity-40"}),g.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return g.jsxs("div",{className:"min-h-screen pt-20 sm:pt-28 pb-32 px-4 relative z-10 bg-[#000000] text-right overflow-x-hidden",dir:"rtl",children:[g.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none",children:[g.jsx("div",{className:"absolute top-[-10%] left-[20%] w-[80vw] h-[80vw] bg-violet-600/10 rounded-full blur-[120px]"}),g.jsx("div",{className:"absolute bottom-[-5%] right-[-10%] w-[60vw] h-[60vw] bg-fuchsia-600/10 rounded-full blur-[100px]"})]}),g.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8 animate-lux-up",children:[g.jsx(r,{}),g.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-4 py-2 rounded-full bg-[#0f172a]/50 border border-violet-500/20 shadow-[0_0_20px_rgba(139,92,246,0.15)] backdrop-blur-xl",children:[g.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-500 animate-pulse"}),g.jsx("span",{className:"text-[9px] sm:text-[11px] font-black text-violet-100 tracking-widest",children:" "})]})]}),g.jsxs("div",{ref:e.ref,className:`grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-24 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[g.jsxs("div",{className:"text-right space-y-6 sm:space-y-8",children:[g.jsx("div",{className:"space-y-4",children:g.jsxs("h1",{className:"text-4xl sm:text-6xl md:text-8xl font-black text-white leading-tight tracking-tighter",children:[" ",g.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-blue-400",children:""})," ",g.jsx("br",{})," ."]})}),g.jsxs("p",{className:"text-slate-400 text-base sm:text-lg md:text-xl leading-relaxed max-w-xl font-medium",children:[" ",g.jsx("span",{className:"text-white font-bold italic",children:" "}),"   ",g.jsx("span",{className:"text-violet-400 font-bold",children:"  "}),".            ."]}),g.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[g.jsxs("a",{href:"https://wa.me/962790000000",target:"_blank",className:"px-8 py-4 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-2xl text-white font-black flex items-center justify-center gap-3 hover:shadow-[0_0_30px_rgba(139,92,246,0.4)] transition-all transform hover:-translate-y-1 active:scale-95 text-sm sm:text-base",children:[g.jsx(lE,{size:20}),"  "]}),g.jsx("button",{className:"px-8 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:" "})]})]}),g.jsx("div",{className:"relative order-first lg:order-last overflow-hidden sm:overflow-visible",children:g.jsxs("div",{className:"relative aspect-square w-full max-w-[280px] sm:max-w-lg mx-auto flex items-center justify-center",children:[g.jsx("div",{className:"absolute w-24 h-24 sm:w-32 sm:h-32 bg-violet-600/20 rounded-full blur-[40px] sm:blur-[60px] animate-pulse"}),g.jsxs("svg",{viewBox:"0 0 200 200",className:"w-full h-full relative z-10 overflow-visible",children:[g.jsx("defs",{children:g.jsxs("radialGradient",{id:"grad1",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",children:[g.jsx("stop",{offset:"0%",style:{stopColor:"#8b5cf6",stopOpacity:.4}}),g.jsx("stop",{offset:"100%",style:{stopColor:"transparent",stopOpacity:0}})]})}),g.jsx("g",{className:"animate-spin",style:{transformOrigin:"center",animationDuration:"60s"},children:[...Array(15)].map((a,o)=>{const l=o/15*Math.PI*2,c=60+Math.random()*30,d=100+Math.cos(l)*c,h=100+Math.sin(l)*c;return g.jsx("circle",{cx:d,cy:h,r:Math.random()*1,fill:"white",className:"animate-pulse",style:{animationDelay:`${o*.3}s`}},o)})}),g.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"none",stroke:"url(#grad1)",strokeWidth:"0.5",className:"animate-pulse"}),g.jsx("circle",{cx:"100",cy:"100",r:"65",fill:"none",stroke:"#8b5cf6",strokeWidth:"0.2",strokeDasharray:"4,10",className:"opacity-40"})]}),g.jsx("div",{className:"absolute top-1/4 right-[10%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-violet-400 shadow-[0_0_20px_rgba(139,92,246,0.3)] animate-bounce",style:{animationDuration:"4.5s"},children:g.jsx(zP,{size:24})}),g.jsx("div",{className:"absolute bottom-[20%] left-[5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-fuchsia-400 shadow-[0_0_20px_rgba(217,70,239,0.3)] animate-bounce",style:{animationDuration:"5.5s",animationDelay:"1.2s"},children:g.jsx(JP,{size:24})}),g.jsx("div",{className:"absolute top-[45%] left-[-5%] p-3 sm:p-4 bg-black/40 backdrop-blur-xl border border-white/10 rounded-xl sm:rounded-2xl text-blue-400 shadow-[0_0_20px_rgba(59,130,246,0.3)] animate-bounce",style:{animationDuration:"6.5s",animationDelay:"2.5s"},children:g.jsx($P,{size:24})}),g.jsx("div",{className:"absolute w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-violet-500/10 to-transparent rounded-full flex items-center justify-center border border-white/5 backdrop-blur-sm",children:g.jsx(aE,{size:28,className:"text-white/80 animate-pulse"})})]})})]}),g.jsxs("div",{ref:t.ref,className:`mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[g.jsxs("div",{className:"text-right",children:[g.jsx("h3",{className:"text-2xl sm:text-3xl font-black text-white mb-2",children:" "}),g.jsx("p",{className:"text-yellow-400 text-sm sm:text-base font-bold mb-3",children:"       "}),g.jsx("div",{className:"h-1.5 w-32 bg-gradient-to-r from-violet-600 via-fuchsia-500 to-transparent rounded-full"})]}),g.jsx("p",{className:"text-slate-500 text-[9px] sm:text-[10px] font-bold uppercase tracking-[0.3em]",children:"Etqan Excellence Solutions"})]}),g.jsx("div",{ref:s.ref,className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-24",children:[{icon:g.jsx(C$,{className:"text-violet-400"}),title:"  ",subtitle:"Premium Web Experiences",desc:g.jsxs("div",{className:"space-y-3",children:[g.jsx("p",{children:"     (Portfolios)       ."}),g.jsxs("div",{className:"text-yellow-400 font-bold text-[11px] sm:text-xs bg-yellow-400/5 p-3 rounded-xl border border-yellow-400/10",children:[g.jsx("p",{className:"mb-2 opacity-80 border-b border-yellow-400/20 pb-1 inline-block",children:":"}),g.jsxs("ul",{className:"space-y-1",children:[g.jsx("li",{children:"   "}),g.jsx("li",{children:"   "}),g.jsx("li",{children:"    "})]})]})]}),tags:["React","Tailwind","Motion"],color:"violet"},{icon:g.jsx(aE,{className:"text-blue-400"}),title:"  ",subtitle:"Academic & Enterprise Solutions",desc:"            .",tags:["Architecture","Database","AI"],color:"blue"}].map((a,o)=>g.jsx(E9,{index:o,icon:a.icon,title:a.title,subtitle:a.subtitle,desc:a.desc,tags:a.tags,color:a.color,isVisible:s.isVisible},o))}),g.jsxs("div",{ref:i.ref,className:`glass-panel p-8 sm:p-16 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] via-[#050505] to-[#111] border border-white/5 relative overflow-hidden text-center transition-all duration-1000 transform shadow-2xl ${i.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-12"}`,children:[g.jsx("div",{className:"absolute -top-24 -left-24 w-64 h-64 bg-violet-600/10 rounded-full blur-[100px] pointer-events-none"}),g.jsx("div",{className:"absolute -bottom-24 -right-24 w-64 h-64 bg-fuchsia-600/10 rounded-full blur-[100px] pointer-events-none"}),g.jsxs("div",{className:"relative z-10 space-y-6 sm:space-y-8",children:[g.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 rounded-2xl bg-white/5 border border-white/10 mb-2",children:g.jsx(B$,{className:"text-violet-500 animate-pulse",size:28})}),g.jsx("h2",{className:"text-3xl sm:text-5xl font-black text-white tracking-tight",children:"   "}),g.jsx("p",{className:"text-slate-400 text-base sm:text-lg max-w-2xl mx-auto font-medium px-4",children:"        .   ."}),g.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-6 px-4",children:[g.jsxs("a",{href:"https://wa.me/962790000000",className:"w-full sm:w-auto px-10 py-4 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-white font-black flex items-center justify-center gap-3 transition-all shadow-xl shadow-emerald-900/20 text-sm sm:text-base",children:[g.jsx(lE,{size:22}),"   "]}),g.jsx("button",{className:"w-full sm:w-auto px-10 py-4 bg-white/5 border border-white/10 rounded-2xl text-slate-300 font-black hover:bg-white/10 transition-all text-sm sm:text-base",children:"  "})]})]})]}),g.jsxs("div",{className:"mt-20 text-center space-y-4 px-4 pb-12",children:[g.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 text-slate-600",children:[g.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"}),g.jsx("span",{className:"text-[9px] sm:text-[10px] font-black uppercase tracking-[0.3em] whitespace-nowrap",children:"Etqan Group Jordan"}),g.jsx("div",{className:"w-6 sm:w-8 h-px bg-white/5"})]}),g.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-700",children:"      2024"})]})]})]})},E9=({index:n,icon:e,title:t,subtitle:s,desc:i,tags:r,color:a,isVisible:o})=>{const l={violet:"text-violet-400",fuchsia:"text-fuchsia-400",blue:"text-blue-400",emerald:"text-emerald-400",amber:"text-amber-400",rose:"text-rose-400"};return g.jsxs("div",{className:`group glass-panel p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border backdrop-blur-xl transition-all duration-700 hover:-translate-y-2 flex flex-col h-full relative overflow-hidden transform ${o?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,style:{transitionDelay:`${n*150}ms`},children:[g.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"}),g.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-2xl bg-white/5 flex items-center justify-center mb-5 sm:mb-6 group-hover:scale-110 transition-transform duration-500",children:mf.cloneElement(e,{size:24})}),g.jsxs("div",{className:"mb-2",children:[g.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-1 group-hover:text-white transition-colors",children:t}),g.jsx("p",{className:`text-[9px] sm:text-[10px] font-black uppercase tracking-widest ${l[a]} opacity-70`,children:s})]}),g.jsx("div",{className:"text-slate-500 text-xs sm:text-sm leading-relaxed mb-6 sm:mb-8 flex-1 font-medium",children:i}),g.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((c,d)=>g.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-white/5 border border-white/5 text-[8px] sm:text-[9px] font-bold text-slate-400 uppercase tracking-wider",children:c},d))}),g.jsx("div",{className:"absolute -bottom-10 -right-10 w-20 h-20 sm:w-24 sm:h-24 rounded-full blur-[30px] sm:blur-[40px] opacity-0 group-hover:opacity-20 transition-opacity bg-current"})]})},rx=()=>{const[n,e]=j.useState(!1),t=j.useRef(null);return j.useEffect(()=>{const s=new IntersectionObserver(([i])=>{i.isIntersecting&&(e(!0),s.unobserve(i.target))},{threshold:.1});return t.current&&s.observe(t.current),()=>{t.current&&s.unobserve(t.current)}},[]),{ref:t,isVisible:n}},A9=({onNavigate:n})=>{const e=rx(),t=rx(),s=rx(),i="https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",r=()=>g.jsxs("div",{className:"flex items-center gap-2 mb-0 text-[10px] sm:text-xs font-bold text-slate-500 overflow-x-auto whitespace-nowrap py-2",dir:"rtl",children:[g.jsxs("button",{onClick:()=>n(Y.HOME),className:"flex items-center gap-1 hover:text-white transition-colors",children:[g.jsx(Zb,{size:14})," "]}),g.jsx(qv,{size:12,className:"shrink-0 opacity-40"}),g.jsx("span",{className:"text-white bg-violet-500/10 px-2 py-0.5 rounded-md border border-violet-500/20",children:" "})]});return g.jsxs("div",{className:"min-h-screen pt-16 sm:pt-40 pb-32 px-4 relative bg-[#020205] text-right overflow-x-hidden",dir:"rtl",children:[g.jsxs("div",{className:"fixed inset-0 pointer-events-none overflow-hidden",children:[g.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[100vw] h-[100vw] bg-violet-900/5 rounded-full blur-[120px]"}),g.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[80vw] h-[80vw] bg-fuchsia-900/5 rounded-full blur-[100px]"})]}),g.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-8 animate-lux-up px-2 sm:px-0",children:[g.jsx(r,{}),g.jsx("div",{className:"px-4 py-1.5 sm:px-5 sm:py-2 rounded-full bg-violet-500/10 border border-violet-500/20 text-violet-400 text-[10px] sm:text-[11px] font-black tracking-widest uppercase",children:" "})]}),g.jsx("div",{ref:e.ref,className:`relative mb-12 sm:mb-20 transition-all duration-1000 transform ${e.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:g.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-gradient-to-br from-[#0a0a0a] to-black border border-white/10 relative overflow-hidden flex flex-col items-center text-center",children:[g.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-1/2 bg-gradient-to-b from-violet-600/5 to-transparent"}),g.jsxs("div",{className:"relative mb-6 sm:mb-8",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-600/10 blur-3xl"}),g.jsx("div",{className:"relative w-28 h-28 sm:w-44 sm:h-44 bg-[#050505] rounded-[2rem] sm:rounded-[2.5rem] border border-white/10 flex items-center justify-center shadow-2xl mx-auto overflow-hidden group",children:g.jsx("img",{src:i,alt:"  ",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:a=>{a.target.src="https://api.dicebear.com/9.x/notionists/svg?seed=Joshua&backgroundColor=b6e3f4,c0aede,d1d4f9"}})}),g.jsx("div",{className:"absolute -bottom-1 -right-1 sm:-bottom-2 sm:-right-2 bg-violet-600 p-2 sm:p-2.5 rounded-xl sm:rounded-2xl border-2 sm:border-4 border-[#0a0a0a] text-white shadow-lg",children:g.jsx(Cf,{size:16,className:"sm:w-5 sm:h-5"})})]}),g.jsxs("div",{className:"space-y-4 relative z-10 w-full",children:[g.jsxs("h1",{className:"text-3xl sm:text-6xl font-black text-white tracking-tighter",children:[" ",g.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-white",children:" "})]}),g.jsx("p",{className:"text-slate-400 text-xs sm:text-base font-bold max-w-lg mx-auto leading-relaxed px-2",children:"            ."}),g.jsx("div",{className:"flex items-center justify-center gap-4 text-[10px] sm:text-xs font-black text-slate-500 uppercase tracking-widest pt-1",children:g.jsxs("span",{className:"flex items-center gap-1.5",children:[g.jsx(v$,{size:12,className:"text-violet-500 sm:w-3.5 sm:h-3.5"}),"  "]})}),g.jsxs("div",{className:"pt-6 sm:pt-8 flex flex-col items-center gap-3",children:[g.jsx("span",{className:"text-yellow-400 text-[11px] sm:text-sm font-black uppercase tracking-[0.25em] drop-shadow-[0_0_8px_rgba(250,204,21,0.3)]",children:" "}),g.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6",children:[g.jsx("a",{href:"https://www.facebook.com/yazanabokaheal2",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#1877F2]/10 border border-[#1877F2]/20 flex items-center justify-center text-[#1877F2] hover:bg-[#1877F2]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(24,119,242,0.15)] group",title:"",children:g.jsx(WV,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(24,119,242,0.5)] transition-all"})}),g.jsx("a",{href:"https://wa.me/972568401548",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#25D366]/10 border border-[#25D366]/20 flex items-center justify-center text-[#25D366] hover:bg-[#25D366]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(37,211,102,0.15)] group",title:"",children:g.jsx(lE,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(37,211,102,0.5)] transition-all"})}),g.jsx("a",{href:"https://t.me/yazan1342",target:"_blank",rel:"noopener noreferrer",className:"w-12 h-12 sm:w-16 sm:h-16 rounded-2xl bg-[#0088cc]/10 border border-[#0088cc]/20 flex items-center justify-center text-[#0088cc] hover:bg-[#0088cc]/20 hover:scale-110 transition-all shadow-[0_0_15px_rgba(0,136,204,0.15)] group",title:"",children:g.jsx(q$,{size:24,className:"sm:w-8 sm:h-8 group-hover:drop-shadow-[0_0_8px_rgba(0,136,204,0.5)] transition-all"})})]})]})]})]})}),g.jsxs("div",{ref:t.ref,className:`grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-12 transition-all duration-1000 transform ${t.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[g.jsxs("div",{className:"group relative",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),g.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-violet-500/30",children:[g.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-violet-500/10 flex items-center justify-center text-violet-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:g.jsx(Qb,{size:24,className:"sm:w-7 sm:h-7"})}),g.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),g.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["  ",g.jsx("span",{className:"text-violet-400 font-bold",children:" "}),"     -    ",g.jsx("span",{className:"text-yellow-400 font-bold",children:""}),"."]})]})]}),g.jsxs("div",{className:"group relative",children:[g.jsx("div",{className:"absolute inset-0 bg-fuchsia-600/20 blur-2xl opacity-0 group-hover:opacity-100 transition-opacity rounded-[2.5rem]"}),g.jsxs("div",{className:"glass-panel relative p-6 sm:p-8 rounded-[2rem] sm:rounded-[2.5rem] bg-[#050505] border border-white/5 h-full flex flex-col items-start text-right transition-all group-hover:border-fuchsia-500/30",children:[g.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 rounded-xl sm:rounded-2xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 mb-5 group-hover:scale-110 transition-transform shadow-inner",children:g.jsx(TV,{size:24,className:"sm:w-7 sm:h-7"})}),g.jsx("h3",{className:"text-lg sm:text-xl font-black text-white mb-2",children:" "}),g.jsxs("p",{className:"text-slate-400 text-xs sm:text-sm leading-relaxed font-medium",children:["    ",g.jsx("span",{className:"text-fuchsia-400 font-bold",children:"   - "}),".            ."]})]})]})]}),g.jsx("div",{ref:s.ref,className:`relative transition-all duration-1000 transform ${s.isVisible?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:g.jsxs("div",{className:"glass-panel p-6 sm:p-12 rounded-[2.5rem] sm:rounded-[3rem] bg-[#030303] border border-white/5 relative overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-violet-600/5 rounded-full blur-3xl"}),g.jsxs("div",{className:"flex flex-col items-center text-center space-y-6 sm:space-y-8 relative z-10",children:[g.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full bg-white/5 border border-white/10 text-violet-400 text-[9px] sm:text-[10px] font-black tracking-widest uppercase",children:[g.jsx(zP,{size:12}),"  "]}),g.jsxs("div",{className:"space-y-3",children:[g.jsx("h3",{className:"text-xl sm:text-4xl font-black text-white tracking-tight leading-tight px-4",children:"   "}),g.jsx("p",{className:"text-slate-500 text-xs sm:text-base max-w-2xl mx-auto leading-relaxed font-medium px-2",children:"              :"})]}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 w-full",children:[{icon:g.jsx($P,{}),label:"  ",color:"text-blue-400",bg:"bg-blue-500/5"},{icon:g.jsx(JP,{}),label:" ",color:"text-violet-400",bg:"bg-violet-500/5"},{icon:g.jsx(aE,{}),label:" ",color:"text-fuchsia-400",bg:"bg-fuchsia-500/5"}].map((a,o)=>g.jsxs("div",{className:"bg-white/5 p-5 rounded-[2rem] border border-white/5 flex flex-col items-center gap-3 sm:gap-4 group hover:bg-white/10 hover:-translate-y-1 transition-all",children:[g.jsx("div",{className:`${a.color} ${a.bg} p-3 sm:p-4 rounded-xl sm:rounded-2xl group-hover:scale-110 transition-transform`,children:mf.cloneElement(a.icon,{size:24,className:"sm:w-7 sm:h-7"})}),g.jsx("span",{className:"text-[10px] sm:text-sm font-black text-slate-200 tracking-tight",children:a.label})]},o))}),g.jsx("div",{className:"pt-6 sm:pt-10 w-full px-2",children:g.jsx("div",{className:"p-0.5 sm:p-1 rounded-[2rem] sm:rounded-[2.5rem] bg-gradient-to-r from-violet-600 via-fuchsia-600 to-violet-600",children:g.jsx("div",{className:"bg-[#0a0a0a] rounded-[1.8rem] sm:rounded-[2.3rem] p-4 sm:p-6 flex flex-wrap justify-center gap-2 sm:gap-4",children:[" "," "," "," "].map((a,o)=>g.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-3 py-1.5 sm:px-4 sm:py-2 bg-white/5 rounded-full text-[9px] sm:text-[10px] font-black text-slate-300 border border-white/5 uppercase tracking-wider",children:[g.jsx(ff,{size:12,className:"text-yellow-500"})," ",a]},o))})})})]})]})}),g.jsxs("div",{className:"mt-16 sm:mt-24 text-center space-y-6 pb-20",children:[g.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 opacity-30",children:[g.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"}),g.jsx("p",{className:"text-[8px] sm:text-[10px] font-black uppercase tracking-[0.3em] text-white",children:"Etqan Group  2026"}),g.jsx("div",{className:"h-px w-8 sm:w-12 bg-white"})]}),g.jsx("p",{className:"text-[8px] sm:text-[9px] text-slate-600 font-bold italic tracking-wide",children:'"      ."'})]})]})]})},ax=["Felix","Joshua","Nolan","Liam","Caleb","Mason","Jack","Ethan","Aiden","Leo","Aneka","Selena","Molly","Sophia","Zoe","Lily","Maya","Chloe","Ruby","Eva"],ox=n=>`https://api.dicebear.com/9.x/notionists/svg?seed=${n}&backgroundColor=b6e3f4,c0aede,d1d4f9`,lx=({src:n,alt:e,className:t})=>{const[s,i]=j.useState(!1);return g.jsxs("div",{className:`relative overflow-hidden bg-white/5 ${t}`,children:[!s&&g.jsx("div",{className:"absolute inset-0 bg-white/5 z-10 flex items-center justify-center"}),g.jsx("img",{src:n,alt:e,loading:"lazy",onLoad:()=>i(!0),className:`w-full h-full object-cover transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`})]})},T9=({user:n,quizHistory:e,onLogout:t,onSaveProfile:s,onNavigate:i})=>{const[r,a]=j.useState(!1),[o,l]=j.useState(!1),c=(n==null?void 0:n.user_metadata)||{};j.useEffect(()=>{r&&window.scrollTo({top:0,behavior:"smooth"})},[r]);const d=j.useMemo(()=>{const L=e.reduce((U,K)=>U+K.score*10,0),$=e.length>0?Math.round(e.reduce((U,K)=>U+K.score/K.total_questions,0)/e.length*100):0;let G=1,ee=200,P=0;L>=2e3?(G=5,ee=5e3,P=2e3):L>=1e3?(G=4,ee=2e3,P=1e3):L>=500?(G=3,ee=1e3,P=500):L>=200&&(G=2,ee=500,P=200);const F=Math.min(100,Math.max(0,(L-P)/(ee-P)*100)),H=[{id:"first",icon:g.jsx(Cf,{}),title:" ",earned:e.length>=1,desc:"  "},{id:"master",icon:g.jsx($v,{}),title:"",earned:e.length>=5,desc:" 5 "},{id:"exp",icon:g.jsx(ff,{}),title:" ",earned:L>=500,desc:" 500  "},{id:"perfect",icon:g.jsx(VP,{}),title:" ",earned:e.some(U=>U.score===U.total_questions),desc:"   100%"}];return{totalExp:L,avgScore:$,level:G,nextLevelXp:ee,progress:F,achievements:H}},[e]),[h,p]=j.useState(c.full_name||""),[y,v]=j.useState(c.gender||"male"),[_,E]=j.useState(c.age||"18-22"),[b,w]=j.useState(c.avatar||ax[0]),[S,T]=j.useState(c.university||""),[N,R]=j.useState(c.major||""),[k,I]=j.useState(c.academic_year||"1"),M=async()=>{l(!0),await s({full_name:h,gender:y,avatar:b,university:S,major:N,academic_year:k,age:_}),l(!1),a(!1)},D=L=>{if(!L)return" ";const $=new Date(L);return new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"numeric",day:"numeric"}).format($)},O=["  18","18-22","23-25","  25"];return g.jsx("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#0A192F] animate-lux-up",children:g.jsx("div",{className:"max-w-7xl mx-auto",children:r?g.jsx("div",{className:"glass-panel p-8 rounded-3xl border border-blue-900/80 bg-[#112240] animate-lux-scale",children:g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[g.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[g.jsxs("div",{children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[g.jsx(u9,{className:"text-amber-400",size:20}),"  "]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),g.jsx("input",{type:"text",value:h,onChange:L=>p(L.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),g.jsx("select",{value:_,onChange:L=>E(L.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 px-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all appearance-none",children:O.map(L=>g.jsx("option",{children:L},L))})]}),g.jsxs("div",{className:"md:col-span-2",children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),g.jsxs("div",{className:"flex bg-black/30 p-1 rounded-xl border border-blue-900/80",children:[g.jsx("button",{onClick:()=>v("male"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${y==="male"?"bg-blue-600 text-white":"text-slate-500 hover:text-white"}`,children:""}),g.jsx("button",{onClick:()=>v("female"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${y==="female"?"bg-pink-600 text-white":"text-slate-500 hover:text-white"}`,children:""})]})]})]})]}),g.jsxs("div",{children:[g.jsxs("h3",{className:"text-lg font-bold text-slate-200 mb-4 flex items-center gap-2 border-b border-blue-900/80 pb-2",children:[g.jsx(Qb,{className:"text-amber-400",size:20}),"  "]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" / "}),g.jsxs("div",{className:"relative",children:[g.jsx(iE,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),g.jsx("input",{type:"text",value:S,onChange:L=>T(L.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),g.jsxs("div",{children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:""}),g.jsxs("div",{className:"relative",children:[g.jsx(oE,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-600",size:16}),g.jsx("input",{type:"text",value:N,onChange:L=>R(L.target.value),className:"w-full bg-black/30 border border-blue-900/80 rounded-xl py-3 pr-12 pl-4 text-slate-200 focus:outline-none focus:border-amber-500 transition-all",placeholder:" "})]})]}),g.jsxs("div",{className:"md:col-span-2",children:[g.jsx("label",{className:"text-sm font-bold text-slate-400 block mb-2",children:" "}),g.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:["1","2","3","4","5",""].map(L=>g.jsx("button",{onClick:()=>I(L),className:`px-6 py-2 rounded-xl border font-bold text-sm transition-all whitespace-nowrap ${k===L?"bg-amber-500 border-amber-400 text-slate-900":"bg-black/30 border-blue-900/80 text-slate-500 hover:bg-white/5"}`,children:L===""?"":` ${L}`},L))})]})]})]}),g.jsxs("div",{className:"pt-6 flex gap-4 border-t border-blue-900/80",children:[g.jsxs(_t,{onClick:M,disabled:o,className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !border-amber-600 px-8",children:[o?g.jsx(gu,{size:18,className:"animate-spin"}):g.jsx(z$,{size:18}),o?" ...":" "]}),g.jsx(_t,{onClick:()=>a(!1),variant:"secondary",children:""})]})]}),g.jsxs("div",{className:"lg:col-span-4 flex flex-col h-full bg-black/20 rounded-2xl p-6 border border-blue-900/80",children:[g.jsxs("h3",{className:"text-sm font-bold text-slate-400 mb-4 flex items-center gap-2",children:[g.jsx(A$,{size:16}),"   "]}),g.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6 mb-6 relative",children:g.jsx("div",{className:"w-48 h-48 rounded-full border-4 border-amber-500 shadow-[0_0_30px_rgba(245,158,11,0.2)] relative z-10 bg-white/5 overflow-hidden",children:g.jsx(lx,{src:ox(b),alt:"Selected Avatar",className:"w-full h-full"})})}),g.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-3",children:" :"}),g.jsx("div",{className:"grid grid-cols-5 gap-2 h-auto overflow-y-auto max-h-[200px] pr-2 custom-scrollbar",children:ax.map(L=>g.jsx("div",{onClick:()=>w(L),className:`aspect-square rounded-xl cursor-pointer transition-all border-2 overflow-hidden ${b===L?"border-amber-500 scale-105 shadow-lg shadow-amber-500/20":"border-transparent hover:border-white/20 hover:scale-105"}`,children:g.jsx(lx,{src:ox(L),alt:L,className:"w-full h-full"})},L))})]})]})}):g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8 mt-6",children:[g.jsx("div",{className:"lg:col-span-1 space-y-6",children:g.jsxs("div",{className:"glass-panel bg-[#112240] p-6 sm:p-8 rounded-[2.5rem] border border-blue-900/80 flex flex-col items-center text-center relative overflow-hidden group",children:[g.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-amber-500/5 via-transparent to-transparent opacity-50 group-hover:opacity-100 transition-opacity"}),g.jsx("div",{className:"w-40 h-40 rounded-full border-[6px] border-[#0A192F] shadow-2xl mb-4 relative z-10 bg-violet-200 overflow-hidden transform group-hover:scale-105 transition-transform duration-500",children:g.jsx(lx,{src:ox(c.avatar||ax[0]),alt:"Profile",className:"w-full h-full"})}),g.jsx("h2",{className:"text-3xl font-black text-slate-200 mb-1 relative z-10",children:c.full_name}),g.jsx("p",{className:"text-sm text-slate-500 font-mono mb-4 sm:mb-6 relative z-10",children:n==null?void 0:n.email}),g.jsxs("div",{className:"w-full space-y-3 sm:space-y-4 text-right relative z-10",children:[g.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[g.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-blue-500/10 flex items-center justify-center text-blue-400 shrink-0",children:g.jsx(iE,{size:20})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:c.university||"  "})]})]}),g.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[g.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-fuchsia-500/10 flex items-center justify-center text-fuchsia-400 shrink-0",children:g.jsx(oE,{size:20})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:"text-sm font-bold text-slate-300 truncate max-w-[150px]",children:c.major||"  "})]})]}),g.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[g.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 shrink-0",children:g.jsx(MV,{size:20})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:" "}),g.jsx("p",{className:"text-sm font-bold text-slate-300",children:c.academic_year?c.academic_year===""?"":` ${c.academic_year}`:" "})]})]}),g.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 p-3 sm:p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:bg-black/50 transition-colors",children:[g.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-xl bg-amber-500/10 flex items-center justify-center text-amber-400 shrink-0",children:g.jsx(FP,{size:20})}),g.jsxs("div",{children:[g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase",children:""}),g.jsx("p",{className:"text-sm font-bold text-slate-300",children:c.age||" "})]})]})]}),g.jsx("div",{className:"w-full mt-4 relative z-10",children:g.jsxs(_t,{onClick:()=>a(!0),variant:"secondary",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl bg-white/5 hover:bg-white/10 border-blue-900/50 text-slate-300 hover:text-white",children:[g.jsx(R$,{size:16}),"  "]})}),g.jsx("div",{className:"w-full mt-3 pt-6 border-t border-blue-900/50 relative z-10",children:g.jsxs(_t,{onClick:t,variant:"danger",fullWidth:!0,className:"!py-3 !text-sm !rounded-xl opacity-80 hover:opacity-100",children:[g.jsx(HA,{size:16}),"  "]})})]})}),g.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4",children:[g.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[g.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-amber-400/10 flex items-center justify-center text-amber-400 transition-transform group-hover:scale-110",children:g.jsx(OA,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-2xl font-black text-white",children:e.length}),g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),g.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[g.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-emerald-500/10 flex items-center justify-center text-emerald-400 transition-transform group-hover:scale-110",children:g.jsx($v,{size:24})}),g.jsxs("div",{children:[g.jsxs("h4",{className:"text-2xl font-black text-white",children:[d.avgScore,"%"]}),g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]}),g.jsxs("div",{className:"glass-panel p-4 sm:p-5 rounded-[2rem] bg-[#050505] border border-blue-900/80 flex items-center gap-3 sm:gap-4 group",children:[g.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-400 transition-transform group-hover:scale-110",children:g.jsx(e2,{size:24})}),g.jsxs("div",{children:[g.jsx("h4",{className:"text-xs font-black text-white",children:D(n==null?void 0:n.created_at)}),g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:" "})]})]})]}),g.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-gradient-to-br from-[#112240] to-black border border-blue-900/80 relative overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 right-0 p-10 opacity-5",children:g.jsx(bV,{size:120})}),g.jsxs("div",{className:"relative z-10",children:[g.jsxs("div",{className:"flex items-center justify-between mb-6",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"w-14 h-14 rounded-2xl bg-amber-500/20 border border-amber-400/30 flex items-center justify-center text-amber-400 shadow-[0_0_20px_rgba(245,158,11,0.2)]",children:g.jsx("span",{className:"text-3xl font-black italic",children:d.level})}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-black text-slate-200 tracking-tight",children:" "}),g.jsxs("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:[d.totalExp,"   "]})]})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1",children:" "}),g.jsxs("p",{className:"text-sm font-black text-slate-300 italic",children:[d.nextLevelXp," XP"]})]})]}),g.jsx("div",{className:"relative h-4 bg-white/5 rounded-full overflow-hidden border border-blue-900/50 p-1 mb-10",children:g.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-yellow-400 rounded-full transition-all duration-1000 shadow-[0_0_15px_rgba(245,158,11,0.4)]",style:{width:`${d.progress}%`}})}),g.jsxs("h4",{className:"text-xs font-black text-slate-400 uppercase tracking-[0.2em] mb-6 flex items-center gap-2",children:[g.jsx(jA,{size:14,className:"text-yellow-500"}),"  "]}),g.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:d.achievements.map(L=>g.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex flex-col items-center text-center ${L.earned?"bg-white/5 border-amber-400/20":"bg-black/20 border-blue-900/50 opacity-40 grayscale"}`,children:[g.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-3 ${L.earned?"bg-amber-400/20 text-amber-400":"bg-white/5 text-slate-700"}`,children:L.icon}),g.jsx("p",{className:`text-xs font-black mb-1 ${L.earned?"text-slate-200":"text-slate-600"}`,children:L.title}),g.jsx("p",{className:"text-[9px] text-slate-500 leading-tight",children:L.desc})]},L.id))})]})]}),g.jsxs("div",{className:"glass-panel bg-[#112240] rounded-[2.5rem] p-8 border border-blue-900/80",children:[g.jsxs("div",{className:"flex items-center justify-between mb-6",children:[g.jsxs("h3",{className:"text-xl font-bold text-slate-200 flex items-center gap-3",children:[g.jsx(t$,{className:"text-amber-400",size:24}),"  "]}),g.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-white/5 px-3 py-1 rounded-full",children:[e.length," "]})]}),g.jsxs("div",{className:"space-y-3",children:[e.length===0?g.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-blue-900/50 rounded-3xl",children:[g.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-600",children:g.jsx(jP,{size:32})}),g.jsx("h4",{className:"text-lg font-bold text-slate-200 mb-2",children:"   "}),g.jsx("p",{className:"text-slate-500 mb-6 text-sm",children:"      ."}),g.jsx(_t,{onClick:()=>i(Y.HOME),className:"!bg-amber-500 hover:!bg-amber-600 !text-slate-900 !py-2 !px-6 !text-sm",children:" "})]}):e.slice(0,10).map((L,$)=>{const G=Math.round(L.score/L.total_questions*100);return g.jsxs("div",{className:"group p-4 rounded-2xl bg-black/30 border border-blue-900/50 hover:border-amber-400/30 hover:bg-black/40 transition-all flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsxs("div",{className:`w-14 h-14 shrink-0 rounded-2xl flex items-center justify-center font-black text-lg border ${G>=50?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400 shadow-[0_0_15px_rgba(16,185,129,0.1)]":"bg-red-500/10 border-red-500/20 text-red-400 shadow-[0_0_15px_rgba(239,68,68,0.1)]"}`,children:[G,"%"]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-bold text-slate-200 text-base mb-1 group-hover:text-amber-300 transition-colors",children:L.quiz_title}),g.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 font-medium",children:[g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(e2,{size:12})," ",L.created_at?new Intl.DateTimeFormat("ar-EG",{day:"numeric",month:"numeric",year:"numeric"}).format(new Date(L.created_at)):" "]}),g.jsxs("span",{className:"flex items-center gap-1",children:[g.jsx(ff,{size:12,className:"text-amber-500"})," +",L.score*10," XP"]})]})]})]}),g.jsxs("div",{className:"flex items-center justify-between sm:block sm:text-right border-t border-blue-900/50 sm:border-0 pt-3 sm:pt-0",children:[g.jsxs("span",{className:"text-sm font-bold text-slate-300 bg-black/30 px-3 py-1 rounded-lg border border-blue-900/50 sm:bg-transparent sm:border-0 sm:p-0",children:[L.score," / ",L.total_questions]}),g.jsx("p",{className:"text-[10px] text-slate-500 uppercase sm:mt-1 hidden sm:block",children:""})]})]},$)}),e.length>10&&g.jsx("p",{className:"text-center text-xs text-slate-600 mt-4 font-medium",children:"   10  ."})]})]})]})]})})})},C9=({user:n,onLogout:e,onNavigate:t})=>{const[s,i]=j.useState({totalQuizzes:0,totalToolUsage:0,totalStudents:0,totalExp:0,loading:!0}),[r,a]=j.useState([]),o=async()=>{i(l=>({...l,loading:!0}));try{const{data:l}=await Sn.from("quiz_history").select("user_id, score, quiz_title, player_name, created_at");if(l){const c=new Set(l.map(v=>v.user_id)).size,d=l.filter(v=>{var _;return!((_=v.quiz_title)!=null&&_.startsWith(": "))}),h=l.filter(v=>{var _;return(_=v.quiz_title)==null?void 0:_.startsWith(": ")}),p=d.reduce((v,_)=>v+_.score*10,0);i({totalQuizzes:d.length,totalToolUsage:h.length,totalStudents:c,totalExp:p,loading:!1});const y=[...l].sort((v,_)=>new Date(_.created_at).getTime()-new Date(v.created_at).getTime()).slice(0,12);a(y)}}catch(l){console.error("Admin stats fetch error:",l),i(c=>({...c,loading:!1}))}};return j.useEffect(()=>{o()},[]),g.jsxs("div",{className:"min-h-screen pt-24 pb-20 px-4 md:px-6 relative z-10 bg-[#020202] text-right",dir:"rtl",children:[g.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-20 overflow-hidden",children:g.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,#10b98115_0%,transparent_70%)]"})}),g.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[g.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6 mb-12 animate-lux-up",children:[g.jsxs("div",{className:"flex items-center gap-5",children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 bg-emerald-500 blur-2xl opacity-30 animate-pulse"}),g.jsx("div",{className:"relative w-24 h-24 sm:w-28 sm:h-28 rounded-[2.5rem] bg-[#0a0a0a] border border-emerald-500/30 flex items-center justify-center overflow-hidden shadow-2xl",children:g.jsx("img",{src:"https://lh3.googleusercontent.com/d/1tbzVNKO3FGH46Pa6MZ58OWD4BXVKdK5P",alt:"",className:"w-full h-full object-cover"})}),g.jsx("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-black p-2 rounded-xl shadow-lg border-4 border-[#020202]",children:g.jsx(HP,{size:20})})]}),g.jsxs("div",{className:"space-y-1",children:[g.jsx("h1",{className:"text-3xl sm:text-5xl font-black text-white tracking-tight",children:" "}),g.jsxs("div",{className:"flex items-center gap-2 text-emerald-400 font-bold text-sm",children:[g.jsx(hf,{size:16}),"   "]})]})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsxs(_t,{onClick:o,variant:"secondary",className:"!bg-white/5 border-white/10",children:[g.jsx(KP,{size:18,className:s.loading?"animate-spin":""}),"  "]}),g.jsxs(_t,{onClick:e,variant:"danger",className:"shadow-lg shadow-red-900/20",children:[g.jsx(HA,{size:18}),"  "]})]})]}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-12",children:[{label:" ",value:s.totalStudents,icon:g.jsx(WP,{}),color:"text-blue-400",bg:"bg-blue-500/10"},{label:" ",value:s.totalQuizzes,icon:g.jsx(OA,{}),color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:" ",value:s.totalToolUsage,icon:g.jsx(rE,{}),color:"text-amber-400",bg:"bg-amber-500/10"},{label:" ",value:s.totalExp,icon:g.jsx(ff,{}),color:"text-fuchsia-400",bg:"bg-fuchsia-500/10"}].map((l,c)=>g.jsxs("div",{className:"glass-panel p-6 rounded-[2rem] bg-[#080808] border border-white/5 hover:border-emerald-500/20 transition-all group animate-lux-up",style:{animationDelay:`${c*.1}s`},children:[g.jsx("div",{className:`w-12 h-12 rounded-2xl ${l.bg} ${l.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`,children:l.icon}),g.jsx("h4",{className:"text-3xl font-black text-white mb-1",children:s.loading?"...":l.value}),g.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:l.label})]},c))}),g.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[g.jsx("div",{className:"lg:col-span-2 space-y-6",children:g.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#050505] border border-white/5",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-3",children:[g.jsx(hV,{className:"text-emerald-400"}),"   "]}),g.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-emerald-500/10 text-emerald-400 rounded-full text-[10px] font-bold",children:[g.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"})," "]})]}),g.jsx("div",{className:"space-y-4",children:r.length===0?g.jsx("div",{className:"text-center py-12 text-slate-600",children:"   "}):r.map((l,c)=>{var p;const d=(p=l.quiz_title)==null?void 0:p.startsWith(": "),h=d?l.quiz_title.replace(": ",""):l.quiz_title;return g.jsxs("div",{className:`p-4 rounded-2xl border flex items-center justify-between group transition-all ${d?"bg-amber-500/5 border-amber-500/10":"bg-white/[0.02] border-white/5 hover:bg-white/[0.05]"}`,children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${d?"bg-amber-500/10 text-amber-400":"bg-emerald-500/10 text-emerald-400"}`,children:d?g.jsx(rE,{size:18}):g.jsx(Vv,{size:18})}),g.jsxs("div",{children:[g.jsxs("p",{className:"text-sm font-bold text-slate-200",children:[g.jsx("span",{className:d?"text-amber-400":"text-emerald-400",children:l.player_name}),d?"   ":"    ",g.jsx("span",{className:"text-white",children:d?h:l.score})]}),g.jsxs("p",{className:"text-[10px] text-slate-500 mt-1",children:[d?"  ":h,"  ",new Date(l.created_at).toLocaleTimeString("ar-EG")]})]})]}),g.jsx("div",{className:"text-right",children:g.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest ${d?"text-amber-500/50":"text-emerald-500/50"}`,children:d?"":""})})]},c)})})]})}),g.jsx("div",{className:"lg:col-span-1 space-y-6",children:g.jsxs("div",{className:"glass-panel p-8 rounded-[2.5rem] bg-[#050505] border border-white/5 space-y-6",children:[g.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-3",children:[g.jsx($$,{className:"text-slate-400"}),"  "]}),g.jsxs("div",{className:"space-y-3",children:[g.jsxs("button",{className:"w-full flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition-all",children:[g.jsx("span",{className:"text-sm font-bold",children:" "}),g.jsx(zA,{size:16})]}),g.jsxs("button",{className:"w-full flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition-all",children:[g.jsx("span",{className:"text-sm font-bold",children:" "}),g.jsx(JV,{size:16})]}),g.jsxs("button",{className:"w-full flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition-all",children:[g.jsx("span",{className:"text-sm font-bold",children:" "}),g.jsx(xV,{size:16})]})]}),g.jsx("div",{className:"pt-6 border-t border-white/5",children:g.jsxs("div",{className:"p-4 rounded-2xl bg-amber-500/5 border border-amber-500/10",children:[g.jsxs("div",{className:"flex items-center gap-2 text-amber-500 mb-2",children:[g.jsx(hf,{size:16}),g.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:" "})]}),g.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:"      ()          ."})]})})]})})]})]})]})},N9=n=>{switch(n){case"true_false":return{label:" / ",icon:g.jsx(UA,{size:12}),color:"bg-orange-500/10 text-orange-400 border-orange-500/20"};case"cloze":return{label:" ",icon:g.jsx(a9,{size:12}),color:"bg-purple-500/10 text-purple-400 border-purple-500/20"};case"wh_question":return{label:" ",icon:g.jsx(BA,{size:12}),color:"bg-blue-500/10 text-blue-400 border-blue-500/20"};default:return{label:" ",icon:g.jsx(P$,{size:12}),color:"bg-slate-800/50 text-slate-300 border-slate-700/50"}}},R9=({question:n,selectedOptionIndex:e,onSelectOption:t,showFeedback:s,language:i})=>{const r=N9(n.type),a=i==="en",o=a?"ltr":"rtl",l=a?"text-left":"text-right";return g.jsxs("div",{className:"w-full max-w-3xl mx-auto animate-fade-in-up",dir:o,children:[g.jsxs("div",{className:"glass-panel bg-[#080808]/95 rounded-2xl p-5 md:p-6 relative overflow-hidden border border-white/5 shadow-xl",children:[g.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-2/3 h-0.5 bg-gradient-to-r from-transparent via-violet-500/30 to-transparent blur-sm"}),g.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-[10px] font-bold border mb-4 ${r.color}`,dir:"rtl",children:[r.icon,g.jsx("span",{children:r.label})]}),g.jsx("h2",{className:`text-sm md:text-[15px] font-bold text-white leading-relaxed mb-6 ${l} drop-shadow-sm tracking-wide`,children:n.question}),g.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.options.map((c,d)=>{let h="border-white/5 bg-white/[0.02] hover:bg-white/[0.05] hover:border-violet-500/30",p=null,y="text-slate-300";return e===d&&(h="border-violet-500 bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.1)]",y="text-white font-semibold"),s&&(d===n.correctAnswerIndex?(h="border-emerald-500/50 bg-emerald-500/10",y="text-emerald-300 font-bold",p=g.jsx(Vv,{className:"text-emerald-500 shrink-0 drop-shadow-[0_0_8px_rgba(16,185,129,0.5)]",size:16})):e===d&&d!==n.correctAnswerIndex?(h="border-red-500/50 bg-red-500/10",y="text-red-300 font-medium",p=g.jsx(HV,{className:"text-red-500 shrink-0",size:16})):(h="border-transparent bg-black/20 opacity-40",y="text-slate-500")),g.jsxs("button",{onClick:()=>!s&&t(d),disabled:s,className:`group w-full ${l} p-3 rounded-xl border transition-all duration-200 flex items-center justify-between gap-3 ${h}`,children:[g.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[g.jsx("div",{className:`shrink-0 w-6 h-6 rounded-md border flex items-center justify-center text-[10px] font-bold transition-all ${e===d?"border-violet-500 text-violet-300 bg-violet-500/20":"border-white/10 text-slate-500 bg-white/5 group-hover:border-violet-500/50 group-hover:text-violet-300"}`,children:String.fromCharCode(65+d)}),g.jsx("span",{className:`text-xs md:text-[13px] leading-relaxed ${y}`,children:c})]}),p]},d)})})]}),s&&g.jsx("div",{className:`mt-4 bg-[#0A0A0A] border border-white/10 p-4 rounded-2xl shadow-lg animate-fade-in ${a?"text-left":"text-right"}`,children:g.jsxs("div",{className:"flex items-start gap-3",children:[g.jsx("div",{className:"mt-0.5 text-emerald-400 shrink-0 p-1.5 bg-emerald-500/10 rounded-full",children:g.jsx(Vv,{size:16})}),g.jsxs("div",{children:[g.jsx("p",{className:"font-bold text-sm mb-1 text-emerald-300",children:a?"Explanation":" "}),g.jsx("p",{className:"text-slate-400 text-xs leading-relaxed",children:n.explanation})]})]})})]})},k9=({quiz:n,config:e,onFinish:t,onExit:s})=>{const[i,r]=j.useState(0),[a,o]=j.useState(null),[l,c]=j.useState(!1),[d,h]=j.useState(0),[p,y]=j.useState(!1),v=e.questionCount*60,[_,E]=j.useState(v);j.useEffect(()=>{const R=setInterval(()=>{E(k=>k<=1?(clearInterval(R),t(d),0):k-1)},1e3);return()=>clearInterval(R)},[d,t]);const b=R=>{const k=Math.floor(R/60),I=R%60;return`${k}:${I.toString().padStart(2,"0")}`},w=()=>{i<n.questions.length-1?(r(R=>R+1),o(null),c(!1)):t(d)},S=()=>{const R=n.questions[i];a===R.correctAnswerIndex&&h(k=>k+1),c(!0)},T=n.questions[i],N=_<60;return g.jsxs("div",{className:"min-h-screen pb-20 relative z-10 pt-24 animate-lux-up",children:[g.jsxs("div",{className:"fixed top-20 left-0 right-0 z-40 bg-[#020617]/80 backdrop-blur-md border-b border-white/5 shadow-lg",children:[g.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-4 flex justify-between items-center",children:[g.jsxs("div",{className:"text-xl font-black text-white font-mono",children:[g.jsx("span",{className:"text-violet-400",children:i+1})," / ",g.jsx("span",{className:"text-slate-500",children:n.questions.length})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsxs("div",{className:`px-4 py-2 rounded-xl font-mono font-bold text-lg border transition-colors ${N?"bg-red-500/10 text-red-400 border-red-500/20 animate-pulse":"bg-white/5 text-slate-300 border-white/5"}`,children:[g.jsx(FA,{size:18,className:"inline mr-2"})," ",b(_)]}),g.jsx("button",{onClick:()=>y(!0),className:"p-3 rounded-xl bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500/20 transition-all",children:g.jsx(e_,{size:18})})]})]}),g.jsx("div",{className:"w-full h-1 bg-white/5",children:g.jsx("div",{className:"h-full bg-gradient-to-r from-violet-600 to-fuchsia-600 transition-all duration-500",style:{width:`${(i+1)/n.questions.length*100}%`}})})]}),g.jsxs("div",{className:"max-w-3xl mx-auto px-4 pt-20",children:[g.jsx("div",{className:"animate-lux-scale",children:g.jsx(R9,{question:T,selectedOptionIndex:a,onSelectOption:o,showFeedback:l,language:e.language})},i),g.jsx("div",{className:"mt-8 flex justify-center gap-4",children:l?g.jsx(_t,{onClick:w,variant:"secondary",className:"w-full md:w-2/3 bg-white text-black hover:bg-slate-200 border-none shadow-xl",children:i<n.questions.length-1?" ":"  "}):g.jsx(_t,{onClick:S,disabled:a===null,className:"w-full md:w-2/3 shadow-xl",children:" "})})]}),p&&g.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>y(!1)}),g.jsxs("div",{className:"glass-panel w-full max-w-sm p-8 rounded-3xl text-center relative animate-lux-scale border border-white/10",children:[g.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-red-500/20",children:g.jsx(XP,{size:32,className:"text-red-500"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"   "}),g.jsx("p",{className:"text-slate-400 mb-8 text-sm leading-relaxed",children:"           ."}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx(_t,{onClick:s,variant:"danger",fullWidth:!0,className:"!py-3",children:" "}),g.jsx(_t,{onClick:()=>y(!1),variant:"secondary",fullWidth:!0,className:"!py-3",children:""})]})]})]})]})},M9=({appState:n,onNavigate:e,onReset:t,onUploadClick:s,isVisible:i})=>i?g.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 z-[60] animate-lux-up",children:g.jsx("div",{className:"bg-black border-t border-white/5 shadow-[0_-10px_40px_rgba(0,0,0,0.8)] pt-3 pb-6 px-2",children:g.jsxs("div",{className:"max-w-md mx-auto flex items-center justify-around relative",children:[g.jsxs("button",{onClick:()=>t(),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${n===Y.HOME?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[g.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${n===Y.HOME?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:g.jsx(Zb,{size:20,strokeWidth:n===Y.HOME?2.5:2})}),g.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${n===Y.HOME?"text-violet-300":"text-slate-600"}`,children:""})]}),g.jsxs("button",{onClick:()=>e(Y.SERVICES),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${n===Y.SERVICES?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[g.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${n===Y.SERVICES?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:g.jsx(o$,{size:20,strokeWidth:n===Y.SERVICES?2.5:2})}),g.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${n===Y.SERVICES?"text-violet-300":"text-slate-600"}`,children:""})]}),g.jsxs("button",{onClick:s,className:"flex flex-col items-center gap-1.5 flex-1 group",children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-600 blur-xl opacity-20 group-active:opacity-40"}),g.jsx("div",{className:"relative w-10 h-10 bg-gradient-to-br from-violet-500 to-purple-700 rounded-xl flex items-center justify-center text-white shadow-lg border border-white/10 active:scale-90 transition-all",children:g.jsx(YP,{size:22,strokeWidth:3})})]}),g.jsx("span",{className:"text-[8px] font-black text-violet-400 uppercase tracking-wider",children:" "})]}),g.jsxs("button",{onClick:()=>e(Y.DEVAI),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${n===Y.DEVAI?"text-fuchsia-400":"text-slate-500 hover:text-slate-300"}`,children:[g.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${n===Y.DEVAI?"bg-fuchsia-500/10 shadow-[0_0_15px_rgba(217,70,239,0.2)]":""}`,children:g.jsx(Cf,{size:20,strokeWidth:n===Y.DEVAI?2.5:2})}),g.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${n===Y.DEVAI?"text-fuchsia-300":"text-slate-600"}`,children:""})]}),g.jsxs("button",{onClick:()=>e(Y.PROFILE),className:`flex flex-col items-center gap-1.5 transition-all duration-300 flex-1 ${n===Y.PROFILE?"text-violet-400":"text-slate-500 hover:text-slate-300"}`,children:[g.jsx("div",{className:`p-2 rounded-xl transition-all duration-300 ${n===Y.PROFILE?"bg-violet-500/10 shadow-[0_0_15px_rgba(139,92,246,0.2)]":""}`,children:g.jsx(Wb,{size:20,strokeWidth:n===Y.PROFILE?2.5:2})}),g.jsx("span",{className:`text-[8px] font-extrabold uppercase tracking-wider ${n===Y.PROFILE?"text-violet-300":"text-slate-600"}`,children:""})]})]})})}):null,I9=mf.memo(({appState:n,user:e,onReset:t,onNavigate:s,onAuthOpen:i,onLogout:r,onProfile:a,isMobileMenuOpen:o,setIsMobileMenuOpen:l})=>{var p,y;const c=n===Y.QUIZ||n===Y.PROCESSING,d=v=>{c||v()},h=((p=e==null?void 0:e.user_metadata)==null?void 0:p.role)==="admin";return g.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 bg-black/50 backdrop-blur-md border-b border-white/5 animate-lux-up w-full",children:[g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 h-16 sm:h-20 flex items-center justify-between",children:[g.jsxs("div",{className:`flex items-center gap-3 sm:gap-5 group ${c?"cursor-not-allowed opacity-50":"cursor-pointer"}`,onClick:()=>d(t),children:[g.jsxs("div",{className:"relative",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-500 blur-xl opacity-40 group-hover:opacity-70 transition-opacity"}),g.jsx("div",{className:"relative w-12 h-12 sm:w-16 sm:h-16 bg-[#0f0f0f] border border-white/10 rounded-xl sm:rounded-2xl flex items-center justify-center shadow-2xl transition-transform group-hover:scale-110",children:h?g.jsx(hf,{className:"text-emerald-400 w-7 h-7 sm:w-10 sm:h-10"}):g.jsx(Qb,{className:"text-violet-400 w-7 h-7 sm:w-10 sm:h-10"})})]}),g.jsxs("div",{className:"flex flex-col",children:[g.jsx("span",{className:"text-3xl sm:text-5xl font-black text-white tracking-tighter leading-none drop-shadow-[0_0_15px_rgba(139,92,246,0.3)]",children:""}),g.jsx("span",{className:"text-[8px] sm:text-[10px] text-violet-400/70 font-bold tracking-[0.3em] hidden sm:block uppercase",children:"IDRAAK"})]}),c&&g.jsx(zA,{size:14,className:"text-slate-500 ml-1 sm:ml-2"})]}),!c&&g.jsxs("div",{className:"hidden lg:flex flex-1 items-center justify-center gap-10 text-sm font-medium text-slate-400",children:[g.jsxs("button",{onClick:()=>t(),className:`hover:text-white transition-colors relative py-2 ${n===Y.HOME?"text-white":""}`,children:["",n===Y.HOME&&g.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-violet-500 rounded-full animate-lux-scale"})]}),g.jsxs("button",{onClick:()=>s(Y.SERVICES),className:`hover:text-white transition-colors relative py-2 ${n===Y.SERVICES?"text-white":""}`,children:[" ",n===Y.SERVICES&&g.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-violet-500 rounded-full animate-lux-scale"})]}),g.jsxs("button",{onClick:()=>s(Y.DEVAI),className:`hover:text-white transition-colors relative py-2 ${n===Y.DEVAI?"text-white":""}`,children:["",n===Y.DEVAI&&g.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-violet-500 rounded-full animate-lux-scale"})]}),g.jsxs("button",{onClick:()=>s(Y.ABOUT),className:`hover:text-white transition-colors relative py-2 ${n===Y.ABOUT?"text-white":""}`,children:[" ",n===Y.ABOUT&&g.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-violet-500 rounded-full animate-lux-scale"})]})]}),g.jsx("div",{className:"flex items-center gap-2 sm:gap-3",children:c?g.jsx("div",{className:"w-8"}):e?g.jsx("div",{className:"hidden md:flex items-center gap-3",children:g.jsxs("button",{onClick:a,className:`flex items-center gap-2 px-4 py-2 rounded-xl border transition-all ${n===Y.PROFILE?h?"bg-emerald-500 text-black border-emerald-600 font-bold":"bg-amber-400 text-slate-900 border-amber-500 font-bold":"bg-white/5 text-slate-300 border-white/10 hover:bg-white/10 hover:text-white"}`,children:[h?g.jsx(hf,{size:16}):g.jsx(Wb,{size:16}),g.jsx("span",{className:"text-sm",children:((y=e.user_metadata)==null?void 0:y.full_name)||" "})]})}):g.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[g.jsx("button",{onClick:i,className:"text-white hover:text-violet-300 transition-colors font-medium text-sm",children:" "}),g.jsx("button",{onClick:i,className:"px-5 py-2 rounded-full bg-white text-black font-bold text-xs hover:bg-slate-200 transition-colors",children:" "})]})}),!c&&g.jsx("button",{className:"lg:hidden p-2 text-slate-300 hover:bg-white/10 rounded-lg",onClick:()=>l(!o),children:o?g.jsx(e_,{size:24}):g.jsx(x$,{size:24})})]}),o&&!c&&g.jsxs("div",{className:"md:hidden absolute top-16 sm:top-20 left-0 right-0 bg-[#050505] border-b border-white/10 p-6 flex flex-col gap-4 animate-lux-up shadow-2xl",children:[g.jsx("button",{onClick:()=>{t(),l(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:""}),g.jsx("button",{onClick:()=>{s(Y.SERVICES),l(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:" "}),g.jsx("button",{onClick:()=>{s(Y.DEVAI),l(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:""}),g.jsx("button",{onClick:()=>{s(Y.ABOUT),l(!1)},className:"text-right font-bold text-slate-300 hover:text-white py-2",children:" "}),e?g.jsxs(g.Fragment,{children:[g.jsx("button",{onClick:()=>{a(),l(!1)},className:`text-right font-bold py-2 ${h?"text-emerald-400":"text-amber-300"}`,children:h?" ":" "}),g.jsx("button",{onClick:()=>{r(),l(!1)},className:"text-right font-bold text-red-400 hover:text-red-300 py-2",children:" "})]}):g.jsx("button",{onClick:()=>{i(),l(!1)},className:"text-right font-bold text-violet-300 hover:text-violet-200 py-2",children:" "})]})]})});function D9(){var er;const[n,e]=j.useState(Y.HOME),[t,s]=j.useState(""),[i,r]=j.useState(0),[a,o]=j.useState(null),[l,c]=j.useState(0),[d,h]=j.useState(""),[p,y]=j.useState(!1),[v,_]=j.useState(null),[E,b]=j.useState(!1),[w,S]=j.useState([]),[T,N]=j.useState(!1),[R,k]=j.useState(null),[I,M]=j.useState(!1),[D,O]=j.useState(null),[L,$]=j.useState(null),[G,ee]=j.useState({language:"ar",questionCount:10,focusTopic:""}),P=((er=v==null?void 0:v.user_metadata)==null?void 0:er.role)==="admin",F=async Z=>{var tt,St,tr;if(!v)return;const ke={user_id:v.id,quiz_title:`: ${Z}`,score:0,total_questions:0,player_name:((tt=v.user_metadata)==null?void 0:tt.full_name)||" ",player_avatar:((St=v.user_metadata)==null?void 0:St.avatar)||"Felix"};await Sn.from("quiz_history").insert([ke]),((tr=v.app_metadata)==null?void 0:tr.provider)!=="guest"&&U(v.id,!1)},H=j.useCallback(Z=>{if(Z===n){window.scrollTo({top:0,left:0,behavior:"smooth"});return}if(Z===Y.PROFILE&&!v){O(Y.PROFILE),b(!0);return}window.history.pushState({appState:Z},""),e(Z),window.scrollTo({top:0,left:0,behavior:"smooth"})},[n,v]);j.useEffect(()=>{const Z=ke=>{ke.state&&ke.state.appState?(e(ke.state.appState),window.scrollTo({top:0,left:0,behavior:"smooth"})):(e(Y.HOME),window.scrollTo({top:0,left:0,behavior:"smooth"}))};return window.addEventListener("popstate",Z),window.history.replaceState({appState:Y.HOME},""),()=>window.history.state&&window.removeEventListener("popstate",Z)},[]),j.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[n]),j.useEffect(()=>{const Z=document.getElementById("stars-container");Z&&(Z.style.display=n===Y.SERVICES||n===Y.PROFILE||n===Y.DEVAI||n===Y.ABOUT?"none":"block")},[n]),j.useEffect(()=>{(async()=>{const{data:{session:tt}}=await Sn.auth.getSession();if(tt!=null&&tt.user)_(tt.user),U(tt.user.id,!1);else{const St=localStorage.getItem("guest_user");if(St){const tr=JSON.parse(St);_(tr),U(tr.id,!0)}}})();const{data:{subscription:ke}}=Sn.auth.onAuthStateChange((tt,St)=>{St!=null&&St.user&&(_(St.user),U(St.user.id,!1))});return()=>ke.unsubscribe()},[]);const U=async(Z,ke)=>{if(ke)S(JSON.parse(localStorage.getItem("guest_history")||"[]"));else{const{data:tt,error:St}=await Sn.from("quiz_history").select("*").eq("user_id",Z).order("created_at",{ascending:!1});tt&&!St&&S(tt)}},K=async Z=>{var tr,JA,XA;if(!v||!a)return;const ke={quiz_title:a.title||" ",score:Z,total_questions:a.questions.length,created_at:new Date().toISOString()},tt=((tr=v.app_metadata)==null?void 0:tr.provider)==="guest",St={user_id:v.id,quiz_title:ke.quiz_title,score:ke.score,total_questions:ke.total_questions,player_name:((JA=v.user_metadata)==null?void 0:JA.full_name)||" ",player_avatar:((XA=v.user_metadata)==null?void 0:XA.avatar)||"Felix"};if(await Sn.from("quiz_history").insert([St]),tt){const ZP=JSON.parse(localStorage.getItem("guest_history")||"[]"),WA=[ke,...ZP];localStorage.setItem("guest_history",JSON.stringify(WA)),S(WA)}else U(v.id,!1)},se=async()=>{N(!0),y(!1),setTimeout(async()=>{var Z;((Z=v==null?void 0:v.app_metadata)==null?void 0:Z.provider)==="guest"?localStorage.removeItem("guest_user"):await Sn.auth.signOut(),_(null),S([]),H(Y.HOME),N(!1)},1500)},le=async Z=>{var tt;if(((tt=v.app_metadata)==null?void 0:tt.provider)==="guest"){const St={...v,user_metadata:Z};localStorage.setItem("guest_user",JSON.stringify(St)),_(St),await Sn.from("quiz_history").update({player_name:Z.full_name,player_avatar:Z.avatar}).eq("user_id",v.id)}else{const{data:St,error:tr}=await Sn.auth.updateUser({data:Z});St.user&&!tr&&(_(St.user),await Sn.from("quiz_history").update({player_name:Z.full_name,player_avatar:Z.avatar}).eq("user_id",St.user.id))}},he=async Z=>{ee(ke=>({...ke,focusTopic:""})),k(Z),M(!0);try{const ke=await W5(Z);$(ke)}catch(ke){M(!1),h(ke.message||"    ."),e(Y.ERROR)}},Je=async()=>{if(L){M(!1);try{e(Y.PROCESSING),s("  ..."),r(0);const Z=setInterval(()=>{r(tt=>tt>=95?tt:tt+(tt<50?5:.5))},200);s("   ...");const ke=await dj(L,G);clearInterval(Z),r(100),await new Promise(tt=>setTimeout(tt,600)),o(ke),e(Y.QUIZ)}catch(Z){h(Z.message||"   "),e(Y.ERROR)}}},Le=Z=>{c(Z),e(Y.RESULT),K(Z)},wt=()=>{n===Y.HOME?window.scrollTo({top:0,left:0,behavior:"smooth"}):H(Y.HOME),o(null),c(0),h(""),r(0),y(!1),M(!1),k(null),ee(Z=>({...Z,focusTopic:""})),$(null)},ht=()=>{var Z;n!==Y.HOME?(e(Y.HOME),setTimeout(()=>{var ke;(ke=document.getElementById("upload-section"))==null||ke.scrollIntoView({behavior:"smooth"})},100)):(Z=document.getElementById("upload-section"))==null||Z.scrollIntoView({behavior:"smooth"}),o(null),c(0),h("")},Nf=()=>g.jsxs("div",{className:"pt-24 sm:pt-32 pb-20 relative z-10 flex flex-col items-center min-h-screen animate-lux-up overflow-hidden w-full",children:[g.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[60%] w-[350px] sm:w-[500px] md:w-[800px] h-[350px] sm:h-[500px] md:h-[800px] bg-violet-600/10 rounded-full blur-[60px] md:blur-[120px] pointer-events-none z-[-1]"}),g.jsxs("div",{className:"max-w-4xl w-full px-4 text-center mb-10 sm:mb-16",children:[g.jsx("h1",{className:"text-8xl sm:text-9xl md:text-[10rem] font-black mb-6 sm:mb-8 leading-tight tracking-tighter drop-shadow-[0_0_30px_rgba(139,92,246,0.35)] flex flex-wrap justify-center items-center gap-x-4 sm:gap-x-6",children:g.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-500 to-white animate-pulse",children:""})}),g.jsx("p",{className:"text-xl sm:text-lg md:text-xl text-slate-400 max-w-2xl mx-auto mb-8 sm:mb-10 leading-relaxed px-4 font-medium",children:"                           "}),g.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 px-4 w-full",children:[g.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 w-full sm:w-auto",children:[g.jsxs(_t,{onClick:()=>{var Z;return(Z=document.getElementById("upload-section"))==null?void 0:Z.scrollIntoView({behavior:"smooth"})},className:"rounded-full px-8 sm:px-10 py-3.5 sm:py-4 text-sm sm:text-base w-full sm:w-auto",children:[g.jsx(BP,{size:18,className:"sm:w-5 sm:h-5"}),g.jsx("span",{className:"mr-1 sm:mr-2",children:"  "})]}),g.jsxs(_t,{variant:"secondary",onClick:()=>H(Y.ABOUT),className:"rounded-full px-8 sm:px-10 py-3.5 sm:py-4 text-sm sm:text-base w-full sm:w-auto border-violet-500/20 hover:border-violet-500/50",children:[g.jsx(j$,{size:18,className:"sm:w-5 sm:h-5 text-violet-400"}),g.jsx("span",{className:"mr-1 sm:mr-2",children:" "})]})]}),v?g.jsxs("button",{onClick:()=>H(Y.PROFILE),className:"mt-2 sm:mt-4 flex items-center gap-2 sm:gap-3 px-5 sm:px-6 py-2 sm:py-2.5 rounded-full bg-white/5 hover:bg-white/10 border border-white/5 hover:border-violet-500/30 transition-all group",children:[g.jsx("div",{className:`w-7 h-7 sm:w-8 sm:h-8 rounded-full ${P?"bg-emerald-500/10":"bg-violet-500/10"} flex items-center justify-center group-hover:scale-110 transition-transform`,children:P?g.jsx(hf,{size:14,className:"text-emerald-400"}):g.jsx(Wb,{size:14,className:"text-violet-400"})}),g.jsx("span",{className:"text-slate-300 group-hover:text-white font-bold text-xs sm:text-sm",children:P?" ":" "})]}):g.jsxs("button",{onClick:()=>b(!0),className:"mt-2 sm:mt-4 flex items-center gap-2 sm:gap-3 px-5 sm:px-6 py-2 sm:py-2.5 rounded-full bg-white/5 hover:bg-white/10 border border-white/5 hover:border-violet-500/30 transition-all group",children:[g.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-violet-500/10 flex items-center justify-center group-hover:scale-110 transition-transform",children:g.jsx(qP,{size:14,className:"text-violet-400"})}),g.jsx("span",{className:"text-slate-300 group-hover:text-white font-bold text-xs sm:text-sm",children:" "})]})]})]}),g.jsx("div",{id:"upload-section",className:"w-full max-w-5xl px-4 md:px-6 mb-8 mt-4 sm:mt-8",children:g.jsx("div",{className:"glass-panel p-1 rounded-[2rem] sm:rounded-[2.5rem] bg-gradient-to-b from-white/10 to-transparent",children:g.jsx("div",{className:"bg-[#030303] rounded-[1.8rem] sm:rounded-[2.3rem] p-6 md:p-10 border border-white/5 relative overflow-hidden",children:g.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start relative z-10",children:[g.jsxs("div",{className:"w-full md:w-1/3 flex flex-col gap-6",children:[g.jsxs("div",{children:[g.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-white mb-2 flex items-center gap-2",children:[g.jsx(m9,{size:20,className:"text-violet-400"}),"  "]}),g.jsx("p",{className:"text-slate-500 text-xs sm:text-sm",children:"   "})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[g.jsx("label",{className:"text-[10px] sm:text-xs font-bold text-slate-400 mb-3 block uppercase tracking-wider",children:""}),g.jsx("div",{className:"flex gap-2",children:["ar","en"].map(Z=>g.jsx("button",{onClick:()=>ee({...G,language:Z}),className:`flex-1 py-2 rounded-lg text-xs sm:text-sm font-bold transition-all ${G.language===Z?"bg-violet-600 text-white":"bg-black/20 text-slate-500 hover:text-white"}`,children:Z==="ar"?"":"English"},Z))})]}),g.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl border border-white/5",children:[g.jsx("label",{className:"text-[10px] sm:text-xs font-bold text-slate-400 mb-3 block uppercase tracking-wider",children:" "}),g.jsx("div",{className:"grid grid-cols-3 gap-2",children:[1,5,10,20,30,40].map(Z=>g.jsx("button",{onClick:()=>ee({...G,questionCount:Z}),className:`py-2 rounded-lg text-xs sm:text-sm font-bold border transition-all ${G.questionCount===Z?"border-violet-500 bg-violet-500/10 text-violet-300":"border-white/10 bg-transparent text-slate-500"}`,children:Z},Z))})]})]})]}),g.jsxs("div",{className:"w-full md:w-2/3",children:[g.jsx(v9,{onFileSelect:he,disabled:!1}),!v&&g.jsxs("div",{className:"mt-4 flex items-start gap-2 sm:gap-3 bg-blue-500/10 border border-blue-500/20 p-3 sm:p-4 rounded-xl text-right",children:[g.jsx(GP,{size:16,className:"text-blue-400 mt-1 shrink-0"}),g.jsxs("p",{className:"text-blue-200 text-xs sm:text-sm leading-relaxed",children:[g.jsx("span",{className:"font-bold text-blue-100 block mb-1",children:":   ."}),"         ."]})]})]})]})})})}),g.jsx(_9,{}),g.jsx(x9,{})]}),Au=()=>{M(!1),k(null)},Sl=()=>P?g.jsx(C9,{user:v,onLogout:se,onNavigate:H}):g.jsx(T9,{user:v,quizHistory:w,onLogout:se,onSaveProfile:le,onNavigate:H});return g.jsxs("div",{className:"min-h-screen text-slate-100 font-sans selection:bg-violet-500/30 selection:text-violet-200 overflow-x-hidden w-full relative",dir:"rtl",children:[g.jsx(I9,{appState:n,user:v,onReset:wt,onNavigate:H,onAuthOpen:()=>b(!0),onLogout:se,onProfile:()=>H(Y.PROFILE),isMobileMenuOpen:p,setIsMobileMenuOpen:y}),g.jsxs("main",{className:"w-full overflow-x-hidden relative flex flex-col",children:[n===Y.HOME&&Nf(),n===Y.SERVICES&&g.jsx(w9,{onNavigate:H,onLogActivity:F}),n===Y.DEVAI&&g.jsx(S9,{onNavigate:H}),n===Y.ABOUT&&g.jsx(A9,{onNavigate:H}),n===Y.PROFILE&&Sl(),n===Y.QUIZ&&a&&g.jsx(k9,{quiz:a,config:G,onFinish:Le,onExit:wt}),n===Y.PROCESSING&&g.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen px-6 text-center animate-lux-scale w-full",children:[g.jsxs("div",{className:"relative mb-8",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-500 blur-2xl opacity-20 animate-pulse"}),g.jsx(gu,{className:"w-16 h-16 sm:w-24 sm:h-24 text-violet-500 animate-spin relative z-10"})]}),g.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-white mt-8 px-4",children:t}),g.jsx("div",{className:"w-48 sm:w-64 h-2 bg-white/5 rounded-full mt-6 overflow-hidden border border-white/5",children:g.jsx("div",{className:"h-full bg-violet-500 transition-all duration-300",style:{width:`${i}%`}})}),g.jsxs("p",{className:"text-slate-500 mt-2 font-mono text-xs sm:text-sm",children:[Math.round(i),"%"]})]}),n===Y.RESULT&&g.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 animate-lux-up w-full",children:g.jsxs("div",{className:"glass-panel p-8 sm:p-10 rounded-[2.5rem] sm:rounded-[3rem] text-center max-w-sm w-full border-white/10 bg-[#080808] relative overflow-hidden",children:[g.jsx("div",{className:"absolute -top-24 -left-24 w-48 h-48 bg-violet-600/20 rounded-full blur-3xl"}),g.jsx($v,{size:64,className:"text-yellow-400 mx-auto mb-6 sm:w-20 sm:h-20 drop-shadow-[0_0_15px_rgba(250,204,21,0.4)]"}),g.jsx("h2",{className:"text-2xl sm:text-3xl font-black mb-1 text-white",children:" "}),g.jsx("p",{className:"text-slate-500 text-xs sm:text-sm mb-6",children:"   !"}),g.jsxs("div",{className:"relative inline-block mb-10",children:[g.jsx("div",{className:"absolute inset-0 bg-violet-500 blur-2xl opacity-20"}),g.jsxs("p",{className:"text-5xl sm:text-7xl font-black text-white relative z-10",children:[Math.round(l/a.questions.length*100),g.jsx("span",{className:"text-xl sm:text-2xl text-violet-400",children:"%"})]})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx(_t,{onClick:wt,fullWidth:!0,className:"!py-3.5 sm:!py-4 text-sm",children:""}),g.jsx(_t,{onClick:()=>H(Y.PROFILE),variant:"secondary",fullWidth:!0,className:"!py-3.5 sm:!py-4 text-sm",children:" "})]})]})}),n===Y.ERROR&&g.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 animate-lux-up w-full",children:[g.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-red-500/10 rounded-2xl flex items-center justify-center mb-6 border border-red-500/20",children:g.jsx(XP,{size:32,className:"text-red-500 sm:w-10 sm:h-10"})}),g.jsx("h3",{className:"text-xl sm:text-2xl font-black text-white mb-2",children:"  "}),g.jsx("p",{className:"text-slate-500 mb-8 max-w-xs mx-auto text-xs sm:text-sm",children:d}),g.jsx(_t,{onClick:wt,variant:"outline",className:"px-8 text-sm",children:" "})]})]}),g.jsx(M9,{appState:n,onNavigate:H,onReset:wt,onUploadClick:ht,isVisible:n!==Y.QUIZ&&n!==Y.PROCESSING}),g.jsx(b9,{isOpen:E,onClose:()=>{b(!1),O(null)},onSuccess:Z=>{var ke;_(Z),U(Z.id,((ke=Z.app_metadata)==null?void 0:ke.provider)==="guest"),D&&(H(D),O(null))}}),I&&g.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[g.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-lg",onClick:Au}),g.jsxs("div",{className:"glass-panel w-full max-w-md bg-[#050505] rounded-[2.5rem] p-6 sm:p-8 relative animate-lux-scale border border-white/10 shadow-[0_0_50px_rgba(139,92,246,0.2)] overflow-hidden",children:[g.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-violet-600 via-fuchsia-600 to-violet-600"}),g.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[g.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 bg-violet-500/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-violet-500/20",children:g.jsx(Cf,{size:28,className:"text-violet-400 sm:w-8 sm:h-8"})}),g.jsx("h3",{className:"text-xl sm:text-2xl font-black text-white tracking-tight",children:" "}),g.jsx("p",{className:"text-slate-500 text-xs sm:text-sm",children:"    "})]}),g.jsxs("div",{className:"space-y-6",children:[g.jsxs("div",{className:"bg-white/[0.03] p-4 sm:p-5 rounded-2xl border border-white/5 group hover:border-white/10 transition-colors",children:[g.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4 p-2.5 rounded-xl bg-black/40 border border-white/5",children:[g.jsxs("div",{className:"flex flex-col items-center flex-1",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-violet-400 mb-0.5",children:[g.jsx(r$,{size:12}),g.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wider",children:""})]}),g.jsx("span",{className:"text-xs font-black text-white",children:G.language==="ar"?"":"English"})]}),g.jsx("div",{className:"w-px h-8 bg-white/5"}),g.jsxs("div",{className:"flex flex-col items-center flex-1",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-violet-400 mb-0.5",children:[g.jsx(BA,{size:12}),g.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wider",children:""})]}),g.jsx("span",{className:"text-xs font-black text-white",children:G.questionCount})]}),g.jsx("div",{className:"w-px h-8 bg-white/5"}),g.jsxs("div",{className:"flex flex-col items-center flex-1",children:[g.jsxs("div",{className:"flex items-center gap-1.5 text-violet-400 mb-0.5",children:[g.jsx(FA,{size:12}),g.jsx("span",{className:"text-[9px] font-bold uppercase tracking-wider",children:""})]}),g.jsxs("span",{className:"text-xs font-black text-white",children:[G.questionCount," "]})]})]}),g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx("div",{className:"p-2 sm:p-2.5 bg-violet-500/10 rounded-xl text-violet-400 group-hover:scale-110 transition-transform",children:g.jsx(jP,{size:18,className:"sm:w-5 sm:h-5"})}),g.jsxs("div",{className:"flex-1 overflow-hidden text-right",children:[g.jsx("p",{className:"text-[9px] sm:text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-0.5",children:" "}),g.jsx("p",{className:"text-white font-bold truncate text-xs sm:text-sm",children:R==null?void 0:R.name})]})]}),g.jsxs("div",{className:"pt-4 border-t border-white/5 space-y-4",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsx("label",{className:"text-[10px] sm:text-xs font-black text-slate-400 mb-2 block leading-relaxed text-right",children:"    (        )"}),g.jsxs("div",{className:"relative",children:[g.jsx(e9,{className:"absolute right-3 sm:right-4 top-1/2 -translate-y-1/2 text-slate-600 sm:w-4 sm:h-4",size:14}),g.jsx("input",{type:"text",value:G.focusTopic,onChange:Z=>ee({...G,focusTopic:Z.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl py-3 sm:py-3.5 pr-10 sm:pr-12 pl-4 text-white text-xs sm:text-sm focus:outline-none focus:border-violet-500 transition-all placeholder:text-slate-700",placeholder:":      ..."})]})]}),g.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-amber-500/5 border border-amber-500/10 rounded-xl animate-fade-in",children:[g.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[g.jsx(u$,{size:14}),g.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider",children:" "})]}),g.jsxs("p",{className:"text-[10px] text-slate-400 leading-relaxed text-right",children:["   : ",g.jsx("span",{className:"text-amber-200",children:'"   "'}),"  ",g.jsx("span",{className:"text-amber-200",children:'"   "'}),"    ."]})]}),g.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-500/5 border border-red-500/20 rounded-xl border-dashed",children:[g.jsx(UA,{size:14,className:"text-red-500 shrink-0 mt-0.5"}),g.jsx("p",{className:"text-[10px] text-red-400 leading-relaxed font-bold text-right",children:":           /        ."})]})]})]}),g.jsxs("div",{className:"flex gap-3",children:[g.jsx(_t,{onClick:Je,fullWidth:!0,className:"!py-3.5 sm:!py-4 text-sm shadow-xl",disabled:!L,children:L?"  ":g.jsxs("span",{className:"flex items-center gap-2",children:[g.jsx(gu,{size:16,className:"animate-spin"}),"  "]})}),g.jsx(_t,{onClick:Au,variant:"secondary",className:"!px-4 sm:!px-6 text-sm",children:""})]})]})]})]}),T&&g.jsxs("div",{className:"fixed inset-0 z-[200] bg-black/90 backdrop-blur-xl flex flex-col items-center justify-center w-full",children:[g.jsxs("div",{className:"relative mb-6",children:[g.jsx("div",{className:"absolute inset-0 bg-red-500 blur-2xl opacity-20 animate-pulse"}),g.jsx(HA,{size:48,className:"text-red-400 relative z-10 sm:w-16 sm:h-16"})]}),g.jsx("h2",{className:"text-xl sm:text-2xl font-black text-white tracking-tight",children:"  ..."})]})]})}const QP=document.getElementById("root");if(!QP)throw new Error("Could not find root element to mount to");const P9=Z4.createRoot(QP);P9.render(g.jsx(mf.StrictMode,{children:g.jsx(D9,{})}));
